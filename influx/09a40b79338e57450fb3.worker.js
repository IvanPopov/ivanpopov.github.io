!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="TZtI")}({"+nKl":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("FrU9"),a=r("fti1"),i=r("xj/u"),s=r("fs98");class l extends i.a{constructor({left:e,right:t,operator:r,...i}){super({instrType:n.b.k_LogicalExpr,type:a.b,...i}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=r}get operator(){return this._operator}get left(){return this._leftOperand}get right(){return this._rightOperand}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},"/zHR":function(e,t,r){"use strict";var n;function a(e){return`${e.line},${e.column}`}function i(e,t){return e.replace(/{([a-zA-Z.]+)}/g,(e,r)=>(function e(t,r){let n=r.split(".");return n.length>1?e(t[n[0]],n.splice(1).join(".")):t[n[0]]})(t,r))}r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),function(e){e[e.k_Warning=0]="k_Warning",e[e.k_Error=1]="k_Error"}(n||(n={}));class s extends Error{constructor(e,t){super(t.content),Error.captureStackTrace(this,s)}}class l{constructor(e,t){this._name=e,this._codePrefix=(t||"").toUpperCase(),this.reset()}emitException(){throw new s(this,this.getLastError())}reset(){this._entries=[]}resolve(){let e={errors:0,warnings:0,messages:[]};for(let t of this._entries){let r=this.resolveEntry(t);switch(r.category){case n.k_Warning:e.warnings++;break;case n.k_Error:e.errors++}e.messages.push(r)}return e}resolveEntry(e){let t,r,n,i=null,s=this.resolveFilename(e.code,e.desc);(t=this.resolveRange(e.code,e.desc))?(({start:r,end:n}=t),i=function(e){return`${a(e.start)}:${a(e.end)}`}(t)):i=a(r=this.resolvePosition(e.code,e.desc));let l=`${this.resolveDescription(e.code,e.category,e.desc)}`;return{code:`${this._codePrefix}${e.code}`,category:e.category,content:l,file:s,start:r,end:n}}resolveFilename(e,t){return"[unknown]"}resolvePosition(e,t){return{file:null,line:0,column:0}}resolveRange(e,t){return null}resolveDescription(e,t,r){let n=this.diagnosticMessages();return n?n[e]?i(n[e],r):`[no description found for code '${e}']`:(console.error(`Diagnostic messages of '${this._name}' not found.`),"[no description found]")}diagnosticMessages(){return null}error(e,t){this._entries.push({category:n.k_Error,code:e,desc:t})}warning(e,t){this._entries.push({category:n.k_Warning,code:e,desc:t})}critical(e,t){this.error(e,t),this.emitException()}prettyPrint(){return null}hasErrors(){return this._entries.filter(e=>e.category===n.k_Error).length>0}getLastError(){for(let e=this._entries.length-1;e>=0;--e)if(this._entries[e].category===n.k_Error)return this.resolveEntry(this._entries[e]);return null}static mergeReports(e){let t={errors:0,warnings:0,messages:[]};return e.forEach(e=>{t.errors+=e.errors,t.warnings+=e.warnings,t.messages=t.messages.concat(e.messages)}),t}static stringify(e){return e.messages.map(e=>e.content).join("\n")}static asRange(e){let t={start:e.start,end:e.end};t.end||(t.end={...t.start});const{start:r,end:n}=t;return n.line==r.line&&n.column==r.column&&(n.column+=1),t}}},"0wCl":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("FrU9"),a=r("fti1"),i=r("xj/u"),s=r("nkzX");class l extends i.a{constructor({value:e,scope:t,...r}){super({instrType:n.b.k_BoolExpr,type:s.a.wrapAsConst(a.b,a.a),scope:t,...r}),this._value="true"===e}set value(e){this._value=e}get value(){return this._value}toString(){return String(this._value)}toCode(){return this._value?"true":"false"}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},"1N+t":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({expr:e,operator:t,...r}){super({instrType:n.b.k_PostfixArithmeticExpr,type:e.type,...r}),this._operator=t,this._expr=i.a.$withParent(e,this)}get expr(){return this._expr}get operator(){return this._operator}toCode(){var e="";return e+=this.expr.toCode(),e+=this.operator}isConst(){return this.expr.isConst()}}},"2Gf8":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("xj/u"),a=r("fti1"),i=r("FrU9"),s=r("nkzX");class l extends n.a{constructor({value:e,scope:t,...r}){super({instrType:i.b.k_IntExpr,type:s.a.wrapAsConst(a.e,a.a),scope:t,...r}),this._value=1*e}get value(){return this._value}toString(){return this._value}toCode(){return this._value.toString()}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},"2blz":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.UNDEF=0]="UNDEF",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.ZERO=3]="ZERO",e[e.ONE=4]="ONE",e[e.SRCCOLOR=5]="SRCCOLOR",e[e.INVSRCCOLOR=6]="INVSRCCOLOR",e[e.SRCALPHA=7]="SRCALPHA",e[e.INVSRCALPHA=8]="INVSRCALPHA",e[e.DESTALPHA=9]="DESTALPHA",e[e.INVDESTALPHA=10]="INVDESTALPHA",e[e.DESTCOLOR=11]="DESTCOLOR",e[e.INVDESTCOLOR=12]="INVDESTCOLOR",e[e.SRCALPHASAT=13]="SRCALPHASAT",e[e.NONE=14]="NONE",e[e.CW=15]="CW",e[e.CCW=16]="CCW",e[e.FRONT=17]="FRONT",e[e.BACK=18]="BACK",e[e.FRONT_AND_BACK=19]="FRONT_AND_BACK",e[e.NEVER=20]="NEVER",e[e.LESS=21]="LESS",e[e.EQUAL=22]="EQUAL",e[e.LESSEQUAL=23]="LESSEQUAL",e[e.GREATER=24]="GREATER",e[e.NOTEQUAL=25]="NOTEQUAL",e[e.GREATEREQUAL=26]="GREATEREQUAL",e[e.ALWAYS=27]="ALWAYS",e[e.FUNCADD=28]="FUNCADD",e[e.FUNCSUBTRACT=29]="FUNCSUBTRACT",e[e.FUNCREVERSESUBTRACT=30]="FUNCREVERSESUBTRACT",e[e.LINELIST=31]="LINELIST",e[e.LINESTRIP=32]="LINESTRIP",e[e.TRIANGLELIST=33]="TRIANGLELIST",e[e.TRAINGLESTRIP=34]="TRAINGLESTRIP",e[e.POINTLIST=35]="POINTLIST"}(n||(n={}))},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"4Xpw":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({id:e,decl:t,...r}){super({instrType:n.b.k_IdExpr,type:t.type,...r}),this._id=i.a.$withParent(e,this),this._decl=t}get decl(){return this._decl}get id(){return this._id}get name(){return this.id.name}isConst(){return this.type.isConst()}evaluate(){return!1}toCode(){return this._decl.id.toCode()}}},"5isi":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("xj/u"),a=r("fs98"),i=r("FrU9");class s extends n.a{constructor({cond:e,left:t,right:r,...n}){super({instrType:i.b.k_ConditionalExpr,type:t.type,...n}),console.assert(t.type.isStrongEqual(r.type)),this._cond=a.a.$withParent(e,this),this._leftValue=a.a.$withParent(t,this),this._rightValue=a.a.$withParent(r,this)}get condition(){return this._cond}get left(){return this._leftValue}get right(){return this._rightValue}toCode(){var e="(";return e+=this.condition.toCode(),e+="?",e+=this.left.toCode(),e+=":",e+=this.right.toCode(),e+=")"}isConst(){return this.condition.isConst()&&this.left.isConst()}}},"6dfp":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.BLENDENABLE=0]="BLENDENABLE",e[e.CULLFACEENABLE=1]="CULLFACEENABLE",e[e.ZENABLE=2]="ZENABLE",e[e.ZWRITEENABLE=3]="ZWRITEENABLE",e[e.DITHERENABLE=4]="DITHERENABLE",e[e.SCISSORTESTENABLE=5]="SCISSORTESTENABLE",e[e.STENCILTESTENABLE=6]="STENCILTESTENABLE",e[e.POLYGONOFFSETFILLENABLE=7]="POLYGONOFFSETFILLENABLE",e[e.CULLFACE=8]="CULLFACE",e[e.FRONTFACE=9]="FRONTFACE",e[e.SRCBLENDCOLOR=10]="SRCBLENDCOLOR",e[e.DESTBLENDCOLOR=11]="DESTBLENDCOLOR",e[e.SRCBLENDALPHA=12]="SRCBLENDALPHA",e[e.DESTBLENDALPHA=13]="DESTBLENDALPHA",e[e.BLENDEQUATIONCOLOR=14]="BLENDEQUATIONCOLOR",e[e.BLENDEQUATIONALPHA=15]="BLENDEQUATIONALPHA",e[e.ZFUNC=16]="ZFUNC",e[e.ALPHABLENDENABLE=17]="ALPHABLENDENABLE",e[e.ALPHATESTENABLE=18]="ALPHATESTENABLE",e[e.SRCBLEND=19]="SRCBLEND",e[e.DESTBLEND=20]="DESTBLEND",e[e.BLENDFUNC=21]="BLENDFUNC",e[e.BLENDFUNCSEPARATE=22]="BLENDFUNCSEPARATE",e[e.BLENDEQUATION=23]="BLENDEQUATION",e[e.BLENDEQUATIONSEPARATE=24]="BLENDEQUATIONSEPARATE",e[e.PRIMITIVETOPOLOGY=25]="PRIMITIVETOPOLOGY"}(n||(n={}))},"8/9+":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("fs98");class i extends a.a{constructor({name:e,value:t,...r}){super({instrType:n.b.k_SamplerState,...r}),this._name=e,this._value=a.a.$withParent(t,this)}get name(){return this._name}get value(){return this.value}toString(){return console.error("@not_implemented"),null}toCode(){return console.error("@not_implmented"),null}}},"8WaY":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("fb8x"),a=r("6dfp"),i=r("2blz"),s=r("FrU9"),l=r("gf1s"),o=r("rw5u"),u=r("fs98");class c extends o.a{constructor({id:e=null,vertexShader:t=null,pixelShader:r=null,renderStates:n={},...a}){super({instrType:s.b.k_PassDecl,...a}),this._passStateMap={},c.clearRenderStateMap(this._passStateMap),c.copyRenderStateMap(n,this._passStateMap),this._vertexShader=u.a.$withNoParent(t),this._pixelShader=u.a.$withNoParent(r),this._id=e}get id(){return this._id}get name(){return Object(n.e)(this._id)?null:this._id.name}get vertexShader(){return this._vertexShader}get pixelShader(){return this._pixelShader}getState(e){return this._passStateMap[e]}get renderStates(){return this._passStateMap}static createRenderStateMap(){let e={};return c.clearRenderStateMap(e),e}static copyRenderStateMap(e,t){Object(n.e)(e)||Object.keys(a.a).filter(e=>Object(n.f)(a.a[e])).map(e=>a.a[e]).forEach(r=>{t[r]=e[r]||t[r]})}static clearRenderStateMap(e){Object.keys(a.a).filter(e=>Object(n.f)(a.a[e])).map(e=>a.a[e]).forEach(t=>{e[t]=i.a.UNDEF})}static createSamplerState(){return{textureName:"",texture:null,wrap_s:l.b.UNDEF,wrap_t:l.b.UNDEF,mag_filter:l.a.UNDEF,min_filter:l.a.UNDEF}}}},"9zTq":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("xj/u"),a=r("FrU9"),i=r("fs98");class s extends n.a{constructor({element:e,index:t,...r}){super({instrType:a.b.k_PostfixIndexExpr,type:e.type.arrayElementType,...r}),this._element=i.a.$withParent(e,this),this._index=i.a.$withParent(t,this)}get index(){return this._index}get element(){return this._element}toCode(){let e="";return e+=this.element.toCode(),e+="["+this.index.toCode()+"]"}isConst(){return this.element.isConst()&&this.index.isConst()}}},BeYb:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("xj/u"),a=r("FrU9"),i=r("fb8x"),s=r("fs98"),l=r("fti1");class o extends n.a{constructor({ctor:e,args:t=null,...r}){super({instrType:a.b.k_ConstructorCallExpr,type:e.subType,...r}),this._args=(t||[]).map(e=>s.a.$withParent(e,this)),this._ctor=s.a.$withParent(e,this)}get args(){return this._args}get ctor(){return this._ctor}toCode(){var e="";e+=this.ctor.toCode(),e+="(";for(var t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){for(var e=0;e<this.args.length;e++)if(!this.args[e].isConst())return!1;return!0}evaluate(){if(!this.isConst())return!1;var e=null,t=l.j(this.type),r=new Array(this.args.length);if(Object(i.e)(t))return!1;try{if(l.q(this.type)){var n=this.args[0];if(this.args.length>1||!n.evaluate())return!1;e=t(n.getEvalValue())}else{for(var a=0;a<this.args.length;a++){if(!(n=this.args[a]).evaluate())return!1;r[a-1]=n.getEvalValue()}(e=new t).set.apply(e,r)}}catch(e){return!1}return this._evalResult=e,!0}}},"C/fJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("fs98");class i extends a.a{constructor({...e}){super({instrType:n.b.k_Stmt,...e})}}},CDNN:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("xj/u"),a=r("FrU9"),i=r("fb8x"),s=r("gf1s"),l=r("fs98"),o=r("fti1");class u extends n.a{constructor({operator:e,params:t=[],...r}){super({instrType:a.b.k_SamplerStateBlockExpr,type:o.f,...r}),this._samplerParams=t.map(e=>l.a.$withParent(e,this)),this._operator=e}get texture(){let e=this._samplerParams;for(let t=0;t<e.length;++t)if("TEXTURE"===e[t].name)return e[t].value;return null}get params(){return this._samplerParams}get operator(){return this._operator}isConst(){return!0}evaluate(){var e={textureName:"",wrap_s:0,wrap_t:0,mag_filter:0,min_filter:0};return Object(i.e)(this.texture)||(e.textureName=this.texture.name),Object(i.e)(this._samplerParams)||(Object(i.c)(this._samplerParams.ADDRESSU)&&(e.wrap_s=u.convertWrapMode(this._samplerParams.ADDRESSU)),Object(i.c)(this._samplerParams.ADDRESSV)&&(e.wrap_t=u.convertWrapMode(this._samplerParams.ADDRESSV)),Object(i.c)(this._samplerParams.MAGFILTER)&&(e.mag_filter=u.convertFilters(this._samplerParams.MAGFILTER)),Object(i.c)(this._samplerParams.MINFILTER)&&(e.min_filter=u.convertFilters(this._samplerParams.MINFILTER))),this._evalResult=e,!0}static convertWrapMode(e){switch(e){case"WRAP":return s.b.REPEAT;case"CLAMP":return s.b.CLAMP_TO_EDGE;case"MIRROR":return s.b.MIRRORED_REPEAT;default:return 0}}static convertFilters(e){switch(e){case"NEAREST":return s.a.NEAREST;case"LINEAR":return s.a.LINEAR;case"NEAREST_MIPMAP_NEAREST":return s.a.NEAREST_MIPMAP_NEAREST;case"LINEAR_MIPMAP_NEAREST":return s.a.LINEAR_MIPMAP_NEAREST;case"NEAREST_MIPMAP_LINEAR":return s.a.NEAREST_MIPMAP_LINEAR;case"LINEAR_MIPMAP_LINEAR":return s.a.LINEAR_MIPMAP_LINEAR;default:return 0}}}},DTTp:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("FrU9");function a(e,t){if(!e)return;const r=r=>{r&&(t(r,e),a(r,t))};switch(e.instructionType){case n.b.k_ReturnStmt:r(e.expr);break;case n.b.k_DeclStmt:e.declList.forEach(e=>r(e));break;case n.b.k_ExprStmt:r(e.expr);break;case n.b.k_IfStmt:r(e.cond),r(e.conseq),r(e.contrary);break;case n.b.k_StmtBlock:e.stmtList.forEach(e=>r(e));break;case n.b.k_ForStmt:r(e.init),r(e.cond),r(e.body),r(e.step);break;case n.b.k_WhileStmt:r(e.cond),r(e.body);break;case n.b.k_ArithmeticExpr:case n.b.k_AssignmentExpr:r(e.left),r(e.right);break;case n.b.k_CastExpr:r(e.expr);break;case n.b.k_CompileExpr:e.args.forEach(e=>r(e)),r(e.function);break;case n.b.k_ComplexExpr:r(e.expr);break;case n.b.k_ConditionalExpr:r(e.left),r(e.right),r(e.condition);break;case n.b.k_ConstructorCallExpr:e.args.forEach(e=>r(e)),r(e.ctor);break;case n.b.k_FunctionCallExpr:e.args.forEach(e=>r(e)),r(e.decl);break;case n.b.k_IdExpr:r(e.id);break;case n.b.k_InitExpr:e.args.forEach(e=>r(e));break;case n.b.k_IntExpr:case n.b.k_FloatExpr:case n.b.k_BoolExpr:case n.b.k_StringExpr:break;case n.b.k_LogicalExpr:r(e.left),r(e.right);break;case n.b.k_PostfixArithmeticExpr:r(e.expr);break;case n.b.k_PostfixIndexExpr:r(e.element),r(e.index);break;case n.b.k_PostfixPointExpr:r(e.element),r(e.postfix);break;case n.b.k_RelationalExpr:r(e.left),r(e.right);break;case n.b.k_SamplerStateBlockExpr:e.params.forEach(e=>r(e)),r(e.texture);break;case n.b.k_UnaryExpr:r(e.expr);break;case n.b.k_ComplexType:e.fields.forEach(e=>r(e));break;case n.b.k_FunctionDef:r(e.returnType),r(e.id),e.params.forEach(e=>r(e));break;case n.b.k_FunctionDecl:r(e.def),r(e.impl);break;case n.b.k_VariableDecl:r(e.type),r(e.initExpr),r(e.id);break;case n.b.k_VariableType:r(e.subType);break;case n.b.k_Id:break;case n.b.k_SystemFunctionDecl:case n.b.k_SystemType:case n.b.k_BreakStmt:break;default:console.error("unsupported instruction type found")}}},Ewde:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({expr:e,operator:t,...r}){super({instrType:n.b.k_UnaryExpr,type:e.type,...r}),this._expr=i.a.$withParent(e,this),this._operator=t}get operator(){return this._operator}get expr(){return this._expr}toCode(){var e="";return e+=this.operator,e+=this.expr.toCode()}isConst(){return this.expr.isConst()}evaluate(){var e=this.operator,t=this.expr;if(!t.evaluate())return!1;var r=null;try{switch(r=t.getEvalValue(),e){case"+":r=+r;break;case"-":r=-r;break;case"!":r=!r;break;case"++":r=++r;break;case"--":r=--r}}catch(e){return!1}return this._evalResult=r,!0}}},FrU9:function(e,t,r){"use strict";var n,a,i,s,l,o;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return o})),function(e){e[e.k_Instruction=0]="k_Instruction",e[e.k_Id=1]="k_Id",e[e.k_Provide=2]="k_Provide",e[e.k_Collector=3]="k_Collector",e[e.k_Keyword=4]="k_Keyword",e[e.k_Simple=5]="k_Simple",e[e.k_SamplerState=6]="k_SamplerState",e[e.k_Attribute=7]="k_Attribute",e[e.k_Annotation=8]="k_Annotation",e[e.k_UsageType=9]="k_UsageType",e[e.k_Typed=10]="k_Typed",e[e.k_VariableType=11]="k_VariableType",e[e.k_SystemType=12]="k_SystemType",e[e.k_ComplexType=13]="k_ComplexType",e[e.k_Expr=14]="k_Expr",e[e.k_IdExpr=15]="k_IdExpr",e[e.k_IntExpr=16]="k_IntExpr",e[e.k_FloatExpr=17]="k_FloatExpr",e[e.k_BoolExpr=18]="k_BoolExpr",e[e.k_StringExpr=19]="k_StringExpr",e[e.k_ArithmeticExpr=20]="k_ArithmeticExpr",e[e.k_AssignmentExpr=21]="k_AssignmentExpr",e[e.k_RelationalExpr=22]="k_RelationalExpr",e[e.k_LogicalExpr=23]="k_LogicalExpr",e[e.k_ConditionalExpr=24]="k_ConditionalExpr",e[e.k_CastExpr=25]="k_CastExpr",e[e.k_UnaryExpr=26]="k_UnaryExpr",e[e.k_PostfixIndexExpr=27]="k_PostfixIndexExpr",e[e.k_PostfixPointExpr=28]="k_PostfixPointExpr",e[e.k_PostfixArithmeticExpr=29]="k_PostfixArithmeticExpr",e[e.k_ComplexExpr=30]="k_ComplexExpr",e[e.k_FunctionCallExpr=31]="k_FunctionCallExpr",e[e.k_ConstructorCallExpr=32]="k_ConstructorCallExpr",e[e.k_CompileExpr=33]="k_CompileExpr",e[e.k_InitExpr=34]="k_InitExpr",e[e.k_SamplerStateBlockExpr=35]="k_SamplerStateBlockExpr",e[e.k_Decl=36]="k_Decl",e[e.k_TypeDecl=37]="k_TypeDecl",e[e.k_VariableDecl=38]="k_VariableDecl",e[e.k_StructDecl=39]="k_StructDecl",e[e.k_FunctionDecl=40]="k_FunctionDecl",e[e.k_SystemFunctionDecl=41]="k_SystemFunctionDecl",e[e.k_FunctionDef=42]="k_FunctionDef",e[e.k_PassDecl=43]="k_PassDecl",e[e.k_TechniqueDecl=44]="k_TechniqueDecl",e[e.k_Stmt=45]="k_Stmt",e[e.k_ExprStmt=46]="k_ExprStmt",e[e.k_BreakStmt=47]="k_BreakStmt",e[e.k_WhileStmt=48]="k_WhileStmt",e[e.k_ForStmt=49]="k_ForStmt",e[e.k_IfStmt=50]="k_IfStmt",e[e.k_DeclStmt=51]="k_DeclStmt",e[e.k_ReturnStmt=52]="k_ReturnStmt",e[e.k_SemicolonStmt=53]="k_SemicolonStmt",e[e.k_StmtBlock=54]="k_StmtBlock",e[e.k_PartFxDecl=55]="k_PartFxDecl",e[e.k_PartFxPass=56]="k_PartFxPass"}(n||(n={})),function(e){e[e.CODE_TARGET_SUPPORT=0]="CODE_TARGET_SUPPORT",e[e.SELF_CONTAINED=1]="SELF_CONTAINED"}(a||(a={})),function(e){e[e.k_Read=0]="k_Read",e[e.k_Write=1]="k_Write",e[e.k_ReadWrite=2]="k_ReadWrite",e[e.k_Undefined=3]="k_Undefined",e[e.k_Default=2]="k_Default"}(i||(i={})),function(e){e[e.k_Header=0]="k_Header",e[e.k_Float=1]="k_Float",e[e.k_Int=2]="k_Int",e[e.k_Bool=3]="k_Bool",e[e.k_Float2=4]="k_Float2",e[e.k_Int2=5]="k_Int2",e[e.k_Bool2=6]="k_Bool2",e[e.k_Float3=7]="k_Float3",e[e.k_Int3=8]="k_Int3",e[e.k_Bool3=9]="k_Bool3",e[e.k_Float4=10]="k_Float4",e[e.k_Int4=11]="k_Int4",e[e.k_Bool4=12]="k_Bool4",e[e.k_Float4x4=13]="k_Float4x4"}(s||(s={})),function(e){e[e.k_System=0]="k_System",e[e.k_Global=1]="k_Global",e[e.k_Default=2]="k_Default",e[e.k_Struct=3]="k_Struct",e[e.k_Annotation=4]="k_Annotation"}(l||(l={})),function(e){e[e.k_BasicFx=0]="k_BasicFx",e[e.k_PartFx=1]="k_PartFx",e[e.k_Unknown=2]="k_Unknown"}(o||(o={}))},GFhz:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({sourceExpr:e,...t}){super({instrType:n.b.k_CastExpr,...t}),this._srcExpr=i.a.$withParent(e,this)}get expr(){return this._srcExpr}toCode(){var e="";return e+="(",e+=this.type.toCode(),e+=")",e+=this._srcExpr.toCode()}isUseless(){return this.type.isEqual(this.expr.type)}isConst(){return this._srcExpr.isConst()}}},JJi1:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("fs98"),i=r("C/fJ");class s extends i.a{constructor({expr:e=null,...t}){super({instrType:n.b.k_ReturnStmt,...t}),this._operator="return",this._expr=a.a.$withParent(e,this)}get operator(){return this._operator}get expr(){return this._expr}toCode(){return this.expr?"return "+this.expr.toCode()+";":"return;"}}},Jbg3:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("rw5u"),i=r("fs98"),s=r("fti1"),l=r("FrU9");class o extends a.a{constructor({returnType:e,id:t,paramList:r=[],...n}){super({instrType:l.b.k_FunctionDef,...n}),this._parameterList=r.map(e=>i.a.$withParent(e,this)),this._returnType=i.a.$withParent(e,this),this._id=i.a.$withParent(t,this)}get returnType(){return this._returnType}get name(){return this._id.name}get params(){return this._parameterList}get numArgsRequired(){return this._parameterList.filter(e=>!e.initExpr).length}get id(){return this._id}toString(){let e=this._returnType.hash+" "+this.name+"(";for(let t=0;t<this._parameterList.length;t++)e+=this._parameterList[t].type.hash+",";return e+=")"}toCode(){let e="";e+=this._returnType.toCode(),e+=" "+this._id.toCode(),e+="(";for(let t=0;t<this._parameterList.length;t++)e+=this._parameterList[t].toCode(),t!==this._parameterList.length-1&&(e+=",");return e+=")"}static checkForVertexUsage(e){return!!o.checkReturnTypeForVertexUsage(e)&&!!o.checkArgumentsForVertexUsage(e)}static checkForPixelUsage(e){return!!o.checkReturnTypeForPixelUsage(e)&&!!o.checkArgumentsForPixelUsage(e)}static checkReturnTypeForVertexUsage(e){const t=e.returnType;if(t.isEqual(s.h))return!0;if(t.isComplex()){if(t.hasFieldWithoutSemantics())return!1;if(!t.hasAllUniqueSemantics())return!1;if(t.isContainSampler())return!1;if(t.isContainComplexType())return!1}else{if(!t.isEqual(s.d))return!1;if("POSITION"!==e.semantic)return!1}return!0}static checkReturnTypeForPixelUsage(e){let t=e.returnType;return!!t.isEqual(s.h)||!!t.isBase()&&(!!t.isEqual(s.d)&&"COLOR"===e.semantic)}static checkArgumentsForVertexUsage(e){let t=e.params,r=!1,a=!1,i=!1;for(let e=0;e<t.length;e++){let s=t[e];if(!s.isUniform())if(i){if(r)return!1;if(a){if(Object(n.e)(s.semantic))return!1;if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1}}else{if(Object(n.e)(s.semantic)){if(s.type.isBase()||s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics())return!1;r=!0}else if(!Object(n.e)(s.semantic)){if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1;a=!0}i=!0}}return!0}static checkArgumentsForPixelUsage(e){let t=e.params,r=!1,n=!1,a=!1;for(let e=0;e<t.length;e++){let i=t[e];if(!i.isUniform())if(a){if(r)return!1;if(n){if(""===i.semantic)return!1;if(i.type.isContainSampler()||s.p(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1}}else{if(""===i.semantic){if(i.type.isBase()||i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()||i.type.isContainSampler())return!1;r=!0}else if(""!==i.semantic){if(i.type.isContainSampler()||s.p(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1;n=!0}a=!0}}return!0}}},Jlck:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("rw5u"),a=r("fb8x"),i=r("FrU9"),s=r("fs98");class l extends n.a{constructor({type:e,...t}){super({instrType:i.b.k_TypeDecl,...t}),this._type=s.a.$withParent(e,this),Object(a.a)(Object(a.c)(this.type)),Object(a.e)(this._type)&&console.warn("Something goes wrong! Type is not specified!",this)}get type(){return this._type}get name(){return this.type.name}toCode(){return this.type.toDeclString()+";"}}},NOIS:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("xj/u"),a=r("FrU9"),i=r("fb8x"),s=r("fs98"),l=r("fti1");class o extends n.a{constructor({type:e,args:t=[],...r}){super({instrType:a.b.k_InitExpr,type:e,...r}),this._isArray=!1,this._args=t.map(e=>s.a.$withParent(e,this))}get args(){return this._args}isArray(){return this._isArray}toCode(){let e="";Object(i.e)(this.type)||(e+=this.type.toCode()),e+="(";for(let t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){let e=this.args;for(let t=0;t<e.length;t++)if(!e[t].isConst())return!1;return!0}optimizeForVariableType(e){if(e.isNotBaseArray()&&e.scope.type<=a.c.k_Global||e.isArray()&&this.args.length>1){if(e.length===s.a.UNDEFINE_LENGTH||e.isNotBaseArray()&&this.args.length!==e.length||!e.isNotBaseArray()&&this.args.length!==e.baseType.length)return!1;e.isNotBaseArray()&&(this._isArray=!0);let t=e.arrayElementType,r=!1,n=null;for(let e=0;e<this.args.length;e++)if((n=this.args[e]).instructionType===a.b.k_InitExpr){if(!(r=n.optimizeForVariableType(t)))return!1}else if(l.p(t)){if(n.instructionType!==a.b.k_SamplerStateBlockExpr)return!1}else if(!(r=n.type.isEqual(t)))return!1;return this._type=e.baseType,!0}{let t=this.args[0];if(1===this.args.length&&t.instructionType!==a.b.k_InitExpr)return l.p(e)?t.instructionType===a.b.k_SamplerStateBlockExpr:!!t.type.isEqual(e);if(1===this.args.length)return!1;let r=this.args,n=e.fieldNames;for(let t=0;t<r.length;t++){let a=e.getField(n[t]).type;if(!r[t].optimizeForVariableType(a))return!1}return this._type=e.baseType,!0}}evaluate(){if(!this.isConst())return this._evalResult=null,!1;let e=null;if(this._isArray){e=new Array(this.args.length);for(let t=0;t<this.args.length;t++){let r=this.args[t];r.evaluate()&&(e[t]=r.getEvalValue())}}else if(1===this.args.length){let t=this.args[0];t.evaluate(),e=t.getEvalValue()}else{let t=l.j(this.type),r=new Array(this.args.length);if(Object(i.e)(t))return!1;try{if(l.q(this.type)){let r=this.args[1];if(this.args.length>2||!r.evaluate())return!1;e=t(r.getEvalValue())}else{for(let e=0;e<this.args.length;e++){let t=this.args[e];if(!t.evaluate())return!1;r[e]=t.getEvalValue()}(e=new t).set.apply(e,r)}}catch(e){return!1}}return this._evalResult=e,!0}}},"NcQ/":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("rw5u"),i=r("fs98");class s extends a.a{constructor({name:e,techniqueType:t,passList:r,...a}){super({instrType:n.b.k_TechniqueDecl,...a}),this._name=e,this._passList=r.map(e=>i.a.$withParent(e,this)),this._techniqueType=t}get name(){return this._name}get passList(){return this._passList}get type(){return this._techniqueType}}},Oowq:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("fs98"),i=r("C/fJ");class s extends i.a{constructor({declList:e=null,...t}){super({instrType:n.b.k_DeclStmt,...t}),this._declList=(e||[]).map(e=>a.a.$withParent(e,this))}get declList(){return this._declList}toCode(){for(var e="",t=this.declList,r=0;r<this.declList.length;r++)e+=t[r].toCode()+";\n";return e}}},P8tn:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fs98"),a=r("FrU9");class i extends n.a{constructor({name:e,...t}){super({instrType:a.b.k_Id,...t}),this._name=e}get name(){return this._name}toString(){return this._name}toCode(){return this.name}}},PVgK:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("xj/u"),a=r("FrU9"),i=r("fs98");class s extends n.a{constructor({left:e,right:t,operator:r,...n}){super({instrType:a.b.k_AssignmentExpr,type:e.type,...n}),this._leftValue=i.a.$withParent(e,this),this._rightValue=i.a.$withParent(t,this),this._operator=r}get left(){return this._leftValue}get right(){return this._rightValue}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}}},PaCb:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("zioJ"),i=r("FrU9"),s=r("fti1"),l=r("fs98");class o extends l.a{constructor({name:e=null,fields:t,...r}){super({instrType:i.b.k_ComplexType,...r}),this._name=e,this._fields={},this._isContainArray=!1,this._isContainSampler=!1,this._isContainComplexType=!1,this.addFields(t.map(e=>l.a.$withParent(e,this)))}get writable(){return!0}get readable(){return!0}get name(){return this._name}get hash(){return this.calcHash()}get strongHash(){return this.calcStrongHash()}get size(){return this.calcSize()}get baseType(){return this}get arrayElementType(){return null}get typeDecl(){return this.parent}get length(){return 0}get fieldNames(){return Object.keys(this._fields)}get fields(){return this.fieldNames.map(e=>this._fields[e])}toString(){return this.name||this.hash}toDeclString(){for(var e="struct "+this._name+"{",t=0;t<this.fields.length;t++)e+="\t"+this.fields[t].toCode()+";\n";return e+="}"}toCode(){return this._name}isBase(){return!1}isArray(){return!1}isNotBaseArray(){return!1}isComplex(){return!0}isEqual(e){return this.hash===e.hash}isStrongEqual(e){return this.strongHash===e.strongHash}isConst(){return!1}isSampler(){return!1}isSamplerCube(){return!1}isSampler2D(){return!1}isContainArray(){return this._isContainArray}isContainSampler(){return this._isContainSampler}isContainComplexType(){return this._isContainComplexType}addField(e){var t=e.name;this._fields[t]=e;var r=e.type;(r.isNotBaseArray()||r.isContainArray())&&(this._isContainArray=!0),(s.p(r)||r.isContainSampler())&&(this._isContainSampler=!0),r.isComplex()&&(this._isContainComplexType=!0)}addFields(e){for(var t=0;t<e.length;t++)this.addField(e[t]);this.calculatePaddings()}hasField(e){return Object(n.c)(this._fields[e])}hasFieldWithSematics(e){return!!this.getFieldBySemantics(e)}getField(e){return this._fields[e]||null}getFieldBySemantics(e){for(let t in this._fields){let r=this._fields[t];if(e==r.semantic)return r}return null}calcSize(){let e=0;for(let t=0;t<this.fields.length;t++){let r=this.fields[t].type.size;if(r===l.a.UNDEFINE_SIZE){e=l.a.UNDEFINE_SIZE;break}e+=r}return e}calcHash(){let e="{";for(let t=0;t<this.fields.length;t++)e+=this.fields[t].type.hash+";";return e+="}"}calcStrongHash(){let e="{";for(let t=0;t<this.fields.length;t++)e+=this.fields[t].type.strongHash+";";return e+="}"}hasFieldWithoutSemantics(){for(let e in this._fields){let t=this._fields[e],r=t.semantic;if(null==r||""==r)return!0;if(t.type.hasFieldWithoutSemantics())return!0}return!1}hasAllUniqueSemantics(){let e={};for(let t in this._fields){let r=this._fields[t],a=r.semantic;if(Object(n.d)(e[a]))return!1;if(e[a]=r,r.type.isComplex()&&!r.type.hasAllUniqueSemantics())return!1}return!0}calculatePaddings(){let e=0;for(let t=0;t<this.fields.length;t++){let r=this.fields[t].type,n=r.size;if(n===l.a.UNDEFINE_SIZE)return void this._setError(a.a.CannotCalcPadding,{typeName:this.name});r.$overwritePadding(e),e+=n}}}},Paat:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({element:e,postfix:t,...r}){super({instrType:n.b.k_PostfixPointExpr,type:t.type,...r}),this._element=i.a.$withParent(e,this),this._postfix=i.a.$withParent(t,this)}get element(){return this._element}get postfix(){return this._postfix}toCode(){var e="";return e+=this.element.toCode(),e+=".",e+=this.postfix.toCode()}isConst(){return this.element.isConst()}}},RTx6:function(e,t,r){"use strict";var n,a=r("fb8x"),i=r("zioJ");!function(e){e[e.UnsupportedRenderStateTypeUsed=3e3]="UnsupportedRenderStateTypeUsed",e[e.IncompleteTechnique=3001]="IncompleteTechnique",e[e.IncompletePass=3002]="IncompletePass",e[e.UselessPassState=3003]="UselessPassState"}(n||(n={}));var s=r("/zHR");r.d(t,"a",(function(){return l}));class l extends s.b{constructor(){super("Analyzer Diagnostics","A")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.loc}diagnosticMessages(){return{[i.a.InvalidReturnStmtEmpty]:"Invalid return statement. Expression with '*type*' type expected.",[i.a.InvalidReturnStmtVoid]:"Invalid return statement. Expression with 'void' type expected.",[i.a.FunctionRedefinition]:"Function redefinition. Function with name '{info.funcName}' already declared.",[i.a.InvalidFuncDefenitionReturnType]:"Invalid function defenition return type. Function with the same name '{info.funcName}' but another type already declared.",[i.a.InvalidFunctionReturnStmtNotFound]:"Return statement expected.",[i.a.InvalidVariableInitializing]:"Invalid variable initializing."}}resolveDescription(e,t,r){let l=this.diagnosticMessages();if(Object(a.d)(l[e]))return super.resolveDescription(e,t,r);let{file:o,loc:u,...c}=r;return t==s.c.k_Warning?`${n[e]}: ${JSON.stringify(c)}`:`${i.a[e]}: ${JSON.stringify(c)}`}}},RkPf:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("fs98"),i=r("C/fJ");class s extends i.a{constructor({expr:e,...t}){super({instrType:n.b.k_ExprStmt,...t}),this._expr=a.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return this._expr.toCode()+";"}}},TZtI:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"flag",(function(){return h})),r.d(n,"testBit",(function(){return p})),r.d(n,"testAll",(function(){return d})),r.d(n,"testAny",(function(){return f})),r.d(n,"setBit",(function(){return m})),r.d(n,"clearBit",(function(){return _})),r.d(n,"setAll",(function(){return y})),r.d(n,"clearAll",(function(){return E})),r.d(n,"equal",(function(){return b})),r.d(n,"isEqual",(function(){return g})),r.d(n,"isNotEqaul",(function(){return x})),r.d(n,"set",(function(){return T})),r.d(n,"clear",(function(){return S})),r.d(n,"setFlags",(function(){return k})),r.d(n,"clearFlags",(function(){return N})),r.d(n,"isEmpty",(function(){return I})),r.d(n,"totalBits",(function(){return C})),r.d(n,"totalSet",(function(){return A}));var a,i,s,l,o,u,c=r("ym9a");!function(e){e[e.k_Default=0]="k_Default",e[e.k_Necessary=1]="k_Necessary",e[e.k_Not=2]="k_Not"}(a||(a={})),function(e){e[e.k_Ok=0]="k_Ok",e[e.k_Error=1]="k_Error"}(i||(i={})),function(e){e[e.k_LR0=0]="k_LR0",e[e.k_LR1=1]="k_LR1",e[e.k_LALR=2]="k_LALR"}(s||(s={})),function(e){e[e.k_AllNode=1]="k_AllNode",e[e.k_Negate=2]="k_Negate",e[e.k_Add=4]="k_Add",e[e.k_Optimize=8]="k_Optimize",e[e.k_DebugMode=16]="k_DebugMode"}(l||(l={})),function(e){e[e.k_NumericLiteral=1]="k_NumericLiteral",e[e.k_CommentLiteral=2]="k_CommentLiteral",e[e.k_StringLiteral=3]="k_StringLiteral",e[e.k_PunctuatorLiteral=4]="k_PunctuatorLiteral",e[e.k_WhitespaceLiteral=5]="k_WhitespaceLiteral",e[e.k_NewlineLiteral=6]="k_NewlineLiteral",e[e.k_IdentifierLiteral=7]="k_IdentifierLiteral",e[e.k_KeywordLiteral=8]="k_KeywordLiteral",e[e.k_Unknown=9]="k_Unknown",e[e.k_End=10]="k_End"}(o||(o={})),function(e){e[e.k_Error=100]="k_Error",e[e.k_Shift=101]="k_Shift",e[e.k_Reduce=102]="k_Reduce",e[e.k_Success=103]="k_Success",e[e.k_Ok=104]="k_Ok"}(u||(u={}));var h=e=>1<<e,p=(e,t)=>0!=(e&h(t)),d=(e,t)=>(e&t)==t,f=(e,t)=>0!=(e&t),m=(e,t,r=!0)=>r?e|=h(t):_(e,t),_=(e,t)=>e&=~h(t),y=(e,t,r=!0)=>r?e|=t:e&=~t,E=(e,t)=>e&=~t,b=(e,t)=>{t},g=(e,t)=>e==t,x=(e,t)=>e!=t,T=(e,t)=>{t},S=e=>{0},k=(e,t)=>e|=t,N=(e,t)=>e&=~t,I=e=>0==e,C=e=>32,A=e=>{for(var t=0,r=C(e);r;--r)t+=1&e,e>>=1;return t},v=n,O=r("fb8x"),R=r("/zHR");class F{constructor(e){this.content=e}valueOf(){return this.content}toString(){return this.content}toSource(){return this.content}static make(e){return new F(`${e}`)}}const P="END",L="EMPTY",D="UNKNOWN",w="S",U="##",z="#",j="ERROR",B="$",V="--LEXER--",M="--AN",q="--NN",G="--F",$="EOF",W="T_STRING",H="T_FLOAT",K="T_UINT",Q="T_TYPE_ID",Z="T_NON_TYPE_ID",Y="T_LINE_TERMINATOR";class X{constructor(e,t,r){this.rule=e,this.pos=t,this.index=0,this.expectedSymbols=new Set,r&&r.forEach(e=>this.addExpected(e))}isEqual(e,t=s.k_LR0){if(t===s.k_LR0)return this.rule===e.rule&&this.pos===e.pos;if(t===s.k_LR1){if(this.rule!==e.rule||this.pos!==e.pos||this.expectedSymbols.size!==e.expectedSymbols.size)return!1;for(const t of this.expectedSymbols)if(!e.isExpected(t))return!1;return!0}return!1}isParentItem(e){return this.rule===e.rule&&this.pos===e.pos+1}isChildItem(e){return this.rule===e.rule&&this.pos===e.pos-1}symbolName(){const e=this.rule.right;return this.pos===e.length?P:e[this.pos]}isExpected(e){return this.expectedSymbols.has(e)}addExpected(e){return!this.isExpected(e)&&(this.expectedSymbols.add(e),!0)}toString(e=null){const{left:t,right:r}=this.rule;let n=`${t} -> `;if(n+=r.map(t=>X.decodeSymbol(t,e)).map((e,t)=>t===this.pos?`. ${e}`:`${e}`).join(" "),this.pos===r.length&&(n+=" . "),this.expectedSymbols){const t=Array.from(this.expectedSymbols).map(t=>X.decodeSymbol(t,e));t.length&&(n+=", "+t.join(" "))}return n}static decodeSymbol(e,t){return t&&t.get(e)&&e!==t.get(e)?`'${t.get(e)}'`:e}}var J,ee;!function(e){e[e.UnknownToken=2101]="UnknownToken",e[e.InvalidToken=2102]="InvalidToken"}(J||(J={}));class te extends R.b{constructor(){super("Lexer Diagnostics","L")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.token.loc}diagnosticMessages(){return{[J.UnknownToken]:"Unknown token: {token.value}.",[J.InvalidToken]:"Invalid token: {token.value}."}}}class re{constructor({onResolveFilename:e,onResolveTypeId:t}){this._lineNumber=0,this._columnNumber=0,this._source="",this._index=0,this._punctuatorsMap={},this._keywordsMap={},this._punctuatorsFirstSymbols={},this._diag=new te,this._onResolveTypeID=t,this._onResolveFilename=e}static getPunctuatorName(e){return"T_PUNCTUATOR_"+e.charCodeAt(0)}getDiagnostics(){return this._diag.resolve()}addPunctuator(e,t=re.getPunctuatorName(e)){return this._punctuatorsMap[e]=t,this._punctuatorsFirstSymbols[e[0]]=!0,t}addKeyword(e,t){return this._keywordsMap[e]=t,t}getTerminalValueByName(e){let t="";for(t in this._punctuatorsMap)if(this._punctuatorsMap[t]===e)return t;for(t in this._keywordsMap)if(this._keywordsMap[t]===e)return t;return e}init(e){this._source=e,this._lineNumber=0,this._columnNumber=0,this._index=0,this._diag.reset()}getNextToken(e){if(!this.currentChar()){let e=this.pos();return{index:this._index,name:B,value:B,loc:{start:e,end:{...e}}}}let t=null;switch(this.identityTokenType()){case o.k_NumericLiteral:t=this.scanNumber();break;case o.k_CommentLiteral:this.scanComment(),t=this.getNextToken();break;case o.k_StringLiteral:t=this.scanString();break;case o.k_PunctuatorLiteral:t=this.scanPunctuator();break;case o.k_IdentifierLiteral:t=this.scanIdentifier();break;case o.k_NewlineLiteral:t=this.scanLineTerminators(),e||(t=this.getNextToken());break;case o.k_WhitespaceLiteral:this.scanWhiteSpace(),t=this.getNextToken();break;default:{const e=this.pos();let r="";for(;this.identityTokenType()===o.k_Unknown;)r+=this.currentChar(),this.readNextChar();return t={index:this._index,name:D,value:r,loc:{start:e,end:this.pos()}},this.emitError(J.UnknownToken,t),t}}return t}getLocation(){return{line:this._lineNumber,file:this._onResolveFilename()}}setSource(e){this._source=e}setIndex(e){this._index=e}pos(e=0){return{file:this._onResolveFilename(),line:this._lineNumber,column:this._columnNumber+e}}emitError(e,t){this._diag.error(e,{file:`${this._onResolveFilename()}`,token:t})}identityTokenType(){return this.isIdentifierStart()?o.k_IdentifierLiteral:this.isWhiteSpaceStart()?o.k_WhitespaceLiteral:this.isNewlineStart()?o.k_NewlineLiteral:this.isStringStart()?o.k_StringLiteral:this.isCommentStart()?o.k_CommentLiteral:this.isNumberStart()?o.k_NumericLiteral:this.isPunctuatorStart()?o.k_PunctuatorLiteral:o.k_Unknown}isNumberStart(){let e=this.currentChar();if(e>="0"&&e<="9")return!0;let t=this.nextChar();return"."===e&&t>="0"&&t<="9"}isCommentStart(){let e=this.currentChar(),t=this.nextChar();return"/"===e&&("/"===t||"*"===t)}isStringStart(){let e=this.currentChar();return'"'===e||"'"===e}isPunctuatorStart(){let e=this.currentChar();return!!this._punctuatorsFirstSymbols[e]}isWhiteSpaceStart(){let e=this.currentChar();return" "===e||"\t"===e}isNewlineStart(){let e=this.currentChar();return"\n"===e||"\r"===e}isIdentifierStart(){let e=this.currentChar();return"_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"}isLineTerminator(e){return"\n"===e||"\r"===e||"\u2028"===e||"\u2029"===e}isKeyword(e){return!!this._keywordsMap[e]}isPunctuator(e){return!!this._punctuatorsMap[e]}nextChar(){return this._source[this._index+1]}currentChar(){return this._source[this._index]}readNextChar(){return this._index++,this._columnNumber++,this._source[this._index]}scanString(){let e=this.currentChar(),t=e,r="",n=e,a=!1,i=this.pos();for(;r=this.readNextChar();){if(t+=r,r===e&&"\\"!==n){a=!0,this.readNextChar();break}n=r}if(a)return{index:this._index,name:W,value:t,loc:{start:i,end:this.pos()}};{r||(r=$),t+=r;const e={index:this._index,type:o.k_StringLiteral,value:t,loc:{start:i,end:this.pos()}};return this.emitError(J.InvalidToken,e),re.makeUnknownToken(e)}}static makeUnknownToken(e){return{...e,type:void 0,name:D,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}scanPunctuator(){let e,t=this.currentChar(),r=this.pos();for(;e=this.readNextChar();)if(t+=e,!this.isPunctuator(t)){t=t.slice(0,t.length-1);break}return{index:this._index,name:this._punctuatorsMap[t],value:t,loc:{start:r,end:this.pos()}}}scanNumber(){let e=this.currentChar(),t="",r=!1,n=e,a=!1,i=!1,s=this.pos();for("."===e&&(t+=0,r=!0),t+=e;;){if("."===(e=this.readNextChar())){if(r)break;r=!0}else if("e"===e){if(i)break;i=!0}else{if(("+"===e||"-"===e)&&"e"===n){t+=e,n=e;continue}if("f"===e&&r){if((e=this.readNextChar())>="a"&&e<="z"||e>="A"&&e<="Z")break;a=!0;break}if(e>="a"&&e<="z"||e>="A"&&e<="Z")break;if(!(e>="0"&&e<="9"&&e)){(i&&"+"!==n&&"-"!==n&&"e"!==n||!i)&&(a=!0);break}}t+=e,n=e}if(a){let e=r?H:K;return{index:this._index,name:e,value:t,loc:{start:s,end:this.pos()}}}{e||(e=$),t+=e;const r={index:this._index,type:o.k_NumericLiteral,value:t,loc:{start:s,end:this.pos()}};return this.emitError(J.InvalidToken,r),re.makeUnknownToken(r)}}scanIdentifier(){let e=this.currentChar(),t=e,r=this.pos(),n=!1;for(;;){if(!(e=this.readNextChar())){n=!0;break}if(!("_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9")){n=!0;break}t+=e}if(n){if(this.isKeyword(t))return{index:this._index,name:this._keywordsMap[t],value:t,loc:{start:r,end:this.pos()}};{let e=this._onResolveTypeID(t)?Q:Z;return{index:this._index,name:e,value:t,loc:{start:r,end:this.pos()}}}}{e||(e=$),t+=e;const n={index:this._index,type:o.k_IdentifierLiteral,value:t,loc:{start:r,end:this.pos()}};return this.emitError(J.InvalidToken,n),re.makeUnknownToken(n)}}scanLineTerminators(){let e=this.currentChar(),t="",r=this.pos();for(;e&&this.isLineTerminator(e);)t+=e,"\r"===e&&"\n"===this.nextChar()&&this._lineNumber--,this._lineNumber++,e=this.readNextChar(),this._columnNumber=0;let n=Y;return{index:this._index,name:n,value:t,loc:{start:r,end:this.pos()}}}scanWhiteSpace(){let e=this.currentChar();for(;e;){if("\t"===e)this._columnNumber+=0;else if(" "!==e)break;e=this.readNextChar()}return!0}scanComment(){let e=this.currentChar(),t=this.readNextChar();if(e+=t,"/"===t){for(;t=this.readNextChar();){if(this.isLineTerminator(t)){"\r"===t&&"\n"===this.nextChar()&&this._lineNumber--,this._lineNumber++,this.readNextChar(),this._columnNumber=0;break}e+=t}return!0}{let r=t,n=!1,a=this.pos();for(;t=this.readNextChar();){if(e+=t,"/"===t&&"*"===r){n=!0,this.readNextChar();break}this.isLineTerminator(t)&&("\r"===t&&"\n"===this.nextChar()&&this._lineNumber--,this._lineNumber++,this._columnNumber=-1),r=t}if(n)return!0;{t||(t=$),e+=t;const r={index:this._index,type:o.k_CommentLiteral,value:e,loc:{start:a,end:this.pos()}};return this.emitError(J.InvalidToken,r),!1}}}}function ne(e,t){var r,n;t.start.line<e.start.line?e.start={...t.start}:t.start.line===e.start.line&&(e.start=(r=t.start,n=e.start,Object(O.a)(r.file==n.file),{line:Math.min(r.line,n.line),column:Math.min(r.column,n.column),file:r.file})),t.end.line>e.end.line?e.end={...t.end}:t.end.line===e.end.line&&(e.end=function(e,t){return Object(O.a)(e.file==t.file),{line:Math.max(e.line,t.line),column:Math.max(e.column,t.column),file:e.file}}(t.end,e.end))}class ae{constructor(e,t=null){this.root=t,this.nodes=[],this.optimized=e,this.nodesCountStack=[]}get lastNode(){return this.nodes[this.nodes.length-1]}finishTree(){this.root=this.nodes.pop()}addToken({name:e,value:t,loc:r}){this.addNode({name:e,value:t,loc:r,children:null,parent:null})}reduceByRule(e,t=a.k_Default){let r=0,n=this.nodesCountStack,i=e.right.length,s=this.nodes,l=this.optimized?1:0;for(;i;)r+=n.pop(),i--;if(t===a.k_Default&&r>l||t===a.k_Necessary){Object(O.a)(r>0);let t=s.pop();r--;const a={name:e.left,children:null,parent:null,value:"",loc:{...t.loc}};for(this.addLink(a,t);r;)Object(O.a)(s.length>0),this.addLink(a,s.pop()),r--;s.push(a),n.push(1)}else n.push(r)}addNode(e){this.nodes.push(e),this.nodesCountStack.push(1)}$pop(e=null){let t=this.nodesCountStack.pop();for(;t;){let r=this.nodes.pop();e&&ne(e,r.loc),t--}}addLink(e,t){e.children=e.children||[],ne(e.loc,t.loc),e.children.push(t),t.parent=e}clone(){return new ae(this.optimized,this.cloneNode(this.root))}cloneNode({name:e,value:t,children:r}){const n={name:e,value:t,children:null,parent:null};return r&&r.forEach(e=>this.addLink(n,this.cloneNode(e))),n}toString(){return this.root?this.toStringNode(this.root):""}toStringNode(e,t=""){let r=t+"{\n",n=t;if(t+="  ",e.value)r+=t+'name : "'+e.name+'",\n',r+=t+'value : "'+e.value+'"\n';else{r+=t+'name : "'+e.name+'"\n',r+=t+"children : [";let a=e.children;if(a){r+="\n",t+="  ";for(let e=a.length-1;e>=0;e--)r+=this.toStringNode(a[e],t),r+=",\n";r=r.slice(0,r.length-2),r+="\n",r+=n+"  ]\n"}else r+=" ]\n"}return r+=n+"}"}toHTMLString(e,t=""){let r=t+"{\n",n=t;if(t+="  ",(e=e||this.root).value)r+=t+'<b style="color: #458383;">name</b>: "'+e.name+'",\n',r+=t+'<b style="color: #458383;">value</b>: "'+e.value+'",\n',r+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',r+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n';else{let a;if(r+=t+'<i style="color: #8A2BE2;">name</i>: "'+e.name+'"\n',r+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',r+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n',r+=t+'<i style="color: #8A2BE2;">children</i>: [',e.children){for(r+="\n",t+="  ",a=e.children.length-1;a>=0;a--)r+=this.toHTMLString(e.children[a],t),r+=",\n";r=r.slice(0,r.length-2),r+="\n",r+=n+"  ]\n"}else r+=" ]\n"}return r+=n+"}"}}class ie{constructor(){this.nextStates={},this.index=0,this.items=[],this.numBaseItems=0,this.numOtherItems=0}eachItem(e){for(let t=0;t<this.items.length;++t)e(this.items[t],t)}eachBaseItem(e){for(let t=0;t<this.numBaseItems;++t)e(this.items[t],t)}isExpected(e){return!!this.items.find(t=>t.isExpected(e))}hasItem(e,t){return this.items.find(r=>r.isEqual(e,t))||null}hasParentItem(e){return this.items.find(t=>t.isParentItem(e))||null}hasChildItem(e){return this.items.find(t=>t.isChildItem(e))||null}hasRule(e,t){for(let r=0;r<this.numBaseItems;++r){const n=this.items[r];if(n.rule===e&&n.pos===t)return!0}return!1}isEmpty(){return!this.items.length}isEqual(e,t){if(this.numBaseItems!==e.numBaseItems)return!1;for(let r=0;r<this.numBaseItems;++r){const n=this.items[r];let a=!1;for(let r=0;r<e.numBaseItems;++r){const i=e.items[r];if(n.isEqual(i,t)){a=!0;break}}if(!a)return!1}return!0}push(e){0===this.items.length||e.pos>0?(Object(O.a)(0===this.numOtherItems),this.numBaseItems++):this.numOtherItems++,this.items.push(e)}tryPush_LR0(e,t){if(this.items.find(r=>r.rule===e&&r.pos===t))return!1;const r=new X(e,t);return this.push(r),!0}tryPush_LR(e,t,r){const n=this.items.find(r=>r.rule===e&&r.pos===t);if(n)return n.addExpected(r);const a=new X(e,t,[r]);return this.push(a),!0}addNextState(e,t){return!this.nextStates[e]&&(this.nextStates[e]=t,!0)}deleteNotBase(){this.items.length=this.numBaseItems}toString(e=!0,t=null){const r=e?this.items.slice(0,this.numBaseItems):this.items;return`State ${this.index}:\n`+r.map(e=>`\t\t${e.toString(t)}\n`).join()}}!function(e){e[e.GrammarAddOperation=2001]="GrammarAddOperation",e[e.GrammarAddStateLink=2002]="GrammarAddStateLink",e[e.GrammarUnexpectedSymbol=2003]="GrammarUnexpectedSymbol",e[e.GrammarInvalidAdditionalFuncName=2004]="GrammarInvalidAdditionalFuncName",e[e.GrammarInvalidKeyword=2005]="GrammarInvalidKeyword",e[e.SyntaxUnknownError=2051]="SyntaxUnknownError",e[e.SyntaxUnexpectedEOF=2052]="SyntaxUnexpectedEOF",e[e.SyntaxRecoverableStateNotFound=2053]="SyntaxRecoverableStateNotFound",e[e.GeneralCouldNotReadFile=2200]="GeneralCouldNotReadFile",e[e.GeneralParsingLimitIsReached=2201]="GeneralParsingLimitIsReached"}(ee||(ee={}));class se extends R.b{constructor(){super("Parser Diagnostics","P")}resolveFilename(e,t){return t.file}resolveRange(e,t){switch(e){case ee.SyntaxUnknownError:case ee.SyntaxUnexpectedEOF:return t.token.loc}return null}resolvePosition(e,t){return console.assert(e!=ee.SyntaxUnknownError),{line:t.line,column:0,file:null}}diagnosticMessages(){return{[ee.GrammarAddOperation]:'Grammar not LALR(1)! Cannot to generate syntax table. Add operation error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld operation: {oldOperation}\nNew operation: {newOperation}\nFor more info init parser in debug-mode and see syntax table and list of states.\n\n{stateDesc}',[ee.GrammarAddStateLink]:'Grammar not LALR(1)! Cannot to generate syntax table. Add state link error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld next state: {oldNextStateIndex}\nNew next state: {newNextStateIndex}\nFor more info init parser in debug-mode and see syntax table and list of states.',[ee.GrammarUnexpectedSymbol]:"Grammar error. Can`t generate rules from grammar\nUnexpected symbol: {unexpectedSymbol}\nExpected: {expectedSymbol}",[ee.GrammarInvalidAdditionalFuncName]:"Grammar error. Empty additional function name.",[ee.GrammarInvalidKeyword]:"Grammar error. Bad keyword: {badKeyword}\nAll keyword must be define in lexer rule block.",[ee.SyntaxUnknownError]:"Syntax error during parsing. Token: '{token.value}'\nLine: {token.loc.start.line}. Column: {token.loc.start.column}.",[ee.SyntaxUnexpectedEOF]:"Syntax error. Unexpected EOF.",[ee.GeneralCouldNotReadFile]:"Could not read file '{target}'.",[ee.GeneralParsingLimitIsReached]:"Parsing limit is reached.",[ee.SyntaxRecoverableStateNotFound]:"Recoverable state not found."}}}class le{constructor(){this._source="",this._syntaxTree=null,this._typeIdMap=null,this._lexer=null,this._stack=[],this._token=null,this._syntaxTable=null,this._productions=null,this._baseItems=null,this._states=null,this._additionalFuncInfoList=null,this._additionalFunctionsMap=null,this._adidtionalFunctByStateDMap=null,this._type=s.k_LR0,this._ruleCreationModeMap=null,this._parseMode=l.k_AllNode,this._firstTerminalsCache=null,this._closureForItemsCache=null,this._expectedExtensionDMap=null,this._filename=F.make("stdin"),this._diag=new se}isTypeId(e){return!!this._typeIdMap[e]}init(e,t=l.k_AllNode,r=s.k_LALR){try{this._type=r,this._lexer=new re({onResolveFilename:()=>this.getParseFileName(),onResolveTypeId:e=>this.isTypeId(e)}),this._parseMode=t,this.generateRules(e),this.buildSyntaxTable(),this.generateFunctionByStateMap(),v.testAll(t,l.k_DebugMode)||this.clearMem()}catch(e){if(e instanceof R.a)return Object(O.i)(e.stack),!1;throw e}return!0}restoreState(e,t,r,n,a){for(;;){let i=-1;for(let t=r.length-1;t>=0;--t){const a=e[r[t]][j];if(Object(O.c)(a)&&a.type===u.k_Shift&&e[a.stateIndex][n.name]){i=t;break}}if(-1!==i){const e=r[i];let n=r.length-1-i;for(;0!=n;)t.$pop(a.loc),r.pop(),n--;return e}if(ne(a.loc,n.loc),n.value===B)break;const s=this.readToken();Object.keys(s).forEach(e=>n[e]=s[e])}return-1}static cloneToken(e){return{...e,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}async run(e,t,r,n,{debugMode:a=!1,allowErrorRecoverty:i=!0}){const s={index:-1,name:null,value:null};let l=s;let o=0;try{e:for(;;){a&&(o>1e4&&this.emitCritical(ee.GeneralParsingLimitIsReached),o++);let c=t[t.length-1],h=e[c][r.name];if(i){if(!h){if(l.index===r.index){r=this.readToken(),l=s;continue}r.value===B?this.emitError(ee.SyntaxUnexpectedEOF,r):this.emitError(ee.SyntaxUnknownError,r),l=le.cloneToken(r),r={...le.cloneToken(r),name:j}}h=e[c][r.name];const a=r.name===j;if(!h||a&&h.type===u.k_Shift){let a=le.cloneToken(l);for(;a.name===D;)a=this.readToken();-1===(c=this.restoreState(e,n,t,a,r))&&this.emitCritical(ee.SyntaxRecoverableStateNotFound),h=e[c][r.name],t.push(h.stateIndex),n.addToken(r),r=a;continue}}if(Object(O.c)(h))switch(h.type){case u.k_Success:break e;case u.k_Shift:{const e=h.stateIndex;t.push(e),n.addToken(r);const a=await this.operationAdditionalAction(e,r.name);a===u.k_Error?this.emitCritical(ee.SyntaxUnknownError,r):a===u.k_Ok&&(r=this.readToken())}break;case u.k_Reduce:{const a=h.rule.right.length;t.length-=a;const i=e[t[t.length-1]][h.rule.left].stateIndex;t.push(i),n.reduceByRule(h.rule,this._ruleCreationModeMap[h.rule.left]),await this.operationAdditionalAction(i,h.rule.left)===u.k_Error&&this.emitCritical(ee.SyntaxUnknownError,r)}}else Object(O.a)(!i,"unexpected end, something went wrong :/"),this.emitCritical(ee.SyntaxUnknownError,r)}n.finishTree()}catch(e){if(!(e instanceof R.a))throw e}}async parse(e){this.defaultInit(),this._source=e,this._lexer.init(e);const t=this._syntaxTable,r=this._stack,n=this._syntaxTree,a=v.testAll(this._parseMode,l.k_DebugMode);return await this.run(t,r,this.readToken(),n,{debugMode:a}),this._diag.hasErrors()?(console.error("parsing was ended with errors."),i.k_Error):i.k_Ok}setParseFileName(e){this._filename=F.make(e)}getParseFileName(){return this._filename}printStates(e=!0){if(!Object(O.c)(this._states))return void console.warn("It`s impossible to print states. You must init parser in debug-mode");const t="\n"+this.statesToString(e);console.log(t)}printState(e,t=!0){if(Object(O.c)(this._states)){var r=this._states[e];Object(O.c)(r)?console.log(`\n${r.toString(t,this.getGrammarSymbols())}`):console.log("Can not print stete with index: "+e.toString())}else console.log("It`s impossible to print states. You must init parser in debug-mode.")}getGrammarSymbols(){return this._grammarSymbols}getSyntaxTree(){return this._syntaxTree}saveState(){return{source:this._source,fileName:this._filename,tree:this._syntaxTree,types:this._typeIdMap,stack:this._stack,token:this._token}}loadState(e){this._source=e.source,this._filename=e.fileName,this._syntaxTree=e.tree,this._typeIdMap=e.types,this._stack=e.stack,this._token=e.token,this._lexer.setSource(e.source),this._lexer.setIndex(e.token.index)}addAdditionalFunction(e,t){Object(O.e)(this._additionalFunctionsMap)&&(this._additionalFunctionsMap={}),this._additionalFunctionsMap[e]=t}addTypeId(e){Object(O.e)(this._typeIdMap)&&(this._typeIdMap={}),this._typeIdMap[e]=!0}defaultInit(){this._stack=[0],this._syntaxTree=new ae(v.testAll(this._parseMode,l.k_Optimize)),this._typeIdMap={},this._diag.reset()}emitError(e,t){this.error(e,{...this._lexer.getLocation(),token:t})}emitCritical(e,t=null){this.critical(e,{...this._lexer.getLocation(),token:t})}grammarError(e,t){let r="grammar";switch(e){case ee.GrammarAddOperation:{const{stateIndex:n,grammarSymbol:a,oldOperation:i,newOperation:s}=t;this.critical(e,{file:r,line:0,stateIndex:n,grammarSymbol:a,oldOperation:le.operationToString(i),newOperation:le.operationToString(s),stateDesc:this._states[n].toString()})}break;case ee.GrammarAddStateLink:{const{stateIndex:n,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s}=t;this.critical(e,{file:r,line:0,stateIndex:n,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s})}break;case ee.GrammarUnexpectedSymbol:{const{grammarLine:n,expectedSymbol:a,unexpectedSymbol:i}=t;this.critical(e,{file:r,line:n,expectedSymbol:a,unexpectedSymbol:i})}break;case ee.GrammarInvalidAdditionalFuncName:{const{grammarLine:n}=t;this.critical(e,{file:r,line:n})}break;case ee.GrammarInvalidKeyword:{const{grammarLine:n,badKeyword:a}=t;this.critical(e,{file:r,line:n,badKeyword:a})}break;default:throw"invalid case!!!!"}}clearMem(){delete this._productions,delete this._states,delete this._baseItems,delete this._firstTerminalsCache,delete this._closureForItemsCache,delete this._expectedExtensionDMap}hasState(e,t){return this._states.find(r=>r.isEqual(e,t))||null}nonTerminals(){return Object.keys(this._productions)}rules(e){const t=this._productions[e];return t?Object.keys(t).map(e=>t[e]):null}ruleCreationMode(e){return this._ruleCreationModeMap[e]}symbols(){return[...this._grammarSymbols.keys()]}isTerminal(e){return!this._productions[e]}pushState(e){e.index=this._states.length,this._states.push(e)}pushBaseItem(e){e.index=this._baseItems.length,this._baseItems.push(e)}tryAddState(e,t){let r=this.hasState(e,t);return Object(O.e)(r)?(t===s.k_LR0&&e.eachItem(e=>this.pushBaseItem(e)),this.pushState(e),this.closure(e,t),e):r}hasEmptyRule(e){return!this.isTerminal(e)&&!!this.rules(e).find(e=>0===e.right.length)}pushInSyntaxTable(e,t,r,n){e[t]=e[t]||{},Object(O.c)(e[t][r])&&this.grammarError(ee.GrammarAddOperation,{stateIndex:t,grammarSymbol:this.convertGrammarSymbol(r),oldOperation:this._syntaxTable[t][r],newOperation:n}),e[t][r]=n}addStateLink(e,t,r){e.addNextState(r,t)||this.grammarError(ee.GrammarAddStateLink,{stateIndex:e.index,oldNextStateIndex:e.nextStates[r]||null,newNextStateIndex:t.index,grammarSymbol:this.convertGrammarSymbol(r)})}firstTerminals(e){if(this.isTerminal(e))return null;if(Object(O.c)(this._firstTerminalsCache[e]))return this._firstTerminalsCache[e];const t=this.rules(e),r=this._firstTerminalsCache[e]=new Set;if(this.hasEmptyRule(e)&&r.add(L),Object(O.e)(t))return r;for(let n=0;n<t.length;++n){const a=t[n].right;let i=!1;for(let t=0;t<a.length;t++){if(a[t]===e){if(r.has(L))continue;i=!0;break}const n=this.firstTerminals(a[t]);if(Object(O.e)(n))r.add(a[t]);else for(const e of n)r.add(e);if(!this.hasEmptyRule(a[t])){i=!0;break}}i||r.add(L)}return r}firstTerminalsForSet(e,t){const r=new Set;for(let t=0;t<e.length;t++){const n=this.firstTerminals(e[t]);if(Object(O.e)(n))return r.add(e[t]),r;let a=!1;for(const e of n)e!==L?r.add(e):a=!0;if(!a)return r}return Object(O.e)(t)||t.forEach(e=>r.add(e)),r}generateRules(e){let t,r,n=e.split(/\r?\n/),i=!1;this._productions={},this._additionalFuncInfoList=[],this._ruleCreationModeMap={},this._grammarSymbols=new Map([["END_SYMBOL",B]]);let s=0,o=0;const u=v.testAll(this._parseMode,l.k_AllNode),c=v.testAll(this._parseMode,l.k_Negate),h=v.testAll(this._parseMode,l.k_Add);let p,d=this._ruleCreationModeMap,f=0;for(s=0;s<n.length;s++)if(""!==n[s]&&"\r"!==n[s]&&(t=n[s].trim().split(/\s* \s*/))[0][0]!=z)if(i){if((3===t.length||4===t.length&&""===t[3])&&('"'===t[2][0]||"'"===t[2][0])&&t[2].length>3){t[2][0]!==t[2][t[2].length-1]&&this.grammarError(ee.GrammarUnexpectedSymbol,{unexpectedSymbol:t[2][t[2].length-1],expectedSymbol:t[2][0],grammarLine:s}),t[2]=t[2].slice(1,t[2].length-1);var m=t[2][0];p="_"===m||m>="a"&&m<="z"||m>="A"&&m<="Z"?this._lexer.addKeyword(t[2],t[0]):this._lexer.addPunctuator(t[2],t[0]),this._grammarSymbols.set(p,t[2])}}else if(t[0]!==V){for(Object(O.c)(this._productions[t[0]])||(this._productions[t[0]]={}),r={left:t[0],right:[],index:0},this._grammarSymbols.set(t[0],t[0]),u?d[t[0]]=a.k_Default:c&&!Object(O.c)(d[t[0]])?d[t[0]]=a.k_Default:h&&!Object(O.c)(d[t[0]])&&(d[t[0]]=a.k_Not),o=2;o<t.length;o++)if(""!==t[o])if(t[o]!==M)if(t[o]!==q)if(t[o]!==G)"'"===t[o][0]||'"'===t[o][0]?(3!==t[o].length&&this.grammarError(ee.GrammarInvalidKeyword,{badKeyword:t[o],grammarLine:s}),t[o][0]!==t[o][2]&&this.grammarError(ee.GrammarUnexpectedSymbol,{unexpectedSymbol:t[o][2],expectedSymbol:t[o][0],grammarLine:s}),p=this._lexer.addPunctuator(t[o][1]),r.right.push(p),this._grammarSymbols.set(p,t[o][1])):(r.right.push(t[o]),this._grammarSymbols.set(t[o],t[o]));else{t[o+1]&&0!==t[o+1].length||this.grammarError(ee.GrammarInvalidAdditionalFuncName,{grammarLine:s});let e={name:t[o+1],position:r.right.length,rule:r};this._additionalFuncInfoList.push(e),o++}else c&&!u&&(d[t[0]]=a.k_Not);else h&&(d[t[0]]=a.k_Necessary);r.index=f,this._productions[t[0]][r.index]=r,f++,Object(O.a)(1!=f||Object(O.c)(this._productions[w][0]))}else i=!0}generateFunctionByStateMap(){if(!Object(O.e)(this._additionalFunctionsMap)){var e,t,r,n,a=this._states,i=this._additionalFuncInfoList,s=0,l=0,o=0,u={};for(u=this._adidtionalFunctByStateDMap={},l=0;l<i.length;l++)if(e=i[l],r=this._additionalFunctionsMap[e.name],Object(O.c)(r))for(t=e.rule,s=e.position,n=t.right[s-1],o=0;o<a.length;o++)a[o].hasRule(t,s)&&(Object(O.c)(u[a[o].index])||(u[a[o].index]={}),u[a[o].index][n]=r)}}generateFirstState_LR0(){const e=new ie,t=this._productions[w][0],r=new X(t,0);this.pushBaseItem(r),e.push(r),this.closure_LR0(e),this.pushState(e)}generateFirstState_LR(){const e=new ie,t=this._productions[w][0];e.push(new X(t,0,[B])),this.closure_LR(e),this.pushState(e)}closure(e,t){t===s.k_LR0?this.closure_LR0(e):this.closure_LR(e)}closure_LR0(e){e.eachItem(t=>{const r=t.symbolName();r===P||this.isTerminal(r)||this.rules(r).forEach(t=>e.tryPush_LR0(t,0))})}closure_LR(e){let t;do{t=!1,e.eachItem(r=>{const n=r.symbolName();if(n!==P&&!this.isTerminal(n)){const a=r.rule.right.slice(r.pos+1),i=this.firstTerminalsForSet(a,r.expectedSymbols);this.rules(n).forEach(r=>{i.forEach(n=>{e.tryPush_LR(r,0,n)&&(t=!0)})})}})}while(t)}static nextState_LR0(e,t){const r=new ie;return e.eachItem(e=>{e.symbolName()===t&&r.push(new X(e.rule,e.pos+1))}),r}static nextState_LR(e,t){const r=new ie;return e.eachItem(e=>{if(e.symbolName()===t){const t=Array.from(e.expectedSymbols);r.push(new X(e.rule,e.pos+1,t))}}),r}deleteNotBaseItems(){this._states.forEach(e=>e.deleteNotBase())}closureForItem({rule:e,pos:t}){const r=e.index+"_"+t;let n=this._closureForItemsCache[r];return Object(O.c)(n)?n:((n=new ie).push(new X(e,t,[U])),this.closure_LR(n),this._closureForItemsCache[r]=n,n)}addLinkExpected(e,t){let r=this._expectedExtensionDMap,n=e.index;r[n]=r[n]||{},r[n][t.index]=!0}determineExpected(e,t){const r=e.nextStates[t]||null;Object(O.e)(r)||e.eachBaseItem(e=>{const t=this.closureForItem(e);r.eachBaseItem(r=>{const n=t.hasChildItem(r);n&&n.expectedSymbols.forEach(t=>{t===U?this.addLinkExpected(e,r):r.addExpected(t)})})})}generateLinksExpected(){const e=this._states,t=this.symbols();e.forEach(e=>t.forEach(t=>this.determineExpected(e,t)))}expandExpected(){const e=this._baseItems,t=e.map(e=>!0),r=this._expectedExtensionDMap;let n;e[0].addExpected(B),t[0]=!0;do{n=!1,e.forEach(a=>{if(t[a.index]&&Object(O.d)(r[a.index])){let i=Object.keys(r[a.index]).map(e=>Number(e));a.expectedSymbols.forEach(r=>{i.forEach(a=>{e[a].addExpected(r)&&(t[a]=!0,n=!0)})})}t[a.index]=!1})}while(n)}generateStates(e){e===s.k_LR0?this.generateStates_LR0():e===s.k_LR1?this.generateStates_LR():e===s.k_LALR&&this.generateStates_LALR()}generateStates_LR0(){this.generateFirstState_LR0();const e=this._states,t=this.symbols();for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<t.length;e++){const r=t[e];let a=le.nextState_LR0(n,r);a.isEmpty()||(a=this.tryAddState(a,s.k_LR0),this.addStateLink(n,a,r))}}}generateStates_LR(){this._firstTerminalsCache={},this.generateFirstState_LR();const e=this._states,t=this.symbols();for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<t.length;e++){let r=t[e],a=le.nextState_LR(n,r);a.isEmpty()||(a=this.tryAddState(a,s.k_LR1),this.addStateLink(n,a,r))}}}generateStates_LALR(){this._baseItems=[],this._expectedExtensionDMap={},this._closureForItemsCache={},this._firstTerminalsCache={},this.generateStates_LR0(),this.deleteNotBaseItems(),this.generateLinksExpected(),this.expandExpected(),this._states.forEach(e=>this.closure_LR(e))}addReducing(e,t,r){t.eachItem(n=>{if(n.symbolName()===P)if(n.rule.left===w)this.pushInSyntaxTable(e,t.index,B,{type:u.k_Success});else for(const a of n.expectedSymbols)this.pushInSyntaxTable(e,t.index,a,r[n.rule.index])})}addShift(e,t,r){const n=t.nextStates,a=Object.keys(n);for(let i=0;i<a.length;i++){const s=n[a[i]];this.pushInSyntaxTable(e,t.index,a[i],r[s.index])}}buildSyntaxTable(){this._states=[],this._syntaxTable={};const e=this._states,t=this._syntaxTable;this.generateStates(this._type);const r={},n={};e.forEach(e=>{n[e.index]={type:u.k_Shift,stateIndex:e.index}}),this.nonTerminals().forEach(e=>{this.rules(e).forEach(e=>{r[e.index]={type:u.k_Reduce,rule:e}})}),e.forEach(e=>{this.addReducing(t,e,r),this.addShift(t,e,n)})}readToken(){return this._lexer.getNextToken()}async operationAdditionalAction(e,t){let r=this._adidtionalFunctByStateDMap;return!Object(O.e)(this._adidtionalFunctByStateDMap)&&Object(O.c)(r[e])&&Object(O.c)(r[e][t])?await r[e][t]():u.k_Ok}async resumeParse(){const e=this._syntaxTable,t=this._stack,r=Object(O.e)(this._token)?this.readToken():this._token,n=this._syntaxTree;return await this.run(e,t,r,n,{}),this._diag.hasErrors()?(console.error("parsing was ended with errors."),i.k_Error):i.k_Ok}statesToString(e=!0){if(!this._states)return"";let t="";for(let r=0;r<this._states.length;r++)t+=this._states[r].toString(e,this._grammarSymbols),t+=" ";return t}static operationToString(e){let t="";switch(e.type){case u.k_Shift:t="SHIFT to state "+e.stateIndex.toString();break;case u.k_Reduce:t="REDUCE by rule { "+le.ruleToString(e.rule)+" }";break;case u.k_Success:t="SUCCESS"}return t}static ruleToString(e){let t;return t=e.left+" : "+e.right.join(" ")}convertGrammarSymbol(e){return this.isTerminal(e)?this._lexer.getTerminalValueByName(e):e}getDiagnostics(){let e=this._diag.resolve(),t=this._lexer.getDiagnostics();return R.b.mergeReports([t,e])}critical(e,t){this._diag.critical(e,t)}error(e,t){this._diag.error(e,t)}static init(e,t=null){const{grammar:r,mode:n,type:a}=e;return r?Object(O.b)(e,le.$parserParams)?le.$parser:(Object(O.e)(t)&&(t=le),console.time(),console.log("%c Creating parser....","background: #222; color: #bada55"),le.$parserParams=e,le.$parser=new t,le.$parser.init(r,n,a)?console.log("%c [ DONE ]","background: #222; color: #bada55"):(console.error("Could not initialize parser!"),le.$parser=null),console.timeEnd(),le.$parser):le.$parser}static async parse(e,t="stdin"){le.$parser.setParseFileName(t);const r=`parse ${t}`;console.time(r);let n=await le.$parser.parse(e);console.timeEnd(r);let a=le.$parser.getDiagnostics(),i=le.$parser.getSyntaxTree();return le.$parser.setParseFileName("stdin"),{result:n,diag:a,ast:i}}}le.$parser=null,le.$parserParams=null;class oe{constructor(e){this._dirname=null,this._extension=null,this._filename=null,Object(O.c)(e)&&this.set(e)}get path(){return this.toString()}set path(e){this.set(e)}get dirname(){return this._dirname}set dirname(e){this._dirname=e}get filename(){return this._filename}set filename(e){this._filename=e}get ext(){return this._extension}set ext(e){this._extension=e}get basename(){return this._filename?this._filename+(this._extension?"."+this._extension:""):""}set basename(e){var t=e.lastIndexOf(".");t<0?(this._filename=e.substr(0),this._extension=null):(this._filename=e.substr(0,t),this._extension=e.substr(t+1))}set(e){if(Object(O.g)(e)){var t=e.replace("\\","/").split("/");this.basename=t.pop(),this._dirname=t.join("/")}else{if(!(e instanceof oe)){if(Object(O.e)(e))return null;throw new Error(`Unexpected data type was used: ${e}`)}this._dirname=e.dirname,this._filename=e.filename,this._extension=e.ext}}isAbsolute(){return"/"===this._dirname[0]}toString(){return(this._dirname?this._dirname+"/":"")+this.basename}}function ue(e){var t=ce(e),r=t.isAbsolute(),n=t.dirname,a=/[\\\/]$/.test(n);return(n=function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];"."===a?e.splice(n,1):".."===a?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;)e.unshift("..");return e}(n.split(/[\\\/]+/).filter((function(e){return!!e})),!r).join("/"))&&a&&(n+="/"),t.dirname=(r?"/":"")+n,t.toString()}function ce(e){return new oe(e)}class he{constructor(e){this._scheme=null,this._userinfo=null,this._host=null,this._port=0,this._path=null,this._query=null,this._fragment=null,e&&this.set(e)}get urn(){return(this._path?this._path:"")+(this._query?"?"+this._query:"")+(this._fragment?"#"+this._fragment:"")}get url(){return(this._scheme?this._scheme:"")+this.authority}get authority(){return this._host?"//"+(this._userinfo?this._userinfo+"@":"")+this._host+(this._port?":"+this._port:""):""}get scheme(){return this._scheme}get protocol(){return this._scheme?this._scheme.substr(0,this._scheme.lastIndexOf(":")):this._scheme}get userInfo(){return this._userinfo}get host(){return this._host}set host(e){this._host=e}get port(){return this._port}set port(e){this._port=e}get path(){return this._path}set path(e){this._path=e}get query(){return this._query}set query(e){this._query=e}get fragment(){return this._fragment}set(e){if(Object(O.g)(e)){var t=he.uriExp.exec(e);return console.assert(null!==t,"Invalid URI format used.\nused uri: "+e),t?(this._scheme=t[1]||null,this._userinfo=t[2]||null,this._host=t[3]||null,this._port=parseInt(t[4])||null,this._path=t[5]||t[6]||null,this._query=t[7]||null,this._fragment=t[8]||null,this):null}return e instanceof he?this.set(e.toString()):(console.error("Unexpected data type was used."),null)}toString(){return this.url+this.urn}}function pe(e){if(!Object(O.e)(e.path))if("filesystem:"===e.scheme){var t=de(e.path);t.path=ue(t.path),e.path=t.toString()}else e.path=ue(e.path);return e}function de(e){return new he(e)}he.uriExp=new RegExp("^([a-z0-9+.-]+:)?(?:\\/\\/(?:((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*)@)?((?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*)(?::(\\d*))?(\\/(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?|(\\/?(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?)(?:\\?((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?$","i");const fe=e=>fetch(e).then(e=>e.text());class me extends le{constructor(){super(),this._includedFilesMap=null,this.addAdditionalFunction("addType",this._addType.bind(this)),this.addAdditionalFunction("includeCode",this._includeCode.bind(this))}defaultInit(){super.defaultInit(),this.addTypeId("float2"),this.addTypeId("float3"),this.addTypeId("float4"),this.addTypeId("float2x2"),this.addTypeId("float3x3"),this.addTypeId("float4x4"),this.addTypeId("int2"),this.addTypeId("int3"),this.addTypeId("int4"),this.addTypeId("uint2"),this.addTypeId("uint3"),this.addTypeId("uint4"),this.addTypeId("bool2"),this.addTypeId("bool3"),this.addTypeId("bool4"),this._includedFilesMap={},this._includedFilesMap[`${this.getParseFileName()}`]=!0}addIncludedFile(e){this._includedFilesMap[e]=!0}_addType(){let e=this.getSyntaxTree().lastNode,t=e.children[e.children.length-2].value;return this.addTypeId(t),u.k_Ok}async _includeCode(){let e=this.getSyntaxTree().lastNode.value,t=e.substr(1,e.length-2);if(e=function(e,t=document.location.href){var r,n=de(t),a=de(e);return pe(a),pe(n),Object(O.e)(a.scheme)&&Object(O.e)(a.host)&&!ce(a.path).isAbsolute()?(r=ce(n.path).dirname,n.path=r?r+"/"+e:e,pe(n).toString()):e}(t,`${this.getParseFileName()}`),this._includedFilesMap[e])return u.k_Ok;let r=this._saveState();try{let t=await fe(e);return r.source=r.source.substr(0,r.token.index)+t+r.source.substr(r.token.index),this.loadState(r),this.addIncludedFile(e),await this.resumeParse()==i.k_Ok?u.k_Ok:u.k_Error}catch(t){this.critical(ee.GeneralCouldNotReadFile,{target:e})}return u.k_Error}_saveState(){let e=super.saveState();return e.includeFiles=this._includedFilesMap,e}_loadState(e){super.loadState(e),this._includedFilesMap=e.includeFiles}}const _e=self;_e.onmessage=e=>{const t=e.data,{type:r,payload:n}=t;switch(r){case"install":le.init(n,me);break;case"validation":!async function(e,t){const r=await le.parse(e,t),n=c.a(r.ast,t),a=R.b.mergeReports([r.diag,n.diag]);_e.postMessage({type:"validation",payload:a.messages})}(n.text,n.uri)}}},Ui5A:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("xj/u"),a=r("FrU9"),i=r("fs98");class s extends n.a{constructor({operand:e,args:t=null,...r}){super({instrType:a.b.k_CompileExpr,...r}),this._operand=i.a.$withParent(e,this),this._args=(t||[]).map(e=>i.a.$withParent(e,this))}get function(){return this._operand}get args(){return this._args}}},VP8E:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fs98"),a=r("FrU9");class i extends n.a{constructor({instructions:e=[],...t}){super({instrType:a.b.k_Collector,...t}),this._instructions=e}get instructions(){return this._instructions}push(e){this._instructions.push(e)}toCode(){let e="";for(const t of this.instructions)switch(t.instructionType){case a.b.k_VariableDecl:e+=t.toCode()+";\n";break;default:e+=t.toCode()+"\n"}return e}}},Vb34:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("FrU9"),a=r("fti1"),i=r("xj/u"),s=r("nkzX");class l extends i.a{constructor({value:e,scope:t,...r}){super({instrType:n.b.k_FloatExpr,type:s.a.wrapAsConst(a.c,a.a),scope:t,...r}),this._value=1*e}get value(){return this._value}toString(){return String(this._value)}toCode(){var e="";return e+=this._value.toString(),this._value%1==0&&(e+="."),e}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},WYGX:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("zioJ"),i=r("FrU9"),s=r("fs98"),l=r("C/fJ");class o extends l.a{constructor({init:e=null,cond:t=null,step:r=null,body:n=null,...a}){super({instrType:i.b.k_ForStmt,...a}),this._init=s.a.$withParent(e,this),this._cond=s.a.$withParent(t,this),this._step=s.a.$withParent(r,this),this._body=s.a.$withParent(n,this)}get init(){return this._init}get cond(){return this._cond}get step(){return this._step}get body(){return this._body}toCode(){var e="for(";return e+=this._init.toCode()+";",e+=this._cond.toCode()+";",e+=this._step.toCode()+")",e+=this._body.toCode()}check(e,t=null){return Object(n.e)(this._step)?(this._setError(a.a.InvalidForStepEmpty),!1):Object(n.e)(this._init)?(this._setError(a.a.InvalidForInitEmptyIterator),!1):this._init.instructionType!==i.b.k_VariableDecl?(this._setError(a.a.InvalidForInitExpr),!1):Object(n.e)(this._cond)?(this._setError(a.a.InvalidForConditionEmpty),!1):this._cond.instructionType!==i.b.k_RelationalExpr?(this._setError(a.a.InvalidForConditionRelation),!1):this._step.instructionType===i.b.k_UnaryExpr||this._step.instructionType===i.b.k_AssignmentExpr||this._step.instructionType===i.b.k_PostfixArithmeticExpr||(this._setError(a.a.InvalidForStepExpr),!1)}}},XXBI:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s}));var n=r("fb8x"),a=r("FrU9");class i{constructor({type:e=a.c.k_Default,parent:t=null,strictMode:r=!1}){this.type=e,this.parent=t,this.strictMode=r,this.variableMap={},this.typeMap={},this.functionMap={},this.techniqueMap={}}isStrict(){let e=this;for(;!Object(n.e)(e);){if(e.strictMode)return!0;e=e.parent}return!1}findVariable(e){let t=this;for(;!Object(n.e)(t);){let r=t.variableMap[e];if(Object(n.c)(r))return r;t=t.parent}return null}findType(e){let t=this;for(;!Object(n.e)(t);){let r=t.typeMap[e];if(Object(n.c)(r))return r;t=t.parent}return null}findFunction(e,t=null){let r=this,a=null;for(;!Object(n.e)(r);){let i=r.functionMap[e];if(Object(n.c)(i))for(let e=0;e<i.length;e++){let r=i[e],s=r.def.params;if(Object(n.e)(t)){if(!Object(n.e)(a))return;a=r;continue}if(t.length>s.length||t.length<r.def.numArgsRequired)continue;let l=!0;for(let e=0;e<t.length&&(l=!1,!t[e]||t[e].isEqual(s[e].type));e++)l=!0;if(l){if(!Object(n.e)(a))return;a=r}}r=r.parent}return a}findTechnique(e){let t=this;for(;!Object(n.e)(t);){let r=t.techniqueMap[e];if(Object(n.c)(r))return r;t=t.parent}return null}hasVariable(e){return!Object(n.e)(this.findVariable(e))}hasType(e){return!Object(n.e)(this.findType(e))}hasFunction(e,t=[]){let r=this;for(;!Object(n.e)(r);){let a=r.functionMap[e];if(Object(n.c)(a))for(let e=0;e<a.length;e++){let r=a[e],n=r.def.params;if(t.length>n.length||t.length<r.def.numArgsRequired)continue;let i=!0;for(let e=0;e<t.length&&(i=!1,t[e].type.isEqual(n[e].type));e++)i=!0;if(i)return!0}r=r.parent}return!1}hasTechnique(e){return!Object(n.e)(this.findTechnique(e))}hasVariableInScope(e){return Object(n.d)(this.variableMap[e])}hasTypeInScope(e){return Object(n.d)(this.typeMap[e])}hasTechniqueInScope(e){return Object(n.d)(this.techniqueMap[e.name])}findFunctionInScope(e){const t=this.functionMap[e.name];if(!Object(n.c)(t))return null;const r=e.def.params;let a=null;for(let e=0;e<t.length;e++){let n=t[e].def.params;if(n.length!==r.length)continue;let i=!0;for(let e=0;e<r.length&&(i=!1,n[e].type.isEqual(r[e].type));e++)i=!0;if(i){a=t[e];break}}return a}hasFunctionInScope(e){return!Object(n.e)(this.findFunctionInScope(e))}addVariable(e){let t=this.variableMap,r=e.name;return!this.hasVariableInScope(r)&&(t[r]=e,Object(n.a)(e.scope===this),!0)}addType(e){let t=this.typeMap,r=e.name;return!this.hasTypeInScope(r)&&(t[r]=e,console.assert(e.scope===this),!0)}addFunction(e){Object(n.a)(this.type<=a.c.k_Global),Object(n.a)(e.scope===this);let t=this.functionMap,r=e.name;t[r]=t[r]||[];const i=t[r];let s=this.findFunctionInScope(e);if(s){Object(n.a)(!Object(n.e)(e.impl)),Object(n.a)(Object(n.e)(s.impl));let t=i.indexOf(s);i[t]=e}else i.push(e);return!0}addTechnique(e){Object(n.a)(this.type<=a.c.k_Global);let t=this.techniqueMap,r=e.name;return!this.hasTechniqueInScope(e)&&(t[r]=e,Object(n.a)(e.scope===this),!1)}}class s{constructor(e){Object(n.a)(null!==e);let t=a.c.k_Global,r=e;this.globalScope=new i({parent:r,type:t}),this.currentScope=this.globalScope}validate(){Object(n.a)(this.currentScope===this.globalScope)}push(e=a.c.k_Default){Object(n.a)(null!==this.currentScope),Object(n.a)(e>=a.c.k_Default);let t=this.currentScope,r=new i({parent:t,type:e});this.currentScope=r}pop(){Object(n.a)(null!==this.currentScope),this.currentScope=this.currentScope.parent,Object(n.a)(null!==this.currentScope)}}},ey6y:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("C/fJ");class i extends a.a{constructor({operator:e="break",...t}){super({instrType:n.b.k_BreakStmt,...t}),this._operator=e}get operator(){return this._operator}toCode(){return console.assert("break"==this.operator),this.operator+";"}}},fb8x:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"g",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return u})),r.d(t,"i",(function(){return c})),r.d(t,"h",(function(){return h}));let n=e=>void 0!==e,a=e=>null!=e,i=e=>null===e,s=e=>"string"==typeof e,l=e=>"number"==typeof e,o=(e,t)=>JSON.stringify(e)===JSON.stringify(t);const u=console.assert.bind(console),c=console.log.bind(console);function h(e,t){let r=0;for(const n in e)if(!1===t(e[n],n,r++))break}},fs98:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fb8x"),a=r("FrU9");class i{constructor({scope:e,instrType:t,sourceNode:r=null,visible:n=!0}){this._sourceNode=r,this._instructionType=t,this._instructionID=i.INSTRUCTION_COUNTER++,this._scope=e,this._parent=null,this._lastError=null}get parent(){return this._parent}get instructionType(){return console.assert(this._instructionType!=a.b.k_Instruction,"Instruction type 'k_Instruction' is forbidden."),this._instructionType}get instructionName(){return a.b[this.instructionType]}get instructionID(){return this._instructionID}get scope(){return Object(n.e)(this._scope)?Object(n.e)(this.parent)?null:this.parent.scope:this._scope}get sourceNode(){return this._sourceNode}_getLastError(){return this._lastError}_setError(e,t=null){this._lastError={code:e,info:t}}_clearError(){this._lastError=null}_isErrorOccured(){return!Object(n.e)(this._lastError)}_check(e,t=null){return!this._isErrorOccured()}toString(){return console.error("@pure_virtual"),null}toCode(){return console.error("@pure_virtual"),null}$withParent(e){return console.assert(null==this._parent,"parent redefenition detected!"),this.instructionType===a.b.k_SystemType&&"float"===this.name&&this._parent,this._parent=e,this}$withNoParent(){return this}static isExpression(e){switch(e.instructionType){case a.b.k_ConditionalExpr:case a.b.k_ConstructorCallExpr:case a.b.k_AssignmentExpr:case a.b.k_ArithmeticExpr:case a.b.k_InitExpr:case a.b.k_IdExpr:case a.b.k_FunctionCallExpr:case a.b.k_FloatExpr:case a.b.k_IntExpr:case a.b.k_BoolExpr:case a.b.k_PostfixArithmeticExpr:case a.b.k_PostfixIndexExpr:case a.b.k_PostfixPointExpr:case a.b.k_ComplexExpr:case a.b.k_CastExpr:case a.b.k_UnaryExpr:return!0}return!1}static isStatement(e){switch(e.instructionType){case a.b.k_Stmt:case a.b.k_DeclStmt:case a.b.k_ReturnStmt:case a.b.k_IfStmt:case a.b.k_StmtBlock:case a.b.k_ExprStmt:case a.b.k_WhileStmt:case a.b.k_ForStmt:case a.b.k_BreakStmt:case a.b.k_SemicolonStmt:return!0}return!1}static isLiteral(e){switch(e.instructionType){case a.b.k_IntExpr:case a.b.k_FloatExpr:case a.b.k_BoolExpr:case a.b.k_StringExpr:return!0}return!1}static $withParent(e,t){return Object(n.e)(e)?null:e.$withParent(t)}static $withNoParent(e){return Object(n.e)(e)?null:e.$withNoParent()}}i.INSTRUCTION_COUNTER=0,i.UNDEFINE_LENGTH=16777215,i.UNDEFINE_SIZE=16777215,i.UNDEFINE_PADDING=16777215,i.UNDEFINE_NAME="undef"},fti1:function(e,t,r){"use strict";var n=r("fb8x"),a=r("Jbg3"),i=r("P8tn"),s=r("FrU9"),l=r("lztJ");class o extends l.a{constructor({vertex:e=!0,pixel:t=!0,implementation:r=null,...a}){super({instrType:s.b.k_SystemFunctionDecl,implementation:null,...a}),Object(n.a)(Object(n.e)(r)),this._bForVertex=e,this._bForPixel=t}checkVertexUsage(){return this._bForVertex}checkPixelUsage(){return this._bForPixel}$makeVertexCompatible(e){console.warn("@deprecated"),this._bForVertex=e}$makePixelCompatible(e){console.warn("@deprecated"),this._bForPixel=e}}var u=r("fs98");class c extends u.a{constructor({name:e,size:t=0,elementType:r=null,length:n=1,fields:a=[],writable:i=!0,readable:l=!0,declaration:o=null,...c}){super({instrType:s.b.k_SystemType,...c}),this._name=e,this._size=t,this._elementType=u.a.$withNoParent(r),this._length=n,this._fields=[],this._bIsWritable=i,this._bIsReadable=l,this._declaration=o,a.forEach(e=>this.addField(e))}get writable(){return this._bIsWritable}get readable(){return this._bIsReadable}set name(e){this._name=e}get name(){return this._name}get hash(){return this._name}get strongHash(){return this._name}get size(){return this.isArray()?this.arrayElementType.size*this.length:this._size}get baseType(){return this}get arrayElementType(){return this._elementType}get typeDecl(){return this.parent}get length(){return this._length}get fields(){return this._fields}get fieldNames(){return this._fields.map(e=>e.name)}isBase(){return!0}isArray(){return!Object(n.e)(this.arrayElementType)}isNotBaseArray(){return!1}isComplex(){return!1}isEqual(e){return this.hash===e.hash}isStrongEqual(e){return this.strongHash===e.strongHash}isConst(){return!1}isSampler(){return"sampler"===this.name||"sampler2D"===this.name||"samplerCUBE"===this.name}isSamplerCube(){return"samplerCUBE"===this.name}isSampler2D(){return"sampler"===this.name||"sampler2D"===this.name}isContainArray(){return!1}isContainSampler(){return!1}isContainPointer(){return!1}isContainComplexType(){return!1}toString(){return this.name||this.hash}toDeclString(){return this._declaration}toCode(){return this._name}hasField(e){return!!this.getField(e)}hasFieldWithSematics(e){return!1}hasAllUniqueSemantics(){return!1}hasFieldWithoutSemantics(){return!1}getField(e){return this._fields.find(t=>t.name==e)||null}getFieldBySemantics(e){return console.error("@undefined_behavior"),null}addField(e){console.assert(null===this.getField(e.name)),this._fields.push(u.a.$withParent(e,this))}}var h=r("jyxV"),p=r("nkzX"),d=r("XXBI"),f=r("zioJ");r.d(t,"a",(function(){return I})),r.d(t,"h",(function(){return C})),r.d(t,"g",(function(){return A})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return F})),r.d(t,"b",(function(){return w})),r.d(t,"e",(function(){return q})),r.d(t,"f",(function(){return Z})),r.d(t,"i",(function(){return Y})),r.d(t,"k",(function(){return X})),r.d(t,"o",(function(){return J})),r.d(t,"r",(function(){return ee})),r.d(t,"q",(function(){return te})),r.d(t,"m",(function(){return re})),r.d(t,"n",(function(){return ne})),r.d(t,"l",(function(){return ae})),r.d(t,"p",(function(){return ie})),r.d(t,"j",(function(){return se}));const m=new d.b({type:s.c.k_System}),_={},y="template";function E(e){throw new Error(e)}function b(e,t={}){E(f.a[e])}function g(e,t=0,r=null,n=1,a=[]){if(N(e))return console.error(`type already exists: ${e}`),null;const i=new c({scope:m,name:e,elementType:r,length:n,fields:a,size:t});return m.addType(i),i}function x(e,t,r){for(let a in t){const s=N(r+(a.length>1?a.length.toString():""));Object(n.a)(s);const l=new i.a({scope:m,name:a}),o=new p.a({scope:m,type:s,writable:t[a]});e.push(new h.b({scope:m,id:l,type:o}))}}function T(e,t,r=0){if(r>=e.length)return;if(0===r){for(let r=0;r<e.length;r++)t[e[r]]=!0;r=1}const n=Object.keys(t);for(let r=0;r<e.length;r++)for(let a=0;a<n.length;a++)-1!==n[a].indexOf(e[r])?t[n[a]+e[r]]=!1:t[n[a]+e[r]]=!1!==t[n[a]];T(e,t,++r)}function S(e,t,r,n,s){let l=r.map((e,t)=>new h.b({type:new p.a({type:e,scope:m}),id:new i.a({name:`p${t}`,scope:m}),scope:m})),u=new p.a({type:e,scope:m}),c=new i.a({scope:m,name:t}),d=new a.a({scope:m,returnType:u,id:c,paramList:l}),f=new o({scope:m,definition:d,pixel:s,vertex:n});m.addFunction(f)}function k(e,t,r,a,i=!0,s=!0){if(Object(n.e)(a)){t===y&&E("Bad return type(TEMPLATE_TYPE) for system function '"+e+"'.");let n=e+"(",a=N(t),l=[];for(let t=0;t<r.length;t++)r[t]===y?E("Bad argument type(TEMPLATE_TYPE) for system function '"+e+"'."):(l.push(N(r[t])),n+=r[t]+",");_[n+=")"]&&b(f.a.SystemFunctionRedefinition,{funcName:n}),S(a,e,l,i,s),_[n]=!0}else for(let n=0;n<a.length;n++){let l=e+"(",o=N(t===y?a[n]:t),u=[];for(let e=0;e<r.length;e++)r[e]===y?(u.push(N(a[n])),l+=a[n]+","):(u.push(N(r[e])),l+=r[e]+",");_[l+=")"]&&b(f.a.SystemFunctionRedefinition,{funcName:l}),S(o,e,u,i,s),_[l]=!0}}function N(e){let t=m.findType(e);return Object(n.a)(!t||t.instructionType===s.b.k_SystemType),t}g("void",0),g("int",4),g("bool",4),g("float",4),g("string"),g("texture"),g("sampler"),g("sampler2D"),g("samplerCUBE"),function(){let e={},t={},r={},n={},a={},i={},s={},l={},o={};T(["x","y"],e),T(["x","y","z"],t),T(["x","y","z","w"],r),T(["r","g"],n),T(["r","g","b"],a),T(["r","g","b","a"],i),T(["s","t"],s),T(["s","t","p"],l),T(["s","t","p","q"],o);let u=N("float"),c=N("int"),h=N("bool"),p=g("float2",-1,u,2),d=g("float3",-1,u,3),f=g("float4",-1,u,4),m=g("int2",-1,c,2),_=g("int3",-1,c,3),y=g("int4",-1,c,4),E=g("bool2",-1,h,2),b=g("bool3",-1,h,3),S=g("bool4",-1,h,4);{let t=[];x(t,e,"float"),x(t,n,"float"),x(t,s,"float"),t.forEach(e=>p.addField(e))}{let e=[];x(e,t,"float"),x(e,a,"float"),x(e,l,"float"),e.forEach(e=>d.addField(e))}{let e=[];x(e,r,"float"),x(e,i,"float"),x(e,o,"float"),e.forEach(e=>f.addField(e))}{let t=[];x(t,e,"int"),x(t,n,"int"),x(t,s,"int"),t.forEach(e=>m.addField(e))}{let e=[];x(e,t,"int"),x(e,a,"int"),x(e,l,"int"),e.forEach(e=>_.addField(e))}{let e=[];x(e,r,"int"),x(e,i,"int"),x(e,o,"int"),e.forEach(e=>y.addField(e))}{let t=[];x(t,e,"bool"),x(t,n,"bool"),x(t,s,"bool"),t.forEach(e=>E.addField(e))}{let e=[];x(e,t,"bool"),x(e,a,"bool"),x(e,l,"bool"),e.forEach(e=>b.addField(e))}{let e=[];x(e,r,"bool"),x(e,i,"bool"),x(e,o,"bool"),e.forEach(e=>S.addField(e))}}(),function(){let e=N("float2"),t=N("float3"),r=N("float4"),n=N("int2"),a=N("int3"),i=N("int4"),s=N("bool2"),l=N("bool3"),o=N("bool4");g("float2x2",-1,e,2),g("float2x3",-1,e,3),g("float2x4",-1,e,4),g("float3x2",-1,t,2),g("float3x3",-1,t,3),g("float3x4",-1,t,4),g("float4x2",-1,r,2),g("float4x3",-1,r,3),g("float4x4",-1,r,4),g("int2x2",-1,n,2),g("int2x3",-1,n,3),g("int2x4",-1,n,4),g("int3x2",-1,a,2),g("int3x3",-1,a,3),g("int3x4",-1,a,4),g("int4x2",-1,i,2),g("int4x3",-1,i,3),g("int4x4",-1,i,4),g("bool2x2",-1,s,2),g("bool2x3",-1,s,3),g("bool2x4",-1,s,4),g("bool3x2",-1,l,2),g("bool3x3",-1,l,3),g("bool3x4",-1,l,4),g("bool4x2",-1,o,2),g("bool4x3",-1,o,3),g("bool4x4",-1,o,4)}(),k("dot","float",[y,y],["float","float2","float3","float4"]),k("mul",y,[y,y],["float","int"]),k("mul",y,[y,"float"],["float2","float3","float4","float2x2","float3x3","float4x4"]),k("mul",y,["float",y],["float2","float3","float4","float2x2","float3x3","float4x4"]),k("mul","float4",["float4",y],["float4x4","float4x3","float4x2"]),k("mul","float3",["float3",y],["float3x4","float3x3","float3x2"]),k("mul","float2",["float2",y],["float2x4","float2x3","float2x2"]),k("mul","float4",[y,"float4"],["float4x4","float3x4","float2x4"]),k("mul","float3",[y,"float3"],["float4x3","float3x3","float2x3"]),k("mul","float2",[y,"float2"],["float4x2","float3x2","float2x2"]),k("mod","float",["float","float"],null),k("floor",y,[y],["float","float2","float3","float4"]),k("ceil",y,[y],["float","float2","float3","float4"]),k("abs",y,[y],["float","float2","float3","float4"]),k("sign",y,[y],["float","float2","float3","float4"]),k("normalize",y,[y],["float","float2","float3","float4"]),k("length","float",[y],["float","float2","float3","float4"]),k("cross","float3",["float3","float3"],null),k("reflect",y,[y,y],["float","float2","float3","float4"]),k("max",y,[y,y],["float","float2","float3","float4"]),k("max",y,[y,"float"],["float2","float3","float4"]),k("min",y,[y,y],["float","float2","float3","float4"]),k("min",y,[y,"float"],["float2","float3","float4"]),k("clamp",y,[y,y,y],["float","float2","float3","float4"]),k("clamp",y,[y,"float","float"],["float2","float3","float4"]),k("pow",y,[y,y],["float","float2","float3","float4"]),k("mod",y,[y,y],["float2","float3","float4"]),k("mod",y,[y,"float"],["float2","float3","float4"]),k("exp",y,[y],["float","float2","float3","float4"]),k("exp2",y,[y],["float","float2","float3","float4"]),k("log",y,[y],["float","float2","float3","float4"]),k("log2",y,[y],["float","float2","float3","float4"]),k("inversesqrt",y,[y],["float","float2","float3","float4"]),k("sqrt",y,[y],["float","float2","float3","float4"]),k("all","bool",[y],["bool2","bool3","bool4"]),k("any","bool",[y],["bool2","bool3","bool4"]),k("not",y,[y],["bool2","bool3","bool4"]),k("distance","float",[y,y],["float","float2","float3","float4"]),k("lessThan","bool2",[y,y],["float2","int2"]),k("lessThan","bool3",[y,y],["float3","int3"]),k("lessThan","bool4",[y,y],["float4","int4"]),k("lessThanEqual","bool2",[y,y],["float2","int2"]),k("lessThanEqual","bool3",[y,y],["float3","int3"]),k("lessThanEqual","bool4",[y,y],["float4","int4"]),k("equal","bool2",[y,y],["float2","int2"]),k("equal","bool3",[y,y],["float3","int3"]),k("equal","bool4",[y,y],["float4","int4"]),k("equal",y,[y,y],["bool2","bool3","bool4"]),k("notEqual","bool2",[y,y],["float2","int2"]),k("notEqual","bool3",[y,y],["float3","int3"]),k("notEqual","bool4",[y,y],["float4","int4"]),k("notEqual",y,[y,y],["bool2","bool3","bool4"]),k("greaterThan","bool2",[y,y],["float2","int2"]),k("greaterThan","bool3",[y,y],["float3","int3"]),k("greaterThan","bool4",[y,y],["float4","int4"]),k("greaterThanEqual","bool2",[y,y],["float2","int2"]),k("greaterThanEqual","bool3",[y,y],["float3","int3"]),k("greaterThanEqual","bool4",[y,y],["float4","int4"]),k("radians",y,[y],["float","float2","float3","float4"]),k("degrees",y,[y],["float","float2","float3","float4"]),k("sin",y,[y],["float","float2","float3","float4"]),k("cos",y,[y],["float","float2","float3","float4"]),k("tan",y,[y],["float","float2","float3","float4"]),k("asin",y,[y],["float","float2","float3","float4"]),k("acos",y,[y],["float","float2","float3","float4"]),k("atan",y,[y],["float","float2","float3","float4"]),k("atan",y,[y,y],["float","float2","float3","float4"]),k("tex2D","float4",["sampler","float2"],null),k("tex2D","float4",["sampler2D","float2"],null),k("tex2DProj","float4",["sampler","float3"],null),k("tex2DProj","float4",["sampler2D","float3"],null),k("tex2DProj","float4",["sampler","float4"],null),k("tex2DProj","float4",["sampler2D","float4"],null),k("texCUBE","float4",["sampler","float3"],null),k("texCUBE","float4",["samplerCUBE","float3"],null),k("tex2D","float4",["sampler","float2","float"],null,!1,!0),k("tex2D","float4",["sampler2D","float2","float"],null,!1,!0),k("tex2DProj","float4",["sampler","float3","float"],null,!1,!0),k("tex2DProj","float4",["sampler2D","float3","float"],null,!1,!0),k("tex2DProj","float4",["sampler","float4","float"],null,!1,!0),k("tex2DProj","float4",["sampler2D","float4","float"],null,!1,!0),k("texCUBE","float4",["sampler","float3","float"],null,!1,!0),k("texCUBE","float4",["samplerCUBE","float3","float"],null,!1,!0),k("tex2DLod","float4",["sampler","float2","float"],null,!0,!1),k("tex2DLod","float4",["sampler2D","float2","float"],null,!0,!1),k("tex2DProjLod","float4",["sampler","float3","float"],null,!0,!1),k("tex2DProjLod","float4",["sampler2D","float3","float"],null,!0,!1),k("tex2DProjLod","float4",["sampler","float4","float"],null,!0,!1),k("tex2DProjLod","float4",["sampler2D","float4","float"],null,!0,!1),k("texCUBELod","float4",["sampler","float3","float"],null,!0,!1),k("texCUBELod","float4",["samplerCUBE","float3","float"],null,!0,!1),k("dFdx",y,[y],["float","float2","float3","float4"]),k("dFdy",y,[y],["float","float2","float3","float4"]),k("width",y,[y],["float","float2","float3","float4"]),k("fwidth",y,[y],["float","float2","float3","float4"]),k("smoothstep",y,[y,y,y],["float","float2","float3","float4"]),k("smoothstep",y,["float","float",y],["float2","float3","float4"]),k("frac",y,[y],["float","float2","float3","float4"]),k("lerp",y,[y,y,y],["float","float2","float3","float4"]),k("lerp",y,[y,y,"float"],["float2","float3","float4"]),k("saturate",y,[y],["float","float2","float3","float4"]);const I=m,C=m.findType("void"),A=m.findType("string"),v=m.findType("float"),O=m.findType("float2"),R=m.findType("float3"),F=m.findType("float4"),P=m.findType("float2x2"),L=m.findType("float3x3"),D=m.findType("float4x4"),w=m.findType("bool"),U=m.findType("bool2"),z=m.findType("bool3"),j=m.findType("bool4"),B=m.findType("bool2x2"),V=m.findType("bool3x3"),M=m.findType("bool4x4"),q=m.findType("int"),G=m.findType("int2"),$=m.findType("int3"),W=m.findType("int4"),H=m.findType("int2x2"),K=m.findType("int3x3"),Q=m.findType("int4x4"),Z=m.findType("sampler"),Y=(m.findType("sampler2D"),m.findType("samplerCUBE"),e=>m.findType(e)),X=e=>m.hasVariable(e);function J(e){return e.isEqual(N("float2x2"))||e.isEqual(N("float3x3"))||e.isEqual(N("float4x4"))||e.isEqual(N("int2x2"))||e.isEqual(N("int3x3"))||e.isEqual(N("int4x4"))||e.isEqual(N("bool2x2"))||e.isEqual(N("bool3x3"))||e.isEqual(N("bool4x4"))}function ee(e){return e.isEqual(N("float2"))||e.isEqual(N("float3"))||e.isEqual(N("float4"))||e.isEqual(N("bool2"))||e.isEqual(N("bool3"))||e.isEqual(N("bool4"))||e.isEqual(N("int2"))||e.isEqual(N("int3"))||e.isEqual(N("int4"))}function te(e){return e.isEqual(w)||e.isEqual(q)||e.isEqual(v)}function re(e){return e.isEqual(v)||e.isEqual(O)||e.isEqual(R)||e.isEqual(F)||e.isEqual(P)||e.isEqual(L)||e.isEqual(D)}function ne(e){return e.isEqual(q)||e.isEqual(G)||e.isEqual($)||e.isEqual(W)||e.isEqual(H)||e.isEqual(K)||e.isEqual(Q)}function ae(e){return e.isEqual(w)||e.isEqual(U)||e.isEqual(z)||e.isEqual(j)||e.isEqual(B)||e.isEqual(V)||e.isEqual(M)}function ie(e){return e.isEqual(Z)||e.isEqual(N("sampler2D"))||e.isEqual(N("samplerCUBE"))}function se(e){return e.isEqual(q)||e.isEqual(v)?Number:e.isEqual(w)?"Boolean":e.isEqual(O)||e.isEqual(U)||e.isEqual(G)?"Vec2":e.isEqual(R)||e.isEqual(z)||e.isEqual($)?"Vec3":e.isEqual(F)||e.isEqual(j)||e.isEqual(W)?"Vec4":e.isEqual(P)||e.isEqual(B)||e.isEqual(H)?"Vec2":e.isEqual(L)||e.isEqual(V)||e.isEqual(K)?"Mat3":e.isEqual(D)||e.isEqual(M)||e.isEqual(Q)?"Mat4":null}},gf1s:function(e,t,r){"use strict";var n,a,i,s,l,o,u;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),function(e){e[e.UNDEF=0]="UNDEF",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(n||(n={})),function(e){e[e.UNDEF=0]="UNDEF",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(a||(a={})),function(e){e[e.MAG_FILTER=10240]="MAG_FILTER",e[e.MIN_FILTER=10241]="MIN_FILTER",e[e.WRAP_S=10242]="WRAP_S",e[e.WRAP_T=10243]="WRAP_T"}(i||(i={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP"}(s||(s={})),function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.NEGATIVE_X=1]="NEGATIVE_X",e[e.POSITIVE_Y=2]="POSITIVE_Y",e[e.NEGATIVE_Y=3]="NEGATIVE_Y",e[e.POSITIVE_Z=4]="POSITIVE_Z",e[e.NEGATIVE_Z=5]="NEGATIVE_Z"}(l||(l={})),function(e){e[e.POSITIVE_X=1]="POSITIVE_X",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.POSITIVE_Y=4]="POSITIVE_Y",e[e.NEGATIVE_Y=8]="NEGATIVE_Y",e[e.POSITIVE_Z=12]="POSITIVE_Z",e[e.NEGATIVE_Z=16]="NEGATIVE_Z"}(o||(o={})),function(e){e[e.TEXTURE0=33984]="TEXTURE0"}(u||(u={}))},iZbo:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("C/fJ"),a=r("FrU9");class i extends n.a{constructor({...e}){super({instrType:a.b.k_SemicolonStmt,...e})}toCode(){return";"}}},jlLN:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("xj/u"),a=r("fti1"),i=r("FrU9"),s=r("nkzX");class l extends n.a{constructor({value:e,scope:t,...r}){super({instrType:i.b.k_StringExpr,type:s.a.wrapAsConst(a.g,a.a),scope:t,...r}),this._value=e}get value(){return this._value}toString(){return this._value}toCode(){return this._value}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},jyxV:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return u}));var n,a=r("rw5u"),i=r("FrU9"),s=r("fb8x"),l=r("nkzX"),o=r("fs98");!function(e){e[e.k_Local=1]="k_Local",e[e.k_Global=2]="k_Global",e[e.k_Argument=4]="k_Argument"}(n||(n={}));class u extends a.a{constructor({id:e,type:t,init:r=null,usageFlags:n=0,...a}){super({instrType:i.b.k_VariableDecl,...a}),this._id=o.a.$withParent(e,this),this._type=o.a.$withNoParent(t),this._initExpr=o.a.$withParent(r,this),this._usageFlags=n,Object(s.a)(!this.isParameter()||Object(s.e)(this.parent)||this.parent.instructionType==i.b.k_FunctionDef),Object(s.a)(this.isLocal()||!this.isLocal()),Object(s.a)(!this.isParameter()||this.isLocal())}get initExpr(){return this._initExpr}get defaultValue(){return this._initExpr.evaluate(),this._initExpr.getEvalValue()}get type(){return this._type}get name(){return this._id.name}get id(){return this._id}get fullName(){if(this.isField()&&l.a.findParentVariableDecl(this.parent)){var e="";return this.parent.instructionType===i.b.k_VariableType&&(e=l.a.resolveVariableDeclFullName(this.parent)),e+="."+this.name}return this.name}isGlobal(){return!!(this._usageFlags&n.k_Global)}isLocal(){return!!(this._usageFlags&n.k_Local)}isParameter(){return!!(this._usageFlags&n.k_Argument)}isUniform(){return this.type.hasUsage("uniform")}isField(){if(Object(s.e)(this.parent))return!1;var e=this.parent.instructionType;return e===i.b.k_VariableType||e===i.b.k_ComplexType||e===i.b.k_SystemType}isSampler(){return this.type.isSampler()}toCode(){var e="";(e=this.type.toCode(),e+=" "+this.id.toCode(),this.type.isNotBaseArray())&&(e+="["+this.type.length+"]");return Object(s.e)(this.initExpr)||this.isSampler()||this.isUniform()||(e+="="+this.initExpr.toCode()),e}static getParameterIndex(e){return e.isParameter()?(Object(s.a)(e.parent.instructionType===i.b.k_FunctionDef),e.parent.params.indexOf(e)):(console.error("invalid call."),-1)}static getParameterOffset(e){if(!e.isParameter())return console.error("invalid call."),0;let t=u.getParameterIndex(e),r=0;for(let n=0;n<t;++n)r+=e.parent.params[n].type.size;return r}}},k8KD:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("C/fJ"),a=r("fs98"),i=r("fb8x"),s=r("FrU9");class l extends n.a{constructor({cond:e,conseq:t,attributes:r=null,contrary:n=null,...i}){super({instrType:s.b.k_IfStmt,...i}),this.cond=a.a.$withParent(e,this),this.conseq=a.a.$withParent(t,this),this.contrary=a.a.$withParent(n,this),this.attributes=(r||[]).map(e=>a.a.$withParent(e,this))}toCode(){var e="";return Object(i.e)(this.contrary)?(e+="if(",e+=this.cond.toCode()+")",e+=this.conseq.toCode()):(e+="if(",e+=this.cond.toCode()+") ",e+=this.conseq.toCode(),e+="else ",e+=this.contrary.toCode()),e}}},lztJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("rw5u"),i=r("fs98");class s extends a.a{constructor({definition:e,implementation:t=null,...r}){super({instrType:n.b.k_FunctionDecl,...r}),this._definition=i.a.$withParent(e,this),this._implementation=i.a.$withParent(t,this)}get impl(){return this._implementation}get def(){return this._definition}get name(){return this.def.name}get id(){return this.def.id}get semantic(){return this.def.semantic}toCode(){let e="";return e+=this.def.toCode(),this.impl?e+=this.impl.toCode():e+=";",e}}},"mQ+y":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("FrU9"),a=r("xj/u"),i=r("fb8x"),s=r("fs98");class l extends a.a{constructor({left:e,right:t,operator:r,...a}){super({instrType:n.b.k_ArithmeticExpr,...a}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=r}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}evaluate(){var e=this._leftOperand.evaluate()?this._leftOperand.getEvalValue():null,t=this._rightOperand.evaluate()?this._rightOperand.getEvalValue():null;if(Object(i.e)(e)||Object(i.e)(t))return!1;try{switch(this.operator){case"+":this._evalResult=e+t;break;case"-":this._evalResult=e-t;break;case"*":this._evalResult=e*t;break;case"/":this._evalResult=e/t;break;case"%":this._evalResult=e%t}return!0}catch(e){return!1}}toCode(){var e="";return e+=this._leftOperand.toCode(),e+=this.operator,e+=this._rightOperand.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},nkzX:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("P8tn"),s=r("fs98"),l=r("jyxV");class o extends s.a{constructor({type:e,usages:t=null,arrayIndex:r=null,writable:i=!0,readable:l=!0,padding:u=s.a.UNDEFINE_PADDING,...c}){super({instrType:a.b.k_VariableType,...c}),e=e.$withNoParent(),this._usageList=[];let h=e.instructionType;if(h===a.b.k_SystemType||h===a.b.k_ComplexType)this._subType=e;else{let t=e;t.isNotBaseArray()?this._subType=e:(this._subType=t.subType,t.usages.forEach(e=>this.addUsage(e)))}Object(n.a)(Object(n.d)(this._subType)),Object(n.a)(Object(n.d)(this._usageList)),this._isWritable=i,this._isReadable=l,this._arrayIndexExpr=null,this._arrayElementType=null,this._padding=u,r&&(this._arrayElementType=s.a.$withParent(new o({scope:this.scope,type:this.subType,usages:this._usageList}),this),this._arrayIndexExpr=s.a.$withParent(r,this)),(t||[]).forEach(e=>this.addUsage(e))}set readable(e){this._isReadable=e}get name(){return this.baseType.name}get hash(){return this.calcHash()}get strongHash(){return this.calcStrongHash()}get writable(){return!!this._isWritable&&(!(this.isArray()&&!this.isBase()||this.isUniform())&&(!this.isConst()&&this.subType.writable))}get readable(){return!!this._isReadable&&(!this.hasUsage("out")&&this.subType.readable)}get size(){if(!Object(n.e)(this._arrayElementType)){let e=this._arrayElementType.size,t=this.length;return t===s.a.UNDEFINE_LENGTH||e===s.a.UNDEFINE_SIZE?s.a.UNDEFINE_SIZE:e*t}return this.subType.size}get baseType(){return this.subType.baseType}get length(){if(!this.isNotBaseArray())return 0;if(this.isNotBaseArray()&&Object(n.e)(this._arrayElementType))return this.subType.length;if(this._arrayIndexExpr.evaluate()){let e=this._arrayIndexExpr.getEvalValue();if(Object(n.f)(e))return e}return s.a.UNDEFINE_LENGTH}get padding(){return this._padding}get arrayElementType(){return this.isArray()?this._arrayElementType||this.subType.arrayElementType:null}get fieldNames(){return this.subType.fieldNames}get usages(){return this._usageList}get subType(){return this._subType}get fields(){return this.isComplex()?this.subType.fields:null}toString(){return this.name||this.subType.toString()||this.hash}toCode(){let e="";if(!Object(n.e)(this._usageList))for(let t=0;t<this._usageList.length;t++)e+=this._usageList[t]+" ";return e+=this.subType.toCode()}toDeclString(){return this.subType.toDeclString()}isBase(){return this.subType.isBase()&&Object(n.e)(this._arrayElementType)}isArray(){return!Object(n.e)(this._arrayElementType)||this.subType.isArray()}isNotBaseArray(){return!Object(n.e)(this._arrayElementType)||this.subType.isNotBaseArray()}isComplex(){return this.subType.isComplex()}isEqual(e){return(!this.isNotBaseArray()||!e.isNotBaseArray()||this.length===e.length&&this.length!==s.a.UNDEFINE_LENGTH&&e.length!==s.a.UNDEFINE_LENGTH)&&this.hash===e.hash}isStrongEqual(e){return!(!this.isEqual(e)||this.strongHash!==e.strongHash)}isSampler(){return this.subType.isSampler()}isSamplerCube(){return this.subType.isSamplerCube()}isSampler2D(){return this.subType.isSampler2D()}isContainArray(){return this.subType.isContainArray()}isContainSampler(){return this.subType.isContainSampler()}isContainComplexType(){return this.subType.isContainComplexType()}isUniform(){return this.hasUsage("uniform")}isConst(){return this.hasUsage("const")}$overwritePadding(e){this._padding=e}addUsage(e){this.hasUsage(e)||this._usageList.push(e)}hasField(e){return!this.isNotBaseArray()&&this.subType.hasField(e)}hasFieldWithSematics(e){return!!this.isComplex()&&this.subType.hasFieldWithSematics(e)}hasAllUniqueSemantics(){return!!this.isComplex()&&this.subType.hasAllUniqueSemantics()}hasFieldWithoutSemantics(){return!!this.isComplex()&&this.subType.hasFieldWithoutSemantics()}getField(e){if(!this.hasField(e))return null;const t=this.scope;let{id:r,type:n,type:{padding:a},semantic:u}=this.subType.getField(e),c=o.wrap(n,t);c.$overwritePadding(a);let h=new i.a({scope:t,name:r.name}),p=new l.b({scope:t,id:h,type:c,semantic:u});return s.a.$withParent(p,this)}getFieldBySemantics(e){if(this.hasFieldWithSematics(e))return null;let t=this.subType.getFieldBySemantics(e);const r=this.scope;t.type.padding;let n=t.id,a=new o({scope:r,type:t.type}),i=new l.b({scope:r,id:n,type:a});return s.a.$withParent(i,this)}hasUsage(e){for(let t=0;t<this._usageList.length;t++)if(this._usageList[t]===e)return!0;return!Object(n.e)(this.subType)&&this.subType.instructionType===a.b.k_VariableType&&this.subType.hasUsage(e)}calcHash(){let e=this.subType.hash;if(!Object(n.e)(this._arrayElementType)){e+="[";const t=this.length;t===s.a.UNDEFINE_LENGTH?e+="undef":e+=t.toString(),e+="]"}return e}calcStrongHash(){let e=this.subType.strongHash;if(this.isArray()){e+="[";const t=this.length;t===s.a.UNDEFINE_LENGTH?e+="undef":e+=t.toString(),e+="]"}return e}static isInheritedFromVariableDecl(e){if(Object(n.e)(e.parent))return!1;let t=e.parent.instructionType;return t===a.b.k_VariableDecl||t===a.b.k_VariableType&&o.isInheritedFromVariableDecl(e.parent)}static isTypeOfField(e){if(Object(n.e)(e.parent))return!1;if(e.parent.instructionType===a.b.k_VariableDecl){return e.parent.isField()}return!1}static findParentContainer(e){if(!o.isInheritedFromVariableDecl(e)||!o.isTypeOfField(e))return null;let t=o.findParentVariableDecl(e).parent;return o.isInheritedFromVariableDecl(t)?o.findParentVariableDecl(t):null}static findParentVariableDecl(e){if(!o.isInheritedFromVariableDecl(e))return null;return e.parent.instructionType===a.b.k_VariableDecl?e.parent:o.findParentVariableDecl(e.parent)}static findParentVariableDeclName(e){let t=o.findParentVariableDecl(e);return Object(n.e)(t)?null:t.name}static finParentTypeDecl(e){if(!o.isInheritedFromVariableDecl(e))return null;return e.parent.instructionType===a.b.k_TypeDecl?e.parent:o.finParentTypeDecl(e.parent)}static finParentTypeDeclName(e){let t=o.finParentTypeDecl(e);return Object(n.e)(t)?null:t.name}static resolveVariableDeclFullName(e){return o.isInheritedFromVariableDecl(e)?o.findParentVariableDecl(e).fullName:(console.error("Not from variable decl"),null)}static findMainVariable(e){return o.isInheritedFromVariableDecl(e)?o.isTypeOfField(e)?o.findMainVariable(e.parent.parent):o.findParentVariableDecl(e):null}static wrap(e,t){return new o({type:e,scope:t})}static wrapAsConst(e,t){return new o({type:e,scope:t,writable:!1,usages:["const"]})}}},qV3Q:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fs98"),a=r("FrU9");class i extends n.a{constructor({moduleName:e,...t}){super({instrType:a.b.k_Provide,...t}),this._value=e}get moduleName(){return this._value}toString(){return this._value}toCode(){return this._value}}},"r/+x":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("fti1"),i=r("xj/u");class s extends i.a{constructor({left:e,right:t,operator:r,...i}){super({instrType:n.b.k_RelationalExpr,type:a.b,...i}),this._leftOperand=e,this._rightOperand=t,this._operator=r}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},ruTA:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("xj/u"),a=r("fs98"),i=r("FrU9");class s extends n.a{constructor({expr:e,...t}){super({instrType:i.b.k_ComplexExpr,type:e.type,...t}),this._expr=a.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return"("+this.expr.toCode()+")"}isConst(){return this.expr.isConst()}evaluate(){return!!this.expr.evaluate()&&(this._evalResult=this.expr.getEvalValue(),!0)}}},rw5u:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("fs98");class i extends a.a{constructor({semantic:e=null,annotation:t=null,...r}){super({instrType:n.b.k_Decl,...r}),this._semantic=e,this._annotation=a.a.$withParent(t,this)}get semantic(){return this._semantic}get annotation(){return this._annotation}get name(){return null}get id(){return null}}},tUdl:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("fs98"),i=r("C/fJ");class s extends i.a{constructor({cond:e,body:t,operator:r,...i}){super({instrType:n.b.k_WhileStmt,...i}),this._cond=a.a.$withParent(e,this),this._body=a.a.$withParent(t,this),this._operator=r}get cond(){return this.cond}get body(){return this._body}get operator(){return this._operator}toCode(){var e="";return"while"===this.operator?(e+="while(",e+=this.cond.toCode(),e+=")",e+=this.body.toCode()):(e+="do",e+=this.body.toCode(),e+="while(",e+=this.cond.toCode(),e+=");"),e}}},uWV6:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("fs98");class i extends a.a{constructor({name:e,args:t,...r}){super({instrType:n.b.k_Attribute,...r}),this.name=e,this.args=t}toCode(){return`[${this.name}]`}}},wBNY:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("xj/u"),i=r("fs98");class s extends a.a{constructor({decl:e,args:t,...r}){super({instrType:n.b.k_FunctionCallExpr,...r}),this._decl=e,this._args=(t||[]).map(e=>i.a.$withParent(e,this))}get decl(){return this._decl}get args(){return this._args}toCode(){let e="";e+=this.decl.def.id.toCode(),e+="(";for(let t=0;t<this._args.length;t++)e+=this._args[t].toCode(),t!==this._args.length-1&&(e+=",");return e+=")"}}},"xj/u":function(e,t,r){"use strict";var n=r("fb8x"),a=r("FrU9"),i=r("fs98");class s extends i.a{constructor({type:e,...t}){super({instrType:a.b.k_Typed,...t}),this._type=i.a.$withNoParent(e),Object(n.e)(this._type)&&console.warn("Something goes wrong! Type is not specified!",this)}get type(){return this._type}}r.d(t,"a",(function(){return l}));class l extends s{constructor({...e}){super({instrType:a.b.k_Expr,...e}),this._evalResult=null}get type(){return super.type}evaluate(){return console.error("@pure_virtual"),!1}getEvalValue(){return this._evalResult}isConst(){return!1}isConstExpr(){return!0}static UnwindExpr(e){if(Object(n.e)(e))return null;switch(e.instructionType){case a.b.k_PostfixPointExpr:case a.b.k_PostfixIndexExpr:return l.UnwindExpr(e.element);case a.b.k_IdExpr:return e.decl;case a.b.k_ArithmeticExpr:return null;case a.b.k_InitExpr:return Object(n.a)(!1,"init expression doesn't support unwind operation"),null;case a.b.k_AssignmentExpr:return l.UnwindExpr(e.left);case a.b.k_CastExpr:case a.b.k_UnaryExpr:case a.b.k_RelationalExpr:case a.b.k_ConstructorCallExpr:return null;case a.b.k_ComplexExpr:return l.UnwindExpr(e.expr);case a.b.k_IntExpr:case a.b.k_FloatExpr:case a.b.k_StringExpr:case a.b.k_BoolExpr:case a.b.k_FunctionCallExpr:return null;default:return Object(n.a)(!1,"unsupported expr found"),null}}}},ym9a:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return ue}));var n=r("fb8x"),a=r("zioJ"),i=r("6dfp"),s=r("2blz"),l=r("FrU9"),o=r("RTx6"),u=r("mQ+y"),c=r("PVgK"),h=r("uWV6"),p=r("0wCl"),d=r("ey6y"),f=r("GFhz"),m=r("Ui5A"),_=r("ruTA"),y=r("PaCb"),E=r("5isi"),b=r("BeYb"),g=r("Oowq"),x=r("xj/u"),T=r("RkPf"),S=r("Vb34"),k=r("WYGX"),N=r("wBNY"),I=r("lztJ"),C=r("Jbg3"),A=r("4Xpw"),v=r("P8tn"),O=r("k8KD"),R=r("NOIS"),F=r("fs98"),P=r("VP8E"),L=r("2Gf8"),D=r("+nKl"),w=r("8WaY"),U=r("1N+t"),z=r("9zTq"),j=r("Paat"),B=r("qV3Q"),V=r("r/+x"),M=r("JJi1"),q=r("CDNN"),G=r("8/9+"),$=r("iZbo"),W=r("zHvP"),H=r("jlLN"),K=r("NcQ/"),Q=r("Jlck"),Z=r("Ewde"),Y=r("jyxV"),X=r("nkzX"),J=r("tUdl"),ee=r("XXBI"),te=r("fti1"),re=r("DTTp");function ne(e,t,r){return t._check(r)?t:(function(e,t,r){e.error(t,r.code,Object(n.e)(r.info)?{}:r.info)}(e,t.sourceNode,t._getLastError()),null)}function ae(e,t){let r=s.a.UNDEF;switch(e){case i.a.ALPHABLENDENABLE:case i.a.ALPHATESTENABLE:return console.warn("ALPHABLENDENABLE/ALPHATESTENABLE not supported in WebGL."),s.a.UNDEF;case i.a.BLENDENABLE:case i.a.CULLFACEENABLE:case i.a.ZENABLE:case i.a.ZWRITEENABLE:case i.a.DITHERENABLE:case i.a.SCISSORTESTENABLE:case i.a.STENCILTESTENABLE:case i.a.POLYGONOFFSETFILLENABLE:switch(t){case"TRUE":r=s.a.TRUE;break;case"FALSE":r=s.a.FALSE;break;default:return console.warn("Unsupported render state ALPHABLENDENABLE/ZENABLE/ZWRITEENABLE/DITHERENABLE value used: "+t+"."),r}break;case i.a.CULLFACE:switch(t){case"FRONT":r=s.a.FRONT;break;case"BACK":r=s.a.BACK;break;case"FRONT_AND_BACK":r=s.a.FRONT_AND_BACK;break;default:return console.warn("Unsupported render state CULLFACE value used: "+t+"."),r}break;case i.a.FRONTFACE:switch(t){case"CW":r=s.a.CW;break;case"CCW":r=s.a.CCW;break;default:return console.warn("Unsupported render state FRONTFACE value used: "+t+"."),r}break;case i.a.SRCBLEND:case i.a.DESTBLEND:case i.a.SRCBLENDALPHA:case i.a.DESTBLENDALPHA:case i.a.SRCBLENDCOLOR:case i.a.DESTBLENDCOLOR:case i.a.BLENDFUNC:case i.a.BLENDFUNCSEPARATE:switch(t){case"ZERO":r=s.a.ZERO;break;case"ONE":r=s.a.ONE;break;case"SRCCOLOR":r=s.a.SRCCOLOR;break;case"INVSRCCOLOR":r=s.a.INVSRCCOLOR;break;case"SRCALPHA":r=s.a.SRCALPHA;break;case"INVSRCALPHA":r=s.a.INVSRCALPHA;break;case"DESTALPHA":r=s.a.DESTALPHA;break;case"INVDESTALPHA":r=s.a.INVDESTALPHA;break;case"DESTCOLOR":r=s.a.DESTCOLOR;break;case"INVDESTCOLOR":r=s.a.INVDESTCOLOR;break;case"SRCALPHASAT":r=s.a.SRCALPHASAT;break;default:return console.warn("Unsupported render state SRCBLEND/DESTBLEND value used: "+t+"."),r}break;case i.a.BLENDEQUATION:case i.a.BLENDEQUATIONSEPARATE:case i.a.BLENDEQUATIONCOLOR:case i.a.BLENDEQUATIONALPHA:switch(t){case"FUNCADD":case"ADD":r=s.a.FUNCADD;break;case"FUNCSUBTRACT":case"SUBTRACT":r=s.a.FUNCSUBTRACT;break;case"FUNCREVERSESUBTRACT":case"REVERSESUBTRACT":r=s.a.FUNCREVERSESUBTRACT;break;default:return console.warn("Unsupported render state BLENDEQUATION/BLENDEQUATIONSEPARATE value used: "+t+"."),r}break;case i.a.ZFUNC:switch(t){case"NEVER":r=s.a.NEVER;break;case"LESS":r=s.a.LESS;break;case"EQUAL":r=s.a.EQUAL;break;case"LESSEQUAL":r=s.a.LESSEQUAL;break;case"GREATER":r=s.a.GREATER;break;case"NOTEQUAL":r=s.a.NOTEQUAL;break;case"GREATEREQUAL":r=s.a.GREATEREQUAL;break;case"ALWAYS":r=s.a.ALWAYS;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),r}break;case i.a.PRIMITIVETOPOLOGY:switch(t){case"TRIANGLELIST":r=s.a.TRIANGLELIST;break;case"LINELIST":r=s.a.LINELIST;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),r}}return r}function ie(e,t,r){te.i(r.name)&&e.error(r.sourceNode,a.a.SystemTypeRedefinition,{typeName:r.name}),t.addType(r.type)||e.error(r.sourceNode,a.a.TypeRedefinition,{typeName:r.name})}function se(e,t){const r=t.globalScope;let i=!1;return Object(n.h)(r.functionMap,t=>{t.forEach(t=>{i=i||!function e(t,r,i){if(-1!==i.indexOf(r.instructionID))return t.error(r.sourceNode,a.a.InvalidFunctionRecursionNotAllowed,{funcName:r.name}),!1;let s=!1;return i=[...i,r.instructionID],Object(re.a)(r.impl,r=>{if(r.instructionType===l.b.k_FunctionCallExpr){let o=r.decl;if(o.instructionType===l.b.k_SystemFunctionDecl)return;if(o=o.scope.findFunctionInScope(o),Object(n.e)(o.impl))return void t.error(r.sourceNode,a.a.InvalidFunctionImplementationNotFound,{funcName:o.name});s=s||e(t,o,i)}}),!s}(e,t,[])})}),!i}class le{constructor(e){this.diagnostics=new o.a,this.filename=e,this.moduleName=null,this.haveCurrentFunctionReturnOccur=!1}beginFunc(){this.func=!0,this.haveCurrentFunctionReturnOccur=!1,this.funcDef=null}endFunc(){this.func=!1}beginPass(){this.renderStates=null}endPass(){this.renderStates=null}error(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.filename;this.diagnostics.error(t,{file:a,loc:n,info:r})}critical(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.filename;this.diagnostics.critical(t,{file:a,loc:n,info:r})}warn(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.filename;this.diagnostics.warning(t,{file:a,loc:n,info:r})}resolveNodeSourceLocation(e){return Object(n.d)(e)?Object(n.c)(e.loc)?e.loc:this.resolveNodeSourceLocation(e.children[e.children.length-1]):null}}class oe{analyzeUseDecl(e,t,r){t.currentScope.strictMode=!0}analyzeComplexName(e){const t=e.children;let r="";for(let e=t.length-1;e>=0;e--)r+=t[e].value;return r}analyzeProvideDecl(t,r,i){const s=i.children,l=r.currentScope;if(3===s.length){let r=this.analyzeComplexName(s[1]);return Object(n.e)(t.moduleName)||console.warn(`Context module overriding detected '${t.moduleName}' => '${e}'`),t.moduleName=r,Object(n.a)("T_KW_PROVIDE"===s[2].name),new B.a({sourceNode:i,moduleName:r,scope:l})}return t.error(i,a.a.UnsupportedProvideAs),null}analyzeInitExpr(e,t,r){const n=r.children,a=t.currentScope;let i=[];if(1===n.length)i.push(this.analyzeExpr(e,t,n[0]));else for(let r=0;r<n.length;r++)"InitExpr"===n[r].name&&i.push(this.analyzeInitExpr(e,t,n[r]));return new R.a({scope:a,sourceNode:r,args:i,type:null})}analyzeVariableDecl(e,t,r){const n=r.children;t.currentScope;let a=this.analyzeUsageType(e,t,n[n.length-1]),i=[];for(let r=n.length-2;r>=1;r--)"Variable"===n[r].name&&i.push(this.analyzeVariable(e,t,n[r],a));return i}analyzeUsageType(e,t,r){const n=r.children,a=t.currentScope;let i=null,s=[];for(let r=n.length-1;r>=0;r--)"Type"===n[r].name?i=this.analyzeType(e,t,n[r]):"Usage"===n[r].name&&s.push(this.analyzeUsage(n[r]));return ne(e,new X.a({scope:a,sourceNode:r,type:i,usages:s}),l.a.CODE_TARGET_SUPPORT)}analyzeType(e,t,r){const i=r.children,s=t.currentScope;let l=null;switch(r.name){case"T_TYPE_ID":l=s.findType(r.value),Object(n.e)(l)&&e.error(r,a.a.InvalidTypeNameNotType,{typeName:r.value});break;case"Struct":l=this.analyzeStruct(e,t,r);break;case"T_KW_VOID":l=te.h;break;case"ScalarType":case"ObjectType":l=s.findType(i[i.length-1].value),Object(n.e)(l)&&e.error(r,a.a.InvalidTypeNameNotType,{typeName:i[i.length-1].value});break;case"VectorType":case"MatrixType":e.error(r,a.a.InvalidTypeVectorMatrix);break;case"BaseType":case"Type":return this.analyzeType(e,t,i[0])}return l}analyzeUsage(e){e=e.children[0];return Object(n.a)(-1!==["uniform","const","in","out","inout"].indexOf(e.value)),e.value}analyzeVariable(e,t,r,i){const s=r.children,o=t.currentScope;let u=null,c=null,h="",p=0;e.func?(e.funcDef||(p|=Y.a.k_Argument),p|=Y.a.k_Local):p|=Y.a.k_Global;let d=null,f=null,m=null,_=s[s.length-1];for(;;){let a=_.children;if(1===a.length){const e=a[0].value;d=new v.a({scope:o,sourceNode:r,name:e});break}Object(n.a)(4==a.length),Object(n.e)(f)||(i=new X.a({scope:o,sourceNode:i.sourceNode,type:i,arrayIndex:f})),f=this.analyzeExpr(e,t,a[a.length-3]),_=a[a.length-1]}m=new X.a({scope:o,sourceNode:i.sourceNode,type:i,arrayIndex:f});for(let n=s.length-2;n>=0;n--)if("Annotation"===s[n].name)u=this.analyzeAnnotation(s[n]);else if("Semantic"===s[n].name)h=this.analyzeSemantic(s[n]);else if("Initializer"===s[n].name){let i=this.analyzeInitializerArguments(e,t,s[n]);c=new R.a({scope:o,sourceNode:s[n],args:i,type:m});let l=!1;try{l=c.optimizeForVariableType(m)}catch(e){}l||(e.error(r,a.a.InvalidVariableInitializing,{varName:d.name}),c=null)}const y=new Y.b({sourceNode:r,scope:o,type:m,init:c,id:d,semantic:h,annotation:u,usageFlags:p});if(Object(n.a)(o.type!=l.c.k_System),te.k(y.name)&&e.error(r,a.a.SystemVariableRedefinition,{varName:y.name}),!o.addVariable(y))switch(o.type){case l.c.k_Global:case l.c.k_Default:e.error(r,a.a.VariableRedefinition,{varName:y.name});break;case l.c.k_Struct:e.error(r,a.a.InvalidNewFieldForStructName,{fieldName:y.name});break;case l.c.k_Annotation:e.error(r,a.a.InvalidNewAnnotationVar,{varName:y.name})}return ne(e,y,l.a.CODE_TARGET_SUPPORT)}analyzeAnnotation(e){return null}analyzeSemantic(e){return e.children[0].value}analyzeInitializerArguments(e,t,r){const n=r.children;t.currentScope;let a=[];if(2===n.length)a.push(this.analyzeExpr(e,t,n[0]));else for(let r=n.length-3;r>=1;r--)"InitExpr"===n[r].name&&a.push(this.analyzeInitExpr(e,t,n[r]));return a}analyzeExpr(e,t,r){const n=r.name;switch(n){case"ObjectExpr":return this.analyzeObjectExpr(e,t,r);case"ComplexExpr":return this.analyzeComplexExpr(e,t,r);case"PostfixExpr":return this.analyzePostfixExpr(e,t,r);case"UnaryExpr":return this.analyzeUnaryExpr(e,t,r);case"CastExpr":return this.analyzeCastExpr(e,t,r);case"ConditionalExpr":return this.analyzeConditionalExpr(e,t,r);case"MulExpr":case"AddExpr":return this.analyzeArithmeticExpr(e,t,r);case"RelationalExpr":case"EqualityExpr":return this.analyzeRelationExpr(e,t,r);case"AndExpr":case"OrExpr":return this.analyzeLogicalExpr(e,t,r);case"AssignmentExpr":return this.analyzeAssignmentExpr(e,t,r);case"T_NON_TYPE_ID":return this.analyzeIdExpr(e,t,r);case"T_STRING":case"T_UINT":case"T_FLOAT":case"T_KW_TRUE":case"T_KW_FALSE":return this.analyzeSimpleExpr(e,t,r);default:e.error(r,a.a.UnsupportedExpr,{exprName:n})}return null}analyzeObjectExpr(e,t,r){switch(r.children[r.children.length-1].name){case"T_KW_COMPILE":return this.analyzeCompileExpr(e,t,r);case"T_KW_SAMPLER_STATE":return this.analyzeSamplerStateBlock(e,t,r)}return null}analyzeCompileExpr(e,t,r,i){const s=r.children,o=s[s.length-2].value,u=t.currentScope;let c=null,h=null,p=null;if(s.length>4){c=[];for(let r=s.length-4;r>0;r--)","!==s[r].value&&c.push(this.analyzeExpr(e,t,s[r]))}p=c?c.map(e=>e.type):null;let d=null;if(i){for(let e of i)if(p=c?c.map(e=>e.type):null,h=null,p=e.args||p,h=e.ret||h,d=t.globalScope.findFunction(o,p))break}else d=t.globalScope.findFunction(o,p);if(Object(n.e)(d))return e.error(r,a.a.InvalidCompileNotFunction,{funcName:o}),null;if(h&&!d.def.returnType.isEqual(h))return e.error(r,a.a.InvalidCompileFunctionNotValid,{funcName:o,funcType:h.toCode(),tooltip:`Return type mismatch: expected '${h.toCode()}' a is a '${d.def.returnType.toCode()}' `}),null;let f=X.a.wrap(d.def.returnType,u);return ne(e,new m.a({args:c,scope:u,type:f,operand:d,sourceNode:r}),l.a.CODE_TARGET_SUPPORT)}analyzeSamplerStateBlock(e,t,r){r=r.children[0];let a=t.currentScope,i=r.children,s=[];for(let r=i.length-2;r>=1;r--){let a=this.analyzeSamplerState(e,t,i[r]);Object(n.e)(a)||s.push(a)}let o=new q.a({sourceNode:r,scope:a,operator:"sampler_state",params:s});return ne(e,o,l.a.CODE_TARGET_SUPPORT),o}analyzeSamplerState(e,t,r){const i=r.children,s=t.currentScope;if("StateIndex"===i[i.length-2].name)return e.error(r,a.a.UnsupportedStateIndex),null;let l=i[i.length-3],o=l.children[l.children.length-1],u=i[i.length-1].value.toUpperCase(),c="";if(Object(n.e)(o.value))return e.error(o,a.a.InvalidSamplerTexture),null;switch(u){case"TEXTURE":if(3!==l.children.length||"{"===o.value)return e.error(o,a.a.InvalidSamplerTexture),null;let t=l.children[1],i=t.value;if(Object(n.e)(i)||!s.findVariable(i))return e.error(l.children[1],a.a.InvalidSamplerTexture),null;let h=s.findVariable(i),p=new v.a({scope:s,sourceNode:t,name:i}),d=new A.a({scope:s,sourceNode:t,id:p,decl:h});return new G.a({scope:s,sourceNode:r,name:u,value:d});case"ADDRESSU":case"ADDRESSV":switch(c=o.value.toUpperCase()){case"WRAP":case"CLAMP":case"MIRROR":break;default:return null}break;case"MAGFILTER":case"MINFILTER":switch(c=o.value.toUpperCase()){case"POINT":c="NEAREST";break;case"POINT_MIPMAP_POINT":c="NEAREST_MIPMAP_NEAREST";break;case"LINEAR_MIPMAP_POINT":c="LINEAR_MIPMAP_NEAREST";break;case"POINT_MIPMAP_LINEAR":c="NEAREST_MIPMAP_LINEAR";break;case"NEAREST":case"LINEAR":case"NEAREST_MIPMAP_NEAREST":case"LINEAR_MIPMAP_NEAREST":case"NEAREST_MIPMAP_LINEAR":case"LINEAR_MIPMAP_LINEAR":break;default:return null}break;default:return console.warn("Don`t support this texture param: "+u),null}return new G.a({sourceNode:r,scope:s,name:u,value:new H.a({sourceNode:l,scope:s,value:c})})}analyzeComplexExpr(e,t,r){const n=r.children;switch(n[n.length-1].name){case"T_NON_TYPE_ID":return this.analyzeFunctionCallExpr(e,t,r);case"BaseType":case"T_TYPE_ID":return this.analyzeConstructorCallExpr(e,t,r);default:return this.analyzeSimpleComplexExpr(e,t,r)}}analyzeFunctionCallExpr(e,t,r){const i=r.children,s=i[i.length-1].value,o=t.currentScope,u=t.globalScope;let c=null,h=null;if(i.length>3){let r;h=[];for(let n=i.length-3;n>0;n--)","!==i[n].value&&(r=this.analyzeExpr(e,t,i[n]),h.push(r))}let p=u.findFunction(s,h?h.map(e=>e?e.type:null):null);if(Object(n.e)(p))return e.error(r,a.a.InvalidComplexNotFunction,{funcName:s}),null;if(!Object(n.c)(p))return e.error(r,a.a.CannotChooseFunction,{funcName:s}),null;if(p.instructionType===l.b.k_FunctionDecl||p.instructionType===l.b.k_SystemFunctionDecl){if(!Object(n.e)(h)){const t=p.def.params;for(let r=0;r<h.length;r++)if(t[r].type.hasUsage("out")){const t=x.a.UnwindExpr(h[r]);if(Object(n.e)(t))return e.error(h[r].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!h[r].type.writable)return e.error(h[r].sourceNode,a.a.InvalidTypeForWriting),null}else if(t[r].type.hasUsage("inout")){const t=x.a.UnwindExpr(h[r]);if(Object(n.e)(t))return e.error(h[r].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!h[r].type.writable)return e.error(h[r].sourceNode,a.a.InvalidTypeForWriting),null;if(!h[r].type.readable)return e.error(h[r].sourceNode,a.a.InvalidTypeForReading),null}else if(!h[r].type.readable)return e.error(h[r].sourceNode,a.a.InvalidTypeForReading),null}const t=X.a.wrap(p.def.returnType,o);c=new N.a({scope:o,type:t,decl:p,args:h,sourceNode:r})}else console.error("@undefined_behavior");return ne(e,c,l.a.CODE_TARGET_SUPPORT)}analyzeConstructorCallExpr(e,t,r){const i=r.children,s=t.currentScope,o=this.analyzeType(e,t,i[i.length-1]);if(Object(n.e)(o))return e.error(r,a.a.InvalidComplexNotType),null;let u=null;if(i.length>3){let r=null;u=[];for(let n=i.length-3;n>0;n--)","!==i[n].value&&(r=this.analyzeExpr(e,t,i[n]),u.push(r))}const c=(h=o,new X.a({type:h,scope:null}));var h;if(Object(n.e)(c))return e.error(r,a.a.InvalidComplexNotConstructor,{typeName:String(o)}),null;if(!Object(n.e)(u))for(let t=0;t<u.length;t++)if(!u[t].type.readable)return e.error(r,a.a.InvalidTypeForReading),null;return ne(e,new b.a({scope:s,sourceNode:r,ctor:c,args:u}),l.a.CODE_TARGET_SUPPORT)}analyzeSimpleComplexExpr(e,t,r){const a=r.children,i=t.currentScope;let s=this.analyzeExpr(e,t,a[1]);return Object(n.e)(s)?null:ne(e,new _.a({scope:i,sourceNode:r,expr:s}),l.a.CODE_TARGET_SUPPORT)}analyzePostfixExpr(e,t,r){const n=r.children;switch(n[n.length-2].value){case"[":return this.analyzePostfixIndex(e,t,r);case".":return this.analyzePostfixPoint(e,t,r);case"++":case"--":return this.analyzePostfixArithmetic(e,t,r)}return null}analyzePostfixIndex(e,t,r){const i=r.children,s=t.currentScope,o=this.analyzeExpr(e,t,i[i.length-1]);if(Object(n.e)(o))return null;const u=o.type;if(!u.isArray())return e.error(r,a.a.InvalidPostfixNotArray,{typeName:String(u)}),null;const c=this.analyzeExpr(e,t,i[i.length-3]),h=c.type;return h.isEqual(te.e)?ne(e,new z.a({scope:s,sourceNode:r,element:o,index:c}),l.a.CODE_TARGET_SUPPORT):(e.error(r,a.a.InvalidPostfixNotIntIndex,{typeName:String(h)}),null)}createFieldDecl(e,t){if(!e.hasField(t))return null;const r=e.scope,{id:n,type:a,type:{padding:i,length:s},semantic:l}=(e.subType||e).getField(t),o=new X.a({type:a,scope:r,padding:i,sourceNode:a.sourceNode}),u=new v.a({scope:r,name:n.name,sourceNode:n.sourceNode}),c=new Y.b({scope:r,id:u,type:o,semantic:l,sourceNode:u.sourceNode});return F.a.$withParent(c,e)}analyzePosifixPointField(e,t,r,a){if(Object(n.e)(a))return null;const i=t.currentScope,s=r.value,l=this.createFieldDecl(a,s);if(Object(n.e)(l))return null;const o=new v.a({scope:i,sourceNode:r,name:s});return new A.a({sourceNode:r,scope:i,id:o,decl:l})}analyzePostfixPoint(e,t,r){const i=r.children,s=t.currentScope,o=this.analyzeExpr(e,t,i[i.length-1]);if(Object(n.e)(o))return null;const u=o.type,c=i[i.length-3].value,h=this.analyzePosifixPointField(e,t,i[i.length-3],u);return Object(n.e)(h)?(e.error(r,a.a.InvalidPostfixNotField,{typeName:String(u),fieldName:c}),null):ne(e,new j.a({sourceNode:r,scope:s,element:o,postfix:h}),l.a.CODE_TARGET_SUPPORT)}analyzePostfixArithmetic(e,t,r){const i=r.children,s=t.currentScope,o=i[0].value,u=this.analyzeExpr(e,t,i[1]),c=u.type,h=oe.checkOneOperandExprType(e,r,o,c);if(Object(n.e)(h))return e.error(r,a.a.InvalidPostfixArithmetic,{operator:o,typeName:String(c)}),null;return ne(e,new U.a({scope:s,sourceNode:r,operator:o,expr:u}),l.a.CODE_TARGET_SUPPORT)}analyzeUnaryExpr(e,t,r){const i=r.children,s=i[1].value,o=t.currentScope;let u=this.analyzeExpr(e,t,i[0]),c=oe.checkOneOperandExprType(e,r,s,u.type);return Object(n.e)(c)?(e.error(r,a.a.InvalidUnaryOperation,{operator:s,tyename:String(u.type)}),null):ne(e,new Z.a({scope:o,sourceNode:r,expr:u,operator:s}),l.a.CODE_TARGET_SUPPORT)}analyzeCastExpr(e,t,r){const n=r.children,i=t.currentScope,s=this.analyzeConstTypeDim(e,t,n[2]),o=this.analyzeExpr(e,t,n[0]);return o.type.readable?ne(e,new f.a({scope:i,sourceNode:r,sourceExpr:o,type:s}),l.a.CODE_TARGET_SUPPORT):(e.error(r,a.a.InvalidTypeForReading),null)}analyzeConditionalExpr(e,t,r){const i=r.children,s=t.currentScope,o=this.analyzeExpr(e,t,i[i.length-1]),u=this.analyzeExpr(e,t,i[i.length-3]),c=this.analyzeExpr(e,t,i[0]);if(Object(n.e)(o)||Object(n.e)(u)||Object(n.e)(c))return e.error(o?o.sourceNode:r,a.a.InvalidConditionType,{typeName:"[unknown]"}),null;const h=o.type,p=u.type,d=c.type,f=te.b;return h.isEqual(f)?p.isEqual(d)?h.readable?p.readable?d.readable?ne(e,new E.a({scope:s,sourceNode:r,cond:o,left:u,right:c}),l.a.CODE_TARGET_SUPPORT):(e.error(d.sourceNode,a.a.InvalidTypeForReading),null):(e.error(p.sourceNode,a.a.InvalidTypeForReading),null):(e.error(h.sourceNode,a.a.InvalidTypeForReading),null):(e.error(p.sourceNode,a.a.InvalidConditonValueTypes,{leftTypeName:String(p),rightTypeName:String(d)}),null):(e.error(o.sourceNode,a.a.InvalidConditionType,{typeName:String(h)}),null)}analyzeArithmeticExpr(e,t,r){const i=r.children,s=t.currentScope,o=r.children[1].value,c=this.analyzeExpr(e,t,i[i.length-1]),h=this.analyzeExpr(e,t,i[0]);if(!c||!h)return e.error(r,a.a.InvalidArithmeticOperation,{operator:o,leftTypeName:"[unknown]",rightTypeName:"[unknown]"}),null;const p=c.type,d=h.type,f=oe.checkTwoOperandExprTypes(e,o,p,d,c.sourceNode,h.sourceNode);return Object(n.e)(f)?(e.error(r,a.a.InvalidArithmeticOperation,{operator:o,leftTypeName:String(p),rightTypeName:String(d)}),null):ne(e,new u.a({scope:s,sourceNode:r,left:c,right:h,operator:o,type:f}),l.a.CODE_TARGET_SUPPORT)}analyzeRelationExpr(e,t,r){const i=r.children,s=t.currentScope,o=r.children[1].value,u=this.analyzeExpr(e,t,i[i.length-1]),c=this.analyzeExpr(e,t,i[0]),h=u?u.type:null,p=c?c.type:null,d=oe.checkTwoOperandExprTypes(e,o,h,p,u?u.sourceNode:null,c?c.sourceNode:null);return Object(n.e)(d)?(e.error(r,a.a.InvalidRelationalOperation,{operator:o,leftTypeName:h?h.hash:"[unknown]",rightTypeName:p?p.hash:"[unknown]"}),null):u&&c?ne(e,new V.a({sourceNode:r,scope:s,left:u,right:c,operator:o}),l.a.CODE_TARGET_SUPPORT):null}analyzeLogicalExpr(e,t,r){const n=r.children,i=t.currentScope,s=r.children[1].value,o=this.analyzeExpr(e,t,n[n.length-1]),u=this.analyzeExpr(e,t,n[0]),c=o.type,h=u.type,p=te.b;if(!c.isEqual(p))return e.error(c.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(c)}),null;if(!h.isEqual(p))return e.error(h.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(h)}),null;if(!c.readable)return e.error(r,a.a.InvalidTypeForReading),null;if(!h.readable)return e.error(r,a.a.InvalidTypeForReading),null;return ne(e,new D.a({scope:i,sourceNode:r,left:o,right:u,operator:s}),l.a.CODE_TARGET_SUPPORT)}analyzeAssignmentExpr(e,t,r){const i=r.children,s=t.currentScope,o=i[1].value,u=this.analyzeExpr(e,t,i[i.length-1]);x.a.UnwindExpr(u)||e.error(r,a.a.InvalidLeftHandSideInAssignment,{operator:o});const h=this.analyzeExpr(e,t,i[0]);if(Object(n.e)(u)||Object(n.e)(h))return null;const p=u.type,d=h.type;let f=null;return"="!==o?(f=oe.checkTwoOperandExprTypes(e,o,p,d,u.sourceNode,h.sourceNode),Object(n.e)(f)&&e.error(r,a.a.InvalidArithmeticAssigmentOperation,{operator:o,leftTypeName:p.hash,rightTypeName:d.hash})):f=d,f=oe.checkTwoOperandExprTypes(e,"=",p,f),Object(n.e)(f)&&e.error(r,a.a.InvalidAssigmentOperation,{leftTypeName:p.hash,rightTypeName:d.hash}),ne(e,new c.a({scope:s,sourceNode:r,left:u,right:h,operator:o}),l.a.CODE_TARGET_SUPPORT)}analyzeIdExpr(e,t,r){const i=t.currentScope;let s=r.value,o=i.findVariable(s);if(Object(n.e)(o))return e.error(r,a.a.UnknownVarName,{varName:s}),null;let u=new v.a({scope:i,sourceNode:r,name:s});return ne(e,new A.a({scope:i,sourceNode:r,id:u,decl:o}),l.a.CODE_TARGET_SUPPORT)}analyzeSimpleExpr(e,t,r){const n=r.name,a=r.value,i=t.currentScope;switch(n){case"T_UINT":return new L.a({scope:i,sourceNode:r,value:a});case"T_FLOAT":return new S.a({scope:i,sourceNode:r,value:a});case"T_STRING":return new H.a({scope:i,sourceNode:r,value:a});case"T_KW_TRUE":return new p.a({scope:i,sourceNode:r,value:"true"});case"T_KW_FALSE":return new p.a({scope:i,sourceNode:r,value:"false"})}return null}analyzeConstTypeDim(e,t,r){const n=r.children;if(n.length>1)return e.error(r,a.a.InvalidCastTypeUsage),null;const i=this.analyzeType(e,t,n[0]);return i.isBase()||e.error(r,a.a.InvalidCastTypeNotBase,{typeName:String(i)}),ne(e,i,l.a.CODE_TARGET_SUPPORT)}analyzeVarStructDecl(e,t,r){const n=r.children;let a=this.analyzeUsageStructDecl(e,t,n[n.length-1]),i=[];for(let r=n.length-2;r>=1;r--)"Variable"===n[r].name&&(i=i.concat(this.analyzeVariable(e,t,n[r],a)));return i}analyzeUsageStructDecl(e,t,r){const a=r.children,i=t.currentScope;let s=[],o=null;for(let r=a.length-1;r>=0;r--)if("StructDecl"===a[r].name){o=this.analyzeStructDecl(e,t,a[r]),ie(e,i,new Q.a({scope:i,sourceNode:a[r],type:o}))}else if("Usage"===a[r].name){const e=this.analyzeUsage(a[r]);s.push(e)}return Object(n.a)(!Object(n.e)(o)),ne(e,new X.a({scope:i,sourceNode:r,usages:s,type:o}),l.a.CODE_TARGET_SUPPORT)}analyzeStruct(e,t,r){const n=r.children,a=t.currentScope;let i=null;"T_NON_TYPE_ID"===n[n.length-2].name&&(i=n[n.length-2].value);let s=[];t.push(l.c.k_Struct);let o=0;for(o=n.length-4;o>=1;o--)"VariableDecl"===n[o].name&&(s=s.concat(this.analyzeVariableDecl(e,t,n[o])));return t.pop(),ne(e,new y.a({scope:a,sourceNode:r,fields:s,name:i}),l.a.CODE_TARGET_SUPPORT)}analyzeFunctionDecl(e,t,r){const i=r.children,s=t.currentScope,o=t.globalScope,u=i[0].value;let c=null,h=null;t.push(l.c.k_Default);let p=this.analyzeFunctionDef(e,t,i[i.length-1]),d=o.findFunction(p.name,p.params.map(e=>e.type));if(!Object(n.c)(d))return e.error(r,a.a.CannotChooseFunction,{funcName:p.name}),t.pop(),null;if(!Object(n.e)(d)&&d.impl)return e.error(r,a.a.FunctionRedefinition,{funcName:p.name}),t.pop(),null;if(!Object(n.e)(d)&&!d.def.returnType.isEqual(p.returnType))return e.error(r,a.a.InvalidFuncDefenitionReturnType,{funcName:p.name}),t.pop(),null;Object(n.a)(null===e.funcDef),e.funcDef=p,3===i.length&&(c=this.analyzeAnnotation(i[1])),";"!==u&&(h=this.analyzeStmtBlock(e,t,i[0])),t.pop();let f=p.returnType.isEqual(te.h);if(!Object(n.e)(h)){let t=h.stmtList;for(let r=t.length-1;r>=0;--r)if(t[r].instructionType==l.b.k_ReturnStmt){r!=t.length-1&&e.error(t[r+1].sourceNode,a.a.UnreachableCode);break}}return Object(n.a)(s==o),d=new I.a({sourceNode:r,scope:s,definition:p,implementation:h,annotation:c}),o.addFunction(d)||e.error(r,a.a.FunctionRedifinition,{funcName:p.name}),f||e.haveCurrentFunctionReturnOccur||Object(n.e)(h)||e.error(r,a.a.InvalidFunctionReturnStmtNotFound,{funcName:p.name}),d}analyzeFunctionDef(e,t,r){const n=r.children,i=t.currentScope,s=n[n.length-2],o=s.value,u=n[n.length-1];let c=this.analyzeUsageType(e,t,u);if(c.isContainSampler())return e.error(u,a.a.InvalidFunctionReturnType,{funcName:o}),null;let h=new v.a({scope:i,name:o,sourceNode:s}),p=null;4===n.length&&(p=this.analyzeSemantic(n[0]));let d=this.analyzeParamList(e,t,n[n.length-3]),f=new C.a({scope:i,sourceNode:r,returnType:c,id:h,paramList:d,semantic:p});return ne(e,f,l.a.CODE_TARGET_SUPPORT),f}analyzeParamList(e,t,r){const n=r.children;let a=[];for(let r=n.length-2;r>=1;r--)if("ParameterDecl"===n[r].name){let i=this.analyzeParameterDecl(e,t,n[r]);a.push(i)}return a}analyzeParameterDecl(e,t,r){const n=r.children;let a=this.analyzeParamUsageType(e,t,n[1]);return this.analyzeVariable(e,t,n[0],a)}analyzeParamUsageType(e,t,r){const n=r.children,a=t.currentScope;let i=[],s=null;for(let r=n.length-1;r>=0;r--)"Type"===n[r].name?s=this.analyzeType(e,t,n[r]):"ParamUsage"===n[r].name&&i.push(this.analyzeUsage(n[r]));let o=new X.a({scope:a,sourceNode:r,type:s,usages:i});return ne(e,o,l.a.CODE_TARGET_SUPPORT),o}analyzeStmtBlock(e,t,r){const a=r.children,i=t.currentScope;let s=[];for(let r=a.length-2;r>0;r--){let i=this.analyzeStmt(e,t,a[r]);Object(n.e)(i)||s.push(i)}const o=new W.a({sourceNode:r,scope:i,stmtList:s});return ne(e,o,l.a.CODE_TARGET_SUPPORT),o}analyzeStmt(e,t,r){const n=r.children;let a,i=n.length;do{a=n[--i].name}while("Attribute"===a);switch(a){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,n[0]);case"UseDecl":return this.analyzeUseDecl(e,t,n[0]),null;case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,r);case"T_KW_FOR":return this.analyzeForStmt(e,t,r);case"T_KW_IF":return this.analyzeIfStmt(e,t,r)}return null}analyzeSimpleStmt(e,t,r){const n=t.currentScope,a=r.children;switch(a[a.length-1].name){case"T_KW_RETURN":return this.analyzeReturnStmt(e,t,r);case"T_KW_DO":return this.analyzeWhileStmt(e,t,r);case"StmtBlock":{t.push(l.c.k_Default);let r=this.analyzeStmtBlock(e,t,a[0]);return t.pop(),r}case"T_KW_DISCARD":case"T_KW_BREAK":case"T_KW_CONTINUE":return this.analyzeBreakStmt(e,t,r);case"TypeDecl":case"VariableDecl":case"VarStructDecl":return this.analyzeDeclStmt(e,t,a[0]);default:return 2===a.length?this.analyzeExprStmt(e,t,r):new $.a({sourceNode:r,scope:n})}}analyzeReturnStmt(e,t,r){const i=r.children,s=t.currentScope;Object(n.a)(e.func);const o=e.funcDef.returnType;if(e.haveCurrentFunctionReturnOccur=!0,o.isEqual(te.h)&&3===i.length)return e.error(r,a.a.InvalidReturnStmtVoid),null;if(!o.isEqual(te.h)&&2===i.length)return e.error(r,a.a.InvalidReturnStmtEmpty),null;let u=null;if(3===i.length){if(u=this.analyzeExpr(e,t,i[1]),Object(n.e)(u))return e.error(r,a.a.InvalidReturnStmtTypesNotEqual),null;if(!o.isEqual(u.type))return e.error(r,a.a.InvalidReturnStmtTypesNotEqual),null}const c=new M.a({sourceNode:r,scope:s,expr:u});return ne(e,c,l.a.CODE_TARGET_SUPPORT),c}analyzeBreakStmt(e,t,r){const a=r.children,i=t.currentScope,s=a[1].value;"discard"===s&&Object(n.e)(e.funcDef);const o=new d.a({sourceNode:r,scope:i,operator:s});return ne(e,o,l.a.CODE_TARGET_SUPPORT),o}analyzeDeclStmt(e,t,r){r.children;const n=t.currentScope;let a=[];switch(r.name){case"TypeDecl":a.push(this.analyzeTypeDecl(e,t,r));break;case"VariableDecl":a=a.concat(this.analyzeVariableDecl(e,t,r));break;case"VarStructDecl":a=a.concat(this.analyzeVarStructDecl(e,t,r))}const i=new g.a({sourceNode:r,scope:n,declList:a});return ne(e,i,l.a.CODE_TARGET_SUPPORT),i}analyzeExprStmt(e,t,r){const n=t.currentScope,a=r.children,i=this.analyzeExpr(e,t,a[1]),s=new T.a({sourceNode:r,scope:n,expr:i});return ne(e,s,l.a.CODE_TARGET_SUPPORT),s}analyzeWhileStmt(e,t,r){const n=t.currentScope,i=r.children,s="do"===i[i.length-1].value,o="NonIfStmt"===r.name,u=te.b;let c=null,h=null,p=null,d="do";if(s){if(d="do",!(h=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(r,a.a.InvalidDoWhileCondition,{typeName:String(h)}),null;p=this.analyzeStmt(e,t,i[0])}else{if(d="while",!(h=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(r,a.a.InvalidWhileCondition,{typeName:String(h)}),null;p=o?this.analyzeNonIfStmt(e,t,i[0]):this.analyzeStmt(e,t,i[0])}const f=new J.a({sourceNode:r,scope:n,cond:c,body:p,operator:d});return ne(e,f,l.a.CODE_TARGET_SUPPORT),f}analyzeAttribute(e,t,r){const a=t.currentScope,i=r.children,s=i[i.length-2].value;let o=null;if(i.length>3){let r=null;o=[];for(let a=i.length-4;a>1;a--)","!==i[a].value&&(r=this.analyzeSimpleExpr(e,t,i[a]),Object(n.a)(r.instructionType===l.b.k_BoolExpr||r.instructionType===l.b.k_FloatExpr||r.instructionType===l.b.k_IntExpr),o.push(r))}return new h.a({scope:a,sourceNode:r,name:s,args:o})}analyzeIfStmt(e,t,r){const n=t.currentScope,i=r.children;let s=[];for(;"Attribute"===i[i.length-1-s.length].name;)s.push(this.analyzeAttribute(e,t,i[i.length-1-s.length]));const o=i.length-s.length==7,u=this.analyzeExpr(e,t,i[i.length-3-s.length]);u&&u.type.isEqual(te.b)||e.error(r,a.a.InvalidIfCondition,{typeName:u?String(u.type):"[unknown]"});let c=null,h=null;if(o?(c=this.analyzeNonIfStmt(e,t,i[2]),h=this.analyzeStmt(e,t,i[0])):c=this.analyzeNonIfStmt(e,t,i[0]),!u)return null;const p=new O.a({sourceNode:r,scope:n,cond:u,conseq:c,contrary:h,attributes:s});return ne(e,p,l.a.CODE_TARGET_SUPPORT),p}analyzeNonIfStmt(e,t,r){const n=r.children;switch(n[n.length-1].name){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,n[0]);case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,r);case"T_KW_FOR":return this.analyzeForStmt(e,t,r)}return null}analyzeForStmt(e,t,r){const n=t.currentScope,a=r.children,i="NonIfStmt"===r.name;let s=null,o=null,u=null,c=null;if("ERROR"===a[1].name)return null;t.push(),o=this.analyzeForInit(e,t,a[a.length-3]),u=this.analyzeForCond(e,t,a[a.length-4]),c=null,7===a.length&&(c=this.analyzeForStep(e,t,a[2])),s=i?this.analyzeNonIfStmt(e,t,a[0]):this.analyzeStmt(e,t,a[0]),t.pop();const h=new k.a({sourceNode:r,scope:n,init:o,cond:u,step:c,body:s});return ne(e,h,l.a.CODE_TARGET_SUPPORT),h}analyzeForInit(e,t,r){const n=r.children;switch(n[n.length-1].name){case"VariableDecl":return this.analyzeVariableDecl(e,t,n[0])[0]||null;case"Expr":return this.analyzeExpr(e,t,n[0])}return null}analyzeForCond(e,t,r){const n=r.children;return 1===n.length?null:this.analyzeExpr(e,t,n[1])}analyzeForStep(e,t,r){const n=r.children;return 0==n.length?null:this.analyzeExpr(e,t,n[0])}analyzeTechniqueDecl(e,t,r){const n=r.children,a=this.analyzeComplexName(n[n.length-2]),i=(n[n.length-2].children.length,t.currentScope);let s=null,o=null,u=null,c=l.d.k_BasicFx;for(let r=n.length-3;r>=0;r--)"Annotation"===n[r].name?s=this.analyzeAnnotation(n[r]):"Semantic"===n[r].name?o=this.analyzeSemantic(n[r]):u=this.analyzeTechnique(e,t,n[r]);const h=new K.a({sourceNode:r,name:a,techniqueType:c,semantic:o,annotation:s,passList:u,scope:i});return oe.addTechnique(e,t,h),h}analyzeTechnique(e,t,r){const a=r.children;let i=[];for(let r=a.length-2;r>=1;r--){let s=this.analyzePassDecl(e,t,a[r]);Object(n.a)(!Object(n.e)(s)),i.push(s)}return i}analyzePassDecl(e,t,r){const n=r.children,a=t.currentScope,i=this.analyzePassStateBlockForShaders(e,t,n[0]),s=this.analyzePassStateBlock(e,t,n[0]);let l=null;for(let e=0;e<n.length;++e)if("T_NON_TYPE_ID"===n[e].name){let t=n[e].value;l=new v.a({scope:a,name:t})}return new w.a({scope:a,sourceNode:r,renderStates:s,id:l,pixelShader:i.pixel,vertexShader:i.vertex})}analyzePassStateBlockForShaders(e,t,r){const a=r.children;let i=null,s=null;const l=["vertexshader","pixelshader"];for(let r=a.length-2;r>=1;r--){let o=null;const u=a[r].children,c=u[u.length-1].value.toLowerCase();if(-1!==l.indexOf(c)&&(o=this.analyzePassStateForShader(e,t,a[r],c),!Object(n.e)(o)))switch(c){case"vertexshader":Object(n.a)(null==s),s=o;break;case"pixelshader":Object(n.a)(null==i),i=o;break;default:console.error("function is not suitable as shader entry point")}}return{vertex:s,pixel:i}}analyzePassStateForShader(e,t,r,i){Object(n.a)("vertexshader"===i||"pixelshader"===i);const s=r.children,l=s[s.length-3],o=l.children[l.children.length-1],u=this.analyzeExpr(e,t,o).function;return"vertexshader"===i?C.a.checkForVertexUsage(u.def)||e.error(r,a.a.FunctionIsNotCompatibleWithVertexShader,{funcDef:String(u)}):C.a.checkForPixelUsage(u.def)||e.error(r,a.a.FunctionIsNotCompatibleWithPixelShader,{funcDef:String(u)}),u}analyzePassStateBlock(e,t,r){const n=r.children;let a={};for(let r=n.length-2;r>=1;r--)a={...a,...this.analyzePassState(e,t,n[r])};return a}analyzePassState(e,t,r){const a=r.children,l=a[a.length-1].value.toUpperCase(),o=i.a[l]||null;if(Object(n.e)(o))return{};const u=a[a.length-3],c=u.children[u.children.length-1];if(Object(n.e)(c.value))return console.warn("Pass state is incorrect."),{};let h={};if("{"===c.value&&u.children.length>3){const e=new Array(Math.ceil((u.children.length-2)/2));for(let t=u.children.length-2,r=0;t>=1;t-=2,r++)e[r]=ae(o,u.children[t].value.toUpperCase());switch(o){case i.a.BLENDFUNC:if(2!==e.length)return console.warn("Pass state are incorrect."),{};h[i.a.SRCBLENDCOLOR]=e[0],h[i.a.SRCBLENDALPHA]=e[0],h[i.a.DESTBLENDCOLOR]=e[1],h[i.a.DESTBLENDALPHA]=e[1];break;case i.a.BLENDFUNCSEPARATE:if(4!==e.length)return console.warn("Pass state are incorrect."),{};h[i.a.SRCBLENDCOLOR]=e[0],h[i.a.SRCBLENDALPHA]=e[2],h[i.a.DESTBLENDCOLOR]=e[1],h[i.a.DESTBLENDALPHA]=e[3];break;case i.a.BLENDEQUATIONSEPARATE:if(2!==e.length)return console.warn("Pass state are incorrect."),{};h[i.a.BLENDEQUATIONCOLOR]=e[0],h[i.a.BLENDEQUATIONALPHA]=e[1];break;default:return console.warn("Pass state is incorrect."),{}}}else{let e="";const t=ae(o,e="{"===c.value?u.children[1].value.toUpperCase():c.value.toUpperCase());if(t!==s.a.UNDEF)switch(o){case i.a.SRCBLEND:h[i.a.SRCBLENDCOLOR]=t,h[i.a.SRCBLENDALPHA]=t;break;case i.a.DESTBLEND:h[i.a.DESTBLENDCOLOR]=t,h[i.a.DESTBLENDALPHA]=t;break;case i.a.BLENDEQUATION:h[i.a.BLENDEQUATIONCOLOR]=t,h[i.a.BLENDEQUATIONALPHA]=t;break;default:h[o]=t}}return h}analyzeImportDecl(e,t,r){const n=r.children,i=this.analyzeComplexName(n[n.length-2]);return e.error(r,a.a.ImportedComponentNotExists,{componentName:i}),null}analyzeStructDecl(e,t,r){const n=r.children,a=t.currentScope,i=n[n.length-2].value;t.push(l.c.k_Struct);let s=[];for(let r=n.length-4;r>=1;r--)"VariableDecl"===n[r].name&&(s=s.concat(this.analyzeVariableDecl(e,t,n[r])));return t.pop(),ne(e,new y.a({scope:a,sourceNode:r,name:i,fields:s}),l.a.CODE_TARGET_SUPPORT)}analyzeTypeDecl(e,t,r){const n=r.children,i=t.currentScope;let s=null;2===n.length?s=this.analyzeStructDecl(e,t,n[1]):e.error(r,a.a.UnsupportedTypeDecl);let o=new Q.a({scope:i,sourceNode:r,type:s});return ie(e,i,o),ne(e,o,l.a.CODE_TARGET_SUPPORT)}analyzeUnknDecl(e,t,r){switch(r.name){case"TechniqueDecl":return[this.analyzeTechniqueDecl(e,t,r)];case"UseDecl":return this.analyzeUseDecl(e,t,r),null;case"ImportDecl":return[this.analyzeImportDecl(e,t,r)];case"ProvideDecl":return[this.analyzeProvideDecl(e,t,r)];case"TypeDecl":return[this.analyzeTypeDecl(e,t,r)];case"VariableDecl":return this.analyzeVariableDecl(e,t,r);case"VarStructDecl":return this.analyzeVarStructDecl(e,t,r);case"FunctionDecl":Object(n.a)(t.currentScope==t.globalScope);let a=null;return e.beginFunc(),a=this.analyzeFunctionDecl(e,t,r),e.endFunc(),[a]}return null}analyzeGlobals(e,t,r){if(Object(n.e)(r)||Object(n.e)(r.root))return null;const a=r.root.children;let i=[];if(Object(n.e)(a))return[];for(let r=a.length-1;r>=0;r--)i.push(...this.analyzeUnknDecl(e,t,a[r])||[]);return i.filter(e=>!!e)}createContext(e){return new le(e)}createProgram(){return new ee.a(te.a)}analyze(e,t="stdin"){console.time(`analyze(${t})`);const r=this.createProgram(),a=this.createContext(t);let i=null;try{i=this.analyzeGlobals(a,r,e),se(a,r),r.validate()}catch(e){console.error(e)}console.timeEnd(`analyze(${t})`),Object(n.a)(r.currentScope==r.globalScope);const s=r.globalScope;return{root:new P.a({scope:s,instructions:i}),scope:s,diag:a.diagnostics.resolve()}}static addTechnique(e,t,r){let n=r.name;t.globalScope.hasTechnique(n)?e.error(r.sourceNode,a.a.TechniqueNameRedefinition,{techName:n}):t.globalScope.addTechnique(r)}static checkTwoOperandExprTypes(e,t,r,n,i=r.sourceNode,s=n.sourceNode){if(!r||!n)return null;const l=r.isComplex()||n.isComplex(),o=r.isNotBaseArray()||n.isNotBaseArray(),u=te.p(r)||te.p(n),c=te.b;if(o||u)return null;if("%"===t||"%="===t)return null;if(oe.isAssignmentOperator(t)){if(!r.writable)return e.error(i,a.a.InvalidTypeForWriting),null;if(!n.readable)return e.error(s,a.a.InvalidTypeForReading),null;"="===t||r.readable||e.error(i,a.a.InvalidTypeForReading)}else{if(!r.readable)return e.error(i,a.a.InvalidTypeForReading),null;if(!n.readable)return e.error(s,a.a.InvalidTypeForReading),null}if(l)return"="===t&&r.isEqual(n)?r:!oe.isEqualOperator(t)||r.isContainArray()||r.isContainSampler()?null:c;const h=X.a.wrap(r.baseType,te.a),p=X.a.wrap(n.baseType,te.a);if(r.isConst()&&oe.isAssignmentOperator(t))return null;if(r.isEqual(n))return oe.isArithmeticalOperator(t)?!te.o(r)||"/"!==t&&"/="!==t?h:null:oe.isRelationalOperator(t)?te.q(r)?c:null:oe.isEqualOperator(t)?c:"="===t?h:null;if(oe.isArithmeticalOperator(t)){if(te.l(r)||te.l(n)||te.m(r)!==te.m(n)||te.n(r)!==te.n(n))return null;if(te.q(r))return p;if(te.q(n))return h;if("*"===t||"*="===t)return te.o(r)&&te.r(n)&&r.length===n.length?p:te.o(n)&&te.r(r)&&r.length===n.length?h:null}return null}static checkOneOperandExprType(e,t,r,i){const s=i.isComplex(),o=i.isNotBaseArray(),u=te.p(i);if(s||o||u)return null;if(!i.readable)return e.error(t,a.a.InvalidTypeForReading),null;if("++"===r||"--"===r)return i.writable?i:(e.error(t,a.a.InvalidTypeForWriting),null);if("!"===r){const e=te.b;return c=e,h=l.b.k_VariableDecl,Object(n.a)(c.instructionType===h),i.isEqual(e)?e:null}return te.l(i)?null:i.baseType;var c,h}static isAssignmentOperator(e){return"+="===e||"-="===e||"*="===e||"/="===e||"%="===e||"="===e}static isArithmeticalOperator(e){return"+"===e||"+="===e||"-"===e||"-="===e||"*"===e||"*="===e||"/"===e||"/="===e}static isRelationalOperator(e){return">"===e||">="===e||"<"===e||"<="===e}static isEqualOperator(e){return"=="===e||"!="===e}}function ue(e,t="stdin"){return(new oe).analyze(e,t)}}).call(this,r("3UD+")(e))},zHvP:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("C/fJ"),a=r("FrU9"),i=r("fs98");class s extends n.a{constructor({stmtList:e,...t}){super({instrType:a.b.k_StmtBlock,...t}),this._stmtList=e.map(e=>i.a.$withParent(e,this))}get stmtList(){return this._stmtList}toCode(){for(var e="{\n",t=0;t<this.stmtList.length;t++)e+="\t"+this.stmtList[t].toCode()+"\n";return e+="}"}}},zioJ:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.SystemTypeRedefinition=2202]="SystemTypeRedefinition",e[e.TypeRedefinition=2203]="TypeRedefinition",e[e.VariableRedefinition=2204]="VariableRedefinition",e[e.SystemVariableRedefinition=2205]="SystemVariableRedefinition",e[e.FunctionRedifinition=2206]="FunctionRedifinition",e[e.SystemFunctionRedefinition=2207]="SystemFunctionRedefinition",e[e.UnsupportedTypeDecl=2208]="UnsupportedTypeDecl",e[e.UnsupportedExpr=2209]="UnsupportedExpr",e[e.UnknownVarName=2210]="UnknownVarName",e[e.InvalidArithmeticOperation=2211]="InvalidArithmeticOperation",e[e.InvalidArithmeticAssigmentOperation=2212]="InvalidArithmeticAssigmentOperation",e[e.InvalidAssigmentOperation=2213]="InvalidAssigmentOperation",e[e.InvalidLeftHandSideInAssignment=2214]="InvalidLeftHandSideInAssignment",e[e.InvalidRelationalOperation=2215]="InvalidRelationalOperation",e[e.InvalidLogicOperation=2216]="InvalidLogicOperation",e[e.InvalidConditionType=2217]="InvalidConditionType",e[e.InvalidConditonValueTypes=2218]="InvalidConditonValueTypes",e[e.InvalidCastTypeUsage=2219]="InvalidCastTypeUsage",e[e.InvalidCastTypeNotBase=2220]="InvalidCastTypeNotBase",e[e.InvalidCastUnknownType=2221]="InvalidCastUnknownType",e[e.InvalidUnaryOperation=2222]="InvalidUnaryOperation",e[e.InvalidPostfixNotArray=2223]="InvalidPostfixNotArray",e[e.InvalidPostfixNotIntIndex=2224]="InvalidPostfixNotIntIndex",e[e.InvalidPostfixNotField=2225]="InvalidPostfixNotField",e[e.InvalidPostfixArithmetic=2226]="InvalidPostfixArithmetic",e[e.InvalidComplexNotFunction=2227]="InvalidComplexNotFunction",e[e.InvalidComplexNotType=2228]="InvalidComplexNotType",e[e.InvalidComplexNotConstructor=2229]="InvalidComplexNotConstructor",e[e.InvalidCompileNotFunction=2230]="InvalidCompileNotFunction",e[e.InvalidCompileFunctionNotValid=2231]="InvalidCompileFunctionNotValid",e[e.FunctionRedefinition=2232]="FunctionRedefinition",e[e.InvalidWhileCondition=2233]="InvalidWhileCondition",e[e.InvalidDoWhileCondition=2234]="InvalidDoWhileCondition",e[e.InvalidIfCondition=2235]="InvalidIfCondition",e[e.InvalidForInitExpr=2236]="InvalidForInitExpr",e[e.InvalidForInitEmptyIterator=2237]="InvalidForInitEmptyIterator",e[e.InvalidForConditionEmpty=2238]="InvalidForConditionEmpty",e[e.InvalidForConditionRelation=2239]="InvalidForConditionRelation",e[e.InvalidForStepEmpty=2240]="InvalidForStepEmpty",e[e.InvalidForStepOperator=2241]="InvalidForStepOperator",e[e.InvalidForStepExpr=2242]="InvalidForStepExpr",e[e.InvalidNewFieldForStructName=2243]="InvalidNewFieldForStructName",e[e.InvalidNewFieldForStructSematic=2244]="InvalidNewFieldForStructSematic",e[e.InvalidNewAnnotationVar=2245]="InvalidNewAnnotationVar",e[e.InvalidFunctionParameterDefenitionDefaultNeeded=2246]="InvalidFunctionParameterDefenitionDefaultNeeded",e[e.CannotChooseFunction=2247]="CannotChooseFunction",e[e.InvalidFuncDefenitionReturnType=2248]="InvalidFuncDefenitionReturnType",e[e.InvalidSystemFunctionReturnType=2249]="InvalidSystemFunctionReturnType",e[e.InvalidTypeNameNotType=2250]="InvalidTypeNameNotType",e[e.InvalidTypeVectorMatrix=2251]="InvalidTypeVectorMatrix",e[e.TechniqueNameRedefinition=2252]="TechniqueNameRedefinition",e[e.InvalidFunctionRecursionNotAllowed=2253]="InvalidFunctionRecursionNotAllowed",e[e.InvalidFunctionImplementationNotFound=2254]="InvalidFunctionImplementationNotFound",e[e.FunctionIsNotCompatibleWithVertexShader=2255]="FunctionIsNotCompatibleWithVertexShader",e[e.FunctionIsNotCompatibleWithPixelShader=2256]="FunctionIsNotCompatibleWithPixelShader",e[e.InvalidReturnStmtVoid=2257]="InvalidReturnStmtVoid",e[e.InvalidReturnStmtEmpty=2258]="InvalidReturnStmtEmpty",e[e.InvalidReturnStmtTypesNotEqual=2259]="InvalidReturnStmtTypesNotEqual",e[e.InvalidFunctionReturnType=2260]="InvalidFunctionReturnType",e[e.InvalidFunctionParameterUsage=2261]="InvalidFunctionParameterUsage",e[e.InvalidTypeForWriting=2262]="InvalidTypeForWriting",e[e.InvalidTypeForReading=2263]="InvalidTypeForReading",e[e.InvalidExprIsNotLValue=2264]="InvalidExprIsNotLValue",e[e.InvalidVariableInitializing=2265]="InvalidVariableInitializing",e[e.UnsupportedStateIndex=2266]="UnsupportedStateIndex",e[e.InvalidSamplerTexture=2267]="InvalidSamplerTexture",e[e.CannotCalcPadding=2268]="CannotCalcPadding",e[e.ImportedComponentNotExists=2269]="ImportedComponentNotExists",e[e.InvalidFunctionReturnStmtNotFound=2270]="InvalidFunctionReturnStmtNotFound",e[e.UnsupportedProvideAs=2271]="UnsupportedProvideAs",e[e.UnreachableCode=2272]="UnreachableCode",e[e.PartFx_VertexShaderParametersMismatch=2273]="PartFx_VertexShaderParametersMismatch"}(n||(n={}))}});
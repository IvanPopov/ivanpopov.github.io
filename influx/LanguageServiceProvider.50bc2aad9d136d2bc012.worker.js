(()=>{"use strict";var e={cOQ3:(e,t,n)=>{n.d(t,{$V:()=>i,Ft:()=>s,HD:()=>o,TP:()=>p,Xq:()=>r,hj:()=>l,hu:()=>u,jn:()=>a,vZ:()=>c});let r=e=>void 0!==e,i=e=>null!=e,s=e=>null===e,a=e=>"boolean"==typeof e,o=e=>"string"==typeof e,l=e=>"number"==typeof e,c=(e,t)=>JSON.stringify(e)===JSON.stringify(t);const u=console.assert.bind(console);console.log.bind(console);function p(e,t){let n=0;for(const r in e)if(!1===t(e[r],r,n++))break}},q04y:(e,t,n)=>{n.d(t,{N:()=>i,a:()=>s});var r=n("vIQR");function i(e,t){if(!e)return;const n=n=>{n&&(t(n,e),i(n,t))};switch(e.instructionType){case r.rO.k_ReturnStmt:n(e.expr);break;case r.rO.k_DeclStmt:e.declList.forEach((e=>n(e)));break;case r.rO.k_ExprStmt:n(e.expr);break;case r.rO.k_IfStmt:n(e.cond),n(e.conseq),n(e.contrary);break;case r.rO.k_StmtBlock:e.stmtList.forEach((e=>n(e)));break;case r.rO.k_ForStmt:n(e.init),n(e.cond),n(e.body),n(e.step);break;case r.rO.k_WhileStmt:n(e.cond),n(e.body);break;case r.rO.k_ArithmeticExpr:case r.rO.k_AssignmentExpr:case r.rO.k_BitwiseExpr:n(e.left),n(e.right);break;case r.rO.k_CastExpr:n(e.expr);break;case r.rO.k_CompileExpr:e.args.forEach((e=>n(e)));break;case r.rO.k_CompileShader11Expr:n(e.func),e.args.forEach((e=>n(e)));break;case r.rO.k_ComplexExpr:n(e.expr);break;case r.rO.k_ConditionalExpr:n(e.left),n(e.right),n(e.condition);break;case r.rO.k_ConstructorCallExpr:case r.rO.k_FunctionCallExpr:e.args.forEach((e=>n(e)));break;case r.rO.k_IdExpr:n(e.id);break;case r.rO.k_InitExpr:e.args.forEach((e=>n(e)));break;case r.rO.k_StateBlockExpr:console.assert(!1,"not implemented");break;case r.rO.k_IntExpr:case r.rO.k_FloatExpr:case r.rO.k_BoolExpr:case r.rO.k_StringExpr:case r.rO.k_NullExpr:break;case r.rO.k_LogicalExpr:n(e.left),n(e.right);break;case r.rO.k_PostfixArithmeticExpr:n(e.expr);break;case r.rO.k_PostfixIndexExpr:n(e.element),n(e.index);break;case r.rO.k_PostfixPointExpr:n(e.element),n(e.postfix);break;case r.rO.k_RelationalExpr:n(e.left),n(e.right);break;case r.rO.k_SamplerStateBlockExpr:e.params.forEach((e=>n(e))),n(e.texture);break;case r.rO.k_UnaryExpr:n(e.expr);break;case r.rO.k_ComplexType:e.fields.forEach((e=>n(e)));break;case r.rO.k_FunctionDef:n(e.returnType),n(e.id),e.params.forEach((e=>n(e)));break;case r.rO.k_FunctionDecl:n(e.def),n(e.impl);break;case r.rO.k_VariableDecl:n(e.type),n(e.initExpr),n(e.id);break;case r.rO.k_VariableType:n(e.subType);break;case r.rO.k_Id:case r.rO.k_SystemFunctionDecl:case r.rO.k_SystemType:case r.rO.k_BreakStmt:case r.rO.k_SpawnStmt:break;default:console.error("unsupported instruction type found")}}const s={each:i}},FB51:(e,t,n)=>{n.d(t,{L:()=>Oe,_:()=>we});var r=n("cOQ3"),i=n("jeW/"),s=n("AW2x"),a=n("Y4FD"),o=n("HS1/"),l=n("vIQR"),c=n("0mZ+"),u=n("z3nI"),p=n("DIkA");class h extends c.g{constructor(){super("Analyzer Diagnostics","A")}resolveFilename(e,t,n){return n.file.toString()}resolveRange(e,t,n){return n.loc}diagnosticMessages(){return{[i.g.InvalidReturnStmtEmpty]:"Invalid return statement. Expression with '*type*' type expected.",[i.g.InvalidReturnStmtVoid]:"Invalid return statement. Expression with 'void' type expected.",[i.g.FunctionRedefinition]:"Function redefinition. Function with name '{info.funcName}' already declared.",[i.g.InvalidFuncDefenitionReturnType]:"Invalid function defenition return type. Function with the same name '{info.funcName}' but another type already declared.",[i.g.InvalidFunctionReturnStmtNotFound]:"Return statement expected.",[i.g.InvalidVariableInitializing]:"Invalid variable initializing.",[i.g.InvalidComplexNotFunction]:({info:e})=>`Function definition for "${e.funcName}(${e.args.join(", ")})" has not been found.`}}resolveDescription(e,t,n){let a=this.diagnosticMessages();if((0,r.$V)(a[e]))return super.resolveDescription(e,t,n);let{file:o,loc:l,...c}=n;return t==p.D.k_Warning?`${s.S[e]}: ${JSON.stringify(c)}`:`${i.g[e]}: ${JSON.stringify(c)}`}}var d=n("q04y"),m=n("W5eQ"),f=n("hbjL");class g extends f.v{constructor({decls:e,...t}){super({instrType:l.rO.k_Annotation,...t}),this.decls=e}}var y=n("BrFC");class T extends y.b{constructor({left:e,right:t,operator:n,...r}){super({instrType:l.rO.k_ArithmeticExpr,...r}),this._leftOperand=f.v.$withParent(e,this),this._rightOperand=f.v.$withParent(t,this),this._operator=n}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}toCode(){var e="";return e+=this._leftOperand.toCode(),e+=` ${this.operator} `,e+=this._rightOperand.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}class _ extends y.b{constructor({left:e,right:t,operator:n,...r}){super({instrType:l.rO.k_AssignmentExpr,type:e.type,...r}),this._leftValue=f.v.$withParent(e,this),this._rightValue=f.v.$withParent(t,this),this._operator=n}get left(){return this._leftValue}get right(){return this._rightValue}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}}var E=n("rs/O");class x extends y.b{constructor({left:e,right:t,operator:n,...r}){super({instrType:l.rO.k_BitwiseExpr,...r}),this.left=f.v.$withParent(e,this),this.right=f.v.$withParent(t,this),this.operator=n}toCode(){return`${this.left.toCode()} ${this.operator} ${this.right.toCode()}`}isConst(){return this.left.isConst()&&this.right.isConst()}}var S=n("6EL/"),k=n("A0ZU");class b extends y.b{constructor({value:e,scope:t,...n}){super({instrType:l.rO.k_BoolExpr,type:S.L.wrapAsConst(k.T_BOOL,k.SCOPE),scope:t,...n}),this.value=e}toString(){return String(this.value)}toCode(){return this.value?"true":"false"}isConst(){return!0}}var N=n("pGoc");class v extends N.W{constructor({operator:e="break",...t}){super({instrType:l.rO.k_BreakStmt,...t}),this._operator=e}get operator(){return this._operator}toCode(){return console.assert("break"==this.operator),this.operator+";"}}class R extends y.b{constructor({sourceExpr:e,...t}){super({instrType:l.rO.k_CastExpr,...t}),this.expr=f.v.$withParent(e,this)}toCode(){return`(${this.type.toCode()})(${this.expr.toCode()})`}isUseless(){return m.V5.equals(this.type,this.expr.type)}isConst(){return this.expr.isConst()}}var C=n("0xZW");class w extends C._{constructor({id:e,type:t,...n}){super({instrType:l.rO.k_CbufferDecl,...n}),this._id=f.v.$withParent(e,this),this._type=f.v.$withParent(t,this)}get id(){return this._id}get name(){return this.id.name}get type(){return this._type}}class O extends y.b{constructor({operand:e,args:t=null,...n}){super({instrType:l.rO.k_CompileExpr,...n}),this._operand=e,this._args=t}get function(){return this._operand}get args(){return this._args}}class P extends y.b{constructor({ver:e,func:t,args:n,...r}){super({instrType:l.rO.k_CompileShader11Expr,...r}),this.func=f.v.$withNoParent(t),this.ver=e,this.args=(n||[]).map((e=>f.v.$withParent(e,this)))}}class I extends y.b{constructor({expr:e,...t}){super({instrType:l.rO.k_ComplexExpr,type:e.type,...t}),this._expr=f.v.$withParent(e,this)}get expr(){return this._expr}toCode(){return"("+this.expr.toCode()+")"}isConst(){return this.expr.isConst()}}class A extends f.v{constructor({name:e=null,fields:t,aligment:n=1,...i}){super({instrType:l.rO.k_ComplexType,...i}),this._name=e,this._fields={},this._aligment=n,this.addFields(t.filter((e=>!(0,r.Ft)(e))).map((e=>f.v.$withParent(e,this))))}get writable(){return!0}get readable(){return!0}get name(){return this._name}get size(){return this.calculatePaddings(!1)}get aligment(){return this._aligment}get baseType(){return this}get arrayElementType(){return null}get typeDecl(){return this.parent}get length(){return 0}get fields(){return Object.values(this._fields)}get methods(){return[]}toString(){return this.name||m.V5.hash(this)}toDeclString(){for(var e="struct "+this._name+"{",t=0;t<this.fields.length;t++)e+="\t"+this.fields[t].toCode()+";\n";return e+="}"}toCode(){return this._name}isArray(){return!1}isNotBaseArray(){return!1}isComplex(){return!0}addField(e){this._fields[e.name]=e}addFields(e){for(var t=0;t<e.length;t++)this.addField(e[t]);this.calculatePaddings()}hasFieldWithSematics(e){return!!this.getFieldBySemantics(e)}getField(e){return this._fields[e]||null}getMethod(e,t){return null}getFieldBySemantics(e){for(let t in this._fields){let n=this._fields[t];if(e==n.semantic)return n}return null}hasFieldWithoutSemantics(){for(let e in this._fields){let t=this._fields[e],n=t.semantic;if(null==n||""==n)return!0;if(t.type.hasFieldWithoutSemantics())return!0}return!1}hasAllUniqueSemantics(){let e={};for(let t in this._fields){let n=this._fields[t],i=n.semantic;if((0,r.$V)(e[i]))return!1;if(e[i]=n,n.type.isComplex()&&!n.type.hasAllUniqueSemantics())return!1}return!0}calculatePaddings(e=!0){const t=this._aligment;let n=0,i=(e,t)=>e+(t-1)&~(t-1);for(let s=0;s<this.fields.length;s++){const a=this.fields[s].type,o=a.size;if(o===m.NQ.UNDEFINE_SIZE)return(0,r.hu)(!1,"cannot calc padding"),m.NQ.UNDEFINE_SIZE;let l=i(n,t);i(n+o,t)>l&&(n=l),e&&a.$overwritePadding(n,t),n+=o}return i(n,t)}}class F extends y.b{constructor({cond:e,left:t,right:n,...r}){super({instrType:l.rO.k_ConditionalExpr,type:t.type,...r}),console.assert(m.V5.equals(t.type,n.type)),this._cond=f.v.$withParent(e,this),this._leftValue=f.v.$withParent(t,this),this._rightValue=f.v.$withParent(n,this)}get condition(){return this._cond}get left(){return this._leftValue}get right(){return this._rightValue}toCode(){var e="(";return e+=this.condition.toCode(),e+="?",e+=this.left.toCode(),e+=":",e+=this.right.toCode(),e+=")"}isConst(){return this.condition.isConst()&&this.left.isConst()}}class L extends y.b{constructor({ctor:e,args:t=null,...n}){super({instrType:l.rO.k_ConstructorCallExpr,type:e.subType,...n}),this._args=(t||[]).map((e=>f.v.$withParent(e,this))),this._ctor=f.v.$withParent(e,this)}get args(){return this._args}get ctor(){return this._ctor}toCode(){var e="";e+=this.ctor.toCode(),e+="(";for(var t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){for(var e=0;e<this.args.length;e++)if(!this.args[e].isConst())return!1;return!0}}class D extends N.W{constructor({declList:e=null,...t}){super({instrType:l.rO.k_DeclStmt,...t}),this._declList=(e||[]).map((e=>f.v.$withParent(e,this)))}get declList(){return this._declList}toCode(){for(var e="",t=this.declList,n=0;n<this.declList.length;n++)e+=t[n].toCode()+";\n";return e}}class U extends N.W{constructor({expr:e,...t}){super({instrType:l.rO.k_ExprStmt,...t}),this._expr=f.v.$withParent(e,this)}get expr(){return this._expr}toCode(){return(this._expr?this._expr.toCode():"")+";"}}class K extends y.b{constructor({value:e,scope:t,...n}){super({instrType:l.rO.k_FloatExpr,type:S.L.wrapAsConst(k.T_FLOAT,k.SCOPE),scope:t,...n}),this.value=e}toString(){return String(this.value)}toCode(){return`${this.value}${this.value%1==0?".":""}`}isConst(){return!0}}class B extends N.W{constructor({init:e=null,cond:t=null,step:n=null,body:r=null,...i}){super({instrType:l.rO.k_ForStmt,...i}),this._init=f.v.$withParent(e,this),this._cond=f.v.$withParent(t,this),this._step=f.v.$withParent(n,this),this._body=f.v.$withParent(r,this)}get init(){return this._init}get cond(){return this._cond}get step(){return this._step}get body(){return this._body}toCode(){var e="for(";return e+=this._init.toCode()+";",e+=this._cond.toCode()+";",e+=this._step.toCode()+")",e+=this._body.toCode()}}class W extends y.b{constructor({decl:e,args:t,callee:n,...r}){super({instrType:l.rO.k_FunctionCallExpr,...r}),this.callee=n,this.args=(t||[]).map((e=>f.v.$withParent(e,this))),this.decl=e}toCode(){const{callee:e,decl:{def:t},args:n}=this;return`${e?e.toCode()+".":""}${t.id.toCode()}(${n.map((e=>e.toCode())).join(",")})`}}var z=n("BLpd"),V=n("O1LO");class M extends y.b{constructor({id:e,decl:t,...n}){super({instrType:l.rO.k_IdExpr,type:t.type,...n}),this.id=f.v.$withParent(e,this),this.decl=t}get name(){return this.id.name}isConst(){return this.type.isConst()}toCode(){return this.decl.id.toCode()}}var $=n("Muaz");class q extends N.W{constructor({cond:e,conseq:t,attrs:n=null,contrary:r=null,...i}){super({instrType:l.rO.k_IfStmt,...i}),this.cond=f.v.$withParent(e,this),this.conseq=f.v.$withParent(t,this),this.contrary=f.v.$withParent(r,this),this.attrs=(n||[]).map((e=>f.v.$withParent(e,this)))}toCode(){var e="";return(0,r.Ft)(this.contrary)?(e+="if(",e+=this.cond.toCode()+")",e+=this.conseq.toCode()):(e+="if(",e+=this.cond.toCode()+") ",e+=this.conseq.toCode(),e+="else ",e+=this.contrary.toCode()),e}}class H extends y.b{constructor({type:e,args:t=[],...n}){super({instrType:l.rO.k_InitExpr,type:e,...n}),this._args=t.map((e=>f.v.$withParent(e,this)))}get args(){return this._args}isArray(){return this.type.isNotBaseArray()}toCode(){let e="";(0,r.Ft)(this.type)||(e+=this.type.toCode()),e+="(";for(let t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")",e}isConst(){let e=this.args;for(let t=0;t<e.length;t++)if(!e[t].isConst())return!1;return!0}optimizeForVariableType(e){if(e.isNotBaseArray()&&e.scope.type<=l.SR.k_Global||e.isArray()&&this.args.length>1){if(e.length===m.NQ.UNDEFINE_LENGTH||e.isNotBaseArray()&&this.args.length!==e.length||!e.isNotBaseArray()&&this.args.length!==e.baseType.length)return!1;let t=e.arrayElementType;for(let e=0;e<this.args.length;e++){let n=this.args[e];if(n.instructionType===l.rO.k_InitExpr){if(!n.optimizeForVariableType(t))return!1}else if(!m.V5.equals(n.type,t))return!1}return this._type=e.baseType,!0}{let t=this.args[0];if(1===this.args.length&&t.instructionType!==l.rO.k_InitExpr)return!(!m.V5.equals(t.type,k.T_INT)&&!m.V5.equals(t.type,k.T_UINT)||!m.V5.equals(e,k.T_INT)&&!m.V5.equals(e,k.T_UINT))||!!m.V5.equals(t.type,e);if(1===this.args.length)return!1;let n=this.args,r=e.fields.map((e=>e.name));for(let t=0;t<n.length;t++){let i=e.getField(r[t]).type;if(!n[t].optimizeForVariableType(i))return!1}return this._type=e.baseType,!0}}}class G extends f.v{constructor({instructions:e=[],...t}){super({instrType:l.rO.k_Collector,...t}),this._instructions=e}get instructions(){return this._instructions}push(e){this._instructions.push(e)}toCode(){let e="";for(const t of this.instructions)if(t.instructionType===l.rO.k_VariableDecl)e+=t.toCode()+";\n";else e+=t.toCode()+"\n";return e}}var j=n("s0og");class J extends y.b{constructor({left:e,right:t,operator:n,...r}){super({instrType:l.rO.k_LogicalExpr,type:k.T_BOOL,...r}),this._leftOperand=f.v.$withParent(e,this),this._rightOperand=f.v.$withParent(t,this),this._operator=n}get operator(){return this._operator}get left(){return this._leftOperand}get right(){return this._rightOperand}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}class Q extends y.b{constructor({scope:e,...t}){super({instrType:l.rO.k_NullExpr,type:k.T_NULL,scope:e,...t})}get value(){return null}toString(){return"NULL"}toCode(){return this.toString()}isConst(){return!0}}var X=n("Z/0D");class Y extends y.b{constructor({expr:e,operator:t,...n}){super({instrType:l.rO.k_PostfixArithmeticExpr,type:e.type,...n}),this._operator=t,this._expr=f.v.$withParent(e,this)}get expr(){return this._expr}get operator(){return this._operator}toCode(){var e="";return e+=this.expr.toCode(),e+=this.operator}isConst(){return this.expr.isConst()}}class Z extends y.b{constructor({element:e,index:t,...n}){super({instrType:l.rO.k_PostfixIndexExpr,type:e.type.arrayElementType,...n}),this.element=f.v.$withParent(e,this),this.index=f.v.$withParent(t,this)}toCode(){return`${this.element.toCode()}[${this.index.toCode()}]`}isConst(){return this.element.isConst()&&this.index.isConst()}}class ee extends y.b{constructor({element:e,postfix:t,...n}){super({instrType:l.rO.k_PostfixPointExpr,type:t.type,...n}),this.element=f.v.$withParent(e,this),this.postfix=f.v.$withParent(t,this)}toCode(){return`${this.element.toCode()}.${this.postfix.toCode()}`}isConst(){return this.element.isConst()}}class te extends C._{constructor({props:e,id:t=null,...n}){super({instrType:l.rO.k_PresetDecl,...n}),this._id=f.v.$withParent(t,this),this._props=e.map((e=>f.v.$withParent(e,this)))}get id(){return this._id}get name(){return(0,r.Ft)(this._id)?null:this._id.name}get props(){return this._props}toCode(){return`${this.id} = {\n${this.props.map((e=>e.toCode())).join(";\n")}\n}`}}class ne extends f.v{constructor({id:e,args:t,...n}){super({instrType:l.rO.k_PresetProperty,...n}),this.id=f.v.$withParent(e,this),this.args=t.map((e=>f.v.$withParent(e,this)))}resolveDeclaration(){return this.scope.findVariable(this.id.name)}toCode(){return`${this.id} = { ${this.args.map((e=>e.toCode())).join(",")} }`}}class re extends f.v{constructor({moduleName:e,...t}){super({instrType:l.rO.k_Provide,...t}),this._value=e}get moduleName(){return this._value}toString(){return this._value}toCode(){return this._value}}class ie extends f.v{constructor(e){super({instrType:l.rO.k_ProxyType,...e}),this._host=null}get host(){return this._host}get writable(){return!this.isResolved()||this.host.writable}get readable(){return!this.isResolved()||this.host.writable}get name(){return this.isResolved()?this.host.name:"auto"}get size(){return this.isResolved()?this.host.size:m.NQ.UNDEFINE_SIZE}get baseType(){return this.host}get arrayElementType(){return this.isResolved()?this.host.arrayElementType:null}get typeDecl(){return this.parent}get length(){return this.isResolved()?this.host.length:m.NQ.UNDEFINE_LENGTH}get fields(){return this.isResolved()?this.host.fields:[]}get methods(){return[]}isResolved(){return!(0,r.Ft)(this.host)}resolve(e){this._host=e}toString(){return this.isResolved()?this.host.toString():this.name}toDeclString(){return this.isResolved()?this.host.toDeclString():null}toCode(){return this.isResolved()?this.host.toCode():this.name}isArray(){return!!this.isResolved()&&this.host.isArray()}isNotBaseArray(){return!!this.isResolved()&&this.host.isNotBaseArray()}isComplex(){return!!this.isResolved()&&this.host.isComplex()}hasFieldWithSematics(e){return!!this.isResolved()&&this.host.hasFieldWithSematics(e)}getField(e){return this.isResolved()?this.host.getField(e):null}getMethod(e,t){return this.isResolved()?this.host.getMethod(e,t):null}getFieldBySemantics(e){return this.isResolved()?this.host.getFieldBySemantics(e):null}hasFieldWithoutSemantics(){return!!this.isResolved()&&this.host.hasFieldWithoutSemantics()}hasAllUniqueSemantics(){return!!this.isResolved()&&this.host.hasAllUniqueSemantics()}}class se extends y.b{constructor({left:e,right:t,operator:n,instrType:r,...i}){super({instrType:l.rO.k_RelationalExpr,type:k[`T_BOOL${e.type.length>1?e.type.length:""}`],...i}),this._leftOperand=e,this._rightOperand=t,this._operator=n}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=` ${this.operator} `,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}class ae extends N.W{constructor({expr:e=null,...t}){super({instrType:l.rO.k_ReturnStmt,...t}),this._operator="return",this._expr=f.v.$withParent(e,this)}get operator(){return this._operator}get expr(){return this._expr}toCode(){return this.expr?"return "+this.expr.toCode()+";":"return;"}}class oe extends N.W{constructor({...e}){super({instrType:l.rO.k_SemicolonStmt,...e})}toCode(){return";"}}class le extends y.b{constructor({type:e,blocks:t=null,props:n=null,...r}){super({instrType:l.rO.k_StateBlockExpr,type:e,...r}),this.props=n,this.blocks=t}toCode(){return console.error("not implemeted"),null}isConst(){return!0}}class ce extends N.W{constructor({stmtList:e,...t}){super({instrType:l.rO.k_StmtBlock,...t}),this._stmtList=e.map((e=>f.v.$withParent(e,this)))}get stmtList(){return this._stmtList}toCode(){for(var e="{\n",t=0;t<this.stmtList.length;t++)e+="\t"+this.stmtList[t].toCode()+"\n";return e+="}"}}class ue extends y.b{constructor({value:e,scope:t,...n}){super({instrType:l.rO.k_StringExpr,type:S.L.wrapAsConst(k.T_STRING,k.SCOPE),scope:t,...n}),this._value=e}get value(){return this._value}toString(){return this._value}toCode(){return this._value}isConst(){return!0}}class pe extends C._{constructor({name:e,passes:t,presets:n,...r}){super({instrType:l.rO.k_Technique11Decl,...r}),this._name=e,this.passes=t?.map((e=>f.v.$withParent(e,this)))}get name(){return this._name}isValid(){return!0}}var he=n("dmHP");class de extends C._{constructor({type:e,...t}){super({instrType:l.rO.k_TypeDecl,...t}),this.type=f.v.$withParent(e,this),(0,r.hu)((0,r.Xq)(this.type))}get name(){return this.type.name}toCode(){return this.type.toDeclString()+";"}}class me extends C._{constructor({type:e,alias:t,...n}){super({instrType:l.rO.k_TypedefDecl,...n}),this.type=f.v.$withNoParent(e),this.alias=t,(0,r.hu)((0,r.Xq)(this.type))}get name(){return this.type?.name}toCode(){return`typedef ${this.type.toDeclString()} ${this.alias};`}}class fe extends y.b{constructor({expr:e,operator:t,...n}){super({instrType:l.rO.k_UnaryExpr,type:"!"===t?S.L.wrapAsConst(k.T_BOOL,k.SCOPE):e.type,...n}),this._expr=f.v.$withParent(e,this),this._operator=t}get operator(){return this._operator}get expr(){return this._expr}toCode(){var e="";return e+=this.operator,e+=this.expr.toCode()}isConst(){return this.expr.isConst()}}var ge=n("k9uP");class ye extends N.W{constructor({cond:e,body:t,operator:n,...r}){super({instrType:l.rO.k_WhileStmt,...r}),this._cond=f.v.$withParent(e,this),this._body=f.v.$withParent(t,this),this._operator=n}get cond(){return this.cond}get body(){return this._body}get operator(){return this._operator}toCode(){var e="";return"while"===this.operator?(e+="while(",e+=this.cond.toCode(),e+=")",e+=this.body.toCode()):(e+="do",e+=this.body.toCode(),e+="while(",e+=this.cond.toCode(),e+=");"),e}}var Te=n("zHDc"),_e=n("W6EL");e=n.hmd(e);const Ee=e=>e?e.type:null,xe=e=>{if(!e)return null;const t=e.getField?e:e.type;if(m.V5.equals(t,k.T_NULL))return/^.*$/;if(k.isIntBasedType(t)||k.isUintBasedType(t)||k.isBoolBasedType(t)){const e=`${t.length>1?t.length:""}`;return new RegExp(`^int${e}$|^uint${e}$|^bool${e}$|^float${e}$`,"g")}return t};function Se(e,t){if(e.subType&&e.subType.instructionType===l.rO.k_ProxyType){const n=e.subType;n.isResolved()||n.resolve(t)}}function ke(e,t){let n=o.m.UNDEF;switch(e){case a.H.ALPHABLENDENABLE:case a.H.ALPHATESTENABLE:return console.warn("ALPHABLENDENABLE/ALPHATESTENABLE not supported in WebGL."),o.m.UNDEF;case a.H.BLENDENABLE:case a.H.CULLFACEENABLE:case a.H.ZENABLE:case a.H.ZWRITEENABLE:case a.H.DITHERENABLE:case a.H.SCISSORTESTENABLE:case a.H.STENCILTESTENABLE:case a.H.POLYGONOFFSETFILLENABLE:switch(t){case"TRUE":n=o.m.TRUE;break;case"FALSE":n=o.m.FALSE;break;default:return console.warn("Unsupported render state ALPHABLENDENABLE/ZENABLE/ZWRITEENABLE/DITHERENABLE value used: "+t+"."),n}break;case a.H.CULLFACE:switch(t){case"FRONT":n=o.m.FRONT;break;case"BACK":n=o.m.BACK;break;case"FRONT_AND_BACK":n=o.m.FRONT_AND_BACK;break;default:return console.warn("Unsupported render state CULLFACE value used: "+t+"."),n}break;case a.H.FRONTFACE:switch(t){case"CW":n=o.m.CW;break;case"CCW":n=o.m.CCW;break;default:return console.warn("Unsupported render state FRONTFACE value used: "+t+"."),n}break;case a.H.SRCBLEND:case a.H.DESTBLEND:case a.H.SRCBLENDALPHA:case a.H.DESTBLENDALPHA:case a.H.SRCBLENDCOLOR:case a.H.DESTBLENDCOLOR:case a.H.BLENDFUNC:case a.H.BLENDFUNCSEPARATE:switch(t){case"ZERO":n=o.m.ZERO;break;case"ONE":n=o.m.ONE;break;case"SRCCOLOR":n=o.m.SRCCOLOR;break;case"INVSRCCOLOR":n=o.m.INVSRCCOLOR;break;case"SRCALPHA":n=o.m.SRCALPHA;break;case"INVSRCALPHA":n=o.m.INVSRCALPHA;break;case"DESTALPHA":n=o.m.DESTALPHA;break;case"INVDESTALPHA":n=o.m.INVDESTALPHA;break;case"DESTCOLOR":n=o.m.DESTCOLOR;break;case"INVDESTCOLOR":n=o.m.INVDESTCOLOR;break;case"SRCALPHASAT":n=o.m.SRCALPHASAT;break;default:return console.warn("Unsupported render state SRCBLEND/DESTBLEND value used: "+t+"."),n}break;case a.H.BLENDEQUATION:case a.H.BLENDEQUATIONSEPARATE:case a.H.BLENDEQUATIONCOLOR:case a.H.BLENDEQUATIONALPHA:switch(t){case"FUNCADD":case"ADD":n=o.m.FUNCADD;break;case"FUNCSUBTRACT":case"SUBTRACT":n=o.m.FUNCSUBTRACT;break;case"FUNCREVERSESUBTRACT":case"REVERSESUBTRACT":n=o.m.FUNCREVERSESUBTRACT;break;default:return console.warn("Unsupported render state BLENDEQUATION/BLENDEQUATIONSEPARATE value used: "+t+"."),n}break;case a.H.ZFUNC:switch(t){case"NEVER":n=o.m.NEVER;break;case"LESS":n=o.m.LESS;break;case"EQUAL":n=o.m.EQUAL;break;case"LESSEQUAL":n=o.m.LESSEQUAL;break;case"GREATER":n=o.m.GREATER;break;case"NOTEQUAL":n=o.m.NOTEQUAL;break;case"GREATEREQUAL":n=o.m.GREATEREQUAL;break;case"ALWAYS":n=o.m.ALWAYS;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),n}break;case a.H.PRIMITIVETOPOLOGY:switch(t){case"TRIANGLELIST":n=o.m.TRIANGLELIST;break;case"LINELIST":n=o.m.LINELIST;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),n}}return n}function be(e,t,n){k.findType(n.name)&&e.error(n.sourceNode,i.g.SystemTypeRedefinition,{typeName:n.name}),t.addType(n.type)||e.error(n.sourceNode,i.g.TypeRedefinition,{typeName:n.name})}function Ne(e,t,n){if(-1!==n.indexOf(t.instructionID))return e.error(t.sourceNode,i.g.InvalidFunctionRecursionNotAllowed,{funcName:t.name}),!1;let a=!1;n=[...n,t.instructionID];return(0,d.N)(t.impl,(t=>{if(t.instructionType===l.rO.k_FunctionCallExpr){let o=t.decl;if(o.instructionType===l.rO.k_SystemFunctionDecl)return;if(o=o.scope.findFunctionInScope(o),(0,r.Ft)(o.impl))return void(o.attrs.find((e=>"extern"===e.name))?e.warn(t.sourceNode,s.S.ExternCall):e.error(t.sourceNode,i.g.InvalidFunctionImplementationNotFound,{funcName:o.name}));a=a||Ne(e,o,n)}})),!a}function ve(e,t){const n=t.globalScope;let i=!1;return(0,r.TP)(n.functions,(t=>{t.forEach((t=>{i=i||!Ne(e,t,[])}))})),!i}function Re(e){return!!function(e){const t=e.returnType;if(m.V5.equals(t,k.T_VOID))return!0;if(t.isComplex()){if(t.hasFieldWithoutSemantics(),!t.hasAllUniqueSemantics())return!1}else{if(!m.V5.equals(t,k.T_FLOAT4))return!1;if("POSITION"!==e.semantic)return!1}return!0}(e)&&!!function(e){let t=e.params,n=!1,i=!1,s=!1;for(let e=0;e<t.length;e++){let a=t[e];if(!a.type.isUniform())if(s){if(n)return!1;if(i){if((0,r.Ft)(a.semantic))return!1;if(a.type.isComplex()&&(a.type.hasFieldWithoutSemantics()||!a.type.hasAllUniqueSemantics()))return!1}}else{if((0,r.Ft)(a.semantic)){if(k.isBase(a.type)||a.type.hasFieldWithoutSemantics()||!a.type.hasAllUniqueSemantics())return!1;n=!0}else if(!(0,r.Ft)(a.semantic)){if(a.type.isComplex()&&(a.type.hasFieldWithoutSemantics()||!a.type.hasAllUniqueSemantics()))return!1;i=!0}s=!0}}return!0}(e)}function Ce(e){return!!function(e){let t=e.returnType;if(m.V5.equals(t,k.T_VOID))return!0;if(!k.isBase(t))return!1;if(!m.V5.equals(t,k.T_FLOAT4))return!1;e.semantic;return!0}(e)&&!!function(e){let t=e.params,n=!1,r=!1,i=!1;for(let e=0;e<t.length;e++){let s=t[e];if(!s.type.isUniform())if(i){if(n)return!1;if(r&&(s.semantic,s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics())))return!1}else{if(""===s.semantic){if(k.isBase(s.type)||s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics())return!1;n=!0}else if(""!==s.semantic){if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1;r=!0}i=!0}}return!0}(e)}class we{constructor(e,t){this.diagnostics=new h,this.uri=e,this.moduleName=null,this.haveCurrentFunctionReturnOccur=!1,this.expressions=t||{}}beginCbuffer(){this.cbuffer=!0}endCbuffer(){this.cbuffer=!1}beginFunc(){this.func=!0,this.haveCurrentFunctionReturnOccur=!1,this.funcDef=null}endFunc(){this.func=!1}beginPass(){this.renderStates=null}endPass(){this.renderStates=null}error(e,t,n={}){let r=this.resolveNodeSourceLocation(e),i=this.uri;this.diagnostics.error(t,{file:i,loc:r,info:n})}critical(e,t,n={}){let r=this.resolveNodeSourceLocation(e),i=this.uri;this.diagnostics.critical(t,{file:i,loc:r,info:n})}warn(e,t,n={}){let r=this.resolveNodeSourceLocation(e),i=this.uri;this.diagnostics.warning(t,{file:i,loc:r,info:n})}resolveNodeSourceLocation(e){return(0,r.$V)(e)?(0,r.Xq)(e.loc)?e.loc:this.resolveNodeSourceLocation(e.children[e.children.length-1]):null}}class Oe{analyzeUseDecl(e,t,n){t.currentScope.strictMode=!0}analyzeComplexName(e){const t=e.children;let n="";for(let e=t.length-1;e>=0;e--)n+=t[e].value;return n}analyzeProvideDecl(t,n,s){const a=s.children,o=n.currentScope;if(3===a.length){let n=this.analyzeComplexName(a[1]);return(0,r.Ft)(t.moduleName)||console.warn(`Context module overriding detected '${t.moduleName}' => '${e}'`),t.moduleName=n,(0,r.hu)("T_KW_PROVIDE"===a[2].name),new re({sourceNode:s,moduleName:n,scope:o})}return t.error(s,i.g.UnsupportedProvideAs),null}analyzeInitExprChildren(e,t,n,s,a,o=null){const c=t.currentScope;if(1===s.length){const r=this.analyzeExpr(e,t,s[0]);if(!r)return null;return Oe.checkTwoOperandExprTypes(e,"=",a,r.type,n,r.sourceNode,o||n,{isInitializing:!0})?r:null}if(a.isNotBaseArray()&&a.scope.type<=l.SR.k_Global||a.isArray()){const o=[],u=(s.length-1)/2;if(a.length===m.NQ.UNDEFINE_LENGTH||a.isNotBaseArray()&&u!==a.length||!a.isNotBaseArray()&&u!==a.baseType.length)return e.error(n,i.g.InvalidVariableInitializingEx,{tooltip:`attemp to init an array with invalid number of arguments. expected: ${a.length}, given: ${u}`}),null;const p=a.arrayElementType;for(let n=s.length-2;n>=1;n--)if("InitExpr"===s[n].name){const i=this.analyzeInitExpr(e,t,s[n],p);if((0,r.Ft)(i))return null;o.push(i)}return(0,r.hu)(a.instructionType===l.rO.k_VariableType),new H({scope:c,sourceNode:n,args:o,type:a})}if(a.isComplex()){const i=(s.length-1)/2,o=a.fields.map((e=>e.name)),u=[];if(i!==o.length)return null;for(let n=s.length-2;n>=1;n--)if("InitExpr"===s[n].name){const i=a.getField(o[n]).type,l=this.analyzeInitExpr(e,t,s[n],i);if((0,r.Ft)(l))return null;u.push(l)}return(0,r.hu)(a.instructionType===l.rO.k_VariableType),new H({scope:c,sourceNode:n,args:u,type:a})}{if(1!==(s.length-1)/2)return null;const n=s[s.length-2];let r=null;return r="InitExpr"===n.name?this.analyzeInitExpr(e,t,n,a):this.analyzeExpr(e,t,s[s.length-2]),m.V5.equals(a,r.type)?r:null}}analyzeInitExpr(e,t,n,r){return this.analyzeInitExprChildren(e,t,n,n.children,r)}analyzeSamplerStateDecl(e,t,n){return null}analyzeVariableDecl(e,t,n){const i=n.children,s=(t.currentScope,this.analyzeUsageType(e,t,i[i.length-1])),a=[];if((0,r.Ft)(s))return null;for(let n=i.length-2;n>=1;n--)"Variable"===i[n].name&&a.push(this.analyzeVariable(e,t,i[n],s));return a}analyzeUsageType(e,t,n){const i=n.children,s=t.currentScope;let a=null,o=[];for(let n=i.length-1;n>=0;n--)if("Type"===i[n].name){if(a=this.analyzeType(e,t,i[n]),(0,r.Ft)(a))return null}else"Usage"===i[n].name&&o.push(this.analyzeUsage(i[n]));const l=o.includes("in"),c=o.includes("out"),u=o.includes("inout"),p=o.includes("const"),h=o.includes("uniform"),d=o.includes("unsigned"),m=o.includes("static");let f=[];return u||l&&c?f.push("inout"):(l&&f.push("in"),c?f.push("out"):(p&&f.push("const"),h&&f.push("uniform"))),m&&f.push("static"),d&&!k.isIntBasedType(a)&&console.error("invalid unsigned usage"),new S.L({scope:s,sourceNode:n,type:a,usages:f})}analyzeType(e,t,n){const s=n.children,a=t.currentScope;let o=null;switch(n.name){case"T_TYPE_ID":if("auto"===n.value){o=new ie({scope:a});break}o=a.findType(n.value),(0,r.Ft)(o)&&e.error(n,i.g.InvalidTypeNameNotType,{typeName:n.value});break;case"Struct":o=this.analyzeStruct(e,t,n);break;case"T_KW_VOID":o=k.T_VOID;break;case"ScalarType":case"ObjectType":{let c=s[s.length-1].value;if(1!==s.length){(0,r.hu)("<"===s[s.length-2].value&&">"===s[0].value);const u=c,p=s.slice(1,-2).reverse().filter(((e,t)=>t%2==0)).map((n=>this.analyzeType(e,t,n))),h=a.findTypeTemplate(c);if((0,r.Ft)(h))return e.error(n,i.g.InvalidTypeNameTemplateNotFound,{tplName:u,args:p.map((e=>e.toCode()))}),null;if(-1!==["Buffer","RWBuffer","RWStructuredBuffer","AppendStructuredBuffer","RWTexture1D","RWTexture2D","RWTexture3D","Texture1D","Texture2D","Texture3D","Texture2DArray","TextureCubeArray"].indexOf(h.name)&&a.type!=l.SR.k_Global)return e.error(n,i.g.InvalidTypeScope,{typeName:h.name,tooltip:"only global scope allowed"}),null;if(c=h.typeName(p),o=a.findType(c),(0,r.Ft)(o)){if(o=h.produceType(a,p),(0,r.Ft)(o))return e.error(n,i.g.CannotProduceType,{typeName:c}),null;a.addType(o)}}else o=a.findType(c);if((0,r.Ft)(o))return e.error(n,i.g.InvalidTypeNameNotType,{typeName:c}),null}break;case"VectorType":case"MatrixType":e.error(n,i.g.InvalidTypeVectorMatrix);break;case"BaseType":case"Type":return this.analyzeType(e,t,s[0])}return o}analyzeUsage(e){e=e.children[0];return(0,r.hu)(-1!==["uniform","const","in","out","inout","static","unsigned","precise","inline"].indexOf(e.value),e.value),e.value}analyzeCbufferDecl(e,t,n){const r=n.children,a=t.currentScope;let o=null,l="",c=null;e.beginCbuffer();let u=r.length-2;if("T_NON_TYPE_ID"===r[u].name&&(c=new $.x({scope:a,sourceNode:r[u],name:r[u].value}),u--),"Semantic"===r[u].name){l=this.analyzeSemantic(r[u]);const t=l.match(/^register\(([utbs]{1})([\d]+)\)$/);if(t){"b"!==t[1]&&e.warn(r[u],s.S.InvalidCbufferRegister)}u--}"Annotation"===r[u].name&&(o=this.analyzeAnnotation(e,t,r[u]),u--),u--;let p=[];for(let n=u;n>=2;n--)switch(r[n].name){case"VariableDecl":p=p.concat(this.analyzeVariableDecl(e,t,r[n]));break;case"VarStructDecl":p=p.concat(this.analyzeVarStructDecl(e,t,r[n]));break;default:e.error(r[n],i.g.UnknownInstruction,{})}e.endCbuffer();const h=k.T_FLOAT4.size,d=c.name,m=new A({scope:a,sourceNode:n,name:d,fields:p,aligment:h});a.addType(m)||e.error(n,i.g.TypeRedefinition,{typeName:d});const f=new w({id:c,type:m,sourceNode:n,semantic:l,annotation:o,scope:a});a.addCbuffer(f)||e.error(n,i.g.CbufferRedefinition,{typeName:d});return f}analyzeVariable(e,t,n,s){const a=n.children,o=t.currentScope;let c=null,u=null,p="",h=0;e.func?(e.funcDef||(h|=ge.K.k_Argument),h|=ge.K.k_Local):(o.type!==l.SR.k_Struct&&(h|=ge.K.k_Global),e.cbuffer&&(h|=ge.K.k_Cbuffer));let d=null,m=null,f=null,g=a[a.length-1];for(;;){let i=g.children;if(1===i.length){const e=i[0].value;d=new $.x({scope:o,sourceNode:n,name:e});break}(0,r.hu)(4==i.length),(0,r.Ft)(m)||(s=new S.L({scope:o,sourceNode:s.sourceNode,type:s,arrayIndex:m})),m=this.analyzeExpr(e,t,i[i.length-3]),g=i[i.length-1]}f=new S.L({scope:o,sourceNode:s.sourceNode,type:s,arrayIndex:m});const y=e=>"="==e.children[e.children.length-1]?.value;for(let r=a.length-2;r>=0;r--)if("Annotation"===a[r].name)c=this.analyzeAnnotation(e,t,a[r]);else if("Semantic"===a[r].name)p=this.analyzeSemantic(a[r]);else if("Initializer"===a[r].name){switch(u=y(a[r])?this.analyzeInitializer(e,t,a[r],f,n):this.analyzeStateBlock(e,t,a[r].children[0],f),f.name){case"BlendState":case"SamplerState":case"SamplerComparisonState":case"DepthStencilState":case"RasterizerState":console.assert(!y(a[r])),console.assert(!f.isNotBaseArray()||f.length==u.blocks.length);break;default:console.assert(y(a[r]))}u||e.error(n,i.g.InvalidVariableInitializing,{varName:d.name})}const T=new ge.D({sourceNode:n,scope:o,type:f,init:u,id:d,semantic:p,annotation:c,usageFlags:h});(0,r.hu)(o.type!=l.SR.k_System),k.hasVariable(T.name)&&e.error(n,i.g.SystemVariableRedefinition,{varName:T.name});if(!o.addVariable(T))switch(o.type){case l.SR.k_Global:case l.SR.k_Default:e.error(n,i.g.VariableRedefinition,{varName:T.name});break;case l.SR.k_Struct:e.error(n,i.g.InvalidNewFieldForStructName,{fieldName:T.name});break;case l.SR.k_Annotation:e.error(n,i.g.InvalidNewAnnotationVar,{varName:T.name})}return T}analyzeAnnotationDecls(e,t,n){const r=n.children;let i=[];for(let n=r.length-1;n>=0;n--)switch(r[n].name){case"AnnotationDecls":i.push(...this.analyzeAnnotationDecls(e,t,r[n]));break;case"VariableDecl":i.push(...this.analyzeVariableDecl(e,t,r[n]))}return i}analyzeAnnotation(e,t,n){const r=new Te.F$(k.SCOPE),i=r.currentScope;r.push(l.SR.k_Annotation);const s=[...n.children.filter((e=>"AnnotationDecls"==e.name)).map((t=>this.analyzeAnnotationDecls(e,r,t))).flat(),...n.children.filter((e=>"VariableDecl"==e.name)).map((t=>this.analyzeVariableDecl(e,r,t))).flat()];return r.pop(),s&&s.length?new g({scope:i,sourceNode:n,decls:s}):null}analyzeSemantic(e){return e.children.slice(0,-1).reverse().map((e=>e.value)).join("")}analyzeInitializer(e,t,n,r,i=null){const s=n.children;return"="==s[s.length-1]?.value?(console.assert("T_PUNCTUATOR_61"===s[s.length-1].name),this.analyzeInitExprChildren(e,t,n,s.slice(0,-1),r,i)):(console.assert(!1,"not valid branch"),null)}analyzeExpr(e,t,n){const r=n.name;switch(r){case"ObjectExpr":return this.analyzeObjectExpr(e,t,n);case"ComplexExpr":return this.analyzeComplexExpr(e,t,n);case"PostfixExpr":return this.analyzePostfixExpr(e,t,n);case"UnaryExpr":return this.analyzeUnaryExpr(e,t,n);case"CastExpr":return this.analyzeCastExpr(e,t,n);case"ConditionalExpr":return this.analyzeConditionalExpr(e,t,n);case"MulExpr":case"AddExpr":return this.analyzeArithmeticExpr(e,t,n);case"RelationalExpr":case"EqualityExpr":return this.analyzeRelationExpr(e,t,n);case"LogicalAndExpr":case"LogicalOrExpr":return this.analyzeLogicalExpr(e,t,n);case"AssignmentExpr":return this.analyzeAssignmentExpr(e,t,n);case"AndExpr":case"ShiftExpr":case"InclusiveOrExpr":case"ExclusiveOrExpr":return this.analyzeBitwiseExpr(e,t,n);case"T_NON_TYPE_ID":return this.analyzeIdExpr(e,t,n);case"T_STRING":case"T_UINT":case"T_FLOAT":case"T_KW_TRUE":case"T_KW_FALSE":return this.analyzeSimpleExpr(e,t,n);default:e.error(n,i.g.UnsupportedExpr,{exprName:r})}return null}analyzeObjectExpr(e,t,n){switch(n.children[n.children.length-1].name){case"T_KW_COMPILE":return this.analyzeCompileExpr(e,t,n);case"T_KW_COMPILE_SHADER":return this.analyzeCompileShader11(e,t,n)}return null}analyzeCompileShader11(e,t,n){const i=n.children,s=t.currentScope,a=i[1],o=i[3].value,l=a.children[a.children.length-1].value,c=[];for(let n=a.children.length-3;n>0;n--)","!==a.children[n].value&&c.push(this.analyzeExpr(e,t,a.children[n]));const u=t.globalScope.functions[l][0],p=o.substring(0,2),h={vs:k.T_VERTEX_SHADER,ps:k.T_PIXEL_SHADER,gs:k.T_GEOMETRY_SHADER,cs:k.T_COMPUTE_SHADER}[p];return(0,r.hu)((0,r.Xq)(h),`unknown shader type '${p} (${o})' has been used`),new P({scope:s,sourceNode:n,ver:o,args:c,func:u,type:h})}analyzeCompileExpr(e,t,n,s){const a=n.children,o=a[a.length-2].value,l=t.currentScope;let c=null,u=null,p=null;if(a.length>4){c=[];for(let n=a.length-4;n>0;n--)","!==a[n].value&&c.push(this.analyzeExpr(e,t,a[n]))}p=c?c.map(Ee):null;let h=null;if(s){for(let e of s)if(p=c?c.map(Ee):null,u=null,p=e.args||p,u=e.ret||u,h=t.globalScope.findFunction(o,p),h){if(e.ret&&!m.V5.equals(e.ret,h.def.returnType))continue;break}}else h=t.globalScope.findFunction(o,p);if((0,r.Ft)(h))return e.error(n,i.g.InvalidCompileNotFunction,{funcName:o}),null;if(u&&!m.V5.equals(h.def.returnType,u))return e.error(n,i.g.InvalidCompileFunctionNotValid,{funcName:o,funcType:u.toCode(),tooltip:`Return type mismatch: expected '${u.toCode()}' a is a '${h.def.returnType.toCode()}' `}),null;let d=S.L.wrap(h.def.returnType,l);return new O({args:c,scope:l,type:d,operand:h,sourceNode:n})}analyzeComplexExpr(e,t,n){const r=n.children;switch(r[r.length-1].name){case"PostfixPointExpr":case"T_NON_TYPE_ID":return this.analyzeFunctionCallExpr(e,t,n);case"BaseType":case"T_TYPE_ID":return this.analyzeConstructorCallExpr(e,t,n);default:return this.analyzeSimpleComplexExpr(e,t,n)}}analyzeCallee(e,t,n){const r=n.children;return this.analyzeExpr(e,t,r[r.length-1])}createTracePseudoDeclaration(e,t,n){const r=t.globalScope,i=[new E.o({scope:r,name:"extern",args:null})],s=S.L.wrap(k.T_VOID,r),a=new $.x({scope:r,name:"trace"}),o=n.map(((e,t)=>{const n=S.L.wrapAsConst(e.type.baseType,r),i=new $.x({scope:r,name:`p${t}`}),s=ge.K.k_Argument|ge.K.k_Local;return new ge.D({scope:r,type:n,id:i,usageFlags:s})})),l=new V.Y({scope:r,returnType:s,id:a,paramList:o}),c=new z.s({scope:r,def:l,impl:null,attrs:i});return r.addFunction(c),c}analyzeFunctionCallExpr(e,t,n){const a=n.children,o=t.currentScope,c=t.globalScope,u=a[a.length-1].name;let p=null,h=null,d=null,f=[];switch(u){case"T_NON_TYPE_ID":if(p=a[a.length-1].value,a.length>3)for(let n=a.length-3;n>0;n--)if(","!==a[n].value){const r=this.analyzeExpr(e,t,a[n]);f.push(r)}f.every((e=>e?.type!=xe(e)));h=c.findFunction(p,f.map((e=>e?.type||null))),h||(h=c.findFunction(p,f.map(xe))),(0,r.Ft)(h)&&"trace"===p&&(h=this.createTracePseudoDeclaration(e,t,f));break;case"PostfixPointExpr":if(d=this.analyzeCallee(e,t,a[a.length-1]),p=a[a.length-1].children[0].value,a.length>3)for(let n=a.length-3;n>0;n--)if(","!==a[n].value){const r=this.analyzeExpr(e,t,a[n]);f.push(r)}h=d.type.getMethod(p,f.map(xe))}if((0,r.Ft)(h))return e.error(n,i.g.InvalidComplexNotFunction,{funcName:p,args:f.map((e=>m.V5.signature(e?.type)))}),null;if(!(0,r.Xq)(h))return e.error(n,i.g.CannotChooseFunction,{funcName:p}),null;if(f.includes(null))return null;if(h.def.params.filter((e=>!e.initExpr)).length>f.length)return e.error(n,i.g.UnsupportedExpr,{funcName:p}),null;if(f.forEach(((t,n)=>{const r=h.def.params[n],i=f[n];m.V5.equals(r.type,i.type)||e.warn(i.sourceNode,s.S.ImplicitTypeConversion,{info:`${i.type.toCode()} => ${r.type.toCode()}`})})),h.instructionType!==l.rO.k_FunctionDecl&&h.instructionType!==l.rO.k_SystemFunctionDecl)return console.error("@undefined_behavior"),null;const g=h.def.params;for(let t=0;t<f.length;t++)if(!(0,r.Ft)(f[t]))if(g[t].type.usages.includes("out")){const n=m.th.unwind(f[t]);(0,r.Ft)(n)&&e.error(f[t].sourceNode,i.g.InvalidExprIsNotLValue),f[t].type.writable||e.error(f[t].sourceNode,i.g.InvalidTypeForWriting)}else if(g[t].type.usages.includes("inout")){const n=m.th.unwind(f[t]);(0,r.Ft)(n)&&e.error(f[t].sourceNode,i.g.InvalidExprIsNotLValue),f[t].type.writable||e.error(f[t].sourceNode,i.g.InvalidTypeForWriting),f[t].type.readable||e.error(f[t].sourceNode,i.g.InvalidTypeForReading)}else f[t].type.readable||e.error(f[t].sourceNode,i.g.InvalidTypeForReading);{const e=S.L.wrap(h.def.returnType,o);return new W({scope:o,type:e,decl:h,args:f,sourceNode:n,callee:d})}}analyzeConstructorCallExpr(e,t,n){const s=n.children,a=t.currentScope,o=this.analyzeType(e,t,s[s.length-1]);if((0,r.Ft)(o))return e.error(n,i.g.InvalidComplexNotType),null;let l=null;if(s.length>3){let n=null;l=[];for(let r=s.length-3;r>0;r--)","!==s[r].value&&(n=this.analyzeExpr(e,t,s[r]),l.push(n))}const c=function(e,t){return new S.L({type:e,scope:null})}(o);if((0,r.Ft)(c))return e.error(n,i.g.InvalidComplexNotConstructor,{typeName:String(o)}),null;if(!(0,r.Ft)(l))for(let t=0;t<l.length;t++)l[t]&&l[t].type.readable||e.error(n,i.g.InvalidTypeForReading);return new L({scope:a,sourceNode:n,ctor:c,args:l})}analyzeSimpleComplexExpr(e,t,n){const i=n.children,s=t.currentScope;let a=this.analyzeExpr(e,t,i[1]);return(0,r.Ft)(a)?null:new I({scope:s,sourceNode:n,expr:a})}analyzePostfixExpr(e,t,n){const r=n.children;switch(r[r.length-2].value){case"[":return this.analyzePostfixIndex(e,t,n);case".":return this.analyzePostfixPoint(e,t,n);case"++":case"--":return this.analyzePostfixArithmetic(e,t,n)}return null}analyzePostfixIndex(e,t,n){const s=n.children,a=t.currentScope,o=this.analyzeExpr(e,t,s[s.length-1]);if((0,r.Ft)(o))return null;const l=o.type;if(!l.isArray())return e.error(n,i.g.InvalidPostfixNotArray,{typeName:String(l)}),null;const c=this.analyzeExpr(e,t,s[s.length-3]),u=c.type;return m.V5.equals(u,k.T_INT)||m.V5.equals(u,k.T_UINT)?new Z({scope:a,sourceNode:n,element:o,index:c}):(e.error(n,i.g.InvalidPostfixNotIntIndex,{typeName:String(u)}),null)}static createFieldDecl(e,t){if(!e.getField(t))return null;const n=(e.subType||e).getField(t),{type:r}=n,i=new S.L({scope:r.scope,sourceNode:r.sourceNode,type:r,readable:e.readable,writable:e.writable,padding:r.padding}),s=new $.x({scope:n.scope,name:n.id.name,sourceNode:n.id.sourceNode}),a=new ge.D({semantic:n.semantic,scope:n.scope,type:i,sourceNode:n.sourceNode,id:s,usageFlags:n.usageFlags});return f.v.$withParent(a,e)}analyzePostfixPointField(e,t,n,i){if((0,r.Ft)(i))return null;const s=t.currentScope,a=n.value,o=Oe.createFieldDecl(i,a);if((0,r.Ft)(o))return null;const l=new $.x({scope:s,sourceNode:n,name:a});return new M({scope:s,sourceNode:n,id:l,decl:o})}analyzePostfixPoint(e,t,n){const s=n.children,a=t.currentScope,o=this.analyzeExpr(e,t,s[s.length-1]);if((0,r.Ft)(o))return null;const l=this.analyzePostfixPointField(e,t,s[s.length-3],o.type);if((0,r.Ft)(l)){const t=s[s.length-3].value;return e.error(n,i.g.InvalidPostfixNotField,{typeName:String(o.type),fieldName:t}),null}return new ee({sourceNode:n,scope:a,element:o,postfix:l})}analyzePostfixArithmetic(e,t,n){const s=n.children,a=t.currentScope,o=s[0].value,l=this.analyzeExpr(e,t,s[1]),c=l.type,u=Oe.checkOneOperandExprType(e,n,o,c);return(0,r.Ft)(u)?(e.error(n,i.g.InvalidPostfixArithmetic,{operator:o,typeName:String(c)}),null):new Y({scope:a,sourceNode:n,operator:o,expr:l})}analyzeUnaryExpr(e,t,n){const s=n.children,a=s[1].value,o=t.currentScope;let c=this.analyzeExpr(e,t,s[0]),u=Oe.checkOneOperandExprType(e,n,a,c.type);if((0,r.Ft)(u))return e.error(n,i.g.InvalidUnaryOperation,{operator:a,tyename:String(c.type)}),null;let p=null;if(("-"===a||"+"===a)&&m.NQ.isLiteral(c))switch(c.instructionType){case l.rO.k_IntExpr:{let e=c,{base:t,signed:r,heximal:i,exp:s}=e;r="-"===a||e.signed,t="-"===a?-t:t,p=new j.v({scope:o,sourceNode:n,base:t,exp:s,signed:r,heximal:i})}break;case l.rO.k_FloatExpr:p=new K({scope:o,sourceNode:n,value:Number(`${a}${c.value}`)})}return p||(p=new fe({scope:o,sourceNode:n,expr:c,operator:a})),p}analyzeCastExpr(e,t,n){const s=n.children,a=t.currentScope,o=this.analyzeConstTypeDim(e,t,s[2]);k.isBase(o)||e.error(n,i.g.InvalidCastTypeNotBase,{typeName:String(o)});const l=this.analyzeExpr(e,t,s[0]);return(0,r.Ft)(l)?null:(l.type.readable||e.error(n,i.g.InvalidTypeForReading),new R({scope:a,sourceNode:n,sourceExpr:l,type:o}))}analyzeConditionalExpr(e,t,n){const s=n.children,a=t.currentScope,o=this.analyzeExpr(e,t,s[s.length-1]),l=this.analyzeExpr(e,t,s[s.length-3]),c=this.analyzeExpr(e,t,s[0]);if((0,r.Ft)(o))return e.error(s[s.length-1],i.g.InvalidConditionType,{typeName:"[unknown]"}),null;if((0,r.Ft)(l))return e.error(s[s.length-3],i.g.InvalidConditionType,{typeName:"[unknown]"}),null;if((0,r.Ft)(c))return e.error(s[0],i.g.InvalidConditionType,{typeName:"[unknown]"}),null;const u=o.type,p=l.type,h=c.type,d=k.T_BOOL;return m.V5.equals(u,d)?m.V5.equals(p,h)?(u.readable||e.error(o.sourceNode,i.g.InvalidTypeForReading,{tooltip:`${o.toCode()}`}),p.readable||e.error(l.sourceNode,i.g.InvalidTypeForReading,{tooltip:`${l.toCode()}`}),h.readable||e.error(c.sourceNode,i.g.InvalidTypeForReading,{tooltip:`${c.toCode()}`}),new F({scope:a,sourceNode:n,cond:o,left:l,right:c})):(e.error(p.sourceNode,i.g.InvalidConditonValueTypes,{leftTypeName:String(p),rightTypeName:String(h)}),null):(e.error(o.sourceNode,i.g.InvalidConditionType,{typeName:String(u)}),null)}analyzeArithmeticExpr(e,t,n){const s=n.children,a=t.currentScope,o=n.children[1].value,l=this.analyzeExpr(e,t,s[s.length-1]),c=this.analyzeExpr(e,t,s[0]);if(!l||!c)return e.error(n,i.g.InvalidArithmeticOperation,{operator:o,leftTypeName:"[unknown]",rightTypeName:"[unknown]"}),null;const u=l.type,p=c.type,h=Oe.checkTwoOperandExprTypes(e,o,u,p,l.sourceNode,c.sourceNode,n);return(0,r.Ft)(h)?(e.error(n,i.g.InvalidArithmeticOperation,{operator:o,leftTypeName:String(u),rightTypeName:String(p)}),null):new T({scope:a,sourceNode:n,left:l,right:c,operator:o,type:h})}analyzeRelationExpr(e,t,n){const s=n.children,a=t.currentScope,o=n.children[1].value,l=this.analyzeExpr(e,t,s[s.length-1]),c=this.analyzeExpr(e,t,s[0]),u=l&&l.type,p=c&&c.type,h=Oe.checkTwoOperandExprTypes(e,o,u,p,l&&l.sourceNode,c&&c.sourceNode,n);return(0,r.Ft)(h)?(e.error(n,i.g.InvalidRelationalOperation,{operator:o,leftTypeName:u?m.V5.signature(u):"[unknown]",rightTypeName:p?m.V5.signature(p):"[unknown]"}),null):l&&c?new se({sourceNode:n,scope:a,left:l,right:c,operator:o}):null}analyzeLogicalExpr(e,t,n){const r=n.children,s=t.currentScope,a=n.children[1].value,o=this.analyzeExpr(e,t,r[r.length-1]),l=this.analyzeExpr(e,t,r[0]),c=o.type,u=l.type,p=k.T_BOOL;return m.V5.equals(c,p)?m.V5.equals(u,p)?(c.readable||e.error(n,i.g.InvalidTypeForReading),u.readable||e.error(n,i.g.InvalidTypeForReading),new J({scope:s,sourceNode:n,left:o,right:l,operator:a})):(e.error(u.sourceNode,i.g.InvalidLogicOperation,{operator:a,typeName:String(u)}),null):(e.error(c.sourceNode,i.g.InvalidLogicOperation,{operator:a,typeName:String(c)}),null)}analyzeBitwiseExpr(e,t,n){const s=n.children,a=t.currentScope,o=n.children[1].value,l=this.analyzeExpr(e,t,s[s.length-1]),c=this.analyzeExpr(e,t,s[0]);if(!l||!c)return null;const u=l.type,p=c.type,h=Oe.checkTwoOperandExprTypes(e,o,u,p,l.sourceNode,c.sourceNode,n);return(0,r.Ft)(h)?(e.error(n,i.g.InvalidBitwiseOperation,{operator:o,leftTypeName:String(u),rightTypeName:String(p)}),null):new x({scope:a,sourceNode:n,left:l,right:c,type:h,operator:o})}analyzeAssignmentExpr(e,t,n){const s=n.children,a=t.currentScope,o=s[1].value,l=this.analyzeExpr(e,t,s[s.length-1]);m.th.unwind(l)||e.error(n,i.g.InvalidLeftHandSideInAssignment,{operator:o});const c=this.analyzeExpr(e,t,s[0]);if((0,r.Ft)(l)||(0,r.Ft)(c))return null;const u=l.type,p=c.type;let h=null;return"="!==o?(h=Oe.checkTwoOperandExprTypes(e,o,u,p,l.sourceNode,c.sourceNode,n),(0,r.Ft)(h)&&e.error(n,i.g.InvalidArithmeticAssigmentOperation,{operator:o,leftTypeName:m.V5.signature(u),rightTypeName:m.V5.signature(p)})):h=p,h=Oe.checkTwoOperandExprTypes(e,"=",u,h,l.sourceNode,null,n),(0,r.Ft)(h)&&e.error(n,i.g.InvalidAssigmentOperation,{leftTypeName:m.V5.signature(u),rightTypeName:m.V5.signature(p)}),new _({scope:a,sourceNode:n,left:l,right:c,operator:o})}analyzeIdExpr(e,t,n){const s=t.currentScope,a=n.value,o=e.expressions[a];if(o)return o(e,t,n);if("NULL"===a)return new Q({scope:s,sourceNode:n});const l=s.findVariable(a);if((0,r.Ft)(l))return e.error(n,i.g.UnknownVarName,{varName:a}),null;const c=new $.x({scope:s,sourceNode:n,name:a});return new M({scope:s,sourceNode:n,id:c,decl:l})}analyzeSimpleExpr(e,t,n){const r=n.name,i=n.value,s=t.currentScope;switch(r){case"T_UINT":{const{base:e,signed:t,heximal:r,exp:a}=(0,_e.F2)(i);return new j.v({scope:s,sourceNode:n,base:e,exp:a,signed:t,heximal:r})}case"T_FLOAT":return new K({scope:s,sourceNode:n,value:Number(i)});case"T_STRING":return new ue({scope:s,sourceNode:n,value:i});case"T_KW_TRUE":return new b({scope:s,sourceNode:n,value:!0});case"T_KW_FALSE":return new b({scope:s,sourceNode:n,value:!1})}return null}analyzeConstTypeDim(e,t,n){const r=n.children;if(r.length>1)return e.error(n,i.g.InvalidCastTypeUsage),null;return this.analyzeType(e,t,r[0])}analyzeVarStructDecl(e,t,n){const r=n.children;let i=this.analyzeUsageStructDecl(e,t,r[r.length-1]),s=[];for(let n=r.length-2;n>=1;n--)"Variable"===r[n].name&&(s=s.concat(this.analyzeVariable(e,t,r[n],i)));return s}analyzeUsageStructDecl(e,t,n){const i=n.children,s=t.currentScope;let a=[],o=null;for(let n=i.length-1;n>=0;n--)if("StructDecl"===i[n].name){o=this.analyzeStructDecl(e,t,i[n]);be(e,s,new de({scope:s,sourceNode:i[n],type:o}))}else if("Usage"===i[n].name){const e=this.analyzeUsage(i[n]);a.push(e)}return(0,r.hu)(!(0,r.Ft)(o)),new S.L({scope:s,sourceNode:n,usages:a,type:o})}analyzeStruct(e,t,n){const r=n.children,i=t.currentScope;let s=null;"T_NON_TYPE_ID"===r[r.length-2].name&&(s=r[r.length-2].value);let a=[];t.push(l.SR.k_Struct);for(let n=r.length-4;n>=1;n--)"VariableDecl"===r[n].name&&(a=a.concat(this.analyzeVariableDecl(e,t,r[n])));t.pop();let o=1;return e.cbuffer&&(o=k.T_FLOAT4.size),new A({scope:i,sourceNode:n,fields:a,name:s,aligment:o})}analyzeFunctionDecl(e,t,n){const s=n.children,a=t.currentScope,o=t.globalScope,c=s[0].value;let u=null,p=null;t.push(l.SR.k_Default);const h=[];for(;"Attribute"===s[s.length-1-h.length].name;)h.push(this.analyzeAttribute(e,t,s[s.length-1-h.length]));const d=this.analyzeFunctionDef(e,t,s[s.length-1-h.length]);if((0,r.Ft)(d))return e.error(n,i.g.UnknownInstruction,{}),t.pop(),null;let f=o.findFunction(d.name,d.params.map(Ee));if(!(0,r.Xq)(f))return e.error(n,i.g.CannotChooseFunction,{funcName:d.name}),t.pop(),null;if(!(0,r.Ft)(f)&&f.impl)return e.error(n,i.g.FunctionRedefinition,{funcName:d.name}),t.pop(),null;if(!(0,r.Ft)(f)&&!m.V5.equals(f.def.returnType,d.returnType))return e.error(n,i.g.InvalidFuncDefenitionReturnType,{funcName:d.name}),t.pop(),null;(0,r.hu)(null===e.funcDef),e.funcDef=d,3===s.length&&(u=this.analyzeAnnotation(e,t,s[1])),";"!==c&&(p=this.analyzeStmtBlock(e,t,s[0])),t.pop();let g=m.V5.equals(d.returnType,k.T_VOID);if(!(0,r.Ft)(p)){let t=p.stmtList;for(let n=t.length-1;n>=0;--n)if(t[n].instructionType==l.rO.k_ReturnStmt){n!=t.length-1&&e.error(t[n+1].sourceNode,i.g.UnreachableCode);break}}return(0,r.hu)(a==o),f=new z.s({sourceNode:n,scope:a,def:d,impl:p,annotation:u,attrs:h}),o.addFunction(f)||e.error(n,i.g.FunctionRedifinition,{funcName:d.name}),g||e.haveCurrentFunctionReturnOccur||(0,r.Ft)(p)||e.error(n,i.g.InvalidFunctionReturnStmtNotFound,{funcName:d.name}),f}analyzeFunctionDef(e,t,n){const r=n.children,s=t.currentScope,a=r[r.length-2],o=a.value,l=r[r.length-1];let c=this.analyzeUsageType(e,t,l);if(!c)return e.error(l,i.g.InvalidFunctionReturnType,{funcName:o}),null;let u=new $.x({scope:s,name:o,sourceNode:a}),p=null;4===r.length&&(p=this.analyzeSemantic(r[0]));let h=this.analyzeParamList(e,t,r[r.length-3]);return new V.Y({scope:s,sourceNode:n,returnType:c,id:u,paramList:h,semantic:p})}analyzeParamList(e,t,n){const r=n.children;let i=[];for(let n=r.length-2;n>=1;n--)if("ParameterDecl"===r[n].name){let s=this.analyzeParameterDecl(e,t,r[n]);i.push(s)}return i}analyzeParameterDecl(e,t,n){const i=n.children,s=this.analyzeParamUsageType(e,t,i[1]);if((0,r.Ft)(s))return null;return this.analyzeVariable(e,t,i[0],s)}analyzeParamUsageType(e,t,n){const i=n.children,s=t.currentScope;let a=[],o=null;for(let n=i.length-1;n>=0;n--)if("Type"===i[n].name){if(o=this.analyzeType(e,t,i[n]),(0,r.Ft)(o))return null}else"ParamUsage"===i[n].name&&a.push(this.analyzeUsage(i[n]));return new S.L({scope:s,sourceNode:n,type:o,usages:a})}analyzeStmtBlock(e,t,n){const i=n.children,s=t.currentScope;if(!i)return null;let a=[];for(let n=i.length-2;n>0;n--){let s=this.analyzeStmt(e,t,i[n]);(0,r.Ft)(s)||a.push(s)}return new ce({sourceNode:n,scope:s,stmtList:a})}analyzeStmt(e,t,n){const r=n.children;let i,s=r.length;do{i=r[--s].name}while("Attribute"===i);switch(i){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,r[0]);case"UseDecl":return this.analyzeUseDecl(e,t,r[0]),null;case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,n);case"T_KW_FOR":return this.analyzeForStmt(e,t,n);case"T_KW_IF":return this.analyzeIfStmt(e,t,n)}return null}analyzeSimpleStmt(e,t,n){const r=t.currentScope,i=n.children;switch(i[i.length-1].name){case"T_KW_RETURN":return this.analyzeReturnStmt(e,t,n);case"T_KW_DO":return this.analyzeWhileStmt(e,t,n);case"StmtBlock":{t.push(l.SR.k_Default);let n=this.analyzeStmtBlock(e,t,i[0]);return t.pop(),n}case"T_KW_DISCARD":case"T_KW_BREAK":case"T_KW_CONTINUE":return this.analyzeBreakStmt(e,t,n);case"TypeDecl":case"VariableDecl":case"VarStructDecl":return this.analyzeDeclStmt(e,t,i[0]);default:return 2===i.length?this.analyzeExprStmt(e,t,n):new oe({sourceNode:n,scope:r})}}analyzeReturnStmt(e,t,n){const s=n.children,a=t.currentScope;(0,r.hu)(e.func);const o=e.funcDef.returnType;if(e.haveCurrentFunctionReturnOccur=!0,2===s.length&&Se(o,k.T_VOID),m.V5.equals(o,k.T_VOID)&&3===s.length)return e.error(n,i.g.InvalidReturnStmtVoid),null;if(!m.V5.equals(o,k.T_VOID)&&2===s.length)return e.error(n,i.g.InvalidReturnStmtEmpty),null;let l=null;if(3===s.length){if(l=this.analyzeExpr(e,t,s[1]),(0,r.Ft)(l))return e.error(n,i.g.InvalidReturnStmtTypesNotEqual),null;if(Se(o,l.type),Se(l.type,o),!m.V5.equals(l.type,o))return e.error(n,i.g.InvalidReturnStmtTypesNotEqual),null}return new ae({sourceNode:n,scope:a,expr:l})}analyzeBreakStmt(e,t,n){const i=n.children,s=t.currentScope,a=i[1].value;return"discard"===a&&(0,r.Ft)(e.funcDef),new v({sourceNode:n,scope:s,operator:a})}analyzeDeclStmt(e,t,n){n.children;const r=t.currentScope;let i=[];switch(n.name){case"TypeDecl":i.push(this.analyzeTypeDecl(e,t,n));break;case"VariableDecl":i=i.concat(this.analyzeVariableDecl(e,t,n));break;case"VarStructDecl":i=i.concat(this.analyzeVarStructDecl(e,t,n))}return new D({sourceNode:n,scope:r,declList:i})}analyzeExprStmt(e,t,n){const r=t.currentScope,i=n.children,s=this.analyzeExpr(e,t,i[1]);return new U({sourceNode:n,scope:r,expr:s})}analyzeWhileStmt(e,t,n){const r=t.currentScope,s=n.children,a="do"===s[s.length-1].value,o="NonIfStmt"===n.name,l=k.T_BOOL;let c=null,u=null,p=null,h="do";if(a){if(h="do",c=this.analyzeExpr(e,t,s[2]),u=c.type,!m.V5.equals(u,l))return e.error(n,i.g.InvalidDoWhileCondition,{typeName:String(u)}),null;p=this.analyzeStmt(e,t,s[0])}else{if(h="while",c=this.analyzeExpr(e,t,s[2]),u=c.type,!m.V5.equals(u,l))return e.error(n,i.g.InvalidWhileCondition,{typeName:String(u)}),null;p=o?this.analyzeNonIfStmt(e,t,s[0]):this.analyzeStmt(e,t,s[0])}return new ye({sourceNode:n,scope:r,cond:c,body:p,operator:h})}analyzeAttribute(e,t,n){const i=t.currentScope,s=n.children,a=s[s.length-2].value;let o=null;if(s.length>3){let n=null;o=[];for(let i=s.length-4;i>1;i--)","!==s[i].value&&(n=this.analyzeSimpleExpr(e,t,s[i]),(0,r.hu)(n.instructionType===l.rO.k_BoolExpr||n.instructionType===l.rO.k_FloatExpr||n.instructionType===l.rO.k_IntExpr),o.push(n))}return new E.o({scope:i,sourceNode:n,name:a,args:o})}analyzeIfStmt(e,t,n){const r=t.currentScope,a=n.children;let o=[];for(;"Attribute"===a[a.length-1-o.length].name;)o.push(this.analyzeAttribute(e,t,a[a.length-1-o.length]));const l=a.length-o.length==7,c=a[a.length-3-o.length],u=this.analyzeExpr(e,t,c);u&&m.V5.equals(xe(u.type),k.T_BOOL)?m.V5.equals(u.type,k.T_BOOL)||e.warn(c,s.S.ImplicitTypeConversion,{tooltip:`${u.type.name} => bool`}):e.error(c,i.g.InvalidIfCondition,{typeName:u?String(u.type):"[unknown]"});let p=null,h=null;return l?(p=this.analyzeNonIfStmt(e,t,a[2]),h=this.analyzeStmt(e,t,a[0])):p=this.analyzeNonIfStmt(e,t,a[0]),u?new q({sourceNode:n,scope:r,cond:u,conseq:p,contrary:h,attrs:o}):null}analyzeNonIfStmt(e,t,n){const r=n.children;switch(r[r.length-1].name){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,r[0]);case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,n);case"T_KW_FOR":return this.analyzeForStmt(e,t,n)}return null}analyzeForStmt(e,t,n){const s=t.currentScope,a=n.children,o="NonIfStmt"===n.name;let c=null,u=null,p=null,h=null,d=[];for(;"Attribute"===a[a.length-1-d.length].name;)d.push(this.analyzeAttribute(e,t,a[a.length-1-d.length]));if("ERROR"===a[1].name)return null;t.push();const m=a[a.length-3-d.length],f=a[a.length-4-d.length];u=this.analyzeForInit(e,t,m),p=this.analyzeForCond(e,t,f),h=null;const g="T_PUNCTUATOR_59"==m.children[0].name;return(0,r.Ft)(u)&&!g?e.error(m,i.g.InvalidForInitEmptyIterator):(u.instructionType,l.rO.k_VariableDecl),(0,r.Ft)(p)?e.error(f,i.g.InvalidForConditionEmpty):(p.instructionType,l.rO.k_RelationalExpr),a.length===7+d.length&&(h=this.analyzeForStep(e,t,a[2]),(0,r.Ft)(h)&&e.error(a[2],i.g.InvalidForStepEmpty)),c=o?this.analyzeNonIfStmt(e,t,a[0]):this.analyzeStmt(e,t,a[0]),t.pop(),new B({sourceNode:n,scope:s,init:u,cond:p,step:h,body:c})}analyzeForInit(e,t,n){const r=n.children;switch(r[r.length-1].name){case"VariableDecl":return this.analyzeVariableDecl(e,t,r[0])[0]||null;case"Expr":case"AssignmentExpr":return this.analyzeExpr(e,t,r[1])}return null}analyzeForCond(e,t,n){const r=n.children;return 1===r.length?null:this.analyzeExpr(e,t,r[1])}analyzeForStep(e,t,n){const r=n.children;if(0==r.length)return null;return this.analyzeExpr(e,t,r[0])}analyzePresetProperty(e,t,n){const i=n.children,a=i[i.length-1],o=a.value,l=i[i.length-3],c=l.children[l.children.length-1],u=t.currentScope;if((0,r.Ft)(c.value)||(0,r.Ft)(o))return console.warn("Pass state is incorrect."),null;const p=u.findVariable(o);if((0,r.Ft)(p))return e.warn(n,s.S.PartFx_PresetPropertyHasNotBeenFound),null;const h=p.type,d=[];if("{"===c.value&&l.children.length>3)for(let n=l.children.length-2;n>=1;n-=2){const r=this.analyzeExpr(e,t,l.children[n]);m.V5.equals(r.type,h.arrayElementType)||e.warn(l.children[n],s.S.ImplicitTypeConversion,{tooltip:`${r.type.name} => ${h.arrayElementType.name}`}),d.push(r)}else"{"===c.value?d.push(this.analyzeExpr(e,t,l.children[1])):d.push(this.analyzeExpr(e,t,c));const f=new $.x({name:o,scope:u,sourceNode:a});return new ne({scope:u,sourceNode:n,id:f,args:d})}analyzePresetStateBlock(e,t,n){const r=n.children;let i=[];for(let n=r.length-2;n>=1;n--)i.push(this.analyzePresetProperty(e,t,r[n]));return i}analyzePresetDecl(e,t,n){const r=n.children,i=t.currentScope;let s=null;for(let e=0;e<r.length;++e)if("T_NON_TYPE_ID"===r[e].name){let t=r[e].value;s=new $.x({sourceNode:r[e],scope:i,name:t})}const a=this.analyzePresetStateBlock(e,t,r[0]);return new te({scope:i,sourceNode:n,id:s,props:a})}analyzeTechnique11Decl(e,t,n){const r=n.children,i=this.analyzeComplexName(r[r.length-2]),s=(r[r.length-2].children.length,t.currentScope);let a=null,o=null,l=null;for(let n=r.length-3;n>=0;n--)"Annotation"===r[n].name?a=this.analyzeAnnotation(e,t,r[n]):"Semantic"===r[n].name?o=this.analyzeSemantic(r[n]):[l]=this.analyzeTechnique11(e,t,r[n]);const c=new pe({sourceNode:n,name:i,semantic:o,annotation:a,passes:l,scope:s,presets:null});return Oe.addTechnique11(e,t,c),c}analyzeTechniqueDecl(e,t,n){const r=n.children;e.warn(n,s.S.Deprecated);const i=this.analyzeComplexName(r[r.length-2]),a=(r[r.length-2].children.length,t.currentScope);let o=null,c=null,u=null,p=null,h=l.vj.k_BasicFx;for(let n=r.length-3;n>=0;n--)"Annotation"===r[n].name?o=this.analyzeAnnotation(e,t,r[n]):"Semantic"===r[n].name?c=this.analyzeSemantic(r[n]):[u,p]=this.analyzeTechnique(e,t,r[n]);const d=new he.L({sourceNode:n,name:i,techniqueType:h,semantic:c,annotation:o,passes:u,scope:a,presets:p});return Oe.addTechnique(e,t,d),d}analyzeTechnique(e,t,n){const i=n.children;let s=[],a=[];for(let n=i.length-2;n>=1;n--){if("PresetDecl"===i[n].children[0].name){let s=this.analyzePresetDecl(e,t,i[n].children[0]);(0,r.hu)(!(0,r.Ft)(s)),a.push(s);continue}let o=this.analyzePassDecl(e,t,i[n]);(0,r.hu)(!(0,r.Ft)(o)),s.push(o)}return[s,a]}analyzeTechnique11(e,t,n){const i=n.children;let s=[];for(let n=i.length-2;n>=1;n--){let a=this.analyzePass11Decl(e,t,i[n],0);(0,r.hu)(!(0,r.Ft)(a)),s.push(a)}return[s]}analyzePassDecl(e,t,n){const r=n.children,i=t.currentScope,s=this.analyzePassStateBlockForShaders(e,t,r[0]),a=this.analyzePassStateBlock(e,t,r[0]);let o=null;for(let e=0;e<r.length;++e)if("T_NON_TYPE_ID"===r[e].name){let t=r[e].value;o=new $.x({scope:i,name:t})}return new X.f({scope:i,sourceNode:n,renderStates:a,id:o,pixelShader:s.pixel,vertexShader:s.vertex})}analyzePass11Decl(e,t,n,r=0){const i=n.children,s=t.currentScope;let a=null;for(let e=0;e<i.length;++e)if("T_NON_TYPE_ID"===i[e].name){let t=i[e].value;a=new $.x({scope:s,name:t,sourceNode:i[e]})}a||(a=new $.x({scope:s,name:`auto_pass_${r}`}));const o=this.analyzeStmtBlock(e,t,i[0]),l=S.L.wrap(k.T_VOID,s),c=new V.Y({scope:s,id:a,returnType:l});return new z.s({scope:s,sourceNode:n,impl:o,def:c})}analyzePassStateBlockForShaders(e,t,n){const i=n.children;let s=null,a=null;const o=["vertexshader","pixelshader"];for(let n=i.length-2;n>=1;n--){let l=null;const c=i[n].children,u=c[c.length-1].value.toLowerCase();if(-1!==o.indexOf(u)&&(l=this.analyzePassStateForShader(e,t,i[n],u),!(0,r.Ft)(l)))switch(u){case"vertexshader":(0,r.hu)(null==a),a=l;break;case"pixelshader":(0,r.hu)(null==s),s=l;break;default:console.error("function is not suitable as shader entry point")}}return{vertex:a,pixel:s}}analyzePassStateForShader(e,t,n,s){(0,r.hu)("vertexshader"===s||"pixelshader"===s);const a=n.children,o=a[a.length-3],l=o.children[o.children.length-1],c=this.analyzeExpr(e,t,l);if(!c)return null;const u=c.function;return"vertexshader"===s?Re(u.def)||e.error(n,i.g.FunctionIsNotCompatibleWithVertexShader,{funcDef:String(u)}):Ce(u.def)||e.error(n,i.g.FunctionIsNotCompatibleWithPixelShader,{funcDef:String(u)}),u}analyzeStateBlock(e,t,n,r){const i=n.children,s=t.currentScope;if(r.isNotBaseArray()){let a=[];for(let n=i.length-2;n>=1;n--)","!==i[n].value&&(a=[...a,this.analyzeStateBlock(e,t,i[n],r.subType)]);return new le({scope:s,sourceNode:n,type:r,blocks:a})}{let a={};for(let n=i.length-2;n>=1;n--)a={...a,...this.analyzeState(e,t,i[n])};return new le({scope:s,sourceNode:n,type:r,props:a})}}analyzeState(e,t,n){const i=n.children,s=i[i.length-1].value,a=i[i.length-3],o=a.children[a.children.length-1];if((0,r.Ft)(o.value))return console.warn("state is incorrect."),{};let l={};if("{"===o.value&&a.children.length>3){const e=new Array(Math.ceil((a.children.length-2)/2));for(let t=a.children.length-2,n=0;t>=1;t-=2,n++)e[n]=a.children[t].value;l[s]=e}else{let e="";e="{"===o.value?a.children[1].value:o.value,l[s]=e}return l}analyzePassStateBlock(e,t,n){const r=n.children;let i={};for(let n=r.length-2;n>=1;n--)i={...i,...this.analyzePassState(e,t,r[n])};return i}analyzePassState(e,t,n){const i=n.children,s=i[i.length-1].value.toUpperCase(),l=a.H[s];if(!(0,u.hj)(l))return{};const c=i[i.length-3],p=c.children[c.children.length-1];if((0,r.Ft)(p.value))return console.warn("Pass state is incorrect."),{};let h={};if("{"===p.value&&c.children.length>3){const e=new Array(Math.ceil((c.children.length-2)/2));for(let t=c.children.length-2,n=0;t>=1;t-=2,n++)e[n]=ke(l,c.children[t].value.toUpperCase());switch(l){case a.H.BLENDFUNC:if(2!==e.length)return console.warn("Pass state are incorrect."),{};h[a.H.SRCBLENDCOLOR]=e[0],h[a.H.SRCBLENDALPHA]=e[0],h[a.H.DESTBLENDCOLOR]=e[1],h[a.H.DESTBLENDALPHA]=e[1];break;case a.H.BLENDFUNCSEPARATE:if(4!==e.length)return console.warn("Pass state are incorrect."),{};h[a.H.SRCBLENDCOLOR]=e[0],h[a.H.SRCBLENDALPHA]=e[2],h[a.H.DESTBLENDCOLOR]=e[1],h[a.H.DESTBLENDALPHA]=e[3];break;case a.H.BLENDEQUATIONSEPARATE:if(2!==e.length)return console.warn("Pass state are incorrect."),{};h[a.H.BLENDEQUATIONCOLOR]=e[0],h[a.H.BLENDEQUATIONALPHA]=e[1];break;default:return console.warn("Pass state is incorrect."),{}}}else{let e="";e="{"===p.value?c.children[1].value.toUpperCase():p.value.toUpperCase();const t=ke(l,e);if(t!==o.m.UNDEF)switch(l){case a.H.SRCBLEND:h[a.H.SRCBLENDCOLOR]=t,h[a.H.SRCBLENDALPHA]=t;break;case a.H.DESTBLEND:h[a.H.DESTBLENDCOLOR]=t,h[a.H.DESTBLENDALPHA]=t;break;case a.H.BLENDEQUATION:h[a.H.BLENDEQUATIONCOLOR]=t,h[a.H.BLENDEQUATIONALPHA]=t;break;default:h[l]=t}}return h}analyzeImportDecl(e,t,n){const r=n.children,s=this.analyzeComplexName(r[r.length-2]);return e.error(n,i.g.ImportedComponentNotExists,{componentName:s}),null}analyzeStructDecl(e,t,n){const r=n.children,i=t.currentScope,s=r[r.length-2].value;t.push(l.SR.k_Struct);let a=[];for(let n=r.length-4;n>=1;n--)"VariableDecl"===r[n].name&&(a=a.concat(this.analyzeVariableDecl(e,t,r[n])));return t.pop(),new A({scope:i,sourceNode:n,name:s,fields:a})}analyzeTypedefDecl(e,t,n){const r=n.children,s=t.currentScope,a=r[1].children[0].value,o=this.analyzeConstTypeDim(e,t,r[2]),l=new me({scope:s,sourceNode:n,type:o,alias:a});return function(e,t,n){k.findType(n.alias)&&e.error(n.sourceNode,i.g.SystemTypeRedefinition,{typeName:n.name}),t.addTypeAlias(n.type,n.alias)||e.error(n.sourceNode,i.g.TypeRedefinition,{typeName:n.alias})}(e,s,l),l}analyzeTypeDecl(e,t,n){const r=n.children,s=t.currentScope;let a=null;if(2===r.length)a=this.analyzeStructDecl(e,t,r[1]);else{if(4===r.length)return this.analyzeTypedefDecl(e,t,n);e.error(n,i.g.UnsupportedTypeDecl)}const o=new de({scope:s,sourceNode:n,type:a});return be(e,s,o),o}analyzeUnknDecl(e,t,n){switch(n.name){case"TechniqueDecl":return[this.analyzeTechniqueDecl(e,t,n)];case"Technique11Decl":return[this.analyzeTechnique11Decl(e,t,n)];case"UseDecl":return this.analyzeUseDecl(e,t,n),null;case"ImportDecl":return[this.analyzeImportDecl(e,t,n)];case"ProvideDecl":return[this.analyzeProvideDecl(e,t,n)];case"TypeDecl":return[this.analyzeTypeDecl(e,t,n)];case"VariableDecl":return this.analyzeVariableDecl(e,t,n);case"VarStructDecl":return this.analyzeVarStructDecl(e,t,n);case"FunctionDecl":(0,r.hu)(t.currentScope==t.globalScope);let a=null;return e.beginFunc(),a=this.analyzeFunctionDecl(e,t,n),e.endFunc(),[a];case"CbufferDecl":return[this.analyzeCbufferDecl(e,t,n)];case"SamplerStateDecl":return[this.analyzeSamplerStateDecl(e,t,n)];case"T_PUNCTUATOR_59":return e.warn(n,s.S.EmptySemicolon),null;default:e.error(n,i.g.UnknownInstruction,{name})}return null}analyzeGlobals(e,t,n){if((0,r.Ft)(n)||(0,r.Ft)(n.root))return null;const i=n.root.children;let s=[];if((0,r.Ft)(i))return[];for(let n=i.length-1;n>=0;n--)s.push(...this.analyzeUnknDecl(e,t,i[n])||[]);return s.filter((e=>!!e))}createContext(e,t){return new we(e,t)}createProgram(e=null){let t=k.SCOPE;return(0,r.Ft)(e)||(t=e.root.scope),new Te.F$(t)}createProgramEx(e=null){return(0,r.Ft)(e)?this.createProgram():new Te.Jx(e.root.scope)}validate(e,t,n){ve(e,t),t.validate()}parse(e,t){const n=e.uri,r=this.createProgram(t),i=this.createContext(n);let s=null;try{s=this.analyzeGlobals(i,r,e)}catch(e){console.error(e)}const a=new G({scope:r.globalScope,instructions:s});this.validate(i,r,a);return{root:a,diagnosticReport:c.g.mergeReports([e.diagnosticReport,i.diagnostics.resolve()]),uri:n}}extend(e,t,n){let r=t.uri,i=this.createProgramEx(t),s=this.createContext(r,n),a=t.root.instructions,o=t.diagnosticReport;if(e){r=e.uri;try{a=a.concat(this.analyzeGlobals(s,i,e))}catch(e){console.error(e)}o=c.g.mergeReports([o,e.diagnosticReport,s.diagnostics.resolve()])}const l=new G({scope:i.globalScope,instructions:a});return this.validate(s,i,l),{root:l,diagnosticReport:o,uri:r}}static addTechnique11(e,t,n){let s=n.name;(0,r.Ft)(t.globalScope.findTechnique11(s))?t.globalScope.addTechnique11(n):e.error(n.sourceNode,i.g.TechniqueNameRedefinition,{techName:s})}static addTechnique(e,t,n){let s=n.name;(0,r.Ft)(t.globalScope.findTechnique(s))?t.globalScope.addTechnique(n):e.error(n.sourceNode,i.g.TechniqueNameRedefinition,{techName:s})}static checkTwoOperandExprTypes(e,t,n,a,o=null,l=null,c=null,{isInitializing:u=!1}={}){if(!n||!a)return null;o=o||n.sourceNode,l=l||a.sourceNode;const p=n.isComplex()||a.isComplex(),h=e=>{if(e>=1&&e<=4){let t=[k.T_BOOL,k.T_BOOL2,k.T_BOOL3,k.T_BOOL4];return S.L.wrapAsConst(t[e-1],k.SCOPE)}return console.error("unsupported code branch"),null};if(n.isNotBaseArray()||a.isNotBaseArray())return null;if(Oe.isAssignmentOperator(t)?(n.writable||u||e.error(o,i.g.InvalidTypeForWriting),a.readable||e.error(l,i.g.InvalidTypeForReading),"="===t||n.readable||e.error(c,i.g.InvalidTypeForReading,{tooltip:"lvalue is not readable"})):(n.readable||e.error(o,i.g.InvalidTypeForReading),a.readable||e.error(l,i.g.InvalidTypeForReading)),p)return"="===t&&m.V5.equals(n,a)?n:Oe.isEqualityOperator(t)&&!n.isComplex()?h(1):null;let d=S.L.wrap(n.baseType,k.SCOPE),f=S.L.wrap(a.baseType,k.SCOPE);if(Oe.isBitwiseOperator(t)){switch(k.isIntBasedType(n)||k.isUintBasedType(n)||(k.isBoolBasedType(n)?e.warn(o,s.S.ImplicitTypeConversion,{tooltip:"bool => int"}):e.error(o,i.g.InvalidCastUnknownType,{tooltip:`${n.name} => int`}),d=S.L.wrap(k.T_INT,k.SCOPE)),k.isIntBasedType(a)||k.isUintBasedType(a)||(k.isBoolBasedType(a)?e.warn(l,s.S.ImplicitTypeConversion,{tooltip:"bool => int"}):e.error(l,i.g.InvalidCastUnknownType,{tooltip:`${a.name} => int`}),f=S.L.wrap(k.T_INT,k.SCOPE)),t){case"&":case"|":case"^":m.V5.equals(d,a)}return d}if(m.V5.equals(n,xe(a)))return m.V5.equals(n,a)||e.warn(c,s.S.ImplicitTypeConversion,{tooltip:`${n.name} [${t}] ${a.name}`}),Oe.isArithmeticalOperator(t)?!k.isMatrixType(n)||"/"!==t&&"/="!==t?d:null:Oe.isRelationalOperator(t)?k.isScalarType(n)||k.isVectorType(n)?h(n.length):null:Oe.isEqualityOperator(t)?h(n.length):"="===t?d:null;if(Oe.isArithmeticalOperator(t)){const o=k.isScalarType(n)?a.length:k.isScalarType(a)?n.length:Math.min(n.length,a.length),l=k.determMostPreciseBaseType(n,a),u=k.findType(`${l.name}${1===o?"":o}`);if(!u)return(0,r.hu)(!1,`cannot determ result type for "${n.toCode()} ${t} ${a.toCode()}"`),null;if(Oe.isAssignmentOperator(t)&&!m.V5.equals(n,u))return e.error(c,i.g.OperatorCannotBeUsedWithGivenLValue,{}),null;if((u.length<n.length||u.length<a.length)&&e.warn(c,s.S.ImplicitTypeTruncation,{tooltip:`${n.toCode()} ${t} ${a.toCode()} => ${u.toCode()}`}),m.V5.equals(k.determBaseType(n),k.determBaseType(a))||e.warn(c,s.S.ImplicitTypeConversion,{tooltip:`${n.toCode()} ${t} ${a.toCode()} => ${u.toCode()}`}),"*"===t||"*="===t){if(k.isMatrixType(n)&&k.isVectorType(a))return n.length===a.length?f:null;if(k.isMatrixType(a)&&k.isVectorType(n))return n.length===a.length?d:null}return u}if("="===t&&k.isScalarType(a)){if(k.determTypePrecision(n)>k.determTypePrecision(a))return e.warn(c,s.S.ImplicitTypeConversion,{tooltip:`${n.toCode()} ${t} ${a.toCode()} => ${n.toCode()}`}),n;if(k.isIntegerType(n)&&k.isIntegerType(a))return e.warn(c,s.S.ImplicitTypeConversion,{tooltip:`${n.toCode()} ${t} ${a.toCode()} => ${n.toCode()}`}),n}return null}static checkOneOperandExprType(e,t,n,r){const s=r.isComplex(),a=r.isNotBaseArray();if(s||a)return null;if(r.readable||e.error(t,i.g.InvalidTypeForReading),"++"===n||"--"===n)return r.writable||e.error(t,i.g.InvalidTypeForWriting),r;if("!"===n){const e=k.T_BOOL;return m.V5.equals(r,e)?e:null}return k.isBoolBasedType(r)?null:r.baseType}static isAssignmentOperator(e){return"+="===e||"-="===e||"*="===e||"/="===e||"%="===e||"="===e||"|="===e||"&="===e||">>="===e||"<<="===e||"^="===e}static isBitwiseOperator(e){return">>"===e||"<<"===e||"|"===e||"&"===e||"^"===e||"|="===e||"&="===e||">>="===e||"<<="===e||"^="===e}static isArithmeticalOperator(e){return"+"===e||"+="===e||"-"===e||"-="===e||"*"===e||"*="===e||"/"===e||"/="===e||"%"===e||"%="===e}static isRelationalOperator(e){return">"===e||">="===e||"<"===e||"<="===e}static isEqualityOperator(e){return"=="===e||"!="===e}}},zHDc:(e,t,n)=>{n.d(t,{F$:()=>l,Jx:()=>c,sX:()=>o});var r=n("cOQ3"),i=n("vIQR"),s=n("z3nI"),a=n("W5eQ");class o{constructor(e){let t,n,r;if(e instanceof o){let s=e;({type:t=i.SR.k_Default,parent:r=null,strictMode:n=!1}=s),this.variables={...s.variables},this.types={...s.types},this.functions={...s.functions},this.techniques={...s.techniques},this.techniques11={...s.techniques11},this.typeTemplates={...s.typeTemplates},this.cbuffers={...s.cbuffers}}else{let s=e;({type:t=i.SR.k_Default,parent:r=null,strictMode:n=!1}=s),this.variables={},this.types={},this.functions={},this.techniques={},this.techniques11={},this.typeTemplates={},this.cbuffers={}}this.type=t,this.parent=r,this.strictMode=n}isStrict(){return this.filter((e=>e.strictMode))}findVariable(e){return this.filter((t=>t.variables[e]||null))}findTypeTemplate(e){return this.filter((t=>t.typeTemplates[e]||null))}findType(e){return this.filter((t=>t.types[e]||null))}findFunction(e,t=null){return this.filter((n=>a.fn.matchList(n.functions[e],t)))}findTechnique(e){return this.filter((t=>t.techniques[e]||null))}findTechnique11(e){return this.filter((t=>t.techniques11[e]||null))}findCbuffer(e){return this.filter((t=>t.cbuffers[e]||null))}findFunctionInScope(e){let t=a.fn.matchList(this.functions[e.name],e.def.params.map((e=>e?e.type:null)));return(0,r.hu)(void 0!==t),t}addVariable(e){let t=this.variables,n=e.name;return!this.variables[n]&&(t[n]=e,(0,r.hu)(e.scope===this),!0)}addTypeTemplate(e){return!(0,r.$V)(this.typeTemplates[e.name])&&(this.typeTemplates[e.name]=e,!0)}addType(e){return!this.types[e.name]&&(this.types[e.name]=e,console.assert(e.scope===this),!0)}addTypeAlias(e,t){let n=null,r=null;(0,s.HD)(e)?(n=e,r=this.findType(n)):(r=e,n=r.name);return!this.findType(t)&&(!!r&&(!!this.findType(n)&&(this.types[t]=r,!0)))}addFunction(e){(0,r.hu)(this.type<=i.SR.k_Global),(0,r.hu)(e.scope===this);let t=this.functions,n=e.name;t[n]=t[n]||[];const s=t[n];let a=this.findFunctionInScope(e);if(a){(0,r.hu)(!(0,r.Ft)(e.impl)),(0,r.hu)((0,r.Ft)(a.impl));let t=s.indexOf(a);s[t]=e}else s.push(e);return!0}addTechnique(e){return(0,r.hu)(this.type<=i.SR.k_Global),!this.techniques[e.name]&&(this.techniques[e.name]=e,(0,r.hu)(e.scope===this),!0)}addTechnique11(e){return(0,r.hu)(this.type<=i.SR.k_Global),!this.techniques11[e.name]&&(this.techniques11[e.name]=e,(0,r.hu)(e.scope===this),!0)}addCbuffer(e){return(0,r.hu)(this.type<=i.SR.k_Global),!this.cbuffers[e.name]&&(this.cbuffers[e.name]=e,(0,r.hu)(e.scope===this),!0)}filter(e){let t=this;for(;!(0,r.Ft)(t);){let n=e(t);if(!(0,r.Ft)(n))return n;t=t.parent}return null}}class l{constructor(e){if(!(0,r.Ft)(e)){let t=i.SR.k_Global;this.globalScope=new o({parent:e,type:t}),this.currentScope=this.globalScope}}validate(){(0,r.hu)(this.currentScope===this.globalScope)}push(e=i.SR.k_Default){(0,r.hu)(null!==this.currentScope),(0,r.hu)(e>=i.SR.k_Default);let t=this.currentScope,n=new o({parent:t,type:e});this.currentScope=n}pop(){(0,r.hu)(null!==this.currentScope),this.currentScope=this.currentScope.parent,(0,r.hu)(null!==this.currentScope)}}class c extends l{constructor(e){super(null),this.globalScope=new o(e),this.currentScope=this.globalScope}}},A0ZU:(e,t,n)=>{n.r(t),n.d(t,{SCOPE:()=>$,T_BLEND_STATE:()=>J,T_BOOL:()=>me,T_BOOL2:()=>fe,T_BOOL2X2:()=>Te,T_BOOL3:()=>ge,T_BOOL3X3:()=>_e,T_BOOL4:()=>ye,T_BOOL4X4:()=>Ee,T_COMPUTE_SHADER:()=>Fe,T_DEPTH_STENCIL_STATE:()=>Q,T_FLOAT:()=>X,T_FLOAT2:()=>Y,T_FLOAT2X2:()=>se,T_FLOAT2X3:()=>ae,T_FLOAT2X4:()=>oe,T_FLOAT3:()=>Z,T_FLOAT3X2:()=>le,T_FLOAT3X3:()=>ce,T_FLOAT3X4:()=>ue,T_FLOAT4:()=>ee,T_FLOAT4X2:()=>pe,T_FLOAT4X3:()=>he,T_FLOAT4X4:()=>de,T_GEOMETRY_SHADER:()=>Le,T_HALF:()=>te,T_HALF2:()=>ne,T_HALF3:()=>re,T_HALF4:()=>ie,T_INT:()=>xe,T_INT2:()=>Se,T_INT2X2:()=>we,T_INT3:()=>ke,T_INT3X3:()=>Oe,T_INT4:()=>be,T_INT4X4:()=>Pe,T_NULL:()=>G,T_PIXEL_SHADER:()=>Ae,T_SAMPLER_STATE:()=>j,T_STRING:()=>H,T_UINT:()=>Ne,T_UINT2:()=>ve,T_UINT3:()=>Re,T_UINT4:()=>Ce,T_VERTEX_SHADER:()=>Ie,T_VOID:()=>q,determBaseType:()=>De,determMostPreciseBaseType:()=>We,determTypePrecision:()=>Ke,findFunction:()=>W,findTechnique:()=>B,findType:()=>U,findVariable:()=>K,hasTechnique:()=>M,hasType:()=>z,hasVariable:()=>V,isBase:()=>a.VC,isBlendState:()=>a.g5,isBoolBasedType:()=>a.a2,isBuffer:()=>a.zH,isDepthStencilState:()=>a.b8,isFloatBasedType:()=>a.v8,isFloatType:()=>a.QN,isHalfBasedType:()=>a.uO,isIntBasedType:()=>a.PV,isIntegerType:()=>a.YF,isMatrixType:()=>a.j4,isPipelineState:()=>a.tj,isRasterizerState:()=>a.$E,isSamplerState:()=>a.u2,isScalarType:()=>a.KA,isTexture:()=>a.DE,isUAV:()=>a.jZ,isUintBasedType:()=>a.Mf,isVectorType:()=>a.C1,resolveRegister:()=>a.vT,typePrecisionAsType:()=>Be});var r=n("cOQ3"),i=n("zHDc"),s=n("vIQR"),a=n("W6EL");var o=n("6EL/"),l=n("W5eQ");const c=class{constructor(e){this.name=e}produceType(e,t){return null}typeName(e){return e&&e.length>0?`${this.name}<${e.map((e=>e.name)).join(", ")}>`:this.name}};var u=n("Muaz"),p=n("k9uP"),h=n("F8nM"),d=n("O1LO"),m=n("/VpG");const f=class extends c{constructor(){super("AppendStructuredBuffer")}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH,s=[];{const n=[];{const r=new o.L({type:t[0],scope:e}),i=new u.x({scope:e,name:"Append"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});n.push(a)}const r=new o.L({type:e.findType("void"),scope:e}),i=new u.x({scope:e,name:"Append"}),a=new d.Y({scope:e,returnType:r,id:i,paramList:n}),l=new h.h({scope:e,def:a,pixel:!1,vertex:!1});s.push(l)}return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:s})}};const g=class extends c{constructor(){super("Buffer")}produceType(e,t){if(1!==t.length)return null;if(!(0,a.VC)(t[0]))return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:[]})}};const y=class extends c{constructor(){super("RWBuffer")}produceType(e,t){if(1!==t.length)return null;if(!(0,a.VC)(t[0]))return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:[]})}};const T=class extends c{constructor(){super("RWStructuredBuffer")}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH,s=[];{let t=new o.L({type:e.findType("uint"),scope:e}),n=new u.x({scope:e,name:"IncrementCounter"}),r=new d.Y({scope:e,returnType:t,id:n}),i=new h.h({scope:e,def:r,pixel:!1,vertex:!1});s.push(i)}{let t=new o.L({type:e.findType("uint"),scope:e}),n=new u.x({scope:e,name:"DecrementCounter"}),r=new d.Y({scope:e,returnType:t,id:n}),i=new h.h({scope:e,def:r,pixel:!1,vertex:!1});s.push(i)}return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:s})}};class _ extends c{constructor(){super(_.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:[]})}}_.TYPE_NAME="RWTexture1D";const E=_;class x extends c{constructor(){super(x.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:[]})}}x.TYPE_NAME="RWTexture2D";const S=x;const k=class extends c{constructor(){super("StructuredBuffer")}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:[]})}};class b extends c{constructor(){super(b.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH,c=[];{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float3");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"dx"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"dy"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"SampleGrad"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:c})}}b.TYPE_NAME="Texture2DArray";const N=b;class v extends c{constructor(){super(v.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH,c=[];{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"Sample"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}const r=`${n.isArray()?n.arrayElementType.name:n.name}4`;let i=new o.L({type:e.findType(r),scope:e}),s=new u.x({scope:e,name:"Gather"}),a=new d.Y({scope:e,returnType:i,id:s,paramList:t}),l=new h.h({scope:e,def:a,pixel:!0,vertex:!0});c.push(l)}{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"lod"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"SampleLevel"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"dx"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float2");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"dy"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"SampleGrad"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"mipLevel"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("uint");const r=new o.L({type:n,scope:e,usages:["out"]}),i=new u.x({scope:e,name:"width"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("uint");const r=new o.L({type:n,scope:e,usages:["out"]}),i=new u.x({scope:e,name:"height"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let n=new o.L({type:e.findType("void"),scope:e}),r=new u.x({scope:e,name:"GetDimensions"}),i=new d.Y({scope:e,returnType:n,id:r,paramList:t}),s=new h.h({scope:e,def:i,pixel:!1,vertex:!1});c.push(s)}{const t=[];{let n=e.findType("int3");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"location"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let n=new o.L({type:i,scope:e}),r=new u.x({scope:e,name:"Load"}),s=new d.Y({scope:e,returnType:n,id:r,paramList:t}),a=new h.h({scope:e,def:s,pixel:!1,vertex:!1});c.push(a)}return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:c})}}v.TYPE_NAME="Texture2D";const R=v;class C extends c{constructor(){super(C.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH,c=[];{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float3");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"Sample"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:c})}}C.TYPE_NAME="Texture3D";const w=C;class O extends c{constructor(){super(O.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH;return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:[]})}}O.TYPE_NAME="TextureCubeArray";const P=O;class I extends c{constructor(){super(I.TYPE_NAME)}produceType(e,t){if(t.length>1)return null;const n=t.length>0?t[0]:e.findType("float4");if(!(0,a.VC)(n))return null;const r=this.typeName(t),i=n,s=l.NQ.UNDEFINE_LENGTH,c=[];{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float3");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"Sample"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}{const t=[];{let n=e.findType("SamplerState");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"samplerState"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float3");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"uv"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("float");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"lod"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"SampleLevel"}),s=new d.Y({scope:e,returnType:r,id:i,paramList:t}),a=new h.h({scope:e,def:s,pixel:!0,vertex:!0});c.push(a)}return new m.F({scope:e,name:r,elementType:i,length:s,fields:[],size:-1,methods:c})}}I.TYPE_NAME="TextureCube";const A=I;var F=n("s0og");const L=class extends c{constructor(){super("TriMesh")}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],i=l.NQ.UNDEFINE_LENGTH,s=[];{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e,usages:["out"]}),i=new u.x({scope:e,name:"vertCount"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{let n=e.findType("uint");const r=new o.L({type:n,scope:e,usages:["out"]}),i=new u.x({scope:e,name:"faceCount"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let n=new o.L({type:e.findType("void"),scope:e}),r=new u.x({scope:e,name:"GetDimensions"}),i=new d.Y({scope:e,returnType:n,id:r,paramList:t}),a=new h.h({scope:e,def:i,pixel:!1,vertex:!1});s.push(a)}{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"vert"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let n=new o.L({type:r,scope:e}),i=new u.x({scope:e,name:"LoadVertex"}),a=new d.Y({scope:e,returnType:n,id:i,paramList:t}),l=new h.h({scope:e,def:a,pixel:!1,vertex:!1});s.push(l)}{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"face"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}let n=new o.L({type:e.findType("uint3"),scope:e}),r=new u.x({scope:e,name:"LoadFace"}),i=new d.Y({scope:e,returnType:n,id:r,paramList:t}),a=new h.h({scope:e,def:i,pixel:!1,vertex:!1});s.push(a)}{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"face"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{const{base:n,signed:r,heximal:i,exp:s}=(0,a.F2)("6u"),l=new F.v({scope:e,base:n,exp:s,signed:r,heximal:i}),c=e.findType("uint"),h=new o.L({type:c,scope:e,arrayIndex:l,usages:["out"]}),d=new u.x({scope:e,name:"adjacency"}),m=p.K.k_Argument|p.K.k_Local,f=new p.D({scope:e,type:h,id:d,usageFlags:m});t.push(f)}let n=new o.L({type:e.findType("void"),scope:e}),r=new u.x({scope:e,name:"LoadGSAdjacency"}),i=new d.Y({scope:e,returnType:n,id:r,paramList:t}),l=new h.h({scope:e,def:i,pixel:!1,vertex:!1});s.push(l)}{const t=[];{let n=e.findType("uint");const r=new o.L({type:n,scope:e}),i=new u.x({scope:e,name:"face"}),s=p.K.k_Argument|p.K.k_Local,a=new p.D({scope:e,type:r,id:i,usageFlags:s});t.push(a)}{const{base:n,signed:r,heximal:i,exp:s}=(0,a.F2)("3u"),l=new F.v({scope:e,base:n,exp:s,signed:r,heximal:i}),c=e.findType("uint"),h=new o.L({type:c,scope:e,arrayIndex:l,usages:["out"]}),d=new u.x({scope:e,name:"adjacency"}),m=p.K.k_Argument|p.K.k_Local,f=new p.D({scope:e,type:h,id:d,usageFlags:m});t.push(f)}let n=new o.L({type:e.findType("void"),scope:e}),r=new u.x({scope:e,name:"LoadFaceAdjacency"}),i=new d.Y({scope:e,returnType:n,id:r,paramList:t}),l=new h.h({scope:e,def:i,pixel:!1,vertex:!1});s.push(l)}return new m.F({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:s})}};const D=new i.sX({type:s.SR.k_System});!function(e){(0,a.$R)(e,"void",0),(0,a.$R)(e,"int",4),(0,a.$R)(e,"uint",4),(0,a.$R)(e,"bool",4),(0,a.$R)(e,"float",4),(0,a.$R)(e,"string",4),(0,a.$R)(e,"null_t",4),(0,a.zo)(e,"float","half"),console.assert(!1===a.z)}(D),function(e){const t=(0,a.ZY)("xy"),n=(0,a.ZY)("xyz"),r=(0,a.ZY)("xyzw"),i=(0,a.ZY)("rg"),s=(0,a.ZY)("rgb"),o=(0,a.ZY)("rgba"),l=(0,a.ZY)("st"),c=(0,a.ZY)("stp"),u=(0,a.ZY)("stpq");let p=(0,a.JP)(e,"float"),h=(0,a.JP)(e,"half"),d=(0,a.JP)(e,"int"),m=(0,a.JP)(e,"uint"),f=(0,a.JP)(e,"bool"),g=(0,a.$R)(e,"float2",-1,p,2),y=(0,a.$R)(e,"float3",-1,p,3),T=(0,a.$R)(e,"float4",-1,p,4);a.z||((0,a.zo)(e,"float2","half2"),(0,a.zo)(e,"float3","half3"),(0,a.zo)(e,"float4","half4"));let _=(0,a.$R)(e,"int2",-1,d,2),E=(0,a.$R)(e,"int3",-1,d,3),x=(0,a.$R)(e,"int4",-1,d,4),S=(0,a.$R)(e,"uint2",-1,m,2),k=(0,a.$R)(e,"uint3",-1,m,3),b=(0,a.$R)(e,"uint4",-1,m,4),N=(0,a.$R)(e,"bool2",-1,f,2),v=(0,a.$R)(e,"bool3",-1,f,3),R=(0,a.$R)(e,"bool4",-1,f,4);{let n=[];(0,a.Fu)(e,n,t,"float"),(0,a.Fu)(e,n,i,"float"),(0,a.Fu)(e,n,l,"float"),n.forEach((e=>g.addField(e)))}{let t=[];(0,a.Fu)(e,t,n,"float"),(0,a.Fu)(e,t,s,"float"),(0,a.Fu)(e,t,c,"float"),t.forEach((e=>y.addField(e)))}{let t=[];(0,a.Fu)(e,t,r,"float"),(0,a.Fu)(e,t,o,"float"),(0,a.Fu)(e,t,u,"float"),t.forEach((e=>T.addField(e)))}if(a.z){let p=(0,a.$R)(e,"half2",-1,h,2),d=(0,a.$R)(e,"half3",-1,h,3),m=(0,a.$R)(e,"half4",-1,h,4);{let n=[];(0,a.Fu)(e,n,t,"half"),(0,a.Fu)(e,n,i,"half"),(0,a.Fu)(e,n,l,"half"),n.forEach((e=>p.addField(e)))}{let t=[];(0,a.Fu)(e,t,n,"half"),(0,a.Fu)(e,t,s,"half"),(0,a.Fu)(e,t,c,"half"),t.forEach((e=>d.addField(e)))}{let t=[];(0,a.Fu)(e,t,r,"half"),(0,a.Fu)(e,t,o,"half"),(0,a.Fu)(e,t,u,"half"),t.forEach((e=>m.addField(e)))}}{let n=[];(0,a.Fu)(e,n,t,"int"),(0,a.Fu)(e,n,i,"int"),(0,a.Fu)(e,n,l,"int"),n.forEach((e=>_.addField(e)))}{let t=[];(0,a.Fu)(e,t,n,"int"),(0,a.Fu)(e,t,s,"int"),(0,a.Fu)(e,t,c,"int"),t.forEach((e=>E.addField(e)))}{let t=[];(0,a.Fu)(e,t,r,"int"),(0,a.Fu)(e,t,o,"int"),(0,a.Fu)(e,t,u,"int"),t.forEach((e=>x.addField(e)))}{let n=[];(0,a.Fu)(e,n,t,"uint"),(0,a.Fu)(e,n,i,"uint"),(0,a.Fu)(e,n,l,"uint"),n.forEach((e=>S.addField(e)))}{let t=[];(0,a.Fu)(e,t,n,"uint"),(0,a.Fu)(e,t,s,"uint"),(0,a.Fu)(e,t,c,"uint"),t.forEach((e=>k.addField(e)))}{let t=[];(0,a.Fu)(e,t,r,"uint"),(0,a.Fu)(e,t,o,"uint"),(0,a.Fu)(e,t,u,"uint"),t.forEach((e=>b.addField(e)))}{let n=[];(0,a.Fu)(e,n,t,"bool"),(0,a.Fu)(e,n,i,"bool"),(0,a.Fu)(e,n,l,"bool"),n.forEach((e=>N.addField(e)))}{let t=[];(0,a.Fu)(e,t,n,"bool"),(0,a.Fu)(e,t,s,"bool"),(0,a.Fu)(e,t,c,"bool"),t.forEach((e=>v.addField(e)))}{let t=[];(0,a.Fu)(e,t,r,"bool"),(0,a.Fu)(e,t,o,"bool"),(0,a.Fu)(e,t,u,"bool"),t.forEach((e=>R.addField(e)))}}(D),function(e){let t=(0,a.JP)(e,"float2"),n=(0,a.JP)(e,"float3"),r=(0,a.JP)(e,"float4"),i=(0,a.JP)(e,"int2"),s=(0,a.JP)(e,"int3"),o=(0,a.JP)(e,"int4"),l=((0,a.JP)(e,"uint2"),(0,a.JP)(e,"uint3"),(0,a.JP)(e,"uint4"),(0,a.JP)(e,"bool2")),c=(0,a.JP)(e,"bool3"),u=(0,a.JP)(e,"bool4");(0,a.$R)(e,"float2x2",-1,t,2),(0,a.$R)(e,"float2x3",-1,n,2),(0,a.$R)(e,"float2x4",-1,r,2),(0,a.$R)(e,"float3x2",-1,t,3),(0,a.$R)(e,"float3x3",-1,n,3),(0,a.$R)(e,"float3x4",-1,r,3),(0,a.$R)(e,"float4x2",-1,t,4),(0,a.$R)(e,"float4x3",-1,n,4),(0,a.$R)(e,"float4x4",-1,r,4),(0,a.$R)(e,"int2x2",-1,i,2),(0,a.$R)(e,"int2x3",-1,s,2),(0,a.$R)(e,"int2x4",-1,o,2),(0,a.$R)(e,"int3x2",-1,i,3),(0,a.$R)(e,"int3x3",-1,s,3),(0,a.$R)(e,"int3x4",-1,o,3),(0,a.$R)(e,"int4x2",-1,i,4),(0,a.$R)(e,"int4x3",-1,s,4),(0,a.$R)(e,"int4x4",-1,o,4),(0,a.$R)(e,"bool2x2",-1,l,2),(0,a.$R)(e,"bool2x3",-1,c,2),(0,a.$R)(e,"bool2x4",-1,u,2),(0,a.$R)(e,"bool3x2",-1,l,3),(0,a.$R)(e,"bool3x3",-1,c,3),(0,a.$R)(e,"bool3x4",-1,u,3),(0,a.$R)(e,"bool4x2",-1,l,4),(0,a.$R)(e,"bool4x3",-1,c,4),(0,a.$R)(e,"bool4x4",-1,u,4)}(D),function(e){(0,a.$R)(e,"SamplerState",4),(0,a.$R)(e,"SamplerComparisonState",4),(0,a.$R)(e,"DepthStencilState",4),(0,a.$R)(e,"BlendState",4),(0,a.$R)(e,"RasterizerState",4),(0,a.$R)(e,"VertexShader",4),(0,a.$R)(e,"PixelShader",4),(0,a.$R)(e,"ComputeShader",4),(0,a.$R)(e,"GeometryShader",4),(0,a.$R)(e,"HullShader",4),(0,a.$R)(e,"DomainShader",4),e.addTypeTemplate(new g),e.addTypeTemplate(new y),e.addTypeTemplate(new T),e.addTypeTemplate(new f),e.addTypeTemplate(new k),e.addTypeTemplate(new L),e.addTypeTemplate(new E),e.addTypeTemplate(new S),e.addTypeTemplate(new R),e.addTypeTemplate(new w),e.addTypeTemplate(new A),e.addTypeTemplate(new N),e.addTypeTemplate(new P);const t=e.findTypeTemplate(R.TYPE_NAME).produceType(e,[]);e.addType(t);const n=e.findTypeTemplate(A.TYPE_NAME).produceType(e,[]);e.addType(n);const r=e.findTypeTemplate(w.TYPE_NAME).produceType(e,[]);e.addType(r);const i=e.findTypeTemplate(N.TYPE_NAME).produceType(e,[]);e.addType(i);const s=e.findTypeTemplate(P.TYPE_NAME).produceType(e,[]);e.addType(s);const o=e.findTypeTemplate(E.TYPE_NAME).produceType(e,[]);e.addType(o);const l=e.findTypeTemplate(S.TYPE_NAME).produceType(e,[]);e.addType(l)}(D),function(e){(0,a.JK)(e,"dot","float",[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"mul",a.cP,[a.cP,a.cP],["float","int"]),(0,a.JK)(e,"mul",a.cP,[a.cP,"float"],["float2","float3","float4","float2x2","float3x3","float4x4"]),(0,a.JK)(e,"mul",a.cP,["float",a.cP],["float2","float3","float4","float2x2","float3x3","float4x4"]),(0,a.JK)(e,"mul","float4",["float4",a.cP],["float4x4","float4x3","float4x2"]),(0,a.JK)(e,"mul","float3",["float3",a.cP],["float3x4","float3x3","float3x2"]),(0,a.JK)(e,"mul","float2",["float2",a.cP],["float2x4","float2x3","float2x2"]),(0,a.JK)(e,"mul","float4",[a.cP,"float4"],["float4x4","float3x4","float2x4"]),(0,a.JK)(e,"mul","float3",[a.cP,"float3"],["float4x3","float3x3","float2x3"]),(0,a.JK)(e,"mul","float2",[a.cP,"float2"],["float4x2","float3x2","float2x2"]),(0,a.JK)(e,"mod","float",["float","float"],null),(0,a.JK)(e,"floor",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"round",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"ceil",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"abs",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"abs",a.cP,[a.cP],["int","int2","int3","int4"]),(0,a.JK)(e,"sign",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"sign",a.cP,[a.cP],["int","int2","int3","int4"]),(0,a.JK)(e,"normalize",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"length","float",[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"cross","float3",["float3","float3"],null),(0,a.JK)(e,"reflect",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"max",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"max",a.cP,[a.cP,a.cP],["int","int2","int3","int4"]),(0,a.JK)(e,"max",a.cP,[a.cP,a.cP],["uint","uint2","uint3","uint4"]),(0,a.JK)(e,"min",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"min",a.cP,[a.cP,a.cP],["int","int2","int3","int4"]),(0,a.JK)(e,"min",a.cP,[a.cP,a.cP],["uint","uint2","uint3","uint4"]),(0,a.JK)(e,"fmod",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"ldexp",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"reversebits",a.cP,[a.cP],["uint"]),(0,a.JK)(e,"clamp",a.cP,[a.cP,a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"clamp",a.cP,[a.cP,"float","float"],["float2","float3","float4"]),(0,a.JK)(e,"pow",a.cP,[a.cP,"float"],["float","float2","float3","float4"]),(0,a.JK)(e,"mod",a.cP,[a.cP,a.cP],["float2","float3","float4"]),(0,a.JK)(e,"mod",a.cP,[a.cP,"float"],["float2","float3","float4"]),(0,a.JK)(e,"exp",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"exp2",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"log",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"log2",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"inversesqrt",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"sqrt",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"not",a.cP,[a.cP],["bool2","bool3","bool4"]),(0,a.JK)(e,"distance","float",[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"lessThan","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"lessThan","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"lessThan","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"lessThanEqual","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"lessThanEqual","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"lessThanEqual","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"equal","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"equal","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"equal","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"equal",a.cP,[a.cP,a.cP],["bool2","bool3","bool4"]),(0,a.JK)(e,"notEqual","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"notEqual","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"notEqual","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"notEqual",a.cP,[a.cP,a.cP],["bool2","bool3","bool4"]),(0,a.JK)(e,"greaterThan","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"greaterThan","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"greaterThan","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"greaterThanEqual","bool2",[a.cP,a.cP],["float2","int2","uint2"]),(0,a.JK)(e,"greaterThanEqual","bool3",[a.cP,a.cP],["float3","int3","uint3"]),(0,a.JK)(e,"greaterThanEqual","bool4",[a.cP,a.cP],["float4","int4","uint4"]),(0,a.JK)(e,"radians",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"degrees",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"sin",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"cos",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"sincos","void",[a.cP,`out ${a.cP}`,`out ${a.cP}`],["float","float2","float3","float4"]),(0,a.JK)(e,"tan",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"asin",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"acos",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"atan",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"atan",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"atan2",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"atan2",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"dFdx",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"dFdy",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"width",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"fwidth",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"smoothstep",a.cP,[a.cP,a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"smoothstep",a.cP,["float","float",a.cP],["float2","float3","float4"]),(0,a.JK)(e,"step",a.cP,[a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"clip","void",[a.cP],["float","float2","float3","float4"],a.M0),(0,a.JK)(e,"frac",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"lerp",a.cP,[a.cP,a.cP,a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"lerp",a.cP,[a.cP,a.cP,"float"],["float2","float3","float4"]),(0,a.JK)(e,"saturate",a.cP,[a.cP],["float","float2","float3","float4"]),(0,a.JK)(e,"asfloat","float",[a.cP],["float","int","bool","uint"]),(0,a.JK)(e,"asfloat","float2",[a.cP],["float2","int2","bool2","uint2"]),(0,a.JK)(e,"asfloat","float3",[a.cP],["float3","int3","bool3","uint3"]),(0,a.JK)(e,"asfloat","float4",[a.cP],["float4","int4","bool4","uint4"]),(0,a.JK)(e,"asint","int",[a.cP],["float","int","bool","uint"]),(0,a.JK)(e,"asint","int2",[a.cP],["float2","int2","bool2","uint2"]),(0,a.JK)(e,"asint","int3",[a.cP],["float3","int3","bool3","uint3"]),(0,a.JK)(e,"asint","int4",[a.cP],["float4","int4","bool4","uint4"]),(0,a.JK)(e,"asuint","uint",[a.cP],["float","int","bool","uint"]),(0,a.JK)(e,"asuint","uint2",[a.cP],["float2","int2","bool2","uint2"]),(0,a.JK)(e,"asuint","uint3",[a.cP],["float3","int3","bool3","uint3"]),(0,a.JK)(e,"asuint","uint4",[a.cP],["float4","int4","bool4","uint4"]),(0,a.JK)(e,"InterlockedAdd",a.cP,[a.cP,a.cP,a.cP],["int"]),(0,a.JK)(e,"f16tof32","float",["uint"],null),(0,a.JK)(e,"f32tof16","uint",["float"],null),(0,a.JK)(e,"any","bool",[a.cP],["int","uint","float","bool"]),(0,a.JK)(e,"any","bool",[a.cP],["int2","uint2","float2","bool2","float2x2"]),(0,a.JK)(e,"any","bool",[a.cP],["int3","uint3","float3","bool3","float3x3"]),(0,a.JK)(e,"any","bool",[a.cP],["int4","uint4","float4","bool4","float4x4"]),(0,a.JK)(e,"all","bool",[a.cP],["int","uint","float","bool"]),(0,a.JK)(e,"all","bool",[a.cP],["int2","uint2","float2","bool2","float2x2"]),(0,a.JK)(e,"all","bool",[a.cP],["int3","uint3","float3","bool3","float3x3"]),(0,a.JK)(e,"all","bool",[a.cP],["int4","uint4","float4","bool4","float4x4"]),(0,a.JK)(e,"WaveGetLaneIndex","uint",[],["void"]),(0,a.JK)(e,"WaveActiveBallot","uint4",[a.cP],["bool"]),(0,a.JK)(e,"SetVertexShader","void",[a.cP],["VertexShader"],a.zW),(0,a.JK)(e,"SetPixelShader","void",[a.cP],["PixelShader"],a.zW),(0,a.JK)(e,"SetGeometryShader","void",[a.cP],["GeometryShader"],a.zW),(0,a.JK)(e,"SetDepthStencilState","void",[a.cP,"int"],["DepthStencilState"],a.zW),(0,a.JK)(e,"SetBlendState","void",[a.cP],["BlendState"],a.zW),(0,a.JK)(e,"SetRasterizerState","void",[a.cP],["RasterizerState"],a.zW)}(D);const U=e=>D.findType(e),K=e=>D.findVariable(e),B=e=>D.findTechnique(e),W=(e,t)=>D.findFunction(e,t),z=e=>!(0,r.Ft)(D.findType(e)),V=e=>!(0,r.Ft)(D.findVariable(e)),M=e=>!(0,r.Ft)(D.findTechnique(e)),$=D,q=D.findType("void"),H=D.findType("string"),G=D.findType("null_t"),j=D.findType("SamplerState"),J=D.findType("BlendState"),Q=D.findType("DepthStencilState"),X=D.findType("float"),Y=D.findType("float2"),Z=D.findType("float3"),ee=D.findType("float4"),te=D.findType("half"),ne=D.findType("half2"),re=D.findType("half3"),ie=D.findType("half4"),se=D.findType("float2x2"),ae=D.findType("float2x3"),oe=D.findType("float2x4"),le=D.findType("float3x2"),ce=D.findType("float3x3"),ue=D.findType("float3x4"),pe=D.findType("float4x2"),he=D.findType("float4x3"),de=D.findType("float4x4"),me=D.findType("bool"),fe=D.findType("bool2"),ge=D.findType("bool3"),ye=D.findType("bool4"),Te=D.findType("bool2x2"),_e=D.findType("bool3x3"),Ee=D.findType("bool4x4"),xe=D.findType("int"),Se=D.findType("int2"),ke=D.findType("int3"),be=D.findType("int4"),Ne=D.findType("uint"),ve=D.findType("uint2"),Re=D.findType("uint3"),Ce=D.findType("uint4"),we=D.findType("int2x2"),Oe=D.findType("int3x3"),Pe=D.findType("int4x4"),Ie=D.findType("VertexShader"),Ae=D.findType("PixelShader"),Fe=D.findType("ComputeShader"),Le=D.findType("GeometryShader");function De(e){if((0,a.KA)(e))return e;if((0,a.C1)(e)||(0,a.j4)(e)){if((0,a.v8)(e))return X;if((0,a.PV)(e))return xe;if((0,a.Mf)(e))return Ne;if((0,a.uO)(e))return te;if((0,a.a2)(e))return me}return(0,r.hu)(!1,`cannot determ base type of ${e.name}`),null}var Ue;function Ke(e){return(0,a.v8)(e)?Ue.k_Float:(0,a.uO)(e)?Ue.k_Half:(0,a.PV)(e)?Ue.k_Int:(0,a.Mf)(e)?Ue.k_Uint:(0,a.a2)(e)?Ue.k_Bool:Ue.k_Unknown}function Be(e){switch(e){case Ue.k_Float:return X;case Ue.k_Half:return te;case Ue.k_Int:return xe;case Ue.k_Uint:return Ne;case Ue.k_Bool:return me}return null}function We(e,t){(0,r.hu)((0,a.KA)(e)||(0,a.C1)(e)),(0,r.hu)((0,a.KA)(t)||(0,a.C1)(t));const n=Be(Math.max(Ke(e),Ke(t)));return(0,r.hu)(null!==n,"cannot determ base type"),n}!function(e){e[e.k_Bool=0]="k_Bool",e[e.k_Uint=1]="k_Uint",e[e.k_Int=2]="k_Int",e[e.k_Half=3]="k_Half",e[e.k_Float=4]="k_Float",e[e.k_Unknown=NaN]="k_Unknown"}(Ue||(Ue={}))},zoki:(e,t,n)=>{n.d(t,{fn:()=>r});var r,i=n("W5eQ"),s=n("cOQ3");!function(e){function t(e,t){return`${i.V5.signature(e.type,t)}${e.initExpr?"?":""}`}function n(e){return e.params.filter((e=>!e||!e.initExpr)).length}e.signature=function(e,n=!1){const{name:r,params:i}=e;return`${r}(${i.map((e=>t(e,n))).join(", ")})`},e.signatureEx=function(e,n=!1){const{name:r,returnType:s,params:a}=e;return`${i.V5.signature(s,n)} ${r}(${a.map((e=>t(e,n))).join(", ")})`},e.numArgsRequired=n,e.match=function(e,t,r=!1){return!(r||!(0,s.Ft)(t))||!(t.length>e.params.length||n(e)>t.length)&&t.every(((t,n)=>!r&&(0,s.Ft)(t)||!r&&(0,s.Ft)(e.params[n].type)||i.V5.equals(t,e.params[n].type,r)))},e.matchList=function(t,n,r=!1){if(!t)return null;const i=t.filter((t=>e.match(t.def,n,r)));return i.length>1?void 0:1===i.length?i[0]:null}}(r||(r={}))},W5eQ:(e,t,n)=>{n.d(t,{th:()=>i,fn:()=>c.fn,NQ:()=>r,V5:()=>l});var r,i,s=n("cOQ3"),a=n("vIQR");!function(e){e.UNDEFINE_LENGTH=16777215,e.UNDEFINE_SIZE=16777215,e.UNDEFINE_PADDING=16777215,e.UNDEFINE_NAME="undef",e.isExpression=function(e){switch(e.instructionType){case a.rO.k_ConditionalExpr:case a.rO.k_ConstructorCallExpr:case a.rO.k_AssignmentExpr:case a.rO.k_ArithmeticExpr:case a.rO.k_BitwiseExpr:case a.rO.k_InitExpr:case a.rO.k_IdExpr:case a.rO.k_FunctionCallExpr:case a.rO.k_FloatExpr:case a.rO.k_IntExpr:case a.rO.k_BoolExpr:case a.rO.k_PostfixArithmeticExpr:case a.rO.k_PostfixIndexExpr:case a.rO.k_PostfixPointExpr:case a.rO.k_ComplexExpr:case a.rO.k_CastExpr:case a.rO.k_UnaryExpr:case a.rO.k_RelationalExpr:case a.rO.k_LogicalExpr:return!0}return!1},e.isStatement=function(e){switch(e.instructionType){case a.rO.k_Stmt:case a.rO.k_DeclStmt:case a.rO.k_ReturnStmt:case a.rO.k_IfStmt:case a.rO.k_StmtBlock:case a.rO.k_ExprStmt:case a.rO.k_WhileStmt:case a.rO.k_ForStmt:case a.rO.k_BreakStmt:case a.rO.k_SemicolonStmt:return!0}return!1},e.isLiteral=function(e){switch(e.instructionType){case a.rO.k_IntExpr:case a.rO.k_FloatExpr:case a.rO.k_BoolExpr:case a.rO.k_StringExpr:return!0}return!1}}(r||(r={})),function(e){function t(e){const n=function(e){if(!e)return 0;if(r.isLiteral(e))return e.value;if(e.instructionType===a.rO.k_CastExpr)return t(e.expr);if(e.instructionType===a.rO.k_IdExpr){const n=e;if(n.decl.isGlobal())return console.assert(n.decl.initExpr.instructionType!==a.rO.k_InitExpr),t(n.decl.initExpr)}return-1}(e);if(n>=0)return n;if(e.instructionType!==a.rO.k_ArithmeticExpr)return console.error(`expr "${e.toCode()}" could not be evaluated`),-1;const{left:i,right:s,operator:o}=e,l=t(i),c=t(s);if(l>=0&&c>=0)switch(o){case"*":return c*l;case"/":return c/l;case"+":return c+l;case"-":return c-l;default:console.error("unsupported operator")}return console.error(`expr "${e.toCode()}" could not be evaluated`),-1}e.unwind=function e(t){if((0,s.Ft)(t))return null;switch(t.instructionType){case a.rO.k_PostfixPointExpr:case a.rO.k_PostfixIndexExpr:return e(t.element);case a.rO.k_IdExpr:return t.decl;case a.rO.k_BitwiseExpr:case a.rO.k_ArithmeticExpr:return null;case a.rO.k_InitExpr:return(0,s.hu)(!1,"init expression doesn't support unwind operation"),null;case a.rO.k_AssignmentExpr:return e(t.left);case a.rO.k_CastExpr:case a.rO.k_UnaryExpr:case a.rO.k_RelationalExpr:case a.rO.k_ConstructorCallExpr:return null;case a.rO.k_ComplexExpr:return e(t.expr);case a.rO.k_IntExpr:case a.rO.k_FloatExpr:case a.rO.k_StringExpr:case a.rO.k_BoolExpr:case a.rO.k_FunctionCallExpr:return null;default:return(0,s.hu)(!1,"unsupported expr found"),null}},e.evalConst=t}(i||(i={}));var o,l,c=n("zoki"),u=n("z3nI");!function(e){function t(e){return e.isParameter()?((0,s.hu)(e.parent.instructionType===a.rO.k_FunctionDef),e.parent.params.indexOf(e)):(console.error("invalid call."),-1)}e.parameterIndex=t,e.parameterOffset=function(e){if(!e.isParameter())return console.error("invalid call."),0;let n=t(e),r=0;for(let t=0;t<n;++t)r+=e.parent.params[t].type.size;return r},e.fullName=function(e){if(e.isField()&&l.findParentVariableDecl(e.parent)){let t="";return e.parent.instructionType===a.rO.k_VariableType&&(t=l.resolveVariableDeclFullName(e.parent)),t+="."+e.name,t}return e.name}}(o||(o={})),function(e){function t(e){if((0,s.Ft)(e.parent))return!1;const n=e.parent.instructionType;return n===a.rO.k_VariableDecl||n===a.rO.k_VariableType&&t(e.parent)}function n(e){if((0,s.Ft)(e.parent))return!1;if(e.parent.instructionType===a.rO.k_VariableDecl){return e.parent.isField()}return!1}function i(e){if(!t(e))return null;return e.parent.instructionType===a.rO.k_VariableDecl?e.parent:i(e.parent)}function l(e){if(!t(e))return null;return e.parent.instructionType===a.rO.k_TypeDecl?e.parent:l(e.parent)}function c(e,t=!1){if(!(0,u.$V)(e))return(0,s.hu)(!t),"*";switch(e.instructionType){case a.rO.k_VariableType:return function(e,t){let n="";t&&e.usages.length>0&&(n=`${e.usages.join("_")}_`);let i="";e.isNotBaseArray()&&(i="[]",e.length!==r.UNDEFINE_LENGTH&&(i=`[${e.length}]`));let s=e.subType;for(;s.instructionType==a.rO.k_VariableType;)s=s.subType;return`${n}${c(s)}${i}`}(e,t);case a.rO.k_ComplexType:return`${e.name}${e.instructionID}`;case a.rO.k_ProxyType:return e.baseType?c(e.baseType):e.name;case a.rO.k_SystemType:return e.name;default:return(0,s.hu)(!1,"unsupported type"),null}}function p(e,t=!1){switch(e.instructionType){case a.rO.k_VariableType:return function(e,t){let n="";return(t?e.isArray():e.isNotBaseArray())&&(n="[]",e.length!==r.UNDEFINE_LENGTH&&(n=`[${e.length}]`)),`${p(e.subType)}${n}`}(e,t);case a.rO.k_ComplexType:return function(e,t){return`{${e.fields.map((e=>p(e.type,t))).join(";")}}`}(e,t);case a.rO.k_ProxyType:return e.baseType?p(e.baseType):e.name;case a.rO.k_SystemType:return e.name;default:return(0,s.hu)(!1,"unsupported type"),null}}function h(e,t,n=!1){if((0,s.Ft)(e)||(0,s.Ft)(t))return!1;if(e instanceof RegExp&&t instanceof RegExp)return(0,s.hu)(!1),!1;if(e instanceof RegExp){let r=e;return!!c(t,n).match(r)}if(t instanceof RegExp){let r=t;return!!c(e,n).match(r)}let i=e,a=t;return(!i.isArray()||!a.isArray()||i.length!==r.UNDEFINE_LENGTH&&a.length!==r.UNDEFINE_LENGTH||i.length===a.length)&&c(i,n)===c(a,n)}e.isInheritedFromVariableDecl=t,e.isTypeOfField=n,e.findParentContainer=function(e){if(!t(e)||!n(e))return null;let r=i(e).parent;return t(r)?i(r):null},e.findParentVariableDecl=i,e.findParentVariableDeclName=function(e){let t=i(e);return(0,s.Ft)(t)?null:t.name},e.finParentTypeDecl=l,e.finParentTypeDeclName=function(e){let t=l(e);return(0,s.Ft)(t)?null:t.name},e.resolveVariableDeclFullName=function(e){return t(e)?o.fullName(i(e)):(console.error("Not from variable decl"),null)},e.findMainVariable=function e(r){return t(r)?n(r)?e(r.parent.parent):i(r):null},e.signature=c,e.hash=p,e.compareRelaxed=function(e,t,n=!1){return p(e,n)===p(t,n)},e.compare=h,e.equals=function(e,t,n=!1){return h(e,t,n)},e.alignSize=function(e,t){if(e===r.UNDEFINE_SIZE)return e;const n=e%t;return 0!==n?e+t-n:e}}(l||(l={}))},"rs/O":(e,t,n)=>{n.d(t,{o:()=>s});var r=n("vIQR"),i=n("hbjL");class s extends i.v{constructor({name:e,args:t=null,...n}){super({instrType:r.rO.k_Attribute,...n}),this.name=e,this.args=t}toCode(){return`[${this.name}${this.args.length>0?`(${this.args.map((e=>e.toCode())).join(", ")})`:""}]`}}},"0xZW":(e,t,n)=>{n.d(t,{_:()=>s});var r=n("vIQR"),i=n("hbjL");class s extends i.v{constructor({semantic:e=null,annotation:t=null,...n}){super({instrType:r.rO.k_Decl,...n}),this._semantic=e,this._annotation=i.v.$withParent(t,this)}get semantic(){return this._semantic}get annotation(){return this._annotation}get name(){return null}get id(){return null}}},BrFC:(e,t,n)=>{n.d(t,{b:()=>o});var r=n("cOQ3"),i=n("vIQR"),s=n("hbjL");class a extends s.v{constructor({type:e,...t}){super({instrType:i.rO.k_Typed,...t}),this._type=s.v.$withNoParent(e),(0,r.Ft)(this._type)&&console.warn("Something goes wrong! Type is not specified!",this)}get type(){return this._type}}class o extends a{constructor({...e}){super({instrType:i.rO.k_Expr,...e}),this._evalResult=null}get type(){return super.type}isConst(){return!1}isConstExpr(){return!0}}},BLpd:(e,t,n)=>{n.d(t,{s:()=>a});var r=n("vIQR"),i=n("0xZW"),s=n("hbjL");class a extends i._{constructor({def:e,impl:t=null,attrs:n=null,...i}){super({instrType:r.rO.k_FunctionDecl,...i}),this.def=s.v.$withParent(e,this),this.impl=s.v.$withParent(t,this),this.attrs=(n||[]).map((e=>s.v.$withParent(e,this)))}get name(){return this.def.name}get id(){return this.def.id}get semantic(){return this.def.semantic}toCode(){let e="";return e+=this.def.toCode(),this.impl?e+=this.impl.toCode():e+=";",e}}},O1LO:(e,t,n)=>{n.d(t,{Y:()=>o});var r=n("0xZW"),i=n("hbjL"),s=n("vIQR"),a=n("W5eQ");class o extends r._{constructor({returnType:e,id:t,paramList:n=[],...r}){super({instrType:s.rO.k_FunctionDef,...r}),this.params=n.map((e=>i.v.$withParent(e,this))),this.returnType=i.v.$withParent(e,this),this._id=i.v.$withParent(t,this)}get id(){return this._id}get name(){return this._id.name}toString(){let e=a.V5.signature(this.returnType)+" "+this.name+"(";for(let t=0;t<this.params.length;t++)e+=a.V5.signature(this.params[t].type)+",";return e+=")",e}toCode(){const{_id:e,returnType:t,params:n}=this;return`${t.toCode()} ${e.toCode()}(${n.map((e=>e.toCode())).join(", ")})`}}},Muaz:(e,t,n)=>{n.d(t,{x:()=>s});var r=n("vIQR"),i=n("hbjL");class s extends i.v{constructor({name:e,...t}){super({instrType:r.rO.k_Id,...t}),this.name=e}toString(){return this.name}toCode(){return this.name}}},hbjL:(e,t,n)=>{n.d(t,{v:()=>s});var r=n("cOQ3"),i=n("vIQR");class s{constructor({scope:e,instrType:t,sourceNode:n=null,visible:r=!0}){this._sourceNode=n,this._instructionType=t,this._instructionID=s.INSTRUCTION_COUNTER++,this._scope=e,this._parent=null,this._lastError=null}get parent(){return this._parent}get instructionType(){return console.assert(this._instructionType!=i.rO.k_Instruction,"Instruction type 'k_Instruction' is forbidden."),this._instructionType}get instructionName(){return i.rO[this.instructionType]}get instructionID(){return this._instructionID}get scope(){return(0,r.Ft)(this._scope)?(0,r.Ft)(this.parent)?null:this.parent.scope:this._scope}get sourceNode(){return this._sourceNode}toString(){return console.error("@pure_virtual"),null}toCode(){return console.error("@pure_virtual"),null}$withParent(e){return console.assert(null==this._parent,"parent redefenition detected!"),this.instructionType===i.rO.k_SystemType&&"float"===this.name&&this._parent,this._parent=e,this}$withNoParent(){return this}static $withParent(e,t){return(0,r.Ft)(e)?null:e.$withParent(t)}static $withNoParent(e){return(0,r.Ft)(e)?null:e.$withNoParent()}}s.INSTRUCTION_COUNTER=0},s0og:(e,t,n)=>{n.d(t,{v:()=>o});var r=n("BrFC"),i=n("6EL/"),s=n("A0ZU"),a=n("vIQR");class o extends r.b{constructor({base:e,signed:t,exp:n,heximal:r=!1,scope:o,...l}){super({instrType:a.rO.k_IntExpr,type:i.L.wrapAsConst(t?s.T_INT:s.T_UINT,s.SCOPE),scope:o,...l}),this.base=e,this.exp=n,this.signed=t,this.heximal=r,t||(this.base>>>=0)}get value(){return this.base*Math.pow(10,this.exp)}toString(){return`${this.heximal?"0x":""}${this.base.toString(this.heximal?16:10).toUpperCase()}${0!==this.exp?`e${this.exp}`:""}${this.signed?"":"u"}`}toCode(){return this.toString()}isConst(){return!0}}},"Z/0D":(e,t,n)=>{n.d(t,{f:()=>c});var r=n("cOQ3"),i=n("Y4FD"),s=n("HS1/"),a=n("vIQR"),o=n("0xZW"),l=n("hbjL");class c extends o._{constructor({id:e=null,vertexShader:t=null,pixelShader:n=null,renderStates:r={},...i}){super({instrType:a.rO.k_PassDecl,...i}),this._passStateMap={},c.clearRenderStateMap(this._passStateMap),c.copyRenderStateMap(r,this._passStateMap),this._vertexShader=l.v.$withNoParent(t),this._pixelShader=l.v.$withNoParent(n),this._id=e}get id(){return this._id}get name(){return(0,r.Ft)(this._id)?null:this._id.name}get vertexShader(){return this._vertexShader}get pixelShader(){return this._pixelShader}getState(e){return this._passStateMap[e]}get renderStates(){return this._passStateMap}static copyRenderStateMap(e,t){(0,r.Ft)(e)||Object.keys(i.H).filter((e=>(0,r.hj)(i.H[e]))).map((e=>i.H[e])).forEach((n=>{t[n]=e[n]||t[n]}))}static clearRenderStateMap(e){Object.keys(i.H).filter((e=>(0,r.hj)(i.H[e]))).map((e=>i.H[e])).forEach((t=>{e[t]=s.m.UNDEF}))}isValid(){return!0}}},pGoc:(e,t,n)=>{n.d(t,{W:()=>s});var r=n("vIQR"),i=n("hbjL");class s extends i.v{constructor({...e}){super({instrType:r.rO.k_Stmt,...e})}}},F8nM:(e,t,n)=>{n.d(t,{h:()=>a});var r=n("cOQ3"),i=n("vIQR"),s=n("BLpd");class a extends s.s{constructor({vertex:e=!0,pixel:t=!0,impl:n=null,...s}){super({instrType:i.rO.k_SystemFunctionDecl,impl:null,...s}),(0,r.hu)((0,r.Ft)(n)),this._bForVertex=e,this._bForPixel=t}checkVertexUsage(){return this._bForVertex}checkPixelUsage(){return this._bForPixel}$makeVertexCompatible(e){console.warn("@deprecated"),this._bForVertex=e}$makePixelCompatible(e){console.warn("@deprecated"),this._bForPixel=e}}},"/VpG":(e,t,n)=>{n.d(t,{F:()=>o});var r=n("cOQ3"),i=n("W5eQ"),s=n("vIQR"),a=n("hbjL");class o extends a.v{constructor({name:e,size:t=0,elementType:n=null,length:r=1,fields:i=[],methods:o=[],writable:l=!0,readable:c=!0,...u}){super({instrType:s.rO.k_SystemType,...u}),this._name=e,this._size=t,this._elementType=a.v.$withNoParent(n),this._length=r,this._fields=[],this._methods=[],this._bIsWritable=l,this._bIsReadable=c,i.forEach((e=>this.addField(e))),o.forEach((e=>this.addMethod(e)))}get writable(){return this._bIsWritable}get readable(){return this._bIsReadable}get name(){return this._name}get size(){return this.isArray()?this.length===i.NQ.UNDEFINE_LENGTH?i.NQ.UNDEFINE_LENGTH:this.arrayElementType.size*this.length:this._size}get baseType(){return this}get arrayElementType(){return this._elementType}get typeDecl(){return this.parent}get length(){return this._length}get fields(){return this._fields}get methods(){return this._methods}toDeclString(){return console.warn("@pure_virtual"),""}isArray(){return!(0,r.Ft)(this.arrayElementType)}isNotBaseArray(){return!1}isComplex(){return!1}isContainPointer(){return!1}toString(){return this.name||i.V5.hash(this)}toCode(){return this._name}hasFieldWithSematics(e){return!1}hasAllUniqueSemantics(){return!1}hasFieldWithoutSemantics(){return!1}getField(e){return this._fields.find((t=>t.name===e))||null}getMethod(e,t){const n=this._methods.filter((t=>t.name===e));return i.fn.matchList(n,t)}getFieldBySemantics(e){return console.error("@undefined_behavior"),null}addField(e){console.assert(null===this.getField(e.name)),this._fields.push(a.v.$withParent(e,this))}addMethod(e){console.assert((0,r.Ft)(this.getMethod(e.name,e.def.params.map((e=>e.type))))),this._methods.push(a.v.$withParent(e,this))}}},dmHP:(e,t,n)=>{n.d(t,{L:()=>a});var r=n("vIQR"),i=n("0xZW"),s=n("hbjL");class a extends i._{constructor({name:e,techniqueType:t,passes:n,presets:i,...a}){super({instrType:r.rO.k_TechniqueDecl,...a}),this._name=e,this.passes=n?.map((e=>s.v.$withParent(e,this))),this.type=t,this.presets=i}get name(){return this._name}isValid(){return!0}}},k9uP:(e,t,n)=>{n.d(t,{D:()=>l,K:()=>r});var r,i=n("cOQ3"),s=n("vIQR"),a=n("0xZW"),o=n("hbjL");!function(e){e[e.k_Local=1]="k_Local",e[e.k_Global=2]="k_Global",e[e.k_Argument=4]="k_Argument",e[e.k_Cbuffer=8]="k_Cbuffer"}(r||(r={}));class l extends a._{constructor({id:e,type:t,init:n=null,usageFlags:r=0,...a}){super({instrType:s.rO.k_VariableDecl,...a}),this._id=o.v.$withParent(e,this),this._type=o.v.$withNoParent(t),this._initExpr=o.v.$withParent(n,this),this._usageFlags=r,(0,i.hu)(!this.isParameter()||(0,i.Ft)(this.parent)||this.parent.instructionType==s.rO.k_FunctionDef),(0,i.hu)(this.isLocal()||!this.isLocal()),(0,i.hu)(!this.isParameter()||this.isLocal())}get usageFlags(){return this._usageFlags}get initExpr(){return this._initExpr}get type(){return this._type}get name(){return this._id.name}get id(){return this._id}isGlobal(){return!!(this._usageFlags&r.k_Global)}isLocal(){return!!(this._usageFlags&r.k_Local)}isParameter(){return!!(this._usageFlags&r.k_Argument)}isField(){if((0,i.Ft)(this.parent))return!1;const e=this.parent.instructionType;return e===s.rO.k_VariableType||e===s.rO.k_ComplexType||e===s.rO.k_SystemType}isConstant(){return!!(this._usageFlags&r.k_Cbuffer)||this.type.isUniform()}toCode(){var e="";(e=this.type.toCode(),e+=" "+this.id.toCode(),this.type.isNotBaseArray())&&(e+="["+this.type.length+"]");return(0,i.Ft)(this.initExpr)||this.type.isUniform()||(e+="="+this.initExpr.toCode()),e}}},"6EL/":(e,t,n)=>{n.d(t,{L:()=>o});var r=n("cOQ3"),i=n("W5eQ"),s=n("vIQR"),a=n("hbjL");class o extends a.v{constructor({type:e,usages:t=[],arrayIndex:n=null,writable:l=!0,readable:c=!0,padding:u=i.NQ.UNDEFINE_PADDING,...p}){super({instrType:s.rO.k_VariableType,...p}),e=a.v.$withNoParent(e),this._usageList=[];let h=e.instructionType;if(h===s.rO.k_ProxyType||h===s.rO.k_SystemType||h===s.rO.k_ComplexType)this._subType=e;else{let t=e;t.isNotBaseArray()?this._subType=e:(this._subType=t.subType,t.usages.forEach((e=>this.addUsage(e))))}(0,r.hu)((0,r.$V)(this._subType)),(0,r.hu)((0,r.$V)(this._usageList)),this._isWritable=l,this._isReadable=c,this._arrayIndexExpr=null,this._arrayElementType=null,this._padding=u,this._aligment=1,n&&(this._arrayElementType=a.v.$withParent(new o({readable:c,writable:l,scope:this.scope,type:this.subType,usages:this._usageList}),this),this._arrayIndexExpr=a.v.$withParent(n,this)),t.forEach((e=>this.addUsage(e)))}get name(){return this.baseType.name}get writable(){return!!this._isWritable&&(!this.isUniform()&&(!this.isConst()&&this.subType.writable))}get readable(){return!!this._isReadable&&(!this.usages.includes("out")&&this.subType.readable)}get methods(){return this.subType.methods}get aligment(){return this._aligment}get size(){if(!(0,r.Ft)(this._arrayElementType)){const e=i.V5.alignSize(this._arrayElementType.size,this.aligment),t=this.length;return t===i.NQ.UNDEFINE_LENGTH||e===i.NQ.UNDEFINE_SIZE?i.NQ.UNDEFINE_SIZE:e*t}return this.subType.size}get baseType(){return this.subType.baseType}get length(){if(!this.isNotBaseArray())return this.subType.length;if(this.isNotBaseArray()&&(0,r.Ft)(this._arrayElementType))return this.subType.length;const e=this._arrayIndexExpr;if(i.NQ.isLiteral(e))return Number(e.value);const t=i.th.evalConst(e);return t<0?i.NQ.UNDEFINE_LENGTH:t}get padding(){return this._padding}get arrayElementType(){return this.isArray()?this._arrayElementType||this.subType.arrayElementType:null}get usages(){let e=[...this._usageList],t=this.subType;for(;t&&t.instructionType===s.rO.k_VariableType;){const n=t;e=[...e,...n.usages],t=n.subType}return e}get subType(){return this._subType}get fields(){return this.subType.fields}toString(){return this.name||this.subType.toString()||i.V5.hash(this)}toCode(){let e="";if(!(0,r.Ft)(this._usageList))for(let t=0;t<this._usageList.length;t++)e+=this._usageList[t]+" ";return e+=this.subType.toCode(),e}toDeclString(){return this.subType.toDeclString()}isArray(){return!(0,r.Ft)(this._arrayElementType)||this.subType.isArray()}isNotBaseArray(){return!(0,r.Ft)(this._arrayElementType)||this.subType.isNotBaseArray()}isComplex(){return this.subType.isComplex()}isUniform(){return this.usages.includes("uniform")}isConst(){return this.usages.includes("const")}isUnsigned(){return this.usages.includes("unsigned")}isStatic(){return this.usages.includes("static")}$overwritePadding(e,t){this._padding=e,this._aligment=t}addUsage(e){this.usages.includes(e)||this._usageList.push(e)}hasFieldWithSematics(e){return this.subType.hasFieldWithSematics(e)}hasAllUniqueSemantics(){return this.subType.hasAllUniqueSemantics()}hasFieldWithoutSemantics(){return this.subType.hasFieldWithoutSemantics()}getField(e){return this.subType.getField(e)}getMethod(e,t){return this.subType.getMethod(e,t)}getFieldBySemantics(e){return this.subType.getFieldBySemantics(e)}static wrap(e,t){return new o({type:e,scope:t})}static wrapAsConst(e,t){return new o({type:e,scope:t,writable:!1,usages:["const"]})}}},W6EL:(e,t,n)=>{n.d(t,{cP:()=>N,zW:()=>K,M0:()=>U,z:()=>b,Fu:()=>O,zo:()=>w,ZY:()=>P,JK:()=>W,$R:()=>C,JP:()=>R,VC:()=>me,g5:()=>ue,a2:()=>Se,zH:()=>le,b8:()=>pe,v8:()=>be,QN:()=>_e,uO:()=>ke,PV:()=>Ee,YF:()=>Te,j4:()=>ge,tj:()=>de,$E:()=>he,u2:()=>ce,KA:()=>ye,DE:()=>oe,jZ:()=>ae,Mf:()=>xe,C1:()=>fe,F2:()=>v,vT:()=>Ne});var r=n("cOQ3"),i=n("W5eQ"),s=n("Muaz"),a=n("/VpG"),o=n("k9uP"),l=n("6EL/"),c=n("vIQR"),u=n("zoki"),p=n("Y4FD"),h=n("HS1/"),d=n("z3nI");class m{constructor(){this.blocks=[],this.stack=[]}top(){return this.stack[this.depth()-1]}findOrCreateOutput(e){const t=this.blocks.findIndex((t=>e&&t.name===e)),n=-1!==t?this.blocks.splice(t,1)[0]:function({tab:e="\t",nl:t="\n",name:n=null}={}){let r=[""],i=[],s=0,a=!1;function o(e){if(!s)for(let t=0;t<i.length;++t)e=i[t]+e;r[r.length-1]+=e,s++,a=!1}function l(){r.push(""),s=0}return{isEmpty:function(){return 1==r.length&&0==r[0].length},keyword:function(e){!a&&s&&o(" "),o(e)},ignoreNextSpace:()=>a=!0,push:(t=e)=>(i.push(t),s&&l()),pop:()=>(i.pop(),s&&l()),newline:l,add:o,toString:()=>r.join(t),name:n}}({name:e});return n}depth(){return this.stack.length}begin(e){this.stack.push(this.findOrCreateOutput(e))}end(e=!1){const t=this.stack.pop();t.isEmpty()||(e?this.blocks=[t,...this.blocks]:this.blocks.push(t))}push(e){this.top().push(e)}pop(){this.top().pop()}emitNewline(e=1){Array(e).fill(0).forEach((e=>this.top()?.newline()))}emitKeyword(e){this.top()?.keyword(e)}emitNoSpace(){this.top()?.ignoreNextSpace()}emitSpace(){this.emitChar(" "),this.emitNoSpace()}emitChar(e){this.top()?.add(e)}emitLine(e){this.emitChar(e),this.emitNewline()}clear(){(0,r.hu)(0==this.stack.length),this.blocks=[]}toString(){const e=this.blocks.map((e=>e.toString())).filter((e=>!!e)).join("\n\n");return this.clear(),e}valueOf(){return this.toString()}}var f,g=n("A0ZU");function y(e,t){-1==e.indexOf(t)&&e.push(t)}!function(e){e[e.k_Vertex=1]="k_Vertex",e[e.k_Pixel=2]="k_Pixel",e[e.k_Compute=4]="k_Compute"}(f||(f={}));class T{constructor(e={}){this.knownSignatures=new Set,this.uavs=[],this.textures=[],this.buffers=[],this.cbuffers=[],this.CSShaders=[],this.opts=e,this.opts.mode||="raw",console.assert(["vs","ps","ds","hs","gs","cs","raw"].includes(this.opts.mode))}get entryName(){return this.opts.entryName}get mode(){return this.opts.mode}isPixel(){return"ps"===this.mode}isVertex(){return"vs"===this.mode}isRaw(){return"raw"===this.mode}has(e){return this.knownSignatures.has(e)}add(e){(0,r.hu)(!this.has(e)),this.knownSignatures.add(e)}addCbuffer(e){(0,r.hu)(!this.has(e.name)),this.add(e.name);const{name:t,type:{size:n}}=e,i={name:t,size:n,register:g.resolveRegister(e).index};return this.cbuffers.push(i),i}addTexture(e,t){(0,r.hu)(!this.has(t)),this.add(t);const n=this.buffers.length+this.textures.length,i=e.match(/^([\w]+)<([\w0-9_]+)>$/)||[`${e}<float4>`,`${e}`,"float4"],s={name:t,type:e,texType:i[1],elementType:i[2],register:n};return this.textures.push(s),s}addUav(e,t){(0,r.hu)(!this.has(t)),this.add(t);const n=this.uavs.length,i=e.match(/^([\w]+)<([\w0-9_]+)>$/);(0,r.hu)(i);const s={name:t,type:e,uavType:i[1],elementType:i[2],register:n};return this.uavs.push(s),s}addBuffer(e,t){(0,r.hu)(!this.has(t)),this.add(t);const n=this.buffers.length+this.textures.length,i=e.match(/^([\w]+)<([\w0-9_]+)>$/);(0,r.hu)(i);const s={name:t,type:e,bufType:i[1],elementType:i[2],register:n};return this.buffers.push(s),s}beginCsShader(e,t){this.CSShader={name:e,numthreads:t,uavs:[],buffers:[],textures:[]}}endCsShader(){const e=this.CSShader;(0,r.hu)(e),(0,r.hu)(!this.has(e.name)),this.add(e.name),this.CSShaders.push(e),this.CSShader=null}linkBuffer(e){(0,r.hu)(this.has(e));let t=this.CSShader;t&&y(t.buffers,this.buffers.find((t=>t.name==e)))}linkCbuffer(e){(0,r.hu)(this.has(e));this.CSShader}linkUav(e){(0,r.hu)(this.has(e));let t=this.CSShader;t&&y(t.uavs,this.uavs.find((t=>t.name==e)))}linkTexture(e){(0,r.hu)(this.has(e));let t=this.CSShader;t&&y(t.textures,this.textures.find((t=>t.name==e)))}}class _ extends m{constructor(e={}){super(),this.options=e}isMain(){return 1===this.depth()}resolveTypeName(e){return e.name}resolveType(e,t){if(!t)return null;let n,r,i,s;if(t.isComplex()){r=t.name;const n=t.scope.findType(t.name);this.emit(e,n)}else r=this.resolveTypeName(t);if(t.instructionType===c.rO.k_VariableType){i=t.usages}return t.isNotBaseArray()&&(n=t.length),i&&i.length&&(s=i.filter((e=>!this.options.omitInUsage||"in"!=e)).join(" ")),{typeName:r,length:n,usage:s}}emitBuffer(e,t,n,r){if(!e.has(n)){const i=e.addBuffer(t,n);this.begin(),r&&this.emitComment(r),this.emitKeyword(`${t} ${n}: register(t${i.register});`),this.end()}e.linkBuffer(n)}emitUav(e,t,n,r){if(!e.has(n)){const i=e.addUav(t,n);this.begin(),r&&this.emitComment(r),this.emitKeyword(`${t} ${n}: register(u${i.register});`),this.end()}e.linkUav(n)}emitTexture(e,t){const{name:n,type:r}=t;this.emitTextureRaw(e,r.name,n)}emitTextureRaw(e,t,n,r){if(!e.has(n)){const i=e.addTexture(t,n);this.begin(),r&&this.emitComment(r),this.emitKeyword(`${t} ${n}: register(t${i.register});`),this.end()}e.linkTexture(n)}emitLine(e,t){this.emitChar(e),t&&(0,r.hu)(1===t.split("\n").length),t&&(this.emitChar("\t"),this.emitComment(t)),this.emitNewline()}emitComment(e){-1!==e.indexOf("\n")?(this.emitLine("/**"),this.push(" * "),e.split("\n").forEach((e=>this.emitLine(e))),this.pop(),this.emitLine(" */")):this.emitLine(`// ${e}`)}emitComplexType(e,t){(0,r.hu)(t.isComplex()),this.emitKeyword("struct"),this.emitKeyword(t.name),this.emitNewline(),this.emitChar("{"),this.push(),t.fields.map((t=>(this.emitComplexField(e,t),this.emitNewline()))),this.pop(),this.emitChar("}")}emitComplexTypeDecl(e,t){e.has(t.name)||(e.add(t.name),this.begin(),this.emitComplexType(e,t),this.emitChar(";"),this.end())}emitVariableNoInit(e,t,n){const{typeName:r,length:i,usage:s}=this.resolveType(e,t.type),a=n?n(t):t.name;s&&this.emitKeyword(s),this.emitKeyword(r),this.emitKeyword(a),i&&this.emitChar(`[${i}]`),t.semantic&&this.emitSemantic(e,t.semantic),t.annotation&&this.emitAnnotation(e,t.annotation)}emitVariable(e,t,n){if(this.emitVariableNoInit(e,t,n),t.initExpr){t.initExpr.instructionType===c.rO.k_StateBlockExpr||(this.emitKeyword("="),this.emitSpace()),this.emitExpression(e,t.initExpr)}}emitIfStmt(e,t){this.emitKeyword("if"),this.emitChar("("),this.emitNoSpace(),this.emitExpression(e,t.cond),this.emitChar(")"),this.emitNewline(),t.conseq?this.emitStmt(e,t.conseq):this.emitChar(";"),t.contrary&&(this.emitNewline(),this.emitKeyword("else"),this.emitStmt(e,t.contrary))}emitSemantic(e,t){this.emitChar(":"),this.emitKeyword(t)}emitAnnotation(e,t){}emitCompile(e,t){this.emitFunction(e,t.function),this.emitKeyword("compile"),this.emitKeyword(t.function.name),this.emitChar("("),this.emitNoSpace(),this.emitExpressionList(e,t.args),this.emitChar(")")}evaluateEntryName(e,t){const n=t.name,i=e.entryName;return(0,d.HD)(i)?((0,r.Xq)(t.scope.functions[i])&&console.error("entry point already exists"),i):n}emitEntryParams(e,t){const n=e.opts.constants;n&&t.filter((e=>e.type.isUniform())).forEach(((t,r)=>{const i=n[r],s=t.name;e.has(s)?console.assert(!1,"?!"):(e.add(s),this.begin(),this.emitLine(`static const ${i.type} ${s} = ${String(i.value)};`),this.end())})),t.filter((e=>!(this.options.omitEmptyParams&&0===e.type.size||e.type.isUniform()&&n))).forEach(((t,n,r)=>{this.emitParam(e,t),n+1!=r.length&&this.emitChar(",")}))}emitEntryFunction(e,t){const{def:n}=t,{typeName:r}=this.resolveType(e,n.returnType);this.begin();{let i=this.evaluateEntryName(e,t);this.emitKeyword(r),this.emitKeyword(i),this.emitChar("("),this.emitNoSpace(),this.emitEntryParams(e,n.params),this.emitChar(")"),n.returnType.isComplex()||e.isPixel()&&(this.emitChar(":"),this.emitKeyword(t.semantic||"SV_Target0")),this.emitNewline(),this.emitBlock(e,t.impl)}this.end()}emitAttributes(e,t){t?.forEach((t=>{this.emitChar("["),this.emitNoSpace(),this.emitKeyword(t.name),this.emitNoSpace(),t.args&&(this.emitChar("("),this.emitNoSpace(),this.emitExpressionList(e,t.args),this.emitChar(")"),this.emitNoSpace()),this.emitChar("]"),this.emitNewline()}))}emitRegularFunction(e,t){if(!t)return;const{def:n}=t,{typeName:r}=this.resolveType(e,n.returnType);this.begin(),this.emitAttributes(e,t.attrs),this.emitKeyword(r),this.emitKeyword(t.name),this.emitChar("("),this.emitNoSpace(),this.emitParams(e,n.params),this.emitChar(")"),this.emitNewline(),t.impl?this.emitBlock(e,t.impl):this.emitChar(";"),this.end()}emitFunction(e,t){if(!t)return;const n=u.fn.signature(t.def);if(e.has(n))return;e.add(n);0==this.depth()&&!e.isRaw()?this.emitEntryFunction(e,t):this.emitRegularFunction(e,t)}emitCollector(e,t){this.begin();for(let n of t.instructions)this.emit(e,n);this.end()}emitTypeDecl(e,t){this.resolveType(e,t.type)}emitTypedef(e,t){}emitForInit(e,t){i.NQ.isExpression(t)?this.emitExpression(e,t):this.emitVariable(e,t)}emitForStmt(e,t){this.emitKeyword("for"),this.emitChar("("),this.emitNoSpace(),this.emitForInit(e,t.init),this.emitChar(";"),this.emitExpression(e,t.cond),this.emitChar(";"),this.emitExpression(e,t.step),this.emitChar(")"),t.body.instructionType===c.rO.k_StmtBlock&&this.emitNewline(),this.emitStmt(e,t.body)}emitExpression(e,t){if(t)switch(t.instructionType){case c.rO.k_ArithmeticExpr:return this.emitArithmetic(e,t);case c.rO.k_AssignmentExpr:return this.emitAssigment(e,t);case c.rO.k_PostfixPointExpr:return this.emitPostfixPoint(e,t);case c.rO.k_IdExpr:return this.emitIdentifier(e,t);case c.rO.k_FunctionCallExpr:return this.emitFCall(e,t);case c.rO.k_ConstructorCallExpr:return this.emitCCall(e,t);case c.rO.k_FloatExpr:return this.emitFloat(e,t);case c.rO.k_IntExpr:return this.emitInteger(e,t);case c.rO.k_BoolExpr:return this.emitBool(e,t);case c.rO.k_StringExpr:return this.emitString(e,t);case c.rO.k_ComplexExpr:return this.emitComplexExpr(e,t);case c.rO.k_CompileExpr:return this.emitCompile(e,t);case c.rO.k_ConditionalExpr:return this.emitConditionalExpr(e,t);case c.rO.k_RelationalExpr:return this.emitRelationalExpr(e,t);case c.rO.k_LogicalExpr:return this.emitLogicalExpr(e,t);case c.rO.k_UnaryExpr:return this.emitUnaryExpr(e,t);case c.rO.k_PostfixArithmeticExpr:return this.emitPostfixArithmetic(e,t);case c.rO.k_InitExpr:return this.emitInitExpr(e,t);case c.rO.k_CastExpr:return this.emitCast(e,t);case c.rO.k_BitwiseExpr:return this.emitBitwise(e,t);case c.rO.k_PostfixIndexExpr:return this.emitPostfixIndex(e,t);case c.rO.k_StateBlockExpr:return this.emitStateBlockExpr(e,t);default:this.emitLine(`/* ... unsupported expression '${t.instructionName}' ... */`),(0,r.hu)(!1,`unsupported instruction found: ${t.instructionName}`)}}emitFloat(e,t){const n=String(t.value);this.emitKeyword(n),-1===n.indexOf(".")&&this.emitChar("."),this.emitChar("f")}emitBool(e,t){this.emitKeyword(t.value?"true":"false")}emitString(e,t){this.emitKeyword(t.value)}emitComplexExpr(e,t){this.emitChar("("),this.emitNoSpace(),this.emitExpression(e,t.expr),this.emitChar(")")}emitConditionalExpr(e,t){this.emitExpression(e,t.condition),this.emitKeyword("?"),this.emitExpression(e,t.left),this.emitKeyword(":"),this.emitExpression(e,t.right)}emitInteger(e,t){const n=t;this.emitKeyword(`${n.heximal?"0x"+n.value.toString(16).toUpperCase():n.value.toFixed(0)}${n.signed?"":"u"}`)}emitRelationalExpr(e,t){this.emitExpression(e,t.left),this.emitKeyword(t.operator),this.emitExpression(e,t.right)}emitLogicalExpr(e,t){this.emitExpression(e,t.left),this.emitKeyword(t.operator),this.emitExpression(e,t.right)}emitUnaryExpr(e,t){this.emitChar(t.operator),this.emitExpression(e,t.expr)}emitPostfixArithmetic(e,t){this.emitExpression(e,t.expr),this.emitChar(t.operator)}emitPostfixIndex(e,t){this.emitExpression(e,t.element),this.emitChar("["),this.emitNoSpace(),this.emitExpression(e,t.index),this.emitChar("]")}emitStateBlockExpr(e,t){"raw"===e.mode&&(0,r.hu)("not implemented")}emitBreakStmt(e,t){this.emitLine(`${t.operator};`)}emitExpressionList(e,t){t?.forEach(((n,r)=>{this.emitExpression(e,n),r!=t.length-1&&this.emitChar(",")}))}emitParam(e,t){this.emitVariable(e,t)}emitParams(e,t){t.filter((e=>!this.options.omitEmptyParams||0!==e.type.size)).forEach(((t,n,r)=>{this.emitParam(e,t),n+1!=r.length&&this.emitChar(",")}))}emitInitExpr(e,t){if(t.args.length>1)return this.emitChar("{"),this.emitNoSpace(),this.emitExpressionList(e,t.args),void this.emitChar("}");this.emitExpression(e,t.args[0])}emitCast(e,t){if(t.isUseless())return;this.emitChar("("),this.emitNoSpace();const{typeName:n}=this.resolveType(e,t.type);this.emitKeyword(n),this.emitChar(")"),this.emitNoSpace(),this.emitChar("("),this.emitNoSpace(),this.emitExpression(e,t.expr),this.emitChar(")")}emitBitwise(e,t){this.emitExpression(e,t.left),this.emitKeyword(t.operator),this.emitSpace(),this.emitExpression(e,t.right)}emitArithmetic(e,t){this.emitExpression(e,t.left),this.emitKeyword(t.operator),this.emitSpace(),this.emitExpression(e,t.right)}emitAssigment(e,t){this.emitExpression(e,t.left),this.emitKeyword(t.operator),this.emitSpace(),(0,r.hu)(i.NQ.isExpression(t.right)),this.emitExpression(e,t.right)}emitPostfixPoint(e,t){t.element.instructionType===c.rO.k_IdExpr||t.element.instructionType===c.rO.k_PostfixPointExpr?this.emitExpression(e,t.element):(this.emitChar("("),this.emitNoSpace(),this.emitExpression(e,t.element),this.emitChar(")")),this.emitChar("."),this.emitChar(t.postfix.name)}emitCbufferField(e,t){this.emitVariable(e,t),this.emitChar(";"),this.emitChar("\t"),this.emitComment(`padding ${t.type.padding}, size ${t.type.size}`)}emitCbuffer(e,t){if(!e.has(t.name)){e.addCbuffer(t),this.begin(),this.emitComment(`size: ${t.type.size}`),this.emitKeyword("cbuffer"),t.id&&this.emitKeyword(t.name);const n=g.resolveRegister(t);-1!==n.index&&(this.emitChar(":"),this.emitKeyword("register"),this.emitChar("("),this.emitNoSpace(),this.emitKeyword(`${n.type}${n.index}`),this.emitNoSpace(),this.emitChar(")")),this.emitNewline(),this.emitChar("{"),this.push(),t.type.fields.forEach((t=>{this.emitCbufferField(e,t)})),this.pop(),this.emitChar("}"),this.emitChar(";"),this.end()}e.linkCbuffer(t.name)}emitGlobal(e,t){const{name:n,type:r}=t;this.isMain()&&t.isParameter()&&r.isUniform();if(t.isGlobal())if(t.usageFlags&o.K.k_Cbuffer){const n=t.parent.parent;this.begin(),this.emitCbuffer(e,n),this.end()}else g.isTexture(r)?(this.begin(),this.emitTexture(e,t),this.end()):(this.begin(),this.emitGlobalVariable(e,t),this.end())}emitIdentifier(e,t){const{decl:n,name:r}=t;this.emitGlobal(e,n),this.emitKeyword(r)}emitCCall(e,t){const n=t.args,{typeName:r}=this.resolveType(e,t.ctor);this.emitKeyword(r),this.emitChar("("),this.emitNoSpace(),this.emitExpressionList(e,n),this.emitChar(")")}emitFCall(e,t,n=(e=>e.name)){const{decl:r,args:i,callee:s}=t;r.instructionType!==c.rO.k_SystemFunctionDecl&&this.emitFunction(e,r),s&&(this.emitExpression(e,s),this.emitChar("."),this.emitNoSpace()),this.emitKeyword(n(r)),this.emitChar("("),this.emitNoSpace(),this.emitExpressionList(e,i),this.emitChar(")")}emitReturnStmt(e,t){this.emitKeyword("return"),this.emitSpace(),this.emitExpression(e,t.expr),this.emitChar(";")}emitExpressionStmt(e,t){this.emitExpression(e,t.expr),this.emitChar(";")}emitLocalVariable(e,t){this.emitVariable(e,t),this.emitChar(";")}emitGlobalVariable(e,t){e.has(t.name)||(e.add(t.name),this.begin(),this.emitVariable(e,t),this.emitChar(";"),this.end())}emitComplexField(e,t){console.assert(t.instructionType===c.rO.k_VariableDecl),this.emitVariable(e,t),this.emitChar(";")}emitDeclStmt(e,t){t.declList.forEach((t=>{console.assert(t.instructionType===c.rO.k_VariableDecl),this.emitLocalVariable(e,t)}))}emitStmt(e,t){switch(t.instructionType){case c.rO.k_DeclStmt:this.emitDeclStmt(e,t);break;case c.rO.k_ExprStmt:this.emitExpressionStmt(e,t);break;case c.rO.k_ReturnStmt:this.emitReturnStmt(e,t);break;case c.rO.k_SemicolonStmt:this.emitChar(";");break;case c.rO.k_IfStmt:this.emitIfStmt(e,t);break;case c.rO.k_StmtBlock:this.emitBlock(e,t);break;case c.rO.k_ForStmt:this.emitForStmt(e,t);break;case c.rO.k_BreakStmt:this.emitBreakStmt(e,t);break;default:this.emitLine(`/* ... unsupported stmt '${t.instructionName}' .... */`),console.warn(`unknown stmt found: '${t.instructionName}'`)}}emitBlock(e,t){this.emitChar("{"),this.push(),t.stmtList.forEach((t=>(this.emitStmt(e,t),this.emitNewline()))),this.pop(),this.emitChar("}")}emitPass(e,t){this.emitKeyword("pass"),t.name&&this.emitKeyword(t.name),this.emitNewline(),this.emitChar("{"),this.push(),this.emitPassBody(e,t),this.pop(),this.emitChar("}"),this.emitNewline()}emitPassBody(e,t){if(t.vertexShader&&(this.emitFunction(e,t.vertexShader),this.emitKeyword("VertexShader"),this.emitKeyword("="),this.emitKeyword("compile"),this.emitKeyword(t.vertexShader.name),this.emitChar("()"),this.emitChar(";"),this.emitNewline()),t.pixelShader&&(this.emitFunction(e,t.pixelShader),this.emitKeyword("PixelShader"),this.emitKeyword("="),this.emitKeyword("compile"),this.emitKeyword(t.pixelShader.name),this.emitChar("()"),this.emitChar(";"),this.emitNewline()),t.renderStates)for(let e in t.renderStates){const n=t.renderStates[e];n!=h.m.UNDEF&&(this.emitKeyword(p.H[Number(e)]),this.emitChar("="),this.emitKeyword(h.m[n]),this.emitChar(";"),this.emitNewline())}this.emitNewline()}emit(e,t){if(!t)return this.emitLine("/* ... empty instruction .... */"),this;if(i.NQ.isExpression(t))return this.emitExpression(e,t),this;if(i.NQ.isStatement(t))return this.emitStmt(e,t),this;switch(t.instructionType){case c.rO.k_FunctionDecl:this.emitFunction(e,t);break;case c.rO.k_CbufferDecl:this.emitCbuffer(e,t);break;case c.rO.k_VariableDecl:this.emitGlobalVariable(e,t);break;case c.rO.k_Collector:this.emitCollector(e,t);break;case c.rO.k_TypeDecl:this.emitTypeDecl(e,t);break;case c.rO.k_TypedefDecl:this.emitTypedef(e,t);break;case c.rO.k_ComplexType:case c.rO.k_VariableType:this.emitComplexTypeDecl(e,t);break;default:this.emitLine(`/* ... unsupported instruction '${t.instructionName}' .... */`),(0,r.hu)(!1,`unsupported instruction found: ${t.instructionName}`)}return this}static translate(e,t=new T){return _.cEmitter.emit(t,e).toString()}static translateDocument(e,t=new T){return(0,r.Ft)(e)||(0,r.Ft)(e.root)?"":_.translate(e.root,t)}}_.cEmitter=new _({omitEmptyParams:!0});var E=n("jeW/"),x=n("rs/O"),S=n("O1LO"),k=n("F8nM");const b=!1,N="template";function v(e){const t=e.match(/^((0x[a-fA-F0-9]{1,8}?|[0-9]+)(e([+-]?[0-9]+))?)([ulUL]*)$/);(0,r.hu)(t,`cannot parse uint literal: ${e}`);const n=-1===t[5].toLowerCase().indexOf("u"),i=Number(t[4]||"0"),s=Number(t[2]);(0,r.hu)(!Number.isNaN(s));return{signed:n,exp:i,base:s,heximal:"x"===e[1]}}function R(e,t){let n=e.findType(t);return(0,r.hu)(!n||n.instructionType===c.rO.k_SystemType),n}function C(e,...t){let n,r,i,s,o,l;if([n,r,i,s,o,l]=t,R(e,n))return console.error(`type already exists: ${n}`),null;const c=new a.F({scope:e,name:n,elementType:i,length:s,fields:o,size:r,methods:l});return e.addType(c),c}function w(e,t,n){e.addTypeAlias(t,n)}function O(e,t,n,i){for(let a in n){const c=R(e,i+(a.length>1?a.length.toString():""));(0,r.hu)(c);const u=new s.x({scope:e,name:a}),p=new l.L({scope:e,type:c,writable:n[a]});t.push(new o.D({scope:e,id:u,type:p}))}}function P(e,t={},n=0){if(n>=4)return t;if(0===n){for(let n=0;n<e.length;n++)t[e[n]]=!0;n=1}const r=Object.keys(t);for(let n=0;n<e.length;n++)for(let i=0;i<r.length;i++)-1!==r[i].indexOf(e[n])?t[r[i]+e[n]]=!1:t[r[i]+e[n]]=!1!==t[r[i]];return P(e,t,++n)}function I(e){return e.split(" ").slice(-1)[0]===N}function A(e,t,n=null){(0,r.hu)(n!==N);const i=(n?t.replace(N,n):t).split(" "),s=i.slice(-1)[0],a=R(e,s),o=i.slice(0,-1);return(0,r.hu)(null!==a),o.forEach((e=>(0,r.hu)(-1!==["in","out","inout"].indexOf(e)))),{type:a,usages:o,hash:s}}const F={};function L(e){throw new Error(e)}function D(e,t={}){L(E.g[e])}const U=2,K=256;function B(e,t,n,r,i){const a=r.map(((t,n)=>new o.D({type:new l.L({type:t.type,usages:t.usages,scope:e}),id:new s.x({name:`p${n}`,scope:e}),scope:e}))),c=new l.L({type:t.type,usages:t.usages,scope:e}),u=!!(i&U),p=!!(1&i),h=[];!!(i&K)&&h.push(new x.o({scope:e,name:"extern"}));const d=new s.x({scope:e,name:n}),m=new S.Y({scope:e,returnType:c,id:d,paramList:a}),f=new k.h({scope:e,def:m,pixel:u,vertex:p,attrs:h});e.addFunction(f)}function W(e,t,n,i,s,a=1|U){if((0,r.Ft)(s)){I(n)&&L("Bad return type(TEMPLATE_TYPE) for system function '"+t+"'.");let r=t+"(",s=A(e,n),o=[];for(let n=0;n<i.length;n++)if(I(i[n]))L("Bad argument type(TEMPLATE_TYPE) for system function '"+t+"'.");else{const t=A(e,i[n]);o.push(t),r+=t.hash+","}r+=")",F[r]&&D(E.g.SystemFunctionRedefinition,{funcName:r}),B(e,s,t,o,a),F[r]=!0}else for(let r=0;r<s.length;r++){let o=t+"(",l=A(e,n,s[r]),c=[];for(let t=0;t<i.length;t++){const n=A(e,i[t],s[r]);c.push(n),o+=n.hash+","}o+=")",F[o]&&D(E.g.SystemFunctionRedefinition,{funcName:o}),B(e,l,t,c,a),F[o]=!0}}const z=["bool","int","uint","half","float"],V=["int","uint"],M=["float"],$=["int","int2","int3","int4","int2x2","int2x3","int2x4","int3x2","int3x3","int3x4","int4x2","int4x3","int4x4"],q=["uint","uint2","uint3","uint4","uint2x2","uint2x3","uint2x4","uint3x2","uint3x3","uint3x4","uint4x2","uint4x3","uint4x4"],H=["half","half2","half3","half4","half2x2","half2x3","half2x4","half3x2","half3x3","half3x4","half4x2","half4x3","half4x4"],G=["float","float2","float3","float4","float2x2","float2x3","float2x4","float3x2","float3x3","float3x4","float4x2","float4x3","float4x4"],j=["bool","bool2","bool3","bool4","bool2x2","bool2x3","bool2x4","bool3x2","bool3x3","bool3x4","bool4x2","bool4x3","bool4x4"],J=["bool2","bool3","bool4","int2","int3","int4","uint2","uint3","uint4","half2","half3","half4","float2","float3","float4"],Q=["bool2x2","bool2x3","bool2x4","bool3x2","bool3x3","bool3x4","bool4x2","bool4x3","bool4x4","int2x2","int2x3","int2x4","int3x2","int3x3","int3x4","int4x2","int4x3","int4x4","uint2x2","uint2x3","uint2x4","uint3x2","uint3x3","uint3x4","uint4x2","uint4x3","uint4x4","half2x2","half2x3","half2x4","half3x2","half3x3","half3x4","half4x2","half4x3","half4x4","float2x2","float2x3","float2x4","float3x2","float3x3","float3x4","float4x2","float4x3","float4x4"],X=[...z,...J,...Q],Y=["RWTexture1D","RWTexture2D","RWTexture3D","RWBuffer","RWStructuredBuffer","AppendStructuredBuffer"],Z=["Texture1D","Texture2D","Texture3D","TextureCube","Texture2DArray","TextureCubeArray","RWTexture1D","RWTexture2D","RWTexture3D"],ee=["Buffer","RWBuffer","RWStructuredBuffer","AppendStructuredBuffer","StructuredBuffer"],te=["SamplerState","SamplerComparisonState"],ne="BlendState",re="DepthStencilState",ie="RasterizerState",se=e=>e.match(/([\w][\w\d]+)(<[\w][\w\d]+>)?/)[1],ae=e=>Y.includes(se(e.name)),oe=e=>Z.includes(se(e.name)),le=e=>ee.includes(se(e.name)),ce=e=>te.includes(e.name),ue=e=>[ne].includes(e.name),pe=e=>[re].includes(e.name),he=e=>[ie].includes(e.name),de=e=>[ne,re,ie].includes(e.name),me=e=>X.includes(i.V5.signature(e)),fe=e=>J.includes(i.V5.signature(e)),ge=e=>Q.includes(i.V5.signature(e)),ye=e=>z.includes(i.V5.signature(e)),Te=e=>V.includes(i.V5.signature(e)),_e=e=>M.includes(i.V5.signature(e)),Ee=e=>$.includes(i.V5.signature(e)),xe=e=>q.includes(i.V5.signature(e)),Se=e=>j.includes(i.V5.signature(e)),ke=e=>H.includes(i.V5.signature(e)),be=e=>G.includes(i.V5.signature(e));function Ne(e){let t=null,n=-1;const i=e.semantic;if(i){const e=i.match(/^register\(([utbs]{1})([\d]+)\)$/);e&&(t=e[1],n=Number(e[2]))}return ae(e.type)&&((0,r.hu)(null===t||"u"===t),t="u"),oe(e.type)&&((0,r.hu)(null===t||"t"===t),t="t"),ce(e.type)&&((0,r.hu)(null===t||"s"===t),t="s"),e.instructionType===c.rO.k_CbufferDecl&&((0,r.hu)(null===t||"b"===t),t="b"),{type:t,index:n}}},"jeW/":(e,t,n)=>{var r;n.d(t,{g:()=>r}),function(e){e[e.SystemTypeRedefinition=2202]="SystemTypeRedefinition",e[e.TypeRedefinition=2203]="TypeRedefinition",e[e.VariableRedefinition=2204]="VariableRedefinition",e[e.SystemVariableRedefinition=2205]="SystemVariableRedefinition",e[e.FunctionRedifinition=2206]="FunctionRedifinition",e[e.CbufferRedefinition=2207]="CbufferRedefinition",e[e.SystemFunctionRedefinition=2208]="SystemFunctionRedefinition",e[e.UnsupportedTypeDecl=2209]="UnsupportedTypeDecl",e[e.UnsupportedExpr=2210]="UnsupportedExpr",e[e.UnknownVarName=2211]="UnknownVarName",e[e.UnknownInstruction=2212]="UnknownInstruction",e[e.InvalidArithmeticOperation=2213]="InvalidArithmeticOperation",e[e.InvalidArithmeticAssigmentOperation=2214]="InvalidArithmeticAssigmentOperation",e[e.InvalidAssigmentOperation=2215]="InvalidAssigmentOperation",e[e.InvalidBitwiseOperation=2216]="InvalidBitwiseOperation",e[e.InvalidLeftHandSideInAssignment=2217]="InvalidLeftHandSideInAssignment",e[e.InvalidRelationalOperation=2218]="InvalidRelationalOperation",e[e.InvalidLogicOperation=2219]="InvalidLogicOperation",e[e.InvalidConditionType=2220]="InvalidConditionType",e[e.InvalidConditonValueTypes=2221]="InvalidConditonValueTypes",e[e.InvalidCastTypeUsage=2222]="InvalidCastTypeUsage",e[e.InvalidCastTypeNotBase=2223]="InvalidCastTypeNotBase",e[e.InvalidCastUnknownType=2224]="InvalidCastUnknownType",e[e.InvalidUnaryOperation=2225]="InvalidUnaryOperation",e[e.InvalidPostfixNotArray=2226]="InvalidPostfixNotArray",e[e.InvalidPostfixNotIntIndex=2227]="InvalidPostfixNotIntIndex",e[e.InvalidPostfixNotField=2228]="InvalidPostfixNotField",e[e.InvalidPostfixArithmetic=2229]="InvalidPostfixArithmetic",e[e.InvalidComplexNotFunction=2230]="InvalidComplexNotFunction",e[e.InvalidComplexNotType=2231]="InvalidComplexNotType",e[e.InvalidComplexNotConstructor=2232]="InvalidComplexNotConstructor",e[e.InvalidCompileNotFunction=2233]="InvalidCompileNotFunction",e[e.InvalidCompileFunctionNotValid=2234]="InvalidCompileFunctionNotValid",e[e.FunctionRedefinition=2235]="FunctionRedefinition",e[e.InvalidWhileCondition=2236]="InvalidWhileCondition",e[e.InvalidDoWhileCondition=2237]="InvalidDoWhileCondition",e[e.InvalidIfCondition=2238]="InvalidIfCondition",e[e.InvalidForInitExpr=2239]="InvalidForInitExpr",e[e.InvalidForInitEmptyIterator=2240]="InvalidForInitEmptyIterator",e[e.InvalidForConditionEmpty=2241]="InvalidForConditionEmpty",e[e.InvalidForConditionRelation=2242]="InvalidForConditionRelation",e[e.InvalidForStepEmpty=2243]="InvalidForStepEmpty",e[e.InvalidForStepOperator=2244]="InvalidForStepOperator",e[e.InvalidForStepExpr=2245]="InvalidForStepExpr",e[e.InvalidNewFieldForStructName=2246]="InvalidNewFieldForStructName",e[e.InvalidNewFieldForStructSematic=2247]="InvalidNewFieldForStructSematic",e[e.InvalidNewAnnotationVar=2248]="InvalidNewAnnotationVar",e[e.InvalidFunctionParameterDefenitionDefaultNeeded=2249]="InvalidFunctionParameterDefenitionDefaultNeeded",e[e.CannotChooseFunction=2250]="CannotChooseFunction",e[e.InvalidFuncDefenitionReturnType=2251]="InvalidFuncDefenitionReturnType",e[e.InvalidSystemFunctionReturnType=2252]="InvalidSystemFunctionReturnType",e[e.InvalidTypeNameNotType=2253]="InvalidTypeNameNotType",e[e.InvalidTypeNameTemplateNotFound=2254]="InvalidTypeNameTemplateNotFound",e[e.InvalidTypeScope=2255]="InvalidTypeScope",e[e.CannotProduceType=2256]="CannotProduceType",e[e.InvalidTypeVectorMatrix=2257]="InvalidTypeVectorMatrix",e[e.TechniqueNameRedefinition=2258]="TechniqueNameRedefinition",e[e.InvalidFunctionRecursionNotAllowed=2259]="InvalidFunctionRecursionNotAllowed",e[e.InvalidFunctionImplementationNotFound=2260]="InvalidFunctionImplementationNotFound",e[e.FunctionIsNotCompatibleWithVertexShader=2261]="FunctionIsNotCompatibleWithVertexShader",e[e.FunctionIsNotCompatibleWithPixelShader=2262]="FunctionIsNotCompatibleWithPixelShader",e[e.InvalidReturnStmtVoid=2263]="InvalidReturnStmtVoid",e[e.InvalidReturnStmtEmpty=2264]="InvalidReturnStmtEmpty",e[e.InvalidReturnStmtTypesNotEqual=2265]="InvalidReturnStmtTypesNotEqual",e[e.InvalidFunctionReturnType=2266]="InvalidFunctionReturnType",e[e.InvalidFunctionParameterUsage=2267]="InvalidFunctionParameterUsage",e[e.InvalidTypeForWriting=2268]="InvalidTypeForWriting",e[e.InvalidTypeForReading=2269]="InvalidTypeForReading",e[e.InvalidExprIsNotLValue=2270]="InvalidExprIsNotLValue",e[e.InvalidVariableInitializing=2271]="InvalidVariableInitializing",e[e.InvalidVariableInitializingEx=2272]="InvalidVariableInitializingEx",e[e.UnsupportedStateIndex=2273]="UnsupportedStateIndex",e[e.InvalidSamplerTexture=2274]="InvalidSamplerTexture",e[e.CannotCalcPadding=2275]="CannotCalcPadding",e[e.ImportedComponentNotExists=2276]="ImportedComponentNotExists",e[e.InvalidFunctionReturnStmtNotFound=2277]="InvalidFunctionReturnStmtNotFound",e[e.UnsupportedProvideAs=2278]="UnsupportedProvideAs",e[e.UnreachableCode=2279]="UnreachableCode",e[e.OperatorCannotBeUsedWithGivenLValue=2280]="OperatorCannotBeUsedWithGivenLValue",e[e.PartFx_VertexShaderParametersMismatch=2281]="PartFx_VertexShaderParametersMismatch",e[e.PartFx_InvalidSpawnStmtInitializerNotFound=2282]="PartFx_InvalidSpawnStmtInitializerNotFound",e[e.PartFx_DrawOpOnlyAllowedWithinUpdateRoutine=2283]="PartFx_DrawOpOnlyAllowedWithinUpdateRoutine"}(r||(r={}))},AW2x:(e,t,n)=>{var r;n.d(t,{S:()=>r}),function(e){e[e.UnsupportedRenderStateTypeUsed=3e3]="UnsupportedRenderStateTypeUsed",e[e.IncompleteTechnique=3001]="IncompleteTechnique",e[e.IncompletePass=3002]="IncompletePass",e[e.UselessPassState=3003]="UselessPassState",e[e.EmptySemicolon=3004]="EmptySemicolon",e[e.InvalidCbufferRegister=3005]="InvalidCbufferRegister",e[e.ImplicitTypeConversion=3006]="ImplicitTypeConversion",e[e.ImplicitTypeTruncation=3007]="ImplicitTypeTruncation",e[e.Deprecated=3008]="Deprecated",e[e.PartFx_SortingCannotBeApplied=3009]="PartFx_SortingCannotBeApplied",e[e.PartFx_PresetPropertyHasNotBeenFound=3010]="PartFx_PresetPropertyHasNotBeenFound",e[e.PartFx_RenderPassWasNotFound=3011]="PartFx_RenderPassWasNotFound",e[e.PartFx_EmitterPersistentDataMustBeMarkedAsInout=3012]="PartFx_EmitterPersistentDataMustBeMarkedAsInout",e[e.ExternCall=3013]="ExternCall"}(r||(r={}))},"HS1/":(e,t,n)=>{var r;n.d(t,{m:()=>r}),function(e){e[e.UNDEF=0]="UNDEF",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.ZERO=3]="ZERO",e[e.ONE=4]="ONE",e[e.SRCCOLOR=5]="SRCCOLOR",e[e.INVSRCCOLOR=6]="INVSRCCOLOR",e[e.SRCALPHA=7]="SRCALPHA",e[e.INVSRCALPHA=8]="INVSRCALPHA",e[e.DESTALPHA=9]="DESTALPHA",e[e.INVDESTALPHA=10]="INVDESTALPHA",e[e.DESTCOLOR=11]="DESTCOLOR",e[e.INVDESTCOLOR=12]="INVDESTCOLOR",e[e.SRCALPHASAT=13]="SRCALPHASAT",e[e.NONE=14]="NONE",e[e.CW=15]="CW",e[e.CCW=16]="CCW",e[e.FRONT=17]="FRONT",e[e.BACK=18]="BACK",e[e.FRONT_AND_BACK=19]="FRONT_AND_BACK",e[e.NEVER=20]="NEVER",e[e.LESS=21]="LESS",e[e.EQUAL=22]="EQUAL",e[e.LESSEQUAL=23]="LESSEQUAL",e[e.GREATER=24]="GREATER",e[e.NOTEQUAL=25]="NOTEQUAL",e[e.GREATEREQUAL=26]="GREATEREQUAL",e[e.ALWAYS=27]="ALWAYS",e[e.FUNCADD=28]="FUNCADD",e[e.FUNCSUBTRACT=29]="FUNCSUBTRACT",e[e.FUNCREVERSESUBTRACT=30]="FUNCREVERSESUBTRACT",e[e.LINELIST=31]="LINELIST",e[e.LINESTRIP=32]="LINESTRIP",e[e.TRIANGLELIST=33]="TRIANGLELIST",e[e.TRAINGLESTRIP=34]="TRAINGLESTRIP",e[e.POINTLIST=35]="POINTLIST"}(r||(r={}))},Y4FD:(e,t,n)=>{var r;n.d(t,{H:()=>r}),function(e){e[e.BLENDENABLE=0]="BLENDENABLE",e[e.CULLFACEENABLE=1]="CULLFACEENABLE",e[e.ZENABLE=2]="ZENABLE",e[e.ZWRITEENABLE=3]="ZWRITEENABLE",e[e.DITHERENABLE=4]="DITHERENABLE",e[e.SCISSORTESTENABLE=5]="SCISSORTESTENABLE",e[e.STENCILTESTENABLE=6]="STENCILTESTENABLE",e[e.POLYGONOFFSETFILLENABLE=7]="POLYGONOFFSETFILLENABLE",e[e.CULLFACE=8]="CULLFACE",e[e.FRONTFACE=9]="FRONTFACE",e[e.SRCBLENDCOLOR=10]="SRCBLENDCOLOR",e[e.DESTBLENDCOLOR=11]="DESTBLENDCOLOR",e[e.SRCBLENDALPHA=12]="SRCBLENDALPHA",e[e.DESTBLENDALPHA=13]="DESTBLENDALPHA",e[e.BLENDEQUATIONCOLOR=14]="BLENDEQUATIONCOLOR",e[e.BLENDEQUATIONALPHA=15]="BLENDEQUATIONALPHA",e[e.ZFUNC=16]="ZFUNC",e[e.ALPHABLENDENABLE=17]="ALPHABLENDENABLE",e[e.ALPHATESTENABLE=18]="ALPHATESTENABLE",e[e.SRCBLEND=19]="SRCBLEND",e[e.DESTBLEND=20]="DESTBLEND",e[e.BLENDFUNC=21]="BLENDFUNC",e[e.BLENDFUNCSEPARATE=22]="BLENDFUNCSEPARATE",e[e.BLENDEQUATION=23]="BLENDEQUATION",e[e.BLENDEQUATIONSEPARATE=24]="BLENDEQUATIONSEPARATE",e[e.PRIMITIVETOPOLOGY=25]="PRIMITIVETOPOLOGY"}(r||(r={}))},DIkA:(e,t,n)=>{var r;n.d(t,{D:()=>r}),function(e){e[e.k_Warning=0]="k_Warning",e[e.k_Error=1]="k_Error"}(r||(r={}))},vIQR:(e,t,n)=>{var r,i,s,a,o,l;n.d(t,{SR:()=>o,rO:()=>r,vj:()=>l}),function(e){e[e.k_Instruction=0]="k_Instruction",e[e.k_Id=1]="k_Id",e[e.k_Provide=2]="k_Provide",e[e.k_Collector=3]="k_Collector",e[e.k_Keyword=4]="k_Keyword",e[e.k_Simple=5]="k_Simple",e[e.k_SamplerState=6]="k_SamplerState",e[e.k_Attribute=7]="k_Attribute",e[e.k_Annotation=8]="k_Annotation",e[e.k_UsageType=9]="k_UsageType",e[e.k_Typed=10]="k_Typed",e[e.k_VariableType=11]="k_VariableType",e[e.k_SystemType=12]="k_SystemType",e[e.k_ComplexType=13]="k_ComplexType",e[e.k_ProxyType=14]="k_ProxyType",e[e.k_Expr=15]="k_Expr",e[e.k_IdExpr=16]="k_IdExpr",e[e.k_IntExpr=17]="k_IntExpr",e[e.k_FloatExpr=18]="k_FloatExpr",e[e.k_BoolExpr=19]="k_BoolExpr",e[e.k_StringExpr=20]="k_StringExpr",e[e.k_NullExpr=21]="k_NullExpr",e[e.k_ArithmeticExpr=22]="k_ArithmeticExpr",e[e.k_AssignmentExpr=23]="k_AssignmentExpr",e[e.k_BitwiseExpr=24]="k_BitwiseExpr",e[e.k_RelationalExpr=25]="k_RelationalExpr",e[e.k_LogicalExpr=26]="k_LogicalExpr",e[e.k_ConditionalExpr=27]="k_ConditionalExpr",e[e.k_CastExpr=28]="k_CastExpr",e[e.k_UnaryExpr=29]="k_UnaryExpr",e[e.k_PostfixIndexExpr=30]="k_PostfixIndexExpr",e[e.k_PostfixPointExpr=31]="k_PostfixPointExpr",e[e.k_PostfixArithmeticExpr=32]="k_PostfixArithmeticExpr",e[e.k_ComplexExpr=33]="k_ComplexExpr",e[e.k_FunctionCallExpr=34]="k_FunctionCallExpr",e[e.k_ConstructorCallExpr=35]="k_ConstructorCallExpr",e[e.k_CompileExpr=36]="k_CompileExpr",e[e.k_CompileShader11Expr=37]="k_CompileShader11Expr",e[e.k_InitExpr=38]="k_InitExpr",e[e.k_StateBlockExpr=39]="k_StateBlockExpr",e[e.k_SamplerStateBlockExpr=40]="k_SamplerStateBlockExpr",e[e.k_Decl=41]="k_Decl",e[e.k_TypeDecl=42]="k_TypeDecl",e[e.k_TypedefDecl=43]="k_TypedefDecl",e[e.k_VariableDecl=44]="k_VariableDecl",e[e.k_StructDecl=45]="k_StructDecl",e[e.k_FunctionDecl=46]="k_FunctionDecl",e[e.k_SystemFunctionDecl=47]="k_SystemFunctionDecl",e[e.k_FunctionDef=48]="k_FunctionDef",e[e.k_PassDecl=49]="k_PassDecl",e[e.k_TechniqueDecl=50]="k_TechniqueDecl",e[e.k_Technique11Decl=51]="k_Technique11Decl",e[e.k_CbufferDecl=52]="k_CbufferDecl",e[e.k_Stmt=53]="k_Stmt",e[e.k_ExprStmt=54]="k_ExprStmt",e[e.k_BreakStmt=55]="k_BreakStmt",e[e.k_WhileStmt=56]="k_WhileStmt",e[e.k_ForStmt=57]="k_ForStmt",e[e.k_IfStmt=58]="k_IfStmt",e[e.k_DeclStmt=59]="k_DeclStmt",e[e.k_ReturnStmt=60]="k_ReturnStmt",e[e.k_SemicolonStmt=61]="k_SemicolonStmt",e[e.k_StmtBlock=62]="k_StmtBlock",e[e.k_PartFxDecl=63]="k_PartFxDecl",e[e.k_PartFxPass=64]="k_PartFxPass",e[e.k_SpawnStmt=65]="k_SpawnStmt",e[e.k_DrawStmt=66]="k_DrawStmt",e[e.k_PresetDecl=67]="k_PresetDecl",e[e.k_PresetProperty=68]="k_PresetProperty"}(r||(r={})),function(e){e[e.CODE_TARGET_SUPPORT=0]="CODE_TARGET_SUPPORT",e[e.SELF_CONTAINED=1]="SELF_CONTAINED"}(i||(i={})),function(e){e[e.k_Read=0]="k_Read",e[e.k_Write=1]="k_Write",e[e.k_ReadWrite=2]="k_ReadWrite",e[e.k_Undefined=3]="k_Undefined",e[e.k_Default=2]="k_Default"}(s||(s={})),function(e){e[e.k_Header=0]="k_Header",e[e.k_Float=1]="k_Float",e[e.k_Int=2]="k_Int",e[e.k_Bool=3]="k_Bool",e[e.k_Float2=4]="k_Float2",e[e.k_Int2=5]="k_Int2",e[e.k_Bool2=6]="k_Bool2",e[e.k_Float3=7]="k_Float3",e[e.k_Int3=8]="k_Int3",e[e.k_Bool3=9]="k_Bool3",e[e.k_Float4=10]="k_Float4",e[e.k_Int4=11]="k_Int4",e[e.k_Bool4=12]="k_Bool4",e[e.k_Float4x4=13]="k_Float4x4"}(a||(a={})),function(e){e[e.k_System=0]="k_System",e[e.k_Global=1]="k_Global",e[e.k_Default=2]="k_Default",e[e.k_Struct=3]="k_Struct",e[e.k_Cbuffer=4]="k_Cbuffer",e[e.k_Annotation=5]="k_Annotation"}(o||(o={})),function(e){e[e.k_BasicFx=0]="k_BasicFx",e[e.k_PartFx=1]="k_PartFx",e[e.k_Unknown=2]="k_Unknown"}(l||(l={}))},"0mZ+":(e,t,n)=>{n.d(t,{V:()=>l,g:()=>c});var r=n("cOQ3"),i=n("DIkA");function s(e){return`${e.line},${e.column}`}function a(e,t){let n=t.split(".");return n.length>1?a(e[n[0]],n.splice(1).join(".")):e[n[0]]}function o(e,t){return e.replace(/{([a-zA-Z.]+)}/g,((e,n)=>a(t,n)))}class l extends Error{constructor(e,t){super(t.content),Error.captureStackTrace(this,l)}}class c{constructor(e,t){this._name=e,this._codePrefix=(t||"").toUpperCase(),this.reset()}emitException(){throw new l(this,this.getLastError())}reset(){this._entries=[]}resolve(){let e={errors:0,warnings:0,messages:[]};for(let t of this._entries){let n=this.resolveEntry(t);switch(n.category){case i.D.k_Warning:e.warnings++;break;case i.D.k_Error:e.errors++}e.messages.push(n)}return e}resolveEntry(e){let t,n,r,i=null,a=this.resolveFilename(e.category,e.code,e.desc);(t=this.resolveRange(e.category,e.code,e.desc))?(({start:n,end:r}=t),i=function(e){return`${s(e.start)}:${s(e.end)}`}(t)):(n=this.resolvePosition(e.category,e.code,e.desc),i=s(n));let o=`${this.resolveDescription(e.code,e.category,e.desc)}`;return{code:`${this._codePrefix}${e.code}`,category:e.category,content:o,file:a,start:n,end:r}}resolveFilename(e,t,n){return"[unknown]"}resolvePosition(e,t,n){return{file:null,line:0,column:0}}resolveRange(e,t,n){return null}resolveDescription(e,t,n){let i=this.diagnosticMessages();return i?i[e]?(0,r.HD)(i[e])?o(i[e],n):i[e](n):`[no description found for code '${e}']`:(console.error(`Diagnostic messages of '${this._name}' not found.`),"[no description found]")}diagnosticMessages(){return null}error(e,t){this._entries.push({category:i.D.k_Error,code:e,desc:t})}warning(e,t){this._entries.push({category:i.D.k_Warning,code:e,desc:t})}critical(e,t){this.error(e,t),this.emitException()}prettyPrint(){return null}hasErrors(){return this._entries.filter((e=>e.category===i.D.k_Error)).length>0}getLastError(){for(let e=this._entries.length-1;e>=0;--e)if(this._entries[e].category===i.D.k_Error)return this.resolveEntry(this._entries[e]);return null}isEmpty(){return 0===this._entries.length}static mergeReports(e){let t={errors:0,warnings:0,messages:[]};return e.forEach((e=>{e&&(t.errors+=e.errors,t.warnings+=e.warnings,t.messages=t.messages.concat(e.messages))})),t}static stringify(e){return e.messages.map((e=>e.content)).join("\n")}static asRange(e){let t={start:e.start,end:e.end};t.end||(t.end={...t.start});const{start:n,end:r}=t;return r.line==n.line&&r.column==n.column&&(r.column+=1),t}}},z3nI:(e,t,n)=>{function r(e){return null!=e}function i(e){return"string"==typeof e}function s(e){return"number"==typeof e}n.d(t,{$V:()=>r,HD:()=>i,hj:()=>s})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r](s,s.exports,n),s.loaded=!0,s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={};n.r(e),n.d(e,{clear:()=>S,clearAll:()=>y,clearBit:()=>f,clearFlags:()=>b,equal:()=>T,flag:()=>u,isEmpty:()=>N,isEqual:()=>_,isNotEqaul:()=>E,set:()=>x,setAll:()=>g,setBit:()=>m,setFlags:()=>k,testAll:()=>h,testAny:()=>d,testBit:()=>p,totalBits:()=>v,totalSet:()=>R});var t,r,i,s,a,o,l,c=n("cOQ3");!function(e){e[e.k_Default=0]="k_Default",e[e.k_Necessary=1]="k_Necessary",e[e.k_Expose=2]="k_Expose",e[e.k_Skip=3]="k_Skip"}(t||(t={})),function(e){e[e.k_Ok=0]="k_Ok",e[e.k_Error=1]="k_Error"}(r||(r={})),function(e){e[e.k_LR0=0]="k_LR0",e[e.k_LR1=1]="k_LR1",e[e.k_LALR=2]="k_LALR"}(i||(i={})),function(e){e[e.k_Optimize=8]="k_Optimize",e[e.k_DeveloperMode=16]="k_DeveloperMode"}(s||(s={})),function(e){e[e.k_ForceAppendAll=1]="k_ForceAppendAll",e[e.k_AllowExposeMode=2]="k_AllowExposeMode",e[e.k_AllowAddMode=4]="k_AllowAddMode",e[e.k_AllowSkipMode=8]="k_AllowSkipMode",e[e.k_Default=14]="k_Default",e[e.k_Debug=16]="k_Debug"}(a||(a={})),function(e){e[e.k_NumericLiteral=1]="k_NumericLiteral",e[e.k_SinglelineCommentLiteral=2]="k_SinglelineCommentLiteral",e[e.k_MultilineCommentLiteral=3]="k_MultilineCommentLiteral",e[e.k_StringLiteral=4]="k_StringLiteral",e[e.k_PunctuatorLiteral=5]="k_PunctuatorLiteral",e[e.k_WhitespaceLiteral=6]="k_WhitespaceLiteral",e[e.k_EscapeSequence=7]="k_EscapeSequence",e[e.k_NewlineLiteral=8]="k_NewlineLiteral",e[e.k_IdentifierLiteral=9]="k_IdentifierLiteral",e[e.k_KeywordLiteral=10]="k_KeywordLiteral",e[e.K_MacroLiteral=11]="K_MacroLiteral",e[e.k_Unknown=12]="k_Unknown",e[e.k_End=13]="k_End"}(o||(o={})),function(e){e[e.k_Error=100]="k_Error",e[e.k_Shift=101]="k_Shift",e[e.k_Reduce=102]="k_Reduce",e[e.k_Success=103]="k_Success",e[e.k_Ok=104]="k_Ok"}(l||(l={}));var u=e=>1<<e,p=(e,t)=>0!=(e&u(t)),h=(e,t)=>(e&t)==t,d=(e,t)=>0!=(e&t),m=(e,t,n=!0)=>n?e|=u(t):f(e,t),f=(e,t)=>e&~u(t),g=(e,t,n=!0)=>n?e|=t:e&=~t,y=(e,t)=>e&~t,T=(e,t)=>{t},_=(e,t)=>e==t,E=(e,t)=>e!=t,x=(e,t)=>{t},S=e=>{0},k=(e,t)=>e|t,b=(e,t)=>e&~t,N=e=>0==e,v=e=>32,R=e=>{for(var t=0,n=v(e);n;--n)t+=1&e,e>>=1;return t};const C=e,w="END",O="EMPTY",P="UNKNOWN",I="S",A="ERROR",F="$",L="EOF",D="T_TYPE_ID",U="T_NON_TYPE_ID",K="T_MACRO",B="T_MACRO_CONCAT";class W{constructor(e,t,n){this.rule=e,this.pos=t,this.index=0,this.expectedSymbols=new Set,n&&n.forEach((e=>this.addExpected(e)))}isEqual(e,t=i.k_LR0){if(t===i.k_LR0)return this.rule===e.rule&&this.pos===e.pos;if(t===i.k_LR1){if(this.rule!==e.rule||this.pos!==e.pos||this.expectedSymbols.size!==e.expectedSymbols.size)return!1;for(const t of this.expectedSymbols)if(!e.isExpected(t))return!1;return!0}return!1}isParentItem(e){return this.rule===e.rule&&this.pos===e.pos+1}isChildItem(e){return this.rule===e.rule&&this.pos===e.pos-1}symbolName(){const e=this.rule.right;return this.pos===e.length?w:e[this.pos]}isExpected(e){return this.expectedSymbols.has(e)}addExpected(e){return!this.isExpected(e)&&(this.expectedSymbols.add(e),!0)}toString(e=null){const{left:t,right:n}=this.rule;let r=`${t} -> `;if(r+=n.map((t=>W.decodeSymbol(t,e))).map(((e,t)=>t===this.pos?`. ${e}`:`${e}`)).join(" "),this.pos===n.length&&(r+=" . "),this.expectedSymbols){const t=Array.from(this.expectedSymbols).map((t=>W.decodeSymbol(t,e)));t.length&&(r+=", "+t.join(" "))}return r}static decodeSymbol(e,t){return t&&t.get(e)&&e!==t.get(e)?`'${t.get(e)}'`:e}}function z(e,t){return(0,c.hu)(e.file===t.file),{offset:Math.min(e.offset,t.offset),line:Math.min(e.line,t.line),column:Math.min(e.column,t.column),file:e.file}}function V(e,t){return(0,c.hu)(e.file===t.file),{offset:Math.max(e.offset,t.offset),line:Math.max(e.line,t.line),column:Math.max(e.column,t.column),file:e.file}}function M(e,t){return t.start.file!==e.start.file||(t.start.line<e.start.line?e.start={...t.start}:t.start.line===e.start.line&&(e.start=z(t.start,e.start)),t.end.line>e.end.line?e.end={...t.end}:t.end.line===e.end.line&&(e.end=V(t.end,e.end))),e}function $(...e){const t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=e[0].start.file;let i={offset:t,column:t,line:t,file:r},s={offset:n,column:n,line:n,file:r};return e.forEach((e=>i=z(i,e.start))),e.forEach((e=>s=V(s,e.end))),{start:i,end:s}}function q(e,t){if(t){const{start:n,end:r}=e;0===n.line&&(n.column+=t.column),0===r.line&&(r.column+=t.column),n.line+=t.line,r.line+=t.line}return e}const H=(e,t)=>e.start.offset<=t&&e.end.offset>t;var G,j,J=n("0mZ+");!function(e){e[e.UnknownToken=2101]="UnknownToken",e[e.InvalidToken=2102]="InvalidToken"}(G||(G={}));class Q extends J.g{constructor(){super("Lexer Diagnostics","L")}resolveFilename(e,t,n){return n.file}resolveRange(e,t,n){return n.token.loc}diagnosticMessages(){return{[G.UnknownToken]:"Unknown token: {token.value}.",[G.InvalidToken]:"Invalid token: {token.value}."}}}class X{constructor(){this.keywords={},this.punctuators={},this.punctuatorsFirstSymbols={}}addPunctuator(e,t=X.getPunctuatorName(e)){return this.punctuators[e]=t,this.punctuatorsFirstSymbols[e[0]]=!0,t}addKeyword(e,t){return this.keywords[e]=t,t}getTerminalValueByName(e){let t="";for(t in this.punctuators)if(this.punctuators[t]===e)return t;for(t in this.keywords)if(this.keywords[t]===e)return t;return e}isLineTerminator(e){return"\n"===e||"\r"===e||"\u2028"===e||"\u2029"===e}isKeyword(e){return!!this.keywords[e]}isPunctuator(e){return!!this.punctuators[e]}isNumberStart(e,t){return e>="0"&&e<="9"||"."===e&&t>="0"&&t<="9"}isCommentStart(e,t){return"/"===e&&("/"===t||"*"===t)}isStringStart(e){return'"'===e||"'"===e}isPunctuatorStart(e){return!!this.punctuatorsFirstSymbols[e]}isWhiteSpaceStart(e){return" "===e||"\t"===e}isNewlineStart(e){return"\n"===e||"\r"===e}isEscapeSequenceStart(e){return"\\"===e}isIdentifierStart(e){return"_"===e||"$"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"}static getPunctuatorName(e){return"T_PUNCTUATOR_"+e.charCodeAt(0)}}class Y{constructor({engine:e=new X,knownTypes:t=new Set,skipComments:n=!0,allowLineTerminators:r=!1}={}){this.diagnostics=new Q,this.knownTypes=t,this.engine=e,this.config={skipComments:n,allowLineTerminators:r}}getPosition(){return this.pos()}setPosition(e){(0,c.hu)(this.document.uri===e.file),this.index=e.offset,this.lineNumber=e.line,this.columnNumber=e.column}setTextDocument(e){return this.columnNumber=0,this.lineNumber=0,this.index=0,this.document=e,this}getDiagnosticReport(){return this.diagnostics.resolve()}getNextToken(){const e=this.scanToken();return q(e.loc,this.document.offset),e}getNextLine(){const e=this.scanThisLine();return q(e.loc,this.document.offset),e}scanToken(){if(!this.currentChar()){const e=this.pos();return{index:this.index,name:F,value:F,loc:{start:e,end:{...e}}}}switch(this.identityTokenType()){case o.k_NumericLiteral:return this.scanNumber();case o.k_SinglelineCommentLiteral:case o.k_MultilineCommentLiteral:return this.config.skipComments?(this.scanComment(),this.scanToken()):this.scanComment();case o.k_StringLiteral:return this.scanString();case o.k_PunctuatorLiteral:return this.scanPunctuator();case o.k_IdentifierLiteral:return this.scanIdentifier();case o.k_EscapeSequence:return this.scanEscapeSequence();case o.k_NewlineLiteral:return this.config.allowLineTerminators?this.scanLineTerminators():(this.scanLineTerminators(),this.scanToken());case o.k_WhitespaceLiteral:return this.scanWhiteSpace(),this.scanToken();case o.K_MacroLiteral:return this.scanMacro();default:return this.scanInvalid()}}scanThisLine(){let e=this.pos(),t="",n=this.currentChar();for(;n;){if("\\"===n){let e=this.readNextChar();switch("\r"===e&&(e=this.readNextChar()),e){case"\n":n=this.readNextChar(),this.lineNumber++,this.columnNumber=0,t+="\\\n";continue;case"n":n="\n";break;case"t":n="\t";break;default:(0,c.hu)(!1,"unsupported character sequence found")}}else if("\n"===n)break;t+=n,n=this.readNextChar()}return{index:this.index,name:P,value:t,loc:{start:e,end:this.pos()}}}pos(e=0){return{file:this.document.uri,line:this.lineNumber,column:this.columnNumber+e,offset:this.index+e}}emitError(e,t){this.diagnostics.error(e,{file:`${this.document.uri}`,token:t})}identityTokenType(){return this.isIdentifierStart()?o.k_IdentifierLiteral:this.isWhiteSpaceStart()?o.k_WhitespaceLiteral:this.isNewlineStart()?o.k_NewlineLiteral:this.isEscapeSequenceStart()?o.k_EscapeSequence:this.isStringStart()?o.k_StringLiteral:this.isCommentStart()?o.k_SinglelineCommentLiteral:this.isNumberStart()?o.k_NumericLiteral:this.isPunctuatorStart()?o.k_PunctuatorLiteral:this.isMacroStart()?o.K_MacroLiteral:o.k_Unknown}isNumberStart(){return this.engine.isNumberStart(this.currentChar(),this.nextChar())}isCommentStart(){return this.engine.isCommentStart(this.currentChar(),this.nextChar())}isStringStart(){return this.engine.isStringStart(this.currentChar())}isPunctuatorStart(){return this.engine.isPunctuatorStart(this.currentChar())}isWhiteSpaceStart(){return this.engine.isWhiteSpaceStart(this.currentChar())}isNewlineStart(){return this.engine.isNewlineStart(this.currentChar())}isEscapeSequenceStart(){return this.engine.isEscapeSequenceStart(this.currentChar())}isMacroStart(){return"#"===this.currentChar()}isIdentifierStart(){return this.engine.isIdentifierStart(this.currentChar())}nextChar(){return this.document.source[this.index+1]}currentChar(){return this.document.source[this.index]}readNextChar(){return this.index++,this.columnNumber++,this.document.source[this.index]}scanEscapeSequence(){let e=this.readNextChar();return"\r"===e&&(e=this.readNextChar()),(0,c.hu)("\n"===e,"unsupported escape sequence found"),this.lineNumber++,this.columnNumber=0,this.readNextChar(),this.scanToken()}scanString(){let e=this.currentChar(),t=e,n="",r=e,i=!1,s=this.pos();for(;n=this.readNextChar(),n;){if(t+=n,n===e&&"\\"!==r){i=!0,this.readNextChar();break}r=n}if(i)return{index:this.index,name:"T_STRING",value:t,loc:{start:s,end:this.pos()}};{n||(n=L),t+=n;const e={index:this.index,type:o.k_StringLiteral,value:t,loc:{start:s,end:this.pos()}};return this.emitError(G.InvalidToken,e),Y.makeUnknownToken(e)}}scanInvalid(){const e=this.pos();let t="";for(;this.identityTokenType()===o.k_Unknown&&this.index<this.document.source.length;)t+=this.currentChar(),this.readNextChar();const n={index:this.index,name:P,value:t,loc:{start:e,end:this.pos()}};return this.emitError(G.UnknownToken,n),n}scanPunctuator(){let e,t=this.currentChar(),n=this.pos();for(;e=this.readNextChar(),e;)if(t+=e,!this.engine.isPunctuator(t)){t=t.slice(0,t.length-1);break}return{index:this.index,name:this.engine.punctuators[t],value:t,loc:{start:n,end:this.pos()}}}scanNumber(){let e=this.currentChar(),t="",n=!1,r=!1,i=!1,s=e,a=!1,l=!1,c=!1,u=this.pos();for("."===e&&(t+=0,n=!0),t+=e;;){if(e=this.readNextChar(),"."===e){if(n||c||i||r)break;n=!0}else if("e"===e){if(l||c||i)break;l=!0}else if("u"===e||"U"===e){if(n||c)break;c=!0}else if("l"===e||"L"===e){if(n||i)break;i=!0}else if("x"===e){if(c||i||l||n)break;r=!0}else if("+"!==e&&"-"!==e||"e"!==s){if("f"===e&&(n||l)){if(n=!0,e=this.readNextChar(),e>="a"&&e<="z"||e>="A"&&e<="Z")break;a=!0;break}if(e>="a"&&e<="z"||e>="A"&&e<="Z"){if(!r)break}else if(!(e>="0"&&e<="9")||!e||c||i){(l&&"+"!==s&&"-"!==s&&"e"!==s||!l)&&(a=!0);break}}else;t+=e,s=e}if(a){let e=n?"T_FLOAT":"T_UINT";return{index:this.index,name:e,value:t,loc:{start:u,end:this.pos()}}}{e||(e=L),t+=e;const n={index:this.index,type:o.k_NumericLiteral,value:t,loc:{start:u,end:this.pos()}};return this.emitError(G.InvalidToken,n),Y.makeUnknownToken(n)}}scanMacro(){const e=this.pos(),t=this.nextChar();if(t>="a"&&t<="z"||t>="A"&&t<="Z"){this.readNextChar();const t=this.scanIdentifier();return{index:this.index,name:K,value:`#${t.value}`,loc:{start:e,end:this.pos()}}}return"#"===t?(this.readNextChar(),this.readNextChar(),{index:this.index,name:B,value:"##",loc:{start:e,end:this.pos()}}):((0,c.hu)(!1,`unsupported macro found: ${this.document.source.substr(this.index,20)}...`),this.readNextChar(),{index:this.index,name:P,value:"#",loc:{start:e,end:this.pos()}})}scanIdentifier(){let e=this.currentChar(),t=e,n=this.pos(),r=!1;for(;;){if(e=this.readNextChar(),!e){r=!0;break}if(!("_"===e||"$"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9")){r=!0;break}t+=e}if(r){if(this.engine.isKeyword(t))return{index:this.index,name:this.engine.keywords[t],value:t,loc:{start:n,end:this.pos()}};{let e=this.knownTypes.has(t)?D:U;return{index:this.index,name:e,value:t,loc:{start:n,end:this.pos()}}}}{e||(e=L),t+=e;const r={index:this.index,type:o.k_IdentifierLiteral,value:t,loc:{start:n,end:this.pos()}};return this.emitError(G.InvalidToken,r),Y.makeUnknownToken(r)}}scanLineTerminators(){let e=this.currentChar(),t="",n=this.pos();for(;e&&this.engine.isLineTerminator(e);)t+=e,"\r"===e&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,e=this.readNextChar(),this.columnNumber=0;return{index:this.index,name:"T_LINE_TERMINATOR",value:t,loc:{start:n,end:this.pos()}}}scanWhiteSpace(){let e=this.currentChar();for(;e;){if("\t"===e)this.columnNumber+=0;else if(" "!==e)break;e=this.readNextChar()}return!0}scanComment(){let e=this.currentChar(),t=this.readNextChar(),n=this.pos();if(e+=t,"/"===t){for(;t=this.readNextChar(),t;){if(this.engine.isLineTerminator(t)){"\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.readNextChar(),this.columnNumber=0;break}e+=t}return{index:this.index,type:o.k_SinglelineCommentLiteral,value:e,loc:{start:n,end:this.pos()}}}{let n=t,r=!1,i=this.pos();for(;t=this.readNextChar(),t;){if(e+=t,"/"===t&&"*"===n){r=!0,this.readNextChar();break}this.engine.isLineTerminator(t)&&("\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.columnNumber=-1),n=t}if(r)return{index:this.index,type:o.k_MultilineCommentLiteral,value:e,loc:{start:i,end:this.pos()}};{t||(t=L),e+=t;const n={index:this.index,type:o.k_MultilineCommentLiteral,value:e,loc:{start:i,end:this.pos()}};return this.emitError(G.InvalidToken,n),Y.makeUnknownToken(n)}}}static makeUnknownToken(e){return{...e,type:void 0,name:P,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}}class Z{constructor(){this.nextStates={},this.index=0,this.items=[],this.numBaseItems=0,this.numOtherItems=0}eachItem(e){for(let t=0;t<this.items.length;++t)e(this.items[t],t)}eachBaseItem(e){for(let t=0;t<this.numBaseItems;++t)e(this.items[t],t)}isExpected(e){return!!this.items.find((t=>t.isExpected(e)))}hasItem(e,t){return this.items.find((n=>n.isEqual(e,t)))||null}hasParentItem(e){return this.items.find((t=>t.isParentItem(e)))||null}hasChildItem(e){return this.items.find((t=>t.isChildItem(e)))||null}hasRule(e,t){for(let n=0;n<this.numBaseItems;++n){const r=this.items[n];if(r.rule===e&&r.pos===t)return!0}return!1}isEmpty(){return!this.items.length}isEqual(e,t){if(this.numBaseItems!==e.numBaseItems)return!1;for(let n=0;n<this.numBaseItems;++n){const r=this.items[n];let i=!1;for(let n=0;n<e.numBaseItems;++n){const s=e.items[n];if(r.isEqual(s,t)){i=!0;break}}if(!i)return!1}return!0}push(e){0===this.items.length||e.pos>0?((0,c.hu)(0===this.numOtherItems),this.numBaseItems++):this.numOtherItems++,this.items.push(e)}tryPush_LR0(e,t){const n=this.items.find((n=>n.rule===e&&n.pos===t));if(n)return!1;const r=new W(e,t);return this.push(r),!0}tryPush_LR(e,t,n){const r=this.items.find((n=>n.rule===e&&n.pos===t));if(r)return r.addExpected(n);const i=new W(e,t,[n]);return this.push(i),!0}addNextState(e,t){return!this.nextStates[e]&&(this.nextStates[e]=t,!0)}deleteNotBase(){this.items.length=this.numBaseItems}toString(e=!0,t=null){const n=e?this.items.slice(0,this.numBaseItems):this.items;return`State ${this.index}:\n`+n.map((e=>`\t\t${e.toString(t)}\n`)).join()}}!function(e){e[e.GrammarAddOperation=2001]="GrammarAddOperation",e[e.GrammarAddStateLink=2002]="GrammarAddStateLink",e[e.GrammarUnexpectedSymbol=2003]="GrammarUnexpectedSymbol",e[e.GrammarInvalidAdditionalFuncName=2004]="GrammarInvalidAdditionalFuncName",e[e.GrammarInvalidKeyword=2005]="GrammarInvalidKeyword"}(j||(j={}));class ee extends J.g{constructor(){super("Grammar diagnostics","G")}resolveFilename(e,t,n){return n.file}resolveRange(e,t,n){return null}resolvePosition(e,t,n){return{line:n.line,column:0,file:null}}diagnosticMessages(){return{[j.GrammarAddOperation]:'Grammar not LALR(1)! Cannot to generate syntax table. Add operation error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld operation: {oldOperation}\nNew operation: {newOperation}\nFor more info init parser in debug-mode and see syntax table and list of states.\n\n{stateDesc}',[j.GrammarAddStateLink]:'Grammar not LALR(1)! Cannot to generate syntax table. Add state link error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld next state: {oldNextStateIndex}\nNew next state: {newNextStateIndex}\nFor more info init parser in debug-mode and see syntax table and list of states.',[j.GrammarUnexpectedSymbol]:"Grammar error. Can`t generate rules from grammar\nUnexpected symbol: {unexpectedSymbol}\nExpected: {expectedSymbol}",[j.GrammarInvalidAdditionalFuncName]:"Grammar error. Empty additional function name.",[j.GrammarInvalidKeyword]:"Grammar error. Bad keyword: {badKeyword}\nAll keyword must be define in lexer rule block."}}}class te{constructor({grammar:e,flags:t=a.k_Default,type:n=i.k_LALR}){this._syntaxTable=null,this._productions=null,this._baseItems=null,this._states=null,this._additionalFuncInfoList=null,this._adidtionalFunctByStateDMap=null,this._ruleCreationModeMap=null,this._firstTerminalsCache=null,this._closureForItemsCache=null,this._expectedExtensionDMap=null,this._diag=new ee,this.init({grammar:e,flags:t,type:n})}get syntaxTable(){return this._syntaxTable}findFunctionByState(e,t){const n=this._adidtionalFunctByStateDMap;return!(0,c.Ft)(n)&&(0,c.Xq)(n[e])&&(0,c.Xq)(n[e][t])?n[e][t]:null}getRuleCreationMode(e){return this._ruleCreationModeMap[e]}getGrammarSymbols(){return this._grammarSymbols}init({grammar:e,flags:t=a.k_Default,type:n=i.k_LALR}){this.lexerEngine=new X,this.generateRules(e,t),this.buildSyntaxTable(n),this.generateFunctionByStateMap(),C.testAll(t,a.k_Debug)||this.clearMem()}printStates(e=!0){if(!(0,c.Xq)(this._states))return void console.warn("It`s impossible to print states. You must init parser in debug-mode");const t="\n"+this.statesToString(e);console.log(t)}printState(e,t=!0){if((0,c.Xq)(this._states)){var n=this._states[e];(0,c.Xq)(n)?console.log(`\n${n.toString(t,this.getGrammarSymbols())}`):console.log("Can not print stete with index: "+e.toString())}else console.log("It`s impossible to print states. You must init parser in debug-mode.")}critical(e,t){this._diag.critical(e,t)}grammarError(e,t){let n="grammar";switch(e){case j.GrammarAddOperation:{const{stateIndex:r,grammarSymbol:i,oldOperation:s,newOperation:a}=t;this.critical(e,{file:n,line:0,stateIndex:r,grammarSymbol:i,oldOperation:te.operationToString(s),newOperation:te.operationToString(a),stateDesc:this._states[r].toString()})}break;case j.GrammarAddStateLink:{const{stateIndex:r,grammarSymbol:i,oldNextStateIndex:s,newNextStateIndex:a}=t;this.critical(e,{file:n,line:0,stateIndex:r,grammarSymbol:i,oldNextStateIndex:s,newNextStateIndex:a})}break;case j.GrammarUnexpectedSymbol:{const{grammarLine:r,expectedSymbol:i,unexpectedSymbol:s}=t;this.critical(e,{file:n,line:r,expectedSymbol:i,unexpectedSymbol:s})}break;case j.GrammarInvalidAdditionalFuncName:{const{grammarLine:r}=t;this.critical(e,{file:n,line:r})}break;case j.GrammarInvalidKeyword:{const{grammarLine:r,badKeyword:i}=t;this.critical(e,{file:n,line:r,badKeyword:i})}break;default:throw"invalid case!!!!"}}clearMem(){delete this._states,delete this._productions,delete this._baseItems,delete this._firstTerminalsCache,delete this._closureForItemsCache,delete this._expectedExtensionDMap}hasState(e,t){return this._states.find((n=>n.isEqual(e,t)))||null}nonTerminals(){return Object.keys(this._productions)}rules(e){const t=this._productions[e];return t?Object.keys(t).map((e=>t[e])):null}ruleCreationMode(e){return this._ruleCreationModeMap[e]}symbols(){return[...this._grammarSymbols.keys()]}isTerminal(e){return!this._productions[e]}pushState(e){e.index=this._states.length,this._states.push(e)}pushBaseItem(e){e.index=this._baseItems.length,this._baseItems.push(e)}tryAddState(e,t){let n=this.hasState(e,t);return(0,c.Ft)(n)?(t===i.k_LR0&&e.eachItem((e=>this.pushBaseItem(e))),this.pushState(e),this.closure(e,t),e):n}hasEmptyRule(e){return!this.isTerminal(e)&&!!this.rules(e).find((e=>0===e.right.length))}pushInSyntaxTable(e,t,n,r){e[t]=e[t]||{},(0,c.Xq)(e[t][n])&&this.grammarError(j.GrammarAddOperation,{stateIndex:t,grammarSymbol:this.convertGrammarSymbol(n),oldOperation:this._syntaxTable[t][n],newOperation:r}),e[t][n]=r}addStateLink(e,t,n){e.addNextState(n,t)||this.grammarError(j.GrammarAddStateLink,{stateIndex:e.index,oldNextStateIndex:e.nextStates[n]||null,newNextStateIndex:t.index,grammarSymbol:this.convertGrammarSymbol(n)})}firstTerminals(e){if(this.isTerminal(e))return null;if((0,c.Xq)(this._firstTerminalsCache[e]))return this._firstTerminalsCache[e];const t=this.rules(e),n=this._firstTerminalsCache[e]=new Set;if(this.hasEmptyRule(e)&&n.add(O),(0,c.Ft)(t))return n;for(let r=0;r<t.length;++r){const i=t[r].right;let s=!1;for(let t=0;t<i.length;t++){if(i[t]===e){if(n.has(O))continue;s=!0;break}const r=this.firstTerminals(i[t]);if((0,c.Ft)(r))n.add(i[t]);else for(const e of r)n.add(e);if(!this.hasEmptyRule(i[t])){s=!0;break}}s||n.add(O)}return n}firstTerminalsForSet(e,t){const n=new Set;for(let t=0;t<e.length;t++){const r=this.firstTerminals(e[t]);if((0,c.Ft)(r))return n.add(e[t]),n;let i=!1;for(const e of r)e!==O?n.add(e):i=!0;if(!i)return n}return(0,c.Ft)(t)||t.forEach((e=>n.add(e))),n}generateRules(e,n){let r,i,s=e.split(/\r?\n/),o=!1;this._productions={},this._additionalFuncInfoList=[],this._ruleCreationModeMap={},this._grammarSymbols=new Map([["END_SYMBOL",F]]);let l=0,u=0;const p=C.testAll(n,a.k_ForceAppendAll),h=C.testAll(n,a.k_AllowExposeMode),d=C.testAll(n,a.k_AllowAddMode),m=C.testAll(n,a.k_AllowSkipMode);let f,g=this._ruleCreationModeMap,y=0;for(l=0;l<s.length;l++)if(""!==s[l]&&"\r"!==s[l]&&(r=s[l].trim().split(/\s* \s*/),"#"!=r[0][0]))if(o){if((3===r.length||4===r.length&&""===r[3])&&('"'===r[2][0]||"'"===r[2][0])&&r[2].length>3){r[2][0]!==r[2][r[2].length-1]&&this.grammarError(j.GrammarUnexpectedSymbol,{unexpectedSymbol:r[2][r[2].length-1],expectedSymbol:r[2][0],grammarLine:l}),r[2]=r[2].slice(1,r[2].length-1);var T=r[2][0];f="_"===T||T>="a"&&T<="z"||T>="A"&&T<="Z"?this.lexerEngine.addKeyword(r[2],r[0]):this.lexerEngine.addPunctuator(r[2],r[0]),this._grammarSymbols.set(f,r[2])}}else if("--LEXER--"!==r[0]){for((0,c.Xq)(this._productions[r[0]])||(this._productions[r[0]]={}),i={left:r[0],right:[],index:0},this._grammarSymbols.set(r[0],r[0]),p||h&&!(0,c.Xq)(g[r[0]])?g[r[0]]=t.k_Default:d&&!(0,c.Xq)(g[r[0]])?g[r[0]]=t.k_Expose:m&&!(0,c.Xq)(g[r[0]])&&(g[r[0]]=t.k_Skip),u=2;u<r.length;u++)if(""!==r[u])if("--add"!==r[u])if("--skip"!==r[u])if("--expose"!==r[u])if("--F"!==r[u])"'"===r[u][0]||'"'===r[u][0]?(3!==r[u].length&&this.grammarError(j.GrammarInvalidKeyword,{badKeyword:r[u],grammarLine:l}),r[u][0]!==r[u][2]&&this.grammarError(j.GrammarUnexpectedSymbol,{unexpectedSymbol:r[u][2],expectedSymbol:r[u][0],grammarLine:l}),f=this.lexerEngine.addPunctuator(r[u][1]),i.right.push(f),this._grammarSymbols.set(f,r[u][1])):(i.right.push(r[u]),this._grammarSymbols.set(r[u],r[u]));else{r[u+1]&&0!==r[u+1].length||this.grammarError(j.GrammarInvalidAdditionalFuncName,{grammarLine:l});const e={name:r[u+1],position:i.right.length,rule:i};this._additionalFuncInfoList.push(e),u++}else h&&!p&&(g[r[0]]=t.k_Expose);else m&&!p&&(g[r[0]]=t.k_Skip);else d&&(g[r[0]]=t.k_Necessary);i.index=y,this._productions[r[0]][i.index]=i,y++,(0,c.hu)(1!=y||(0,c.Xq)(this._productions.S[0]))}else o=!0}generateFunctionByStateMap(){const e=this._states,t=this._additionalFuncInfoList,n=this._adidtionalFunctByStateDMap={};for(let r=0;r<t.length;r++){const i=t[r],s=i.rule,a=i.position,o=s.right[a-1];for(let t=0;t<e.length;t++)e[t].hasRule(s,a)&&(n[e[t].index]=n[e[t].index]||{},n[e[t].index][o]=i.name)}}generateFirstState_LR0(){const e=new Z,t=this._productions.S[0],n=new W(t,0);this.pushBaseItem(n),e.push(n),this.closure_LR0(e),this.pushState(e)}generateFirstState_LR(){const e=new Z,t=this._productions.S[0];e.push(new W(t,0,[F])),this.closure_LR(e),this.pushState(e)}closure(e,t){t===i.k_LR0?this.closure_LR0(e):this.closure_LR(e)}closure_LR0(e){e.eachItem((t=>{const n=t.symbolName();n===w||this.isTerminal(n)||this.rules(n).forEach((t=>e.tryPush_LR0(t,0)))}))}closure_LR(e){let t;do{t=!1,e.eachItem((n=>{const r=n.symbolName();if(r!==w&&!this.isTerminal(r)){const i=n.rule.right.slice(n.pos+1),s=this.firstTerminalsForSet(i,n.expectedSymbols);this.rules(r).forEach((n=>{s.forEach((r=>{e.tryPush_LR(n,0,r)&&(t=!0)}))}))}}))}while(t)}static nextState_LR0(e,t){const n=new Z;return e.eachItem((e=>{e.symbolName()===t&&n.push(new W(e.rule,e.pos+1))})),n}static nextState_LR(e,t){const n=new Z;return e.eachItem((e=>{if(e.symbolName()===t){const t=Array.from(e.expectedSymbols);n.push(new W(e.rule,e.pos+1,t))}})),n}deleteNotBaseItems(){this._states.forEach((e=>e.deleteNotBase()))}closureForItem({rule:e,pos:t}){const n=e.index+"_"+t;let r=this._closureForItemsCache[n];return(0,c.Xq)(r)||(r=new Z,r.push(new W(e,t,["##"])),this.closure_LR(r),this._closureForItemsCache[n]=r),r}addLinkExpected(e,t){let n=this._expectedExtensionDMap,r=e.index;n[r]=n[r]||{},n[r][t.index]=!0}determineExpected(e,t){const n=e.nextStates[t]||null;(0,c.Ft)(n)||e.eachBaseItem((e=>{const t=this.closureForItem(e);n.eachBaseItem((n=>{const r=t.hasChildItem(n);r&&r.expectedSymbols.forEach((t=>{"##"===t?this.addLinkExpected(e,n):n.addExpected(t)}))}))}))}generateLinksExpected(){const e=this._states,t=this.symbols();e.forEach((e=>t.forEach((t=>this.determineExpected(e,t)))))}expandExpected(){const e=this._baseItems,t=e.map((e=>!0)),n=this._expectedExtensionDMap;let r;e[0].addExpected(F),t[0]=!0;do{r=!1,e.forEach((i=>{if(t[i.index]&&(0,c.$V)(n[i.index])){let s=Object.keys(n[i.index]).map((e=>Number(e)));i.expectedSymbols.forEach((n=>{s.forEach((i=>{e[i].addExpected(n)&&(t[i]=!0,r=!0)}))}))}t[i.index]=!1}))}while(r)}generateStates(e){e===i.k_LR0?this.generateStates_LR0():e===i.k_LR1?this.generateStates_LR():e===i.k_LALR&&this.generateStates_LALR()}generateStates_LR0(){this.generateFirstState_LR0();const e=this._states,t=this.symbols();for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<t.length;e++){const n=t[e];let s=te.nextState_LR0(r,n);s.isEmpty()||(s=this.tryAddState(s,i.k_LR0),this.addStateLink(r,s,n))}}}generateStates_LR(){this._firstTerminalsCache={},this.generateFirstState_LR();const e=this._states,t=this.symbols();for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<t.length;e++){let n=t[e],s=te.nextState_LR(r,n);s.isEmpty()||(s=this.tryAddState(s,i.k_LR1),this.addStateLink(r,s,n))}}}generateStates_LALR(){this._baseItems=[],this._expectedExtensionDMap={},this._closureForItemsCache={},this._firstTerminalsCache={},this.generateStates_LR0(),this.deleteNotBaseItems(),this.generateLinksExpected(),this.expandExpected(),this._states.forEach((e=>this.closure_LR(e)))}addReducing(e,t,n){t.eachItem((r=>{if(r.symbolName()===w)if(r.rule.left===I)this.pushInSyntaxTable(e,t.index,F,{type:l.k_Success});else for(const i of r.expectedSymbols)this.pushInSyntaxTable(e,t.index,i,n[r.rule.index])}))}addShift(e,t,n){const r=t.nextStates,i=Object.keys(r);for(let s=0;s<i.length;s++){const a=r[i[s]];this.pushInSyntaxTable(e,t.index,i[s],n[a.index])}}buildSyntaxTable(e){this._states=[],this._syntaxTable={};const t=this._states,n=this._syntaxTable;this.generateStates(e);const r={},i={};t.forEach((e=>{i[e.index]={type:l.k_Shift,stateIndex:e.index}}));this.nonTerminals().forEach((e=>{this.rules(e).forEach((e=>{r[e.index]={type:l.k_Reduce,rule:e}}))})),t.forEach((e=>{this.addReducing(n,e,r),this.addShift(n,e,i)}))}statesToString(e=!0){if(!this._states)return"";let t="";for(let n=0;n<this._states.length;n++)t+=this._states[n].toString(e,this._grammarSymbols),t+=" ";return t}static operationToString(e){let t="";switch(e.type){case l.k_Shift:t="SHIFT to state "+e.stateIndex.toString();break;case l.k_Reduce:t="REDUCE by rule { "+te.ruleToString(e.rule)+" }";break;case l.k_Success:t="SUCCESS"}return t}static ruleToString(e){let t;return t=e.left+" : "+e.right.join(" "),t}convertGrammarSymbol(e){return this.isTerminal(e)?this.lexerEngine.getTerminalValueByName(e):e}}te.$parserEngine=null,te.$parserParams=null;const ne="S : Program\r\nProgram : --add\r\nProgram : Decls\r\n\r\nDecls : Decl --expose\r\nDecls : Decls Decl\r\n\r\nDecl : ';'\r\nDecl : TypeDecl\r\nDecl : VariableDecl\r\nDecl : VarStructDecl\r\nDecl : FunctionDecl\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    Decl : TechniqueDecl\r\n#endif\r\nDecl : Technique11Decl\r\nDecl : UseDecl\r\n#if FX_PART\r\n    Decl : ImportDecl\r\n    Decl : ProvideDecl\r\n#endif\r\nDecl : CbufferDecl\r\nDecl : TbufferDecl\r\nDecl : ERROR\r\n\r\n#if FX_PART\r\n    Decl : PartFxDecl\r\n    ImportDecl : T_KW_IMPORT String ';'\r\n    ProvideDecl : T_KW_PROVIDE ComplexNameOpt ';'\r\n# ProvideDecl : T_KW_PROVIDE ComplexNameOpt T_KW_AS ComplexNameOpt ';'\r\n#endif \r\n\r\nUseDecl : T_KW_USE Mode\r\nMode : T_KW_STRICT\r\n\r\nUsages : Usage --expose\r\nUsages : Usages Usage\r\nUsage : T_KW_STATIC --add\r\nUsage : T_KW_NOINTERPOLATION\r\nUsage : T_KW_CENTROID\r\nUsage : T_KW_NOPERSPECTIVE\r\nUsage : T_KW_UNIFORM\r\nUsage : T_KW_EXTERN\r\nUsage : T_KW_VOLATILE\r\nUsage : T_KW_INLINE\r\nUsage : T_KW_UNSIGNED\r\nUsage : T_KW_PRECISE\r\nUsage : ConstUsage\r\n\r\nConstUsages : ConstUsage --expose\r\nConstUsages : ConstUsages ConstUsage\r\nConstUsage : T_KW_CONST\r\nConstUsage : T_KW_ROW_MAJOR\r\nConstUsage : T_KW_COLUMN_MAJOR\r\n\r\nUsageType : Type --add\r\nUsageType : Usages Type\r\n\r\nUsageStructDecl : StructDecl --add\r\nUsageStructDecl : Usages StructDecl\r\n\r\nTypeDecl : T_KW_TYPEDEF ConstType TypeDefs --F addTypeDef ';' --add\r\nTypeDecl : T_KW_TYPEDEF ConstStructDecl TypeDefs --F addTypeDef ';'\r\nTypeDecl : StructDecl ';'\r\nTypeDefs : VariableDim\r\nTypeDefs : VariableDim ',' TypeDefs\r\n\r\nType : BaseType --add\r\nType : Struct\r\nType : TypeId\r\nType : T_KW_STRUCT TypeId\r\n\r\nConstType : Type --add\r\nConstType : ConstUsages Type\r\nConstTypeDim : ConstType --expose\r\nConstTypeDim : ConstTypeDim '[' ConstantExpr ']'\r\n\r\nBaseType : T_KW_VOID --add\r\nBaseType : ScalarType\r\nBaseType : VectorType\r\nBaseType : MatrixType\r\nBaseType : ObjectType\r\n\r\nScalarType : T_KW_BOOL --add\r\nScalarType : T_KW_INT\r\n# ScalarType : T_KW_UNSIGNED T_KW_INT\r\nScalarType : T_KW_UINT\r\nScalarType : T_KW_HALF\r\nScalarType : T_KW_FLOAT\r\nScalarType : T_KW_DOUBLE\r\n\r\nVectorType : T_KW_VECTOR --add\r\nVectorType : T_KW_VECTOR '<' ScalarType ',' AddExpr '>'\r\n\r\nMatrixType : T_KW_MATRIX --add\r\nMatrixType : T_KW_MATRIX '<' ScalarType ',' ConstantExpr ',' AddExpr '>'\r\n\r\nObjectType : T_KW_STRING --add\r\nObjectType : T_KW_TEXTURE\r\nObjectType : T_KW_TEXTURE1D\r\nObjectType : T_KW_TEXTURE2D\r\nObjectType : T_KW_TEXTURE2D '<' Type '>'\r\n#if FX_PART\r\n    ObjectType : T_KW_TRIMESH '<' Type '>'\r\n#endif\r\nObjectType : T_KW_TEXTURE2DARRAY\r\nObjectType : T_KW_TEXTURE3D\r\nObjectType : T_KW_TEXTURE3D '<' Type '>'\r\nObjectType : T_KW_TEXTURECUBE\r\nObjectType : T_KW_TEXTURECUBEARRAY\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    # ObjectType : T_KW_SAMPLER\r\n    # ObjectType : T_KW_SAMPLER1D\r\n    # ObjectType : T_KW_SAMPLER2D\r\n    # ObjectType : T_KW_SAMPLER3D\r\n    # ObjectType : T_KW_SAMPLERCUBE\r\n    # ObjectType : T_KW_STATEBLOCK\r\n#endif\r\nObjectType : T_KW_SAMPLER_STATE\r\nObjectType : T_KW_SAMPLER_COMPARISON_STATE\r\nObjectType : T_KW_DEPTH_STENCIL_STATE\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    # ObjectType : T_KW_PIXELSHADER\r\n    # ObjectType : T_KW_VERTEXSHADER\r\n    # ObjectType : T_KW_PIXELFRAGMENT\r\n    # ObjectType : T_KW_VERTEXFRAGMENT\r\n#endif\r\nObjectType : T_KW_RWTEXTURE1D '<' Type '>'\r\nObjectType : T_KW_RWTEXTURE2D '<' Type '>'\r\nObjectType : T_KW_RWTEXTURE3D '<' Type '>'\r\nObjectType : T_KW_BUFFER '<' Type '>'\r\nObjectType : T_KW_RWBUFFER '<' Type '>'\r\nObjectType : T_KW_RWSTRUCTUREDBUFFER '<' Type '>'\r\nObjectType : T_KW_STRUCTUREDBUFFER '<' Type '>'\r\nObjectType : T_KW_APPENDSTRUCTUREDBUFFER '<' Type '>'\r\n\r\nStruct : T_KW_STRUCT '{' '}' --add\r\nStruct : T_KW_STRUCT '{' StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id --F addType '{' '}' --add\r\nStructDecl : T_KW_STRUCT Id --F addType '{' UseDecl StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id --F addType '{' StructDecls '}'\r\n\r\nConstStructDecl : StructDecl\r\nConstStructDecl : ConstUsages StructDecl\r\n\r\nStructDecls : VariableDecl --expose \r\nStructDecls : VarStructDecl --expose \r\nStructDecls : VariableDecl StructDecls\r\nStructDecls : VarStructDecl StructDecls\r\n\r\nSemantic : ':' Id --add\r\nSemantic : ':' T_KW_REGISTER '(' Register ')'\r\nSemantics : Semantic\r\nSemantics : Semantics Semantic\r\nSemanticsOpt :\r\nSemanticsOpt : Semantics\r\n\r\nRegister : Id\r\nRegister : Target ',' Id\r\n\r\nAnnotation : AnnotationBegin AnnotationEnd  --add\r\nAnnotation : AnnotationBegin AnnotationDecls AnnotationEnd\r\nAnnotationOpt :\r\nAnnotationOpt : Annotation\r\nAnnotationBegin : '<'\r\nAnnotationDecls : VariableDecl\r\nAnnotationDecls : VariableDecl AnnotationDecls\r\nAnnotationEnd : '>'\r\n\r\nInitializer : '=' AssignmentExpr --add\r\nInitializer : '=' ERROR --add\r\nInitializer : '=' '{' InitExprs '}'\r\nInitializer : '=' '{' InitExprs ',' '}'\r\nInitializer : StateBlock\r\n\r\nVariableDecl : UsageType Variables ';' --add\r\nVariableDecl : UsageType Variables ERROR --add\r\nVarStructDecl : UsageStructDecl Variables ';' --add\r\n\r\nVariables : Variable --expose\r\nVariables : Variables ',' Variable\r\n# Variables : Variables ERROR Variable\r\nVariables : Variables ',' ERROR\r\nVariable : VariableDim SemanticsOpt AnnotationOpt Initializer --add\r\nVariable : VariableDim SemanticsOpt AnnotationOpt --add\r\nVariableDim : NonTypeId --add\r\nVariableDim : VariableDim '[' ConstantExpr ']'\r\n\r\n\r\nFunctionDecl : Attributes FunctionDef ';' --add\r\nFunctionDecl : FunctionDef ';' --add\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt StmtBlock\r\nFunctionDecl : FunctionDef AnnotationOpt StmtBlock\r\n\r\n# TODO: remove it;\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt ERROR\r\nFunctionDecl : FunctionDef AnnotationOpt ERROR\r\n\r\nFunctionDef : UsageType NonTypeId ParamList SemanticsOpt\r\n\r\nAttribute : '[' Id '(' ArgumentsOpt ')' ']'\r\nAttribute : '[' Id ']'\r\nAttributes : Attribute --expose\r\nAttributes : Attributes Attribute\r\nAttributesOpt : --expose\r\nAttributesOpt : Attributes\r\n\r\nParamList : '(' ')'\r\nParamList : '(' T_KW_VOID ')'\r\nParamList : '(' ParameterDecls ')'\r\n\r\nParameterDecls : ParameterDecl --expose\r\nParameterDecls : ParameterDecls ',' ParameterDecl\r\nParameterDecls : ParameterDecls ERROR ParameterDecl\r\nParameterDecls : ParameterDecls ',' ERROR\r\nParameterDecls : ERROR\r\nParameterDecl : ParamUsageType Variable\r\n\r\nParamUsageType : Type --add\r\nParamUsageType : ParamUsages Type\r\n\r\nParamUsages : ParamUsage --expose\r\nParamUsages : ParamUsages ParamUsage\r\nParamUsage : T_KW_IN --add\r\nParamUsage : T_KW_OUT\r\nParamUsage : T_KW_INOUT\r\nParamUsage : T_KW_UNIFORM\r\nParamUsage : ConstUsage\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    TechniqueDecl : T_KW_TECHNIQUE ComplexNameOpt SemanticsOpt AnnotationOpt TechniqueBody --add\r\n    TechniqueBody : '{' '}'  --add\r\n    TechniqueBody : '{' PassDecls '}'\r\n#endif \r\n\r\nTechnique11Decl : T_KW_TECHNIQUE11 ComplexNameOpt SemanticsOpt AnnotationOpt Technique11Body --add\r\nTechnique11Body : '{' '}'  --add\r\nTechnique11Body : '{' Pass11Decls '}'\r\n\r\nCbufferDecl : T_KW_CBUFFER IdOpt SemanticsOpt AnnotationOpt '{' StructDecls '}' ';' --add\r\nCbufferDecl : T_KW_CBUFFER IdOpt SemanticsOpt AnnotationOpt '{' '}' ';' --add\r\nTbufferDecl : T_KW_TBUFFER IdOpt SemanticsOpt AnnotationOpt '{' StructDecls '}' ';' --add\r\nTbufferDecl : T_KW_TBUFFER IdOpt SemanticsOpt AnnotationOpt '{' '}' ';' --add\r\n\r\nComplexNameOpt : ComplexName --add\r\nComplexName : Id --expose\r\nComplexName : ComplexName '.' Id\r\n\r\n#if PRESETS_EX\r\n    PresetDecl : T_KW_PRESET Id AnnotationOpt PassStateBlock --add\r\n#endif\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    PassDecls : PassDecl --expose\r\n    PassDecls : PassDecls PassDecl\r\n    PassDecl : T_KW_PASS IdOpt AnnotationOpt PassStateBlock --add\r\n    #if PRESETS_EX\r\n    PassDecl : PresetDecl\r\n    #endif\r\n    PassDecl : ';'\r\n#endif\r\n\r\nPass11Decls : Pass11Decl --expose\r\nPass11Decls : Pass11Decls Pass11Decl\r\nPass11Decl : T_KW_PASS IdOpt AnnotationOpt StmtBlock --add\r\nPass11Decl : ';'\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    PassStateBlock : '{' '}' --add\r\n    PassStateBlock : '{' PassStates '}'\r\n    PassStates : PassState --expose\r\n    PassStates : PassStates PassState\r\n\r\n    PassState : Id StateIndex '=' PassStateExpr ';' --add\r\n#endif\r\n\r\n# todo: move all particles declarations to separate grammar!\r\n#if FX_PART\r\n    PartFxDecl : T_KW_FXPART ComplexNameOpt SemanticsOpt AnnotationOpt PartFxBody --add\r\n\r\n    PartFxBody : '{' '}' \r\n    PartFxBody : '{' PartFxProperties '}'\r\n\r\n    PartFxProperties : PartFxProperty --expose\r\n    PartFxProperties : PartFxProperties PartFxProperty\r\n    PartFxProperty : PassState\r\n    PartFxProperty : PassDecl\r\n#endif // FX_PART\r\n\r\nStateBlock : '{' '}' --add\r\nStateBlock : '{' States '}'\r\nStateBlock : '{' StateBlockItems '}'\r\nStateBlockItems : StateBlock  --expose\r\nStateBlockItems : StateBlock ',' StateBlockItems\r\nState : Id StateIndex '=' StateExpr ';' --add\r\nStates : State --expose\r\nStates : States State\r\n\r\nStateIndex :\r\nStateIndex : '[' Uint ']'\r\n\r\nStmtBlock : '{' '}' --add\r\nStmtBlock : '{' Stmts '}'  \r\n\r\nStmts : Stmt --expose\r\nStmts : Stmts Stmt\r\n\r\n# SimpleStmt : ERROR ';' \r\n# SimpleStmt : ';' --add\r\n\r\nSimpleStmt : Expr ';'\r\nSimpleStmt : Expr ERROR\r\nSimpleStmt : T_KW_RETURN ';'\r\nSimpleStmt : T_KW_RETURN Expr ';'\r\nSimpleStmt : T_KW_RETURN ERROR ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' Expr ')' ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' ERROR ')' ';'\r\nSimpleStmt : StmtBlock\r\nSimpleStmt : T_KW_DISCARD ';'\r\nSimpleStmt : TypeDecl\r\nSimpleStmt : VariableDecl --add\r\nSimpleStmt : VarStructDecl\r\nSimpleStmt : T_KW_BREAK ';'\r\nSimpleStmt : T_KW_BREAK ERROR\r\nSimpleStmt : T_KW_CONTINUE ';'\r\nSimpleStmt : T_KW_CONTINUE ERROR\r\n\r\n#if FX_PART\r\n    SimpleStmt : T_KW_SPAWN '(' Expr ')' NonTypeId '(' ArgumentsOpt ')' ';'\r\n    SimpleStmt : T_KW_DRAW NonTypeId '(' ArgumentsOpt ')' ';'\r\n#endif\r\n\r\n\r\nNonIfStmt : SimpleStmt --add\r\nNonIfStmt : ';'\r\nNonIfStmt : WhileStmt NonIfStmt\r\nNonIfStmt : ForStmt NonIfStmt\r\n\r\nStmt : SimpleStmt --add\r\nStmt : UseDecl\r\nStmt : WhileStmt Stmt\r\nStmt : ForStmt Stmt\r\nStmt : IfStmt Stmt\r\nStmt : IfStmt NonIfStmt T_KW_ELSE Stmt\r\nStmt : ERROR\r\nStmt : ';'\r\n\r\nIfStmt : AttributesOpt T_KW_IF '(' Expr ')' --expose\r\nIfStmt : AttributesOpt T_KW_IF '(' ERROR ')' --expose\r\n\r\nWhileStmt : T_KW_WHILE '(' Expr ')' --expose\r\nWhileStmt : T_KW_WHILE '(' ERROR ')' --expose\r\n\r\nForStmt : AttributesOpt For '(' ForInit ForCond ForStep ')' --expose\r\nForStmt : AttributesOpt For ERROR --expose\r\n\r\nFor : T_KW_FOR\r\n\r\nForInit : ';' --add\r\nForInit : Expr ';'\r\nForInit : VariableDecl\r\nForInit : ERROR ';'\r\n\r\nForCond : ';' --add\r\nForCond : Expr ';'\r\nForCond : ERROR ';'\r\n\r\nForStep : --add\r\nForStep : Expr\r\nForStep : ERROR\r\n\r\nDwordExpr : Dword\r\nDwordExpr : Dword '|' DwordExpr\r\n\r\nDwordExprSeq : DwordExpr --expose\r\nDwordExprSeq : DwordExpr ',' DwordExprSeq\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    PassStateExpr : DwordExpr --add\r\n    PassStateExpr : ComplexExpr\r\n    PassStateExpr : String\r\n    PassStateExpr : '{' DwordExprSeq '}'\r\n#endif\r\n\r\nStateExpr : DwordExpr --add\r\nStateExpr : ComplexExpr\r\nStateExpr : '{' InitExprs '}'\r\nStateExpr : '{' InitExprs ',' '}'\r\nStateExpr : '<' RelationalExpr '>'\r\n\r\nSimpleExpr : T_KW_TRUE\r\nSimpleExpr : T_KW_FALSE\r\nSimpleExpr : Uint\r\nSimpleExpr : Float\r\nSimpleExpr : String\r\nSimpleExpr : NonTypeId\r\n\r\nComplexExpr : '(' Expr ')'\r\nComplexExpr : TypeId '(' ArgumentsOpt ')'\r\nComplexExpr : BaseType '(' ArgumentsOpt ')' \r\nComplexExpr : NonTypeId '(' ArgumentsOpt ')'\r\nComplexExpr : PostfixPointExpr '(' ArgumentsOpt ')'\r\nComplexExpr : ObjectExpr\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    ObjectExpr : T_KW_COMPILE NonTypeId '(' ArgumentsOpt ')'\r\n    ObjectExpr : T_KW_COMPILE_FRAGMENT Target NonTypeId '(' ArgumentsOpt ')'\r\n#endif\r\n\r\nObjectExpr : T_KW_COMPILE_SHADER '(' ArgumentsOpt ')'\r\n\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    # ObjectExpr : T_KW_SAMPLER_STATE StateBlock\r\n    # ObjectExpr : T_KW_STATEBLOCK_STATE StateBlocStateBlockk\r\n#endif\r\n\r\nPrimaryExpr : ComplexExpr\r\nPrimaryExpr : SimpleExpr\r\nPostfixExpr : PrimaryExpr\r\nPostfixExpr : PostfixExpr '[' Expr ']'\r\nPostfixExpr : PostfixExpr '[' ERROR ']'\r\nPostfixExpr : PostfixExpr '.' Id\r\nPostfixExpr : PostfixExpr T_OP_INC\r\nPostfixExpr : PostfixExpr T_OP_DEC\r\n\r\nPostfixPointExpr : PostfixExpr '.' Id\r\n\r\nUnaryExpr : PostfixExpr\r\nUnaryExpr : T_OP_INC UnaryExpr\r\nUnaryExpr : T_OP_DEC UnaryExpr\r\n# UnaryExpr : T_OP_INC ERROR\r\n# UnaryExpr : T_OP_DEC ERROR\r\nUnaryExpr : '!' CastExpr\r\nUnaryExpr : '~' CastExpr\r\n# UnaryExpr : '!' ERROR\r\nUnaryExpr : '-' CastExpr\r\nUnaryExpr : '+' CastExpr\r\n\r\nCastExpr : UnaryExpr\r\nCastExpr : '(' ConstTypeDim ')' CastExpr\r\nCastExpr : '(' ERROR ')' CastExpr\r\n\r\nMulExpr : CastExpr\r\nMulExpr : MulExpr '*' CastExpr\r\nMulExpr : MulExpr '/' CastExpr\r\nMulExpr : MulExpr '%' CastExpr\r\n\r\nMulExpr : ERROR '*' CastExpr\r\nMulExpr : ERROR '/' CastExpr\r\nMulExpr : ERROR '%' CastExpr\r\nMulExpr : MulExpr '*' ERROR\r\nMulExpr : MulExpr '/' ERROR\r\nMulExpr : MulExpr '%' ERROR\r\n# MulExpr : ERROR '*' ERROR\r\n# MulExpr : ERROR '/' ERROR\r\n# MulExpr : ERROR '%' ERROR\r\n\r\nAddExpr : MulExpr\r\nAddExpr : AddExpr '+' MulExpr\r\nAddExpr : AddExpr '-' MulExpr\r\n\r\nAddExpr : AddExpr '+' ERROR\r\nAddExpr : AddExpr '-' ERROR\r\n\r\nShiftExpr : AddExpr\r\nShiftExpr : ShiftExpr T_OP_SL AddExpr\r\nShiftExpr : ShiftExpr T_OP_SR AddExpr\r\n\r\nShiftExpr : ShiftExpr T_OP_SR ERROR\r\nShiftExpr : ShiftExpr T_OP_SL ERROR\r\n\r\nRelationalExpr : ShiftExpr\r\nRelationalExpr : RelationalExpr '<' ShiftExpr\r\nRelationalExpr : RelationalExpr '>' ShiftExpr\r\nRelationalExpr : RelationalExpr T_OP_LE ShiftExpr\r\nRelationalExpr : RelationalExpr T_OP_GE ShiftExpr\r\n\r\nRelationalExpr : ERROR '<' ShiftExpr\r\nRelationalExpr : RelationalExpr '<' ERROR\r\nRelationalExpr : ERROR '<' ERROR\r\n\r\nRelationalExpr : RelationalExpr '>' ERROR\r\nRelationalExpr : ERROR '>' ShiftExpr\r\nRelationalExpr : ERROR '>' ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_LE ERROR\r\nRelationalExpr : ERROR T_OP_LE ShiftExpr\r\nRelationalExpr : ERROR T_OP_LE ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_GE ERROR\r\nRelationalExpr : ERROR T_OP_GE ShiftExpr\r\nRelationalExpr : ERROR T_OP_GE ERROR\r\n\r\nEqualityExpr : RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE RelationalExpr\r\nEqualityExpr : ERROR T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE ERROR\r\nEqualityExpr : ERROR T_OP_NE ERROR\r\n\r\nAndExpr : EqualityExpr\r\nAndExpr : AndExpr '&' EqualityExpr\r\nAndExpr : ERROR '&' EqualityExpr\r\nAndExpr : AndExpr '&' ERROR\r\n\r\nExclusiveOrExpr : AndExpr\r\nExclusiveOrExpr : ExclusiveOrExpr '^' AndExpr\r\nExclusiveOrExpr : ERROR '^' AndExpr\r\nExclusiveOrExpr : ExclusiveOrExpr '^' ERROR\r\n\r\nInclusiveOrExpr : ExclusiveOrExpr\r\nInclusiveOrExpr : InclusiveOrExpr '|' ExclusiveOrExpr\r\nInclusiveOrExpr : ERROR '|' ExclusiveOrExpr\r\nInclusiveOrExpr : InclusiveOrExpr '|' ERROR\r\n\r\nLogicalAndExpr : InclusiveOrExpr\r\nLogicalAndExpr : LogicalAndExpr T_OP_AND InclusiveOrExpr\r\nLogicalAndExpr : ERROR T_OP_AND InclusiveOrExpr\r\nLogicalAndExpr : LogicalAndExpr T_OP_AND ERROR\r\n\r\nLogicalOrExpr : LogicalAndExpr\r\nLogicalOrExpr : LogicalOrExpr T_OP_OR LogicalAndExpr\r\nLogicalOrExpr : ERROR T_OP_OR LogicalAndExpr\r\nLogicalOrExpr : LogicalOrExpr T_OP_OR ERROR\r\n\r\nConditionalExpr : LogicalOrExpr\r\nConditionalExpr : LogicalOrExpr '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : ERROR '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : LogicalOrExpr '?' ERROR ':' ConditionalExpr\r\nConditionalExpr : LogicalOrExpr '?' AssignmentExpr ':' ERROR\r\nConditionalExpr : LogicalOrExpr '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ConditionalExpr\r\n\r\nAssignmentExpr : ConditionalExpr\r\nAssignmentExpr : CastExpr '=' AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_ME AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_DE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_RE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_AE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_SE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_BORE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_BANDE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_XORE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_SRE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_SLE AssignmentExpr\r\n\r\nArguments : AssignmentExpr --expose\r\nArguments : Arguments ',' AssignmentExpr\r\nArguments : Arguments ERROR AssignmentExpr\r\nArguments : Arguments ',' ERROR\r\nArgumentsOpt : --expose\r\nArgumentsOpt : Arguments\r\n\r\nInitExpr : AssignmentExpr --add\r\nInitExpr : '{' InitExprs '}'\r\nInitExpr : '{' InitExprs ',' '}'\r\nInitExprs : InitExpr --expose\r\nInitExprs : InitExprs ',' InitExpr\r\n\r\nConstantExpr : AssignmentExpr\r\nExpr : AssignmentExpr\r\nExpr : Expr ',' AssignmentExpr\r\nExpr : Expr ',' ERROR\r\nExpr : ERROR ',' ERROR\r\nExpr : ERROR ',' AssignmentExpr\r\n\r\nDword : Uint\r\nDword : '-' Uint\r\nDword : Float\r\nDword : '-' Float\r\nDword : DwordId\r\nDword : Uint DwordId\r\nDwordId : Id\r\nDwordId : T_KW_TRUE\r\nDwordId : T_KW_FALSE\r\nDwordId : T_KW_TEXTURE\r\n\r\nId : TypeId\r\nId : NonTypeId\r\nIdOpt :\r\nIdOpt : Id\r\n\r\nTarget : NonTypeId\r\n\r\nUint : T_UINT\r\nFloat : T_FLOAT\r\n\r\nStrings : String\r\nStrings : Strings String\r\nString : T_STRING\r\n\r\nTypeId : T_TYPE_ID\r\nNonTypeId : T_NON_TYPE_ID\r\n\r\nLineTerminator : T_LINE_TERMINATOR\r\n\r\nAsmDecl : T_KW_DECL '{'\r\nAsm : T_KW_ASM '{'\r\nAsmFragment : T_KW_ASM_FRAGMENT '{'\r\n\r\n--LEXER--\r\n\r\nT_KW_UNSIGNED : \"unsigned\"\r\nT_KW_PRECISE : \"precise\"\r\nT_KW_STATIC : \"static\"\r\nT_KW_NOINTERPOLATION : \"nointerpolation\"\r\nT_KW_CENTROID : \"centroid\"\r\nT_KW_NOPERSPECTIVE : \"noperspective\"\r\nT_KW_UNIFORM : \"uniform\"\r\nT_KW_EXTERN : \"extern\"\r\nT_KW_VOLATILE : \"volatile\"\r\nT_KW_INLINE : \"inline\"\r\nT_KW_CONST : \"const\"\r\nT_KW_ROW_MAJOR : \"row_major\"\r\nT_KW_COLUMN_MAJOR : \"column_major\"\r\nT_KW_TYPEDEF : \"typedef\"\r\nT_KW_STRUCT : \"struct\"\r\nT_KW_VOID : \"void\"\r\nT_KW_BOOL : \"bool\"\r\nT_KW_INT : \"int\"\r\nT_KW_UINT : \"uint\"\r\nT_KW_HALF : \"half\"\r\nT_KW_FLOAT : \"float\"\r\nT_KW_DOUBLE : \"double\"\r\nT_KW_VECTOR : \"vector\"\r\nT_KW_MATRIX : \"matrix\"\r\nT_KW_STRING : \"string\"\r\nT_KW_TEXTURE : \"Texture\"\r\nT_KW_TEXTURE1D : \"Texture1D\"\r\nT_KW_TEXTURE2D : \"Texture2D\"\r\nT_KW_TEXTURE2DARRAY : \"Texture2DArray\"\r\nT_KW_TEXTURE3D : \"Texture3D\"\r\nT_KW_TEXTURECUBE : \"TextureCube\"\r\nT_KW_TEXTURECUBEARRAY : \"TextureCubeArray\"\r\nT_KW_CBUFFER : \"cbuffer\"\r\nT_KW_TBUFFER : \"tbuffer\"\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    # T_KW_SAMPLER : \"sampler\"\r\n    # T_KW_SAMPLER1D : \"sampler1D\"\r\n    # T_KW_SAMPLER2D : \"sampler2D\"\r\n    # T_KW_SAMPLER3D : \"sampler3D\"\r\n    # T_KW_SAMPLERCUBE : \"samplerCUBE\"\r\n    # T_KW_STATEBLOCK : \"stateblock\"\r\n    # T_KW_STATEBLOCK_STATE : \"stateblock_state\"\r\n#endif\r\nT_KW_SAMPLER_STATE : \"SamplerState\"\r\nT_KW_SAMPLER_COMPARISON_STATE : \"SamplerComparisonState\"\r\nT_KW_DEPTH_STENCIL_STATE : \"DepthStencilState\"\r\nT_KW_BLEND_STATE : \"BlendState\"\r\nT_KW_RASTERIZER_STATE : \"RasterizerState\"\r\nT_KW_BUFFER : \"Buffer\"\r\nT_KW_RWTEXTURE1D : \"RWTexture1D\"\r\nT_KW_RWTEXTURE2D : \"RWTexture2D\"\r\nT_KW_RWTEXTURE3D : \"RWTexture3D\"\r\nT_KW_RWBUFFER : \"RWBuffer\"\r\nT_KW_STRUCTUREDBUFFER : \"StructuredBuffer\"\r\nT_KW_RWSTRUCTUREDBUFFER : \"RWStructuredBuffer\"\r\nT_KW_APPENDSTRUCTUREDBUFFER : \"AppendStructuredBuffer\"\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    # T_KW_PIXELSHADER : \"pixelshader\"\r\n    # T_KW_VERTEXSHADER : \"vertexshader\"\r\n    # T_KW_PIXELFRAGMENT : \"pixelfragment\"\r\n    # T_KW_VERTEXFRAGMENT : \"vertexfragment\"\r\n#endif\r\nT_KW_REGISTER : \"register\"\r\nT_KW_IN : \"in\"\r\nT_KW_OUT : \"out\"\r\nT_KW_INOUT : \"inout\"\r\nT_KW_TECHNIQUE : \"technique\"\r\nT_KW_TECHNIQUE11 : \"technique11\"\r\n#if PRESETS_EX\r\n    T_KW_PRESET : \"preset\"\r\n#endif\r\n#if FX_PART\r\n    T_KW_FXPART : \"partFx\"\r\n    T_KW_TRIMESH : \"TriMesh\"\r\n#endif\r\nT_KW_PASS : \"pass\"\r\nT_KW_RETURN : \"return\"\r\nT_KW_DO : \"do\"\r\nT_KW_DISCARD : \"discard\"\r\nT_KW_WHILE : \"while\"\r\nT_KW_IF : \"if\"\r\nT_KW_ELSE : \"else\"\r\nT_KW_FOR : \"for\"\r\nT_KW_TRUE : \"true\"\r\nT_KW_FALSE : \"false\"\r\n#if TECHNIQUE9_DEPRECATED_SUPPORT\r\n    T_KW_COMPILE : \"compile\"\r\n    T_KW_COMPILE_SHADER : \"CompileShader\"\r\n#endif\r\nT_KW_COMPILE_FRAGMENT : \"compile_fragment\"\r\nT_KW_DECL : \"decl\"\r\nT_KW_ASM : \"asm\"\r\nT_KW_ASM_FRAGMENT : \"asm_fragment\"\r\nT_KW_USE : \"use\"\r\nT_KW_STRICT : \"strict\"\r\n#id FX_PART\r\n    T_KW_IMPORT : \"import\"\r\n    T_KW_PROVIDE : \"provide\"\r\n#endif\r\nT_KW_SWITCH : \"switch\"\r\nT_KW_CASE : \"case\"\r\nT_KW_DEFAULT : \"default\"\r\nT_KW_BREAK : \"break\"\r\n#if FX_PART\r\n    T_KW_SPAWN : \"spawn\"\r\n    T_KW_DRAW : \"draw\"\r\n#endif\r\nT_KW_CONTINUE : \"continue\"\r\n# T_KW_AS : \"as\"\r\nT_OP_INC : \"++\"\r\nT_OP_DEC : \"--\"\r\nT_OP_LE : \">=\"\r\nT_OP_GE : \"<=\"\r\nT_OP_EQ : \"==\"\r\nT_OP_NE : \"!=\"\r\nT_OP_AND : \"&&\"\r\nT_OP_OR : \"||\"\r\nT_OP_ME : \"*=\"\r\nT_OP_DE : \"/=\"\r\nT_OP_RE : \"%=\"\r\nT_OP_AE : \"+=\"\r\nT_OP_SE : \"-=\"\r\nT_OP_SR : \">>\"\r\nT_OP_SL : \"<<\"\r\nT_OP_BORE : \"|=\"\r\nT_OP_BANDE : \"&=\"\r\nT_OP_XORE : \"^=\"\r\nT_OP_SRE : \">>=\"\r\nT_OP_SLE : \"<<=\"\r\n";class re extends te{init({grammar:e=ne,type:t=i.k_LALR,flags:n=a.k_Default}){super.init({grammar:e,type:t,flags:n})}}let ie=null,se=null;function ae(){return se||oe(),se}function oe(e={grammar:ne}){(0,c.vZ)(ie,e)||(ie=e,se=new re(e))}var le,ce=n("DIkA"),ue=n("W5eQ"),pe=n("jeW/"),he=n("AW2x"),de=n("vIQR");!function(e){e[e.k_Auto=0]="k_Auto",e[e.k_Manual=1]="k_Manual"}(le||(le={}));var me=n("FB51"),fe=n("Muaz"),ge=n("pGoc");class ye extends ge.W{constructor({name:e,args:t,...n}){super({instrType:de.rO.k_DrawStmt,...n}),this.name=e,this.args=t}toCode(){return`draw ${this.name};`}}var Te=n("A0ZU"),_e=n("dmHP");class Ee extends _e.L{constructor({spawnRoutine:e,initRoutine:t,updateRoutine:n,particle:r,capacity:i=-1,...s}){super({instrType:de.rO.k_PartFxDecl,techniqueType:de.vj.k_PartFx,...s}),this.spawnRoutine=e,this.initRoutine=t,this.updateRoutine=n,this.particle=r,this.capacity=i}isValid(){if(!this.spawnRoutine)return console.error("no spawn routine found"),!1;if(!ue.V5.equals(this.spawnRoutine.function.def.returnType,Te.T_VOID)&&!this.initRoutine)return console.error("init routine must be defined if regular spawner is used"),!1;if(!this.updateRoutine)return console.error("no update routine found"),!1;const e=!!this.particle,t=this.passes&&this.passes.filter((e=>e.isValid())).length>0;return e&&t}}var xe=n("Z/0D");class Se extends xe.f{constructor({sorting:e=!1,instanceCount:t=1,drawMode:n=le.k_Auto,prerenderRoutine:r,geometry:i,...s}){super({instrType:de.rO.k_PartFxPass,...s}),this.sorting=e,this.prerenderRoutine=r,this.geometry=i,this.instanceCount=t,this.drawMode=n}get particleInstance(){return(0,c.Ft)(this.prerenderRoutine)?null:this.prerenderRoutine.function.def.params[1].type.subType}isValid(){return!!this.particleInstance&&!!this.prerenderRoutine}}class ke extends ge.W{constructor({count:e,name:t,args:n,...r}){super({instrType:de.rO.k_SpawnStmt,...r}),this.count=e,this.args=n,this.name=t}toCode(){return`spawn(${this.count}) ${this.name}(${this.args.map((e=>e.toCode())).join(", ")});`}}const be=e=>e?e.type:null;class Ne extends me._{constructor(){super(...arguments),this.spawnStmts=[],this.drawStmts=[]}beginPartFxPass(){this.beginPass(),this.particleInstance=null}endPartFxPass(){this.particleInstance=null,this.endPass()}beginPartFx(){this.particleCore=null}endPartFx(){this.particleCore=null}}class ve extends me.L{analyzeSpawnStmt(e,t,n){const r=n.children,i=t.currentScope,s=r.slice(-5,-4)[0].value,a=[];for(let n=r.length-7;n>=2;n--)if(","!==r[n].value){const i=this.analyzeExpr(e,t,r[n]);a.push(i)}const o=this.analyzeExpr(e,t,r.slice(-3,-2)[0]),l=new ke({sourceNode:n,scope:i,name:s,args:a,count:o});return e.spawnStmts.push(l),l}analyzeDrawStmt(e,t,n){const r=n.children,i=t.currentScope,s=r[r.length-2].value,a=[];for(let n=r.length-4;n>=2;n--)if(","!==r[n].value){const i=this.analyzeExpr(e,t,r[n]);a.push(i)}const o=new ye({sourceNode:n,scope:i,name:s,args:a}),l=e.funcDef;return e.drawStmts.push({instr:o,ctx:l}),o}analyzeSimpleStmt(e,t,n){const r=n.children;switch(r[r.length-1].name){case"T_KW_SPAWN":return this.analyzeSpawnStmt(e,t,n);case"T_KW_DRAW":return this.analyzeDrawStmt(e,t,n);default:return super.analyzeSimpleStmt(e,t,n)}}analyzePartFXPassDecl(e,t,n){e.beginPartFxPass();const r=n.children,i=t.currentScope,s=this.analyzePassStateBlockForShaders(e,t,r[0]),a=this.analyzePassStateBlock(e,t,r[0]);e.renderStates=a;const o=this.analyzePartFxStateBlock(e,t,r[0]);let l=!!(0,c.jn)(o.sorting)&&o.sorting;const u=o.prerenderRoutine||null,p=o.geometry||null,h=o.instanceCount||1;l&&u&&ue.V5.equals(u.function.def.returnType,Te.T_VOID)&&(e.warn(n,he.S.PartFx_SortingCannotBeApplied),e.warn(u.function.def.sourceNode,he.S.PartFx_SortingCannotBeApplied));let d=s.pixel,m=s.vertex;if(m){const t=["POSITION","POSITION0"];let r=!1,i=!1;for(const n of m.def.params)r=r||n.type.subType===e.particleInstance,i=i||!!t.find((e=>n.type.hasFieldWithSematics(e)));r||(e.error(n,pe.g.PartFx_VertexShaderParametersMismatch,{tooltip:"vertex shader must have a valid material param which is compatible with prerender routine."}),m=d=null)}let f=null;for(let e=0;e<r.length;++e)if("T_NON_TYPE_ID"===r[e].name){let t=r[e].value;f=new fe.x({sourceNode:r[e],scope:i,name:t})}let g=le.k_Auto;f&&e.drawStmts.find((e=>e.instr.name==f.name))&&(g=le.k_Manual);const y=new Se({scope:i,sourceNode:n,id:f,sorting:l,geometry:p,instanceCount:h,prerenderRoutine:u,drawMode:g,renderStates:a,pixelShader:d,vertexShader:m});return e.endPartFxPass(),y}analyzePartFxStateBlock(e,t,n){const r=n.children;let i={};for(let n=r.length-2;n>=1;n--)i={...i,...this.analyzePartFXPassProperies(e,t,r[n])};return i}analyzePartFXPassProperies(e,t,n){const r=n.children,i=r[r.length-1].value.toUpperCase(),s=r[r.length-3],a=s.children[s.children.length-1];let o={};if((0,c.Ft)(a.value)||(0,c.Ft)(i))return console.warn("Pass state is incorrect."),o;if("{"===a.value&&s.children.length>3){const e=new Array(Math.ceil((s.children.length-2)/2));for(let t=s.children.length-2,n=0;t>=1;t-=2,n++)e[n]=s.children[t].value.toUpperCase();return console.warn("Pass fx state is incorrect."),o}{let n=null;switch(n="{"===a.value?s.children[1].value.toUpperCase():a.value.toUpperCase(),i){case"InstanceCount".toUpperCase():o.instanceCount=Number(n)||1;break;case"Geometry".toUpperCase():"T_STRING"==a.name?n=n.replace(/^"(.+)"$/,"$1"):console.assert("T_NON_TYPE_ID"===a.name),o.geometry=n.toLowerCase();break;case"Sorting".toUpperCase():(0,c.hu)("TRUE"==n||"FALSE"==n),o.sorting="TRUE"===n;break;case"PrerenderRoutine".toUpperCase():{let n=[{ret:Te.T_VOID,args:[e.particleCore,null]},{ret:Te.T_VOID,args:[e.particleCore,null,Te.T_INT]},{ret:Te.T_INT,args:[e.particleCore,null]},{ret:Te.T_INT,args:[e.particleCore,null,Te.T_INT]}],r=this.analyzeCompileExpr(e,t,a,n);if(!r)break;let i=r.function,s=i.def.params.map((e=>e.type));s.length<2&&(e.error(a,pe.g.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'PrerenderRoutine' arguments' count mismatch."}),r=null),s[0].readable&&s[0].subType===e.particleCore&&!s[0].isNotBaseArray()&&(s[1].usages.includes("out")||s[1].usages.includes("inout"))&&s[1].writable&&!s[1].isNotBaseArray()||(e.error(a,pe.g.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'PrerenderRoutine' arguments' type mismatch."}),r=null),e.particleInstance=s[1].subType,o.prerenderRoutine=r}}}return o}analyzePartFXBody(e,t,n){let r=[],i=null,s=null,a=null,o=null,l=null;const u=n.children;for(let n=u.length-2;n>0;n--)if("PassState"===u[n].name){let r=u[n];switch(r.children[3].value.toUpperCase()){case"Capacity".toUpperCase():{const e=r.children[1].children[0].value;(0,c.hu)((0,c.hj)(Number(e))),l=Number(e)||-1,l=64*Math.floor((l+63)/64);break}case"SpawnRoutine".toUpperCase():{let n=[{ret:Te.T_INT,args:[]},{ret:Te.T_VOID,args:[/.*/]},{ret:Te.T_VOID,args:[]}],s=r.children[1].children[0];i=this.analyzeCompileExpr(e,t,s,n);const a=i.function.def.params;a.length>0&&(a[0].type.usages.includes("inout")||e.warn(a[0].type.sourceNode,he.S.PartFx_EmitterPersistentDataMustBeMarkedAsInout))}break;case"InitRoutine".toUpperCase():{let n=[{ret:Te.T_VOID,args:[null,/u?int/]},{ret:Te.T_VOID,args:[null,/u?int/,/u?int/]},{ret:Te.T_VOID,args:[null]}],i=r.children[1].children[0];if(s=this.analyzeCompileExpr(e,t,i,n),!s)break;let l=s.function,c=l.def.params[0].type;(!c.usages.includes("out")&&!c.usages.includes("inout")||c.isNotBaseArray())&&(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),s=null),o&&c.subType!==o&&(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),a=null),o=c.subType}break;case"UpdateRoutine".toUpperCase():{let n=[{ret:Te.T_BOOL,args:[null,Te.T_INT]},{ret:Te.T_BOOL,args:[null]}],i=r.children[1].children[0];if(a=this.analyzeCompileExpr(e,t,i,n),!a)break;const s=a.function,l=s.def,c=l.params;(c.length<1||c.length>2)&&(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:s.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),a=null);let u=c[0].type;if((!u.usages.includes("out")&&!u.usages.includes("inout")||u.isNotBaseArray())&&(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:s.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),a=null),o&&u.subType!==o&&(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:s.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),a=null),ue.V5.equals(l.returnType,Te.T_BOOL)||(e.error(i,pe.g.InvalidCompileFunctionNotValid,{funcName:s.name,tooltip:"'UpdateRoutine' return type mismatch. 'boolean' is expected."}),a=null),!a)break;o=u.subType}}}e.particleCore=o;const p=[];for(let n=u.length-2;n>0;n--)switch(u[n].name){case"PassDecl":{if("PresetDecl"===u[n].children[0].name){p.push(this.analyzePresetDecl(e,t,u[n].children[0]));break}let i=this.analyzePartFXPassDecl(e,t,u[n]);i.isValid()||e.warn(i.id&&i.id.sourceNode||u[n],he.S.IncompletePass,{techniqueName:i.name,tooltip:"The pass is not completed. Not all required parameters are specified."}),(0,c.hu)(!(0,c.Ft)(i)),r.push(i)}}return{passes:r,spawnRoutine:i,initRoutine:s,updateRoutine:a,particle:o,capacity:l,presets:p}}analyzePartFXDecl(e,t,n){const r=n.children,i=this.analyzeComplexName(r[r.length-2]),s=(r[r.length-2].children.length,t.currentScope);let a=null,o=null,l=null;e.beginPartFx();for(let n=r.length-3;n>=0;n--)switch(r[n].name){case"Annotation":a=this.analyzeAnnotation(e,t,r[n]);break;case"Semantic":o=this.analyzeSemantic(r[n]);break;case"PartFxBody":l=this.analyzePartFXBody(e,t,r[n])}for(const t of e.drawStmts){const{instr:n,ctx:r}=t;l.passes.find((e=>e.id.name==n.name))||e.warn(n.sourceNode,he.S.PartFx_RenderPassWasNotFound,{techniqueName:i,tooltip:`The technique doesn't have pass with name <${n.name}>`});const s=r.params[0].type;ue.V5.equals(s,e.particleCore)&&s.readable||e.error(n.sourceNode,pe.g.PartFx_DrawOpOnlyAllowedWithinUpdateRoutine,{tooltip:"Draw operator only allowed within update routine"})}e.endPartFx();const c=new Ee({sourceNode:n,name:i,semantic:o,annotation:a,scope:s,...l});return c.isValid()||e.warn(r[r.length-2],he.S.IncompleteTechnique,{techniqueName:c.name,tooltip:"The technique is not completed. Not all required parameters are specified."}),ve.addTechnique(e,t,c),c}analyzeUnknDecl(e,t,n){return"PartFxDecl"===n.name?[this.analyzePartFXDecl(e,t,n)]:super.analyzeUnknDecl(e,t,n)}createContext(e){return new Ne(e)}validate(e,t,n){super.validate(e,t,n);const r=t.globalScope;if(!n.instructions)return;const i=n.instructions.filter((e=>e.instructionType===de.rO.k_PartFxDecl));for(const t of e.spawnStmts){const n=!1;if((0,c.hu)(!n,"unsupported"),!n){let n=null;for(const e of i){let i=[[/u?int/,/u?int/],[/u?int/],[]].map((n=>[e.particle,...n,...t.args.map(be)]));for(const e of i)if(n=r.findFunction(t.name,e),n)break;if(n)break}n||e.error(t.sourceNode,pe.g.PartFx_InvalidSpawnStmtInitializerNotFound,{tooltip:"Invalid spawn statement. Effect initializer not found."})}}}}class Re{constructor(e,t=null){this.root=t,this.nodes=[],this.optimized=e,this.nodesCountStack=[]}get lastNode(){return this.nodes[this.nodes.length-1]}finishTree(){this.root=this.nodes.pop()||null}addToken({name:e,value:t,loc:n}){this.addNode({name:e,value:t,loc:n,children:null,parent:null})}reduceByRule(e,n=t.k_Default){let r=0,i=this.nodesCountStack,s=e.right.length,a=this.nodes,o=this.optimized?1:0;for(;s;)r+=i.pop(),s--;if(n===t.k_Skip&&r>o||0===r)a.length-=r,i.push(0);else if(n===t.k_Default&&r>o||n===t.k_Necessary){(0,c.hu)(r>0);let t=a.pop();r--;const n={name:e.left,children:null,parent:null,value:"",loc:{...t.loc}};for(this.addLink(n,t);r;)(0,c.hu)(a.length>0),this.addLink(n,a.pop()),r--;a.push(n),i.push(1)}else i.push(r)}addNode(e){this.nodes.push(e),this.nodesCountStack.push(1)}$pop(e=null){let t=this.nodesCountStack.pop();for(;t;){let n=this.nodes.pop();e&&M(e,n.loc),t--}}addLink(e,t){e.children=e.children||[],M(e.loc,t.loc),e.children.push(t),t.parent=e}clone(){return new Re(this.optimized,this.cloneNode(this.root))}cloneNode({name:e,value:t,children:n}){const r={name:e,value:t,children:null,parent:null};return n&&n.forEach((e=>this.addLink(r,this.cloneNode(e)))),r}toString(){return this.root?this.toStringNode(this.root):""}toStringNode(e,t=""){let n=t+"{\n",r=t,i="  ";if(t+=i,e.value)n+=t+'name : "'+e.name+'",\n',n+=t+'value : "'+e.value+'"\n';else{n+=t+'name : "'+e.name+'"\n',n+=t+"children : [";let s=e.children;if(s){n+="\n",t+=i;for(let e=s.length-1;e>=0;e--)n+=this.toStringNode(s[e],t),n+=",\n";n=n.slice(0,n.length-2),n+="\n",n+=r+i+"]\n"}else n+=" ]\n"}return n+=r+"}",n}toHTMLString(e,t=""){let n=t+"{\n",r=t,i="  ";if(t+=i,(e=e||this.root).value)n+=t+'<b style="color: #458383;">name</b>: "'+e.name+'",\n',n+=t+'<b style="color: #458383;">value</b>: "'+e.value+'",\n',n+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',n+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n';else{let s;if(n+=t+'<i style="color: #8A2BE2;">name</i>: "'+e.name+'"\n',n+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',n+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n',n+=t+'<i style="color: #8A2BE2;">children</i>: [',e.children){for(n+="\n",t+=i,s=e.children.length-1;s>=0;s--)n+=this.toHTMLString(e.children[s],t),n+=",\n";n=n.slice(0,n.length-2),n+="\n",n+=r+i+"]\n"}else n+=" ]\n"}return n+=r+"}",n}}var Ce,we;!function(e){e[e.SyntaxUnknownError=2051]="SyntaxUnknownError",e[e.SyntaxUnexpectedEOF=2052]="SyntaxUnexpectedEOF",e[e.SyntaxRecoverableStateNotFound=2053]="SyntaxRecoverableStateNotFound",e[e.GeneralParsingLimitIsReached=2054]="GeneralParsingLimitIsReached"}(Ce||(Ce={})),function(e){e[e.MacroUnknownWarning=3e3]="MacroUnknownWarning",e[e.ReserveWordUsing=3001]="ReserveWordUsing"}(we||(we={}));class Oe extends J.g{constructor(){super("Parsing diagnostics","P")}resolveFilename(e,t,n){return n.file}resolveRange(e,t,n){if(e===ce.D.k_Warning&&t===we.MacroUnknownWarning)return n.loc;switch(t){case Ce.SyntaxUnknownError:case Ce.SyntaxUnexpectedEOF:return n.token.loc}return null}resolvePosition(e,t,n){return console.assert(t!=Ce.SyntaxUnknownError),{line:n.line,column:0,file:null}}diagnosticMessages(){return{[Ce.SyntaxUnknownError]:"Syntax error during parsing. Token: '{token.value}'\n{token.loc.start.file}:{token.loc.start.line}:{token.loc.start.column}.",[Ce.SyntaxUnexpectedEOF]:"Syntax error. Unexpected EOF.",[Ce.GeneralParsingLimitIsReached]:"Parsing limit is reached.",[Ce.SyntaxRecoverableStateNotFound]:"Recoverable state not found."}}resolveDescription(e,t,n){let r=this.diagnosticMessages();if((0,c.$V)(r[e]))return super.resolveDescription(e,t,n);let{file:i,loc:s,...a}=n;return t==ce.D.k_Warning?`${we[e]}: ${JSON.stringify(a)}`:`${Ce[e]}: ${JSON.stringify(a)}`}}function Pe(e){return{...e,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}class Ie{constructor(e){(0,c.hu)(e.parser,"parser engine is not defined"),this.init(e)}init({parser:e,knownTypes:t=new Set,ruleFunctions:n=new Map}){this.parser=e,this.knownTypes=t,this.ruleFunctions=n}get uri(){return this.lexer.document.uri}get diagnosticReport(){let e=this.lexer.getDiagnosticReport(),t=this.diag.resolve();return J.g.mergeReports([e,t])}get root(){return this.tree.root}async parse(e,t=s.k_Optimize){const n=C.testAll(t,s.k_DeveloperMode),i=C.testAll(t,s.k_Optimize);return this.diag=new Oe,this.tree=new Re(i),this.stack=[0],this.setTextDocument(e),this.token=await this.readToken(),this.token.name===F?r.k_Ok:(await this.run({developerMode:n,allowErrorRecoverty:!0}),this.diag.hasErrors()?(console.error("parsing was ended with errors."),r.k_Error):r.k_Ok)}setTextDocument(e){this.lexer=new Y({engine:this.parser.lexerEngine,knownTypes:this.knownTypes}),this.lexer.setTextDocument(e)}async readToken(){return this.lexer.getNextToken()}emitWarning(e,t){this.diag.warning(e,{token:t})}emitError(e,t){this.diag.error(e,{token:t})}emitCritical(e,t=null){this.diag.critical(e,{token:t})}async restoreState(e,t,n,r,i){for(;;){let s=-1;for(let t=n.length-1;t>=0;--t){const i=e[n[t]].ERROR;if((0,c.Xq)(i)&&i.type===l.k_Shift&&e[i.stateIndex][r.name]){s=t;break}}if(-1!==s){const e=n[s];let r=n.length-1-s;for(;0!=r;)t.$pop(i.loc),n.pop(),r--;return e}if(M(i.loc,r.loc),r.value===F)break;const a=await this.readToken();Object.keys(a).forEach((e=>r[e]=a[e]))}return-1}operationAdditionalAction(e,t){const n=this.parser.findFunctionByState(e,t);return(0,c.Ft)(n)?l.k_Ok:((0,c.hu)(!!this.ruleFunctions.has(n)),this.ruleFunctions.get(n)())}async run({developerMode:e=!1,allowErrorRecoverty:t=!0}){const{syntaxTable:n}=this.parser,{stack:r,tree:i}=this,s={index:-1,name:null,value:null};let a=s;let o=0;try{e:for(;;){e&&(o>64e5&&this.emitCritical(Ce.GeneralParsingLimitIsReached),o++);let u=r[r.length-1],p=n[u][this.token.name];if(t){if(!p){const e=/^[_a-zA-Z][_a-zA-Z0-9]{0,30}$/,t=this.token.name!==U&&e.test(this.token.value)&&n[u].T_NON_TYPE_ID;if(a.index===this.token.index){this.token=await this.readToken(),this.token.index,a=s;continue}this.token.name===F?this.emitError(Ce.SyntaxUnexpectedEOF,this.token):t||this.emitError(Ce.SyntaxUnknownError,this.token),a=Pe(this.token),this.token=t?{...Pe(this.token),name:U}:{...Pe(this.token),name:A}}p=n[u][this.token.name];const e=this.token.name===A;if(!p||e&&p.type===l.k_Shift){let e=Pe(a);for(;e.name===P;)e=await this.readToken(),e.index;u=await this.restoreState(n,i,r,e,this.token),-1===u&&this.emitCritical(Ce.SyntaxRecoverableStateNotFound),p=n[u][this.token.name],r.push(p.stateIndex),i.addToken(this.token),this.token=e;continue}}if((0,c.Xq)(p))switch(p.type){case l.k_Success:break e;case l.k_Shift:{const e=p.stateIndex;r.push(e),i.addToken(this.token);const t=this.operationAdditionalAction(e,this.token.name);t===l.k_Error?this.emitCritical(Ce.SyntaxUnknownError,this.token):t===l.k_Ok&&(this.token=await this.readToken(),this.token.index)}break;case l.k_Reduce:{const e=p.rule.right.length;r.length-=e;const t=n[r[r.length-1]][p.rule.left].stateIndex;r.push(t),i.reduceByRule(p.rule,this.parser.getRuleCreationMode(p.rule.left));this.operationAdditionalAction(t,p.rule.left)===l.k_Error&&this.emitCritical(Ce.SyntaxUnknownError,this.token)}}else(0,c.hu)(!t,"unexpected end, something went wrong :/"),this.emitCritical(Ce.SyntaxUnknownError,this.token)}i.finishTree()}catch(e){if(!(e instanceof J.V))throw e}}}class Ae{constructor(e){this.content=e}valueOf(){return this.content}toString(){return this.content}toSource(){return this.content}static make(e){if(!e)return null;if(!(0,c.HD)(e)){if(e instanceof Ae)return e;if((0,c.HD)(e.content))return Ae.make(e.content)}const t=e;let n=Ae.storage[t];return n||(n=new Ae(t),Ae.storage[t]=n,n)}}async function Fe(e,t,n=null){return{uri:e=Ae.make(e),source:t,offset:n}}Ae.storage={};class Le{constructor(e){this._dirname=null,this._extension=null,this._filename=null,(0,c.Xq)(e)&&this.set(e)}get path(){return this.toString()}set path(e){this.set(e)}get dirname(){return this._dirname}set dirname(e){this._dirname=e}get filename(){return this._filename}set filename(e){this._filename=e}get ext(){return this._extension}set ext(e){this._extension=e}get basename(){return this._filename?this._filename+(this._extension?"."+this._extension:""):""}set basename(e){var t=e.lastIndexOf(".");t<0?(this._filename=e.substr(0),this._extension=null):(this._filename=e.substr(0,t),this._extension=e.substr(t+1))}set(e){if((0,c.HD)(e)){var t=e.replace("\\","/").split("/");this.basename=t.pop(),this._dirname=t.join("/")}else{if(!(e instanceof Le)){if((0,c.Ft)(e))return null;throw new Error(`Unexpected data type was used: ${e}`)}this._dirname=e.dirname,this._filename=e.filename,this._extension=e.ext}}replaceExt(e){return this.ext=e,this}isAbsolute(){return!("/"!==this._dirname?.[0])}toString(){return(this._dirname?this._dirname+"/":"")+this.basename}}function De(e){var t=Ue(e),n=t.isAbsolute(),r=t.dirname,i=/[\\\/]$/.test(r);return(r=function(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}(r.split(/[\\\/]+/).filter((function(e){return!!e})),!n).join("/"))&&i&&(r+="/"),t.dirname=(n?"/":"")+r,t.toString()}function Ue(e){return new Le(e)}class Ke{constructor(e){this._scheme=null,this._userinfo=null,this._host=null,this._port=0,this._path=null,this._query=null,this._fragment=null,e&&this.set(e)}get urn(){return(this._path?this._path:"")+(this._query?"?"+this._query:"")+(this._fragment?"#"+this._fragment:"")}get url(){return(this._scheme?this._scheme+"//":"")+this.authority}get authority(){return this._host?(this._userinfo?this._userinfo+"@":"")+this._host+(this._port?":"+this._port:""):""}get scheme(){return this._scheme}get protocol(){return this._scheme?this._scheme.substr(0,this._scheme.lastIndexOf(":")):this._scheme}get userInfo(){return this._userinfo}get host(){return this._host}set host(e){this._host=e}get port(){return this._port}set port(e){this._port=e}get path(){return this._path}set path(e){this._path=e}get query(){return this._query}set query(e){this._query=e}get fragment(){return this._fragment}set(e){if((0,c.HD)(e)){var t=Ke.uriExp.exec(e);return console.assert(null!==t,"Invalid URI format used.\nused uri: "+e),t?(this._scheme=t[1]||null,this._userinfo=t[2]||null,this._host=t[3]||null,this._port=parseInt(t[4])||null,this._path=t[5]||t[6]||null,this._query=t[7]||null,this._fragment=t[8]||null,this):null}return e instanceof Ke?this.set(e.toString()):(console.error("Unexpected data type was used."),null)}toString(){return this.url+this.urn}}function Be(e){if(!(0,c.Ft)(e.path))if("filesystem:"===e.scheme){var t=We(e.path);t.path=De(t.path),e.path=t.toString()}else e.path=De(e.path);return e}function We(e){return new Ke(String(e))}Ke.uriExp=new RegExp("^([a-z0-9+.-]+:)?(?:\\/\\/(?:((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*)@)?((?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*)(?::(\\d*))?(\\/(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?|(\\/?(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?)(?:\\?((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?$","i");class ze{constructor(e){this.tokens=e||[],this.pos=0}get document(){return(0,c.hu)(!1),null}get config(){return(0,c.hu)(!1),null}setTextDocument(e){return(0,c.hu)(!1),this}getNextLine(){return(0,c.hu)(!1),null}getPosition(){return this.pos}setPosition(e){this.pos=e}getDiagnosticReport(){return(0,c.hu)(!1),null}getNextToken(){return this.tokens[this.pos++]||ze.END_TOKEN}}ze.END_TOKEN={index:-1,name:F,value:F,loc:null};class Ve{constructor(){this.stack=[{root:null,macros:{}}]}get depth(){return this.stack.length}get root(){return this.stack[this.depth-1].root}push(e){this.stack.push({root:e,macros:{}})}pop(){this.stack.pop()}set(e){this.stack[this.depth-1].macros[e.name]=e}unset(e){delete this.stack[this.depth-1].macros[e]}get(e){let t=this.depth-1;for(;;){const{macros:n,root:r}=this.stack[t];if(r?.name===e&&!r.bFunction)return null;const i=n[e];if(i)return i;if(0==t)break;t=0}return null}has(e){return null!==this.get(e)}forEach(e){let t=new Set;for(let n=this.depth-1;n>=0;--n){const r=this.stack[n].macros;for(const n of Object.values(r))t.has(n.name)||(t.add(n.name),e(n))}}*[Symbol.iterator](){let e=new Set;for(let t=this.depth-1;t>=0;--t){const n=this.stack[t].macros;for(const t of Object.values(n))e.has(t.name)||(e.add(t.name),yield t)}}}let Me=!1;var $e,qe,He,Ge;!function(e){e[e.k_AllowElse=0]="k_AllowElse",e[e.k_ForbidElse=1]="k_ForbidElse"}($e||($e={})),function(e){e[e.SyntaxUnknownError=7051]="SyntaxUnknownError",e[e.GeneralCouldNotReadFile=7200]="GeneralCouldNotReadFile",e[e.MacroUnknownError=7201]="MacroUnknownError"}(qe||(qe={})),function(e){e[e.MacroUnknownWarning=3e3]="MacroUnknownWarning"}(He||(He={}));class je extends J.g{constructor(){super("Preprocessor diagnostics","M")}resolveFilename(e,t,n){return n.file}resolveRange(e,t,n){if(e===ce.D.k_Warning&&t===He.MacroUnknownWarning)return n.loc;switch(t){case qe.SyntaxUnknownError:return n.token.loc;case qe.GeneralCouldNotReadFile:case qe.MacroUnknownError:return n.loc}return null}diagnosticMessages(){return{[qe.SyntaxUnknownError]:"Syntax error during parsing. Token: '{token.value}'\nLine: {token.loc.start.line}. Column: {token.loc.start.column}.",[qe.GeneralCouldNotReadFile]:"Could not read file '{target}'."}}resolveDescription(e,t,n){let r=this.diagnosticMessages();if((0,c.$V)(r[e]))return super.resolveDescription(e,t,n);let{file:i,loc:s,...a}=n;return t==ce.D.k_Warning?`${He[e]}: ${JSON.stringify(a)}`:`${qe[e]}: ${JSON.stringify(a)}`}}function Je(e,t){return(0,c.hu)((0,c.HD)(e),e),{index:-1,type:o.k_Unknown,name:K,value:e,loc:t}}function Qe(e){return{op:(...t)=>Je(String(e(...t)),$(...t.map((e=>e.loc)))),length:e.length}}function Xe(e,t=(()=>NaN)){const n=e.value;return"true"===String(n)?1:"false"===String(n)?0:String(Number(n))===String(n)?Number(n):t(e)}class Ye{constructor(){this.states=[]}is(e){return this.states[this.states.length-1]===e}isEmpty(){return 0===this.states.length}push(e){this.states.push(e)}pop(){return this.states.pop()}replace(e){this.pop(),this.push(e)}}!function(e){e[e.k_None=0]="k_None",e[e.k_Macro=1]="k_Macro",e[e.k_Include=2]="k_Include"}(Ge||(Ge={}));class Ze{constructor(e,{knownTypes:t=new Set,macros:n=new Ve,diag:r=new je,skipComments:i=!0,includeResolver:s=null,defines:a=null}={}){this.macros=n,a&&a.forEach((({name:e})=>this.macros.set({name:e,tokens:[],bFunction:!1,params:null,bRegionExpr:!1}))),this.macroState=new Ye,this.includeMap=new Map,this.unreachableCodeList=[],this.unresolvedMacros=[],this.knownTypes=t,this.lexerEngine=e,this.diagnostics=r,this.includeResolver=s,this.lexerReport=null,this.lexerOptions={skipComments:i},this.stack=[],this.includes=[]}get lexer(){return this.stack[this.stack.length-1].lexer}get tokens(){return this.stack[this.stack.length-1].tokens}get uri(){return this.document.uri}macroLocation(){const e=this.includes[this.includes.length-1];return e<this.stack.length-1?this.stack[e+1].loc:null}currentMacro(){return this.macros.root}getDiagnosticReport(){return J.g.mergeReports([this.lexerReport,this.diagnostics.resolve()])}readLine(){return this.lexer.getNextLine()}setTextDocument(e){return this.document=e,this.pushDocument(this.documentToLexer(e),null,Ge.k_Include),this}pushDocument(e,t,n,r=null){n&Ge.k_Macro&&((0,c.hu)((0,c.$V)(r)),this.macros.push(r)),n&Ge.k_Include&&(this.includes.push(this.stack.length),this.includeMap.set(`${e.document.uri}`,t)),this.stack.push({lexer:e,tokens:[],flags:n,loc:t})}pop(){const{flags:e,lexer:t}=this.stack.pop(),n=t.diagnostics;n&&!n.isEmpty()&&(this.lexerReport=J.g.mergeReports([this.lexerReport,t.getDiagnosticReport()])),e&Ge.k_Macro&&this.macros.pop(),e&Ge.k_Include&&this.includes.pop()}pushToken(...e){this.tokens.push(...e)}popToken(){return this.tokens.shift()||null}async readToken(e=!0,t=!0){const n=this.popToken()||this.lexer.getNextToken();switch(n.name){case K:if(e)return this.readMacro(n);break;case F:if(t){if(this.stack.length>1)return this.pop(),this.readToken(e);this.macroState.isEmpty()||this.emitMacroError("'endif' not found :/",n.loc)}break;default:if(e)return this.examMacro(n)}return n}async readMacro(e){switch(e.value){case"#define":return this.processDefineMacro(e);case"#ifdef":return this.processIfdefMacro(e);case"#ifndef":return this.processIfndefMacro(e);case"#endif":return this.processEndifMacro(e);case"#else":return this.processElseMacro(e);case"#elif":return this.processElifMacro(e);case"#if":return this.processIfMacro(e);case"#error":return this.processErrorMacro(e);case"#include":return this.processIncludeMacro(e);case"#undef":return this.processUndefMacro(e);case"#pragma":return this.readLine(),this.readToken()}return this.emitMacroWarning(`unsupported macro type found: ${e.value}`,e.loc),this.readToken()}async processUndefMacro(e){const t=await this.readToken(!1);this.readLine();return t.name!==U?((0,c.hu)(t.name===U),this.readToken()):(this.macros.has(t.value)?this.macros.unset(t.value):this.emitMacroWarning(`target macro not found: ${t.value}`,t.loc),this.readToken())}async processDefineMacro(e){const t=await this.readToken(!1),n=this.readLine();if(t.name!==U)return(0,c.hu)(t.name===U),this.readToken();this.macros.has(t.value)&&this.emitMacroWarning(`macro redefinition found: ${t.value}`,t.loc);const r=await this.processMacro(t,n);if(r){const e=this.unresolvedMacros.find((e=>e.name===t.value));e&&(r.bRegionExpr=e.bRegionExpr,this.unresolvedMacros=this.unresolvedMacros.filter((e=>e.name!==t.value))),this.macros.set(r)}return this.readToken()}async processMacro(e,t){let n=!1,r=null,i=[];if(!/^\s*$/.test(t.value)){const s=await this.tokenToLexer(t);let a=s.getNextToken();const o="("===a.value,l=a.loc.start.line===e.loc.end.line,c=a.loc.start.column===e.loc.end.column;if(o&&l&&c){r=[],n=!0;let e=!1;for(a=s.getNextToken();a.name!==F&&")"!==a.value;){if(e){if(","!==a.value)return this.emitMacroError("invalid macro, comma expected",a.loc),null}else{if(a.name!==U)return this.emitMacroError("invalid token found. only identifiers allowed as param names",a.loc),null;r.push(a.value)}e=!e,a=s.getNextToken()}if(a.name===F)return this.emitMacroError("comma mismatch",a.loc),null;a=s.getNextToken()}for(;a.name!==F;)i.push(a),a=s.getNextToken()}return i.forEach((e=>{e.synthetic=!0})),{name:e.value,tokens:i,bFunction:n,params:r,bRegionExpr:!1}}async processIfdefMacro(e){return this.resolveDefMacro(await this.lineToLexer(this.readLine()))?(this.macroState.push($e.k_ForbidElse),this.readToken()):(this.macroState.push($e.k_AllowElse),this.skipUnreachableCode(e))}async processIfndefMacro(e){return this.resolveDefMacro(await this.lineToLexer(this.readLine()))?(this.macroState.push($e.k_AllowElse),this.skipUnreachableCode(e)):(this.macroState.push($e.k_ForbidElse),this.readToken())}async processIfMacro(e){return this.resolveMacroInner(await this.lineToLexer(this.readLine()))?(this.macroState.push($e.k_ForbidElse),this.readToken()):(this.macroState.push($e.k_AllowElse),this.skipUnreachableCode(e))}async processElifMacro(e){return this.macroState.is($e.k_AllowElse)||this.macroState.is($e.k_ForbidElse)?this.macroState.is($e.k_AllowElse)&&this.resolveMacroInner(await this.lineToLexer(this.readLine()))?(this.macroState.replace($e.k_ForbidElse),this.readToken()):this.skipUnreachableCode(e):(this.emitMacroError("inappropriate control instruction found",e.loc),this.readToken())}async processElseMacro(e){return this.macroState.is($e.k_AllowElse)||this.macroState.is($e.k_ForbidElse)?this.macroState.is($e.k_AllowElse)?(this.macroState.replace($e.k_ForbidElse),this.readToken()):this.skipUnreachableCode(e):(this.emitMacroError("inappropriate control instruction found",e.loc),this.readToken())}async processEndifMacro(e){return this.macroState.is($e.k_AllowElse)||this.macroState.is($e.k_ForbidElse)?(this.macroState.pop(),this.readToken()):(this.emitMacroError("inappropriate control instruction found",e.loc),this.readToken())}resolveDefMacro(e){const t=this.macros,n=e=>Xe(e,(({value:e})=>{const n=t.get(e);return n?(n.bRegionExpr=!0,1):(this.addUnresolvedMacro(e),0)})),r=Qe,i=r(n),s={"&&":r(((e,t)=>n(e)&&n(t))),"||":r(((e,t)=>n(e)||n(t))),"!":r((e=>!n(e))),asValue:i};return this.evaluateMacroExpr(e,{"(":1,")":1,"&&":2,"||":3,"!":8},s,{})}resolveMacroInner(e){const t=this.macros,n=e=>this.resolveMacro(e),r=Qe,i=r(n),s={"(":1,")":1,"||":2,"&&":3,"<":4,">":4,"<=":4,">=":4,"==":5,"!=":5,"+":6,"-":6,"*":7,"/":7,"!":8,defined:9},a={"&&":r(((e,t)=>n(e)&&n(t))),"||":r(((e,t)=>n(e)||n(t))),"!":r((e=>!n(e))),"+":r(((e,t)=>n(e)+n(t))),"-":r(((e,t)=>n(e)-n(t))),"*":r(((e,t)=>n(e)*n(t))),"/":r(((e,t)=>n(e)/n(t))),"<":r(((e,t)=>n(e)<n(t))),">":r(((e,t)=>n(e)>n(t))),"<=":r(((e,t)=>n(e)<=n(t))),">=":r(((e,t)=>n(e)>=n(t))),"==":r(((e,t)=>n(e)===n(t))),"!=":r(((e,t)=>n(e)!==n(t))),asValue:i},l={defined:r((e=>{const n=t.get(e.value);return n?(n.bRegionExpr=!0,1):(this.addUnresolvedMacro(e.value),0)}))};return t.forEach((e=>{e.bFunction&&(s[e.name]=10,l[e.name]={op:(...n)=>{t.push(e),(0,c.hu)(e.params.length===n.length);const r=e.params;for(let e=0;e<r.length;++e)t.set({name:r[e],tokens:[n[e]],bFunction:!1,params:null,bRegionExpr:!1});const i=String(this.resolveMacroInner(this.macroToLexer(e)));t.pop();const s=$(...n.map((e=>e.loc)));return{index:-1,type:o.k_NumericLiteral,name:"T_UINT",value:i,loc:s}},length:e.params.length})})),this.evaluateMacroExpr(e,s,a,l)}resolveMacro(e){return Xe(e,(t=>{const n=this.macros.get(t.value);if(!(0,c.Ft)(n)&&!(0,c.Ft)(n.tokens)){const e=this.resolveMacroInner(this.macroToLexer(n));return e}return this.emitMacroWarning(`cannot resolve macro '${t.value}'`,e.loc),this.addUnresolvedMacro(t.value),NaN}))}addUnresolvedMacro(e){this.unresolvedMacros.find((t=>t.name===e))||this.unresolvedMacros.push({bFunction:!1,name:e,params:null,tokens:null,bRegionExpr:!0})}evaluateMacroExpr(e,t,n,r={}){const i=[],s=[];let a=e.getNextToken();e:for(;;){switch(a.name){case"T_TYPE_ID":case"T_NON_TYPE_ID":if(r[a.value]){s.push(a);break}i.push(a);break;case"T_UINT":case"T_KW_TRUE":case"T_KW_FALSE":i.push(a);break;case"T_PUNCTUATOR_40":s.push(a);break;case"T_PUNCTUATOR_41":{let e=s.pop();for(;"("!==e.value;)i.push(e),e=s.pop()}break;case"T_PUNCTUATOR_44":break;case F:break e;default:if(t[a.value]){if(s.length){const e=a.value,n=s[s.length-1].value;(0,c.hu)(t[n]&&t[e],n,e),t[n]>=t[e]&&i.push(s.pop())}s.push(a);break}return this.emitMacroError(`unsupported macro operator found: '${a.value}'`,a.loc),NaN}a=e.getNextToken()}for(;s.length;)i.push(s.pop());i.map((e=>e.value)).join(", ");const o=[];return i.forEach((e=>{if(t=e,(0,c.Xq)(n[t.value])){const{op:t,length:r}=(e=>n[e.value])(e);o.push(t(...o.splice(-r)))}else{var t;if((e=>(0,c.Xq)(r[e.value]))(e)){const{op:t,length:n}=(e=>r[e.value])(e);o.push(t(...o.splice(-n)))}else o.push(e)}})),1===i.length&&(o[0]=n.asValue.op(o[0])),Xe(o[0])}async processErrorMacro(e){const t=this.readLine(),n=t.value.trim();return this.emitMacroError(`erroneous macro reached: "${n}"`,$(e.loc,t.loc)),this.readToken()}async skipUnreachableCode(e){let t=await this.readToken(!1),n=0;for(;t.name!==F;){if(t.name===K)switch(t.value){case"#if":case"#ifdef":case"#ifndef":n++,this.readLine();break;case"#elif":case"#else":if(0!==n){this.readLine();break}case"#endif":if(n>0){n--,this.readLine();break}return this.addUnreachableCode(e,t),this.readMacro(t);case"#error":this.readLine()}t=await this.readToken(!1)}return this.emitMacroError("'endif' non found :/",t.loc),t}addUnreachableCode(e,t){const n={start:{...e.loc.end,column:0},end:{...t.loc.end,column:0}};n.start.line++,n.end.line-n.start.line>0&&this.unreachableCodeList.push(n)}async processIncludeMacro(e){const t=this.readLine(),n=function(e,t=document.location.href){var n,r=We(t),i=We(e);return Be(i),Be(r),(0,c.Ft)(i.scheme)&&(0,c.Ft)(i.host)&&!Ue(i.path).isAbsolute()?(n=Ue(r.path).dirname,r.path=n?n+"/"+e:e,Be(r).toString()):e}(t.value.trim().slice(1,-1),`${e.loc.start.file}`),r=$(e.loc,t.loc);this.includeMap.has(n);const i=await this.includeResolver(n);if(!i)return this.emitFileNotFound(n,r),this.readToken();const{uri:s,source:a}=i,o=await Fe(s,a);return this.pushDocument(this.documentToLexer(o),r,Ge.k_Include),this.readToken()}emitMacroWarning(e,t){this.diagnostics.warning(He.MacroUnknownWarning,{...t.start,loc:t,msg:e})}emitMacroError(e,t){this.diagnostics.error(qe.MacroUnknownError,{...t.start,loc:t,msg:e})}emitFileNotFound(e,t){this.diagnostics.error(qe.GeneralCouldNotReadFile,{...t.start,loc:t,target:e})}async applyMacro(e){const t=this.macros,n=t.get(e.value);if(!n)return null;if(n.bFunction){const r=this.lexer,i=this.lexer.getPosition(),s=await this.readToken();if("("!==s.value)return this.emitMacroWarning(`for macro '${n.name} function call signature is expected'`,e.loc),(0,c.hu)(r===this.lexer,"something went wrong"),this.lexer.setPosition(i),null;let a=[s],o=[],l=await this.readToken(),u=0,p=1,h=1;for(a.push(l);l.name!==F&&(")"!==l.value||0!=u);){switch(l.value){case"(":u++;break;case")":u--;break;case",":0===u&&((0,c.hu)(h-p>0),h-p>0&&o.push(p,h),p=h+1)}h++,l=await this.readToken(),a.push(l)}h>p&&o.push(p,h);const d=o.length/2;if(d!==n.params.length)return this.emitMacroError(`macro '${n.name}' arguments mismatch, expected count is ${n.params.length} but recived ${d}`,e.loc),(0,c.hu)(r===this.lexer,"something went wrong"),this.lexer.setPosition(i),null;{const{loc:{start:t}}=e,{loc:{end:r}}=l;this.pushDocument(this.macroToLexer(n),{start:t,end:r},Ge.k_Macro,n)}const m=n.params;for(let e=0;e<m.length;++e){const n=2*e,r=o[n],i=o[n+1],s=(a[r].loc.start,a[i-1].loc.end,a.slice(r,i));Me,t.set({name:m[e],tokens:s,bFunction:!1,params:null,bRegionExpr:!1})}}else this.pushDocument(this.macroToLexer(n),e.loc,Ge.k_Macro,n);return n}async preprocessToString(e,t){const{knownTypes:n,macros:r,diagnostics:i}=this,s=new Ze(this.lexerEngine,{knownTypes:n,macros:r,diag:i,includeResolver:t});s.setTextDocument(await Fe("://macro",e));let a=await s.readToken(),o=null;for(;a.name!==F;)o=(o?o+" ":"")+a.value,a=await s.readToken();return o}async applyConcatMacro(e){(0,c.hu)(!this.macros.get(e.value)||!this.macros.get(e.value).bFunction);const t=await this.readToken(!1,!1);(0,c.hu)(t.name!==F);const n=await this.preprocessToString(e.value,this.includeResolver),r=await this.preprocessToString(t.value,this.includeResolver),i=`${n}${r}`;const s={start:e.loc.start,end:t.loc.end},a=await this.readToken(!1,!1);if(a.name===B)return this.applyConcatMacro(Je(i,s));this.pushToken(a);const o=e.loc.start,l=await Fe(o.file,i,o);return this.pushDocument(this.documentToLexer(l),s,Ge.k_None),this.readToken()}async examMacro(e){if(this.stack[this.stack.length-1].flags&Ge.k_Macro){const t=await this.readToken(!1,!1);if(t.name===B)return this.applyConcatMacro(e);this.pushToken(t)}if(e.name===U||e.name===D){if(await this.applyMacro(e))return this.readToken()}return e}documentToLexer(e){const{lexerEngine:t,knownTypes:n,lexerOptions:{skipComments:r}}=this,i=new Y({engine:t,knownTypes:n,skipComments:r});return i.setTextDocument(e),i}tokensToLexer(e){return new ze(e)}macroToLexer(e){return this.tokensToLexer(e.tokens)}async tokenToLexer(e){const t=new Y({engine:this.lexerEngine,knownTypes:this.knownTypes}),n=e.loc.start.file,r=e.value,i=e.loc.start;return t.setTextDocument(await Fe(n,r,i)),t}async lineToTokens(e){const t=await this.tokenToLexer(e);let n=[],r=t.getNextToken();for(;r.name!==F;)n.push(r),r=t.getNextToken();return n}async lineToLexer(e){return this.tokensToLexer(await this.lineToTokens(e))}}const et=["half2","half3","half4","float2","float3","float4","float2x2","float2x3","float2x4","float3x2","float3x3","float3x4","float4x2","float4x3","float4x4","int2","int3","int4","uint2","uint3","uint4","bool2","bool3","bool4","auto"];class tt extends Ie{constructor({parser:e=ae(),knownTypes:t=new Set,...n}={}){super({parser:e,knownTypes:new Set([...et,...t]),...n})}get includes(){return this.preprocessor.includeMap}get unreachableCode(){return this.preprocessor.unreachableCodeList}get macros(){return[...this.preprocessor.macros]}get unresolvedMacros(){return this.preprocessor.unresolvedMacros}get uri(){return this.preprocessor.uri}get diagnosticReport(){let e=this.preprocessor.getDiagnosticReport(),t=this.diag.resolve();return J.g.mergeReports([e,t])}init(e){super.init(e);const{knownTypes:t}=this,{includeResolver:n,defines:r}=e;this.preprocessor=new Ze(this.parser.lexerEngine,{knownTypes:t,includeResolver:n,defines:r}),this.ruleFunctions.set("addType",this._addType.bind(this)),this.ruleFunctions.set("addTypeDef",this._addTypeDef.bind(this)),this.ruleFunctions.set("print",this._print.bind(this))}_addType(){const e=this.tree.lastNode.value;return this.knownTypes.add(e),l.k_Ok}_addTypeDef(){const e=this.tree.lastNode.children[0].value;return this.knownTypes.add(e),l.k_Ok}_print(){const e=this.tree.lastNode;return console.log(e),l.k_Ok}setTextDocument(e){this.preprocessor.setTextDocument(e)}async readToken(){const e=await this.preprocessor.readToken(),t=this.preprocessor.macroLocation();return t&&(e.loc=t),e}}async function nt(e,t={}){const{flags:n,knownTypes:r,includeResolver:i,defines:s}=t,a=new tt({knownTypes:new Set([...r||[]]),includeResolver:i,defines:s});return await a.parse(e,n),a}async function rt(e,t={},n=null){let r,i;(0,c.HD)(e.source)?(r=e,i=await nt(r,t)):i=e;const s=`createFXSLDocument(${i.uri})`;console.time(s);const a=new ve,o=await a.parse(i,n);return console.timeEnd(s),o}var it,st,at,ot,lt,ct,ut,pt,ht,dt,mt,ft,gt,yt,Tt,_t,Et,xt,St,kt,bt,Nt,vt,Rt,Ct,wt,Ot,Pt;!function(e){e.is=function(e){return"string"==typeof e}}(it||(it={})),function(e){e.is=function(e){return"string"==typeof e}}(st||(st={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(at||(at={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(ot||(ot={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=ot.MAX_VALUE),t===Number.MAX_VALUE&&(t=ot.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.uinteger(t.line)&&vn.uinteger(t.character)}}(lt||(lt={})),function(e){e.create=function(e,t,n,r){if(vn.uinteger(e)&&vn.uinteger(t)&&vn.uinteger(n)&&vn.uinteger(r))return{start:lt.create(e,t),end:lt.create(n,r)};if(lt.is(e)&&lt.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments[".concat(e,", ").concat(t,", ").concat(n,", ").concat(r,"]"))},e.is=function(e){var t=e;return vn.objectLiteral(t)&&lt.is(t.start)&&lt.is(t.end)}}(ct||(ct={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&ct.is(t.range)&&(vn.string(t.uri)||vn.undefined(t.uri))}}(ut||(ut={})),function(e){e.create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&ct.is(t.targetRange)&&vn.string(t.targetUri)&&ct.is(t.targetSelectionRange)&&(ct.is(t.originSelectionRange)||vn.undefined(t.originSelectionRange))}}(pt||(pt={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.numberRange(t.red,0,1)&&vn.numberRange(t.green,0,1)&&vn.numberRange(t.blue,0,1)&&vn.numberRange(t.alpha,0,1)}}(ht||(ht={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&ct.is(t.range)&&ht.is(t.color)}}(dt||(dt={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.string(t.label)&&(vn.undefined(t.textEdit)||kt.is(t))&&(vn.undefined(t.additionalTextEdits)||vn.typedArray(t.additionalTextEdits,kt.is))}}(mt||(mt={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(ft||(ft={})),function(e){e.create=function(e,t,n,r,i,s){var a={startLine:e,endLine:t};return vn.defined(n)&&(a.startCharacter=n),vn.defined(r)&&(a.endCharacter=r),vn.defined(i)&&(a.kind=i),vn.defined(s)&&(a.collapsedText=s),a},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.uinteger(t.startLine)&&vn.uinteger(t.startLine)&&(vn.undefined(t.startCharacter)||vn.uinteger(t.startCharacter))&&(vn.undefined(t.endCharacter)||vn.uinteger(t.endCharacter))&&(vn.undefined(t.kind)||vn.string(t.kind))}}(gt||(gt={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return vn.defined(t)&&ut.is(t.location)&&vn.string(t.message)}}(yt||(yt={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(Tt||(Tt={})),function(e){e.Unnecessary=1,e.Deprecated=2}(_t||(_t={})),function(e){e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.string(t.href)}}(Et||(Et={})),function(e){e.create=function(e,t,n,r,i,s){var a={range:e,message:t};return vn.defined(n)&&(a.severity=n),vn.defined(r)&&(a.code=r),vn.defined(i)&&(a.source=i),vn.defined(s)&&(a.relatedInformation=s),a},e.is=function(e){var t,n=e;return vn.defined(n)&&ct.is(n.range)&&vn.string(n.message)&&(vn.number(n.severity)||vn.undefined(n.severity))&&(vn.integer(n.code)||vn.string(n.code)||vn.undefined(n.code))&&(vn.undefined(n.codeDescription)||vn.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(vn.string(n.source)||vn.undefined(n.source))&&(vn.undefined(n.relatedInformation)||vn.typedArray(n.relatedInformation,yt.is))}}(xt||(xt={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i={title:e,command:t};return vn.defined(n)&&n.length>0&&(i.arguments=n),i},e.is=function(e){var t=e;return vn.defined(t)&&vn.string(t.title)&&vn.string(t.command)}}(St||(St={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.string(t.newText)&&ct.is(t.range)}}(kt||(kt={})),function(e){e.create=function(e,t,n){var r={label:e};return void 0!==t&&(r.needsConfirmation=t),void 0!==n&&(r.description=n),r},e.is=function(e){var t=e;return vn.objectLiteral(t)&&vn.string(t.label)&&(vn.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(vn.string(t.description)||void 0===t.description)}}(bt||(bt={})),function(e){e.is=function(e){var t=e;return vn.string(t)}}(Nt||(Nt={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return kt.is(t)&&(bt.is(t.annotationId)||Nt.is(t.annotationId))}}(vt||(vt={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return vn.defined(t)&&Ft.is(t.textDocument)&&Array.isArray(t.edits)}}(Rt||(Rt={})),function(e){e.create=function(e,t,n){var r={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){var t=e;return t&&"create"===t.kind&&vn.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||vn.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||vn.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||Nt.is(t.annotationId))}}(Ct||(Ct={})),function(e){e.create=function(e,t,n,r){var i={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(i.options=n),void 0!==r&&(i.annotationId=r),i},e.is=function(e){var t=e;return t&&"rename"===t.kind&&vn.string(t.oldUri)&&vn.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||vn.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||vn.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||Nt.is(t.annotationId))}}(wt||(wt={})),function(e){e.create=function(e,t,n){var r={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){var t=e;return t&&"delete"===t.kind&&vn.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||vn.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||vn.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||Nt.is(t.annotationId))}}(Ot||(Ot={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return vn.string(e.kind)?Ct.is(e)||wt.is(e)||Ot.is(e):Rt.is(e)})))}}(Pt||(Pt={}));var It,At,Ft,Lt,Dt,Ut,Kt,Bt,Wt,zt,Vt,Mt,$t,qt,Ht,Gt,jt,Jt,Qt,Xt,Yt,Zt,en,tn,nn,rn,sn,an,on,ln,cn,un,pn,hn,dn,mn,fn,gn,yn,Tn,_n,En,xn,Sn,kn=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var r,i;if(void 0===n?r=kt.insert(e,t):Nt.is(n)?(i=n,r=vt.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=vt.insert(e,t,i)),this.edits.push(r),void 0!==i)return i},e.prototype.replace=function(e,t,n){var r,i;if(void 0===n?r=kt.replace(e,t):Nt.is(n)?(i=n,r=vt.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=vt.replace(e,t,i)),this.edits.push(r),void 0!==i)return i},e.prototype.delete=function(e,t){var n,r;if(void 0===t?n=kt.del(e):Nt.is(t)?(r=t,n=vt.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(t),n=vt.del(e,r)),this.edits.push(n),void 0!==r)return r},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),bn=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(Nt.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id ".concat(n," is already in use."));if(void 0===t)throw new Error("No annotation provided for id ".concat(n));return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}();!function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new bn(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(Rt.is(e)){var n=new kn(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var r=new kn(e.changes[n]);t._textEditChanges[n]=r}))):this._workspaceEdit={}}Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(Ft.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(r=this._textEditChanges[t.uri])){var n={textDocument:t,edits:i=[]};this._workspaceEdit.documentChanges.push(n),r=new kn(i,this._changeAnnotations),this._textEditChanges[t.uri]=r}return r}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var r;if(!(r=this._textEditChanges[e])){var i=[];this._workspaceEdit.changes[e]=i,r=new kn(i),this._textEditChanges[e]=r}return r},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new bn,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,i,s;if(bt.is(t)||Nt.is(t)?r=t:n=t,void 0===r?i=Ct.create(e,n):(s=Nt.is(r)?r:this._changeAnnotations.manage(r),i=Ct.create(e,n,s)),this._workspaceEdit.documentChanges.push(i),void 0!==s)return s},e.prototype.renameFile=function(e,t,n,r){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,s,a;if(bt.is(n)||Nt.is(n)?i=n:r=n,void 0===i?s=wt.create(e,t,r):(a=Nt.is(i)?i:this._changeAnnotations.manage(i),s=wt.create(e,t,r,a)),this._workspaceEdit.documentChanges.push(s),void 0!==a)return a},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,i,s;if(bt.is(t)||Nt.is(t)?r=t:n=t,void 0===r?i=Ot.create(e,n):(s=Nt.is(r)?r:this._changeAnnotations.manage(r),i=Ot.create(e,n,s)),this._workspaceEdit.documentChanges.push(i),void 0!==s)return s}}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return vn.defined(t)&&vn.string(t.uri)}}(It||(It={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return vn.defined(t)&&vn.string(t.uri)&&vn.integer(t.version)}}(At||(At={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return vn.defined(t)&&vn.string(t.uri)&&(null===t.version||vn.integer(t.version))}}(Ft||(Ft={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){var t=e;return vn.defined(t)&&vn.string(t.uri)&&vn.string(t.languageId)&&vn.integer(t.version)&&vn.string(t.text)}}(Lt||(Lt={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(Dt||(Dt={})),function(e){e.is=function(e){var t=e;return vn.objectLiteral(e)&&Dt.is(t.kind)&&vn.string(t.value)}}(Ut||(Ut={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(Kt||(Kt={})),function(e){e.PlainText=1,e.Snippet=2}(Bt||(Bt={})),function(e){e.Deprecated=1}(Wt||(Wt={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&vn.string(t.newText)&&ct.is(t.insert)&&ct.is(t.replace)}}(zt||(zt={})),function(e){e.asIs=1,e.adjustIndentation=2}(Vt||(Vt={})),function(e){e.is=function(e){var t=e;return t&&(vn.string(t.detail)||void 0===t.detail)&&(vn.string(t.description)||void 0===t.description)}}(Mt||(Mt={})),function(e){e.create=function(e){return{label:e}}}($t||($t={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(qt||(qt={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return vn.string(t)||vn.objectLiteral(t)&&vn.string(t.language)&&vn.string(t.value)}}(Ht||(Ht={})),function(e){e.is=function(e){var t=e;return!!t&&vn.objectLiteral(t)&&(Ut.is(t.contents)||Ht.is(t.contents)||vn.typedArray(t.contents,Ht.is))&&(void 0===e.range||ct.is(e.range))}}(Gt||(Gt={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(jt||(jt={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i={label:e};return vn.defined(t)&&(i.documentation=t),vn.defined(n)?i.parameters=n:i.parameters=[],i}}(Jt||(Jt={})),function(e){e.Text=1,e.Read=2,e.Write=3}(Qt||(Qt={})),function(e){e.create=function(e,t){var n={range:e};return vn.number(t)&&(n.kind=t),n}}(Xt||(Xt={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(Yt||(Yt={})),function(e){e.Deprecated=1}(Zt||(Zt={})),function(e){e.create=function(e,t,n,r,i){var s={name:e,kind:t,location:{uri:r,range:n}};return i&&(s.containerName=i),s}}(en||(en={})),function(e){e.create=function(e,t,n,r){return void 0!==r?{name:e,kind:t,location:{uri:n,range:r}}:{name:e,kind:t,location:{uri:n}}}}(tn||(tn={})),function(e){e.create=function(e,t,n,r,i,s){var a={name:e,detail:t,kind:n,range:r,selectionRange:i};return void 0!==s&&(a.children=s),a},e.is=function(e){var t=e;return t&&vn.string(t.name)&&vn.number(t.kind)&&ct.is(t.range)&&ct.is(t.selectionRange)&&(void 0===t.detail||vn.string(t.detail))&&(void 0===t.deprecated||vn.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(nn||(nn={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(rn||(rn={})),function(e){e.Invoked=1,e.Automatic=2}(sn||(sn={})),function(e){e.create=function(e,t,n){var r={diagnostics:e};return null!=t&&(r.only=t),null!=n&&(r.triggerKind=n),r},e.is=function(e){var t=e;return vn.defined(t)&&vn.typedArray(t.diagnostics,xt.is)&&(void 0===t.only||vn.typedArray(t.only,vn.string))&&(void 0===t.triggerKind||t.triggerKind===sn.Invoked||t.triggerKind===sn.Automatic)}}(an||(an={})),function(e){e.create=function(e,t,n){var r={title:e},i=!0;return"string"==typeof t?(i=!1,r.kind=t):St.is(t)?r.command=t:r.edit=t,i&&void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return t&&vn.string(t.title)&&(void 0===t.diagnostics||vn.typedArray(t.diagnostics,xt.is))&&(void 0===t.kind||vn.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||St.is(t.command))&&(void 0===t.isPreferred||vn.boolean(t.isPreferred))&&(void 0===t.edit||Pt.is(t.edit))}}(on||(on={})),function(e){e.create=function(e,t){var n={range:e};return vn.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return vn.defined(t)&&ct.is(t.range)&&(vn.undefined(t.command)||St.is(t.command))}}(ln||(ln={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return vn.defined(t)&&vn.uinteger(t.tabSize)&&vn.boolean(t.insertSpaces)}}(cn||(cn={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return vn.defined(t)&&ct.is(t.range)&&(vn.undefined(t.target)||vn.string(t.target))}}(un||(un={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return vn.objectLiteral(n)&&ct.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(pn||(pn={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(hn||(hn={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(dn||(dn={})),function(e){e.is=function(e){var t=e;return vn.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(mn||(mn={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){var t=e;return null!=t&&ct.is(t.range)&&vn.string(t.text)}}(fn||(fn={})),function(e){e.create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},e.is=function(e){var t=e;return null!=t&&ct.is(t.range)&&vn.boolean(t.caseSensitiveLookup)&&(vn.string(t.variableName)||void 0===t.variableName)}}(gn||(gn={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){var t=e;return null!=t&&ct.is(t.range)&&(vn.string(t.expression)||void 0===t.expression)}}(yn||(yn={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){var t=e;return vn.defined(t)&&ct.is(e.stoppedLocation)}}(Tn||(Tn={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(_n||(_n={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){var t=e;return vn.objectLiteral(t)&&(void 0===t.tooltip||vn.string(t.tooltip)||Ut.is(t.tooltip))&&(void 0===t.location||ut.is(t.location))&&(void 0===t.command||St.is(t.command))}}(En||(En={})),function(e){e.create=function(e,t,n){var r={position:e,label:t};return void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return vn.objectLiteral(t)&&lt.is(t.position)&&(vn.string(t.label)||vn.typedArray(t.label,En.is))&&(void 0===t.kind||_n.is(t.kind))&&void 0===t.textEdits||vn.typedArray(t.textEdits,kt.is)&&(void 0===t.tooltip||vn.string(t.tooltip)||Ut.is(t.tooltip))&&(void 0===t.paddingLeft||vn.boolean(t.paddingLeft))&&(void 0===t.paddingRight||vn.boolean(t.paddingRight))}}(xn||(xn={})),function(e){e.is=function(e){var t=e;return vn.objectLiteral(t)&&st.is(t.uri)&&vn.string(t.name)}}(Sn||(Sn={}));var Nn;!function(e){function t(e,n){if(e.length<=1)return e;var r=e.length/2|0,i=e.slice(0,r),s=e.slice(r);t(i,n),t(s,n);for(var a=0,o=0,l=0;a<i.length&&o<s.length;){var c=n(i[a],s[o]);e[l++]=c<=0?i[a++]:s[o++]}for(;a<i.length;)e[l++]=i[a++];for(;o<s.length;)e[l++]=s[o++];return e}e.create=function(e,t,n,r){return new Rn(e,t,n,r)},e.is=function(e){var t=e;return!!(vn.defined(t)&&vn.string(t.uri)&&(vn.undefined(t.languageId)||vn.string(t.languageId))&&vn.uinteger(t.lineCount)&&vn.func(t.getText)&&vn.func(t.positionAt)&&vn.func(t.offsetAt))},e.applyEdits=function(e,n){for(var r=e.getText(),i=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),s=r.length,a=i.length-1;a>=0;a--){var o=i[a],l=e.offsetAt(o.range.start),c=e.offsetAt(o.range.end);if(!(c<=s))throw new Error("Overlapping edit");r=r.substring(0,l)+o.newText+r.substring(c,r.length),s=l}return r}}(Nn||(Nn={}));var vn,Rn=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var i=t.charAt(r);n="\r"===i||"\n"===i,"\r"===i&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return lt.create(0,e);for(;n<r;){var i=Math.floor((n+r)/2);t[i]>e?r=i:n=i+1}var s=n-1;return lt.create(s,e-t[s])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,r){return"[object Number]"===t.call(e)&&n<=e&&e<=r},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(vn||(vn={}));class Cn{doProvide(e,t){if(!t)return[];const n=[],r=t.root.scope,i=(e,t)=>{const n=lt.create(t.start.line,t.start.column),r=ct.create(n,n),i=ln.create(r);return i.command=St.create(e,null),i};if(!(0,c.Ft)(r))for(const t in r.techniques){const s=r.techniques[t];if(s.type===de.vj.k_PartFx){const t=s;if(t.spawnRoutine){const e=t.spawnRoutine.function.def,r=t.spawnRoutine.function.def.sourceNode;ue.V5.equals(e.returnType,Te.T_VOID)?e.params.length>0?n.push(i("[extened spawn]",r.loc)):n.push(i("[generic spawn]",r.loc)):n.push(i("[regular spawn]",r.loc))}if(t.initRoutine){const e=t.initRoutine.function.def.sourceNode;n.push(i("[init routine]",e.loc))}if(t.updateRoutine){const e=t.updateRoutine.function.def.sourceNode;n.push(i("[update routine]",e.loc))}if(t.particle&&t.particle.instructionType!==de.rO.k_SystemType){const e=t.particle.sourceNode;n.push(i("[particle]",e.loc))}for(const r of t.passes)if(r.prerenderRoutine){{const e=r.prerenderRoutine.function.def.sourceNode;n.push(i("[prerender routine]",e.loc))}{const t=r.particleInstance.sourceNode;t.loc.start.file.toString()===e.uri&&n.push(i("[material]",t.loc))}}}}return n}}var wn=n("q04y");const On=e=>e.sourceNode.loc;class Pn{doSignatureHelp(e,t,n){if(!n)return null;const r=e.offsetAt(t),i=n.root.instructions.find((e=>H(On(e),r)));if(i&&i.instructionType===de.rO.k_FunctionDecl){let e=null;if(wn.a.each(i,(t=>{t.instructionType===de.rO.k_FunctionCallExpr&&H(On(t),r)&&(e=t)})),!e)return null;const t=e.decl,n=t.scope.functions[t.name],s=n.map((e=>Jt.create(e.def.toCode(),null,...e.def.params.map((e=>jt.create(e.name))))));let a=n.indexOf(t),o=0;return-1!==a?o=e.args.findIndex((e=>H(On(e),r))):(a=0,console.error(`could not find active signature for: '${t.def.toCode()}'`)),{signatures:s,activeParameter:o,activeSignature:a}}return null}}const In=Symbol("Comlink.proxy"),An=Symbol("Comlink.endpoint"),Fn=Symbol("Comlink.releaseProxy"),Ln=Symbol("Comlink.thrown"),Dn=e=>"object"==typeof e&&null!==e||"function"==typeof e,Un=new Map([["proxy",{canHandle:e=>Dn(e)&&e[In],serialize(e){const{port1:t,port2:n}=new MessageChannel;return Kn(e,t),[n,[n]]},deserialize(e){return e.start(),zn(e,[],t);var t}}],["throw",{canHandle:e=>Dn(e)&&Ln in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function Kn(e,t=self){t.addEventListener("message",(function n(r){if(!r||!r.data)return;const{id:i,type:s,path:a}=Object.assign({path:[]},r.data),o=(r.data.argumentList||[]).map(qn);let l;try{const t=a.slice(0,-1).reduce(((e,t)=>e[t]),e),n=a.reduce(((e,t)=>e[t]),e);switch(s){case"GET":l=n;break;case"SET":t[a.slice(-1)[0]]=qn(r.data.value),l=!0;break;case"APPLY":l=n.apply(t,o);break;case"CONSTRUCT":l=function(e){return Object.assign(e,{[In]:!0})}(new n(...o));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;Kn(e,n),l=function(e,t){return Mn.set(e,t),e}(t,[t])}break;case"RELEASE":l=void 0;break;default:return}}catch(e){l={value:e,[Ln]:0}}Promise.resolve(l).catch((e=>({value:e,[Ln]:0}))).then((e=>{const[r,a]=$n(e);t.postMessage(Object.assign(Object.assign({},r),{id:i}),a),"RELEASE"===s&&(t.removeEventListener("message",n),Bn(t))}))})),t.start&&t.start()}function Bn(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function Wn(e){if(e)throw new Error("Proxy has been released and is not useable")}function zn(e,t=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(n,s){if(Wn(r),s===Fn)return()=>Hn(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{Bn(e),r=!0}));if("then"===s){if(0===t.length)return{then:()=>i};const n=Hn(e,{type:"GET",path:t.map((e=>e.toString()))}).then(qn);return n.then.bind(n)}return zn(e,[...t,s])},set(n,i,s){Wn(r);const[a,o]=$n(s);return Hn(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},o).then(qn)},apply(n,i,s){Wn(r);const a=t[t.length-1];if(a===An)return Hn(e,{type:"ENDPOINT"}).then(qn);if("bind"===a)return zn(e,t.slice(0,-1));const[o,l]=Vn(s);return Hn(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:o},l).then(qn)},construct(n,i){Wn(r);const[s,a]=Vn(i);return Hn(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:s},a).then(qn)}});return i}function Vn(e){const t=e.map($n);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const Mn=new WeakMap;function $n(e){for(const[t,n]of Un)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},Mn.get(e)||[]]}function qn(e){switch(e.type){case"HANDLER":return Un.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Hn(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}function Gn(e){const{code:t,content:n,start:r,end:i,category:s}=e,a={[ce.D.k_Error]:Tt.Error,[ce.D.k_Warning]:Tt.Warning};return{range:ct.create(r.line,r.column,(i||r).line,(i||r).column),severity:a[s],code:t,message:n,source:`${r.file}`}}Kn(new class{constructor(){this.documents=new Map}init(e,t,n,r){console.log("%c Creating parser for language service provider...","background: #222; color: #bada55");try{oe(e),console.log("%c [ DONE ]","background: #222; color: #bada55")}catch(e){return console.error("could not initialize parser."),null}this.service=function(e){const t=new Pn,n=new Cn;return{async $parseSLASTDocument(t){const n=t.uri,r=t.getText();return await nt(await Fe(n,r),e)},$parseSLDocument:async e=>await rt(e),async parseDocument(t){const n=t.uri,r=t.getText();return await rt(await Fe(n,r),e)},doResolve:e=>null,doComplete:(e,t,n)=>null,findDocumentSymbols:(e,t)=>[],findDocumentColors:(e,t)=>null,getColorPresentations:(e,t,n,r)=>[],doHover:(e,t,n)=>null,format:(e,t,n)=>[],getFoldingRanges:e=>[],getSelectionRanges:(e,t,n)=>[],doSignatureHelp:t.doSignatureHelp.bind(t),doFxCodeLenses:n.doProvide.bind(n)}}({flags:t,includeResolver:n,defines:r})}async validate(e){const t=function({_content:e,_languageId:t,_lineOffsets:n,_uri:r,_version:i}){return Nn.create(r,t,i,e)}(e),n=await this.service.$parseSLASTDocument(t),r=await this.service.$parseSLDocument(n);return this.documents.set(t.uri,{textDocument:t,slastDocument:n,slDocument:r}),r.diagnosticReport.messages.forEach((e=>{const t=function(e,t){if(!t)return null;const{includes:n,uri:r}=t;let i=e;for(;i&&String(r)!==String(i.start.file);)i=n.get(String(i.start.file));return i}(e,n);if(!t)return;const{start:r,end:i}=t;e.start=r,e.end=i})),r.diagnosticReport.messages.filter((e=>"A3008"!==e.code)).map(Gn)}async provideFxCodeLenses(e){if(!this.service)return[];const{textDocument:t,slDocument:n}=await this.getDocument(e);return this.service.doFxCodeLenses(t,n)}async provideSignatureHelp(e,t){if(!this.service)return null;const{textDocument:n,slDocument:r}=await this.getDocument(e);return this.service.doSignatureHelp(n,t,r)}getDocument(e){return this.documents.has(e.uri)?this.documents.get(e.uri):(console.warn("could not find document",e.uri),{textDocument:null,slastDocument:null,slDocument:null})}})})()})();
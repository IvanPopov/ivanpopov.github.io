/*! For license information please see 8120badfd321fa12f0cc.worker.js.LICENSE */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="Vs+U")}({"+Z36":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("mXWi"),i=n("2b0+");class s extends a.a{constructor({name:e,techniqueType:t,passList:n,...a}){super({instrType:r.b.k_TechniqueDecl,...a}),this._name=e,this._passList=n.map(e=>i.a.$withParent(e,this)),this._techniqueType=t}get name(){return this._name}get passList(){return this._passList}get type(){return this._techniqueType}}},"/zHR":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("zX2+");function a(e){return`${e.line},${e.column}`}function i(e,t){return e.replace(/{([a-zA-Z.]+)}/g,(e,n)=>(function e(t,n){let r=n.split(".");return r.length>1?e(t[r[0]],r.splice(1).join(".")):t[r[0]]})(t,n))}class s extends Error{constructor(e,t){super(t.content),Error.captureStackTrace(this,s)}}class o{constructor(e,t){this._name=e,this._codePrefix=(t||"").toUpperCase(),this.reset()}emitException(){throw new s(this,this.getLastError())}reset(){this._entries=[]}resolve(){let e={errors:0,warnings:0,messages:[]};for(let t of this._entries){let n=this.resolveEntry(t);switch(n.category){case r.a.k_Warning:e.warnings++;break;case r.a.k_Error:e.errors++}e.messages.push(n)}return e}resolveEntry(e){let t,n,r,i=null,s=this.resolveFilename(e.code,e.desc);(t=this.resolveRange(e.code,e.desc))?(({start:n,end:r}=t),i=function(e){return`${a(e.start)}:${a(e.end)}`}(t)):i=a(n=this.resolvePosition(e.code,e.desc));let o=`${this.resolveDescription(e.code,e.category,e.desc)}`;return{code:`${this._codePrefix}${e.code}`,category:e.category,content:o,file:s,start:n,end:r}}resolveFilename(e,t){return"[unknown]"}resolvePosition(e,t){return{file:null,line:0,column:0}}resolveRange(e,t){return null}resolveDescription(e,t,n){let r=this.diagnosticMessages();return r?r[e]?i(r[e],n):`[no description found for code '${e}']`:(console.error(`Diagnostic messages of '${this._name}' not found.`),"[no description found]")}diagnosticMessages(){return null}error(e,t){this._entries.push({category:r.a.k_Error,code:e,desc:t})}warning(e,t){this._entries.push({category:r.a.k_Warning,code:e,desc:t})}critical(e,t){this.error(e,t),this.emitException()}prettyPrint(){return null}hasErrors(){return this._entries.filter(e=>e.category===r.a.k_Error).length>0}getLastError(){for(let e=this._entries.length-1;e>=0;--e)if(this._entries[e].category===r.a.k_Error)return this.resolveEntry(this._entries[e]);return null}static mergeReports(e){let t={errors:0,warnings:0,messages:[]};return e.forEach(e=>{t.errors+=e.errors,t.warnings+=e.warnings,t.messages=t.messages.concat(e.messages)}),t}static stringify(e){return e.messages.map(e=>e.content).join("\n")}static asRange(e){let t={start:e.start,end:e.end};t.end||(t.end={...t.start});const{start:n,end:r}=t;return r.line==n.line&&r.column==n.column&&(r.column+=1),t}}},"1O8D":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("FrU9"),i=n("2b0+"),s=n("oseZ");class o extends s.a{constructor({cond:e,conseq:t,attributes:n=null,contrary:r=null,...s}){super({instrType:a.b.k_IfStmt,...s}),this.cond=i.a.$withParent(e,this),this.conseq=i.a.$withParent(t,this),this.contrary=i.a.$withParent(r,this),this.attributes=(n||[]).map(e=>i.a.$withParent(e,this))}toCode(){var e="";return Object(r.f)(this.contrary)?(e+="if(",e+=this.cond.toCode()+")",e+=this.conseq.toCode()):(e+="if(",e+=this.cond.toCode()+") ",e+=this.conseq.toCode(),e+="else ",e+=this.contrary.toCode()),e}}},"2b0+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("fb8x"),a=n("FrU9");class i{constructor({scope:e,instrType:t,sourceNode:n=null,visible:r=!0}){this._sourceNode=n,this._instructionType=t,this._instructionID=i.INSTRUCTION_COUNTER++,this._scope=e,this._parent=null,this._lastError=null}get parent(){return this._parent}get instructionType(){return console.assert(this._instructionType!=a.b.k_Instruction,"Instruction type 'k_Instruction' is forbidden."),this._instructionType}get instructionName(){return a.b[this.instructionType]}get instructionID(){return this._instructionID}get scope(){return Object(r.f)(this._scope)?Object(r.f)(this.parent)?null:this.parent.scope:this._scope}get sourceNode(){return this._sourceNode}_getLastError(){return this._lastError}_setError(e,t=null){this._lastError={code:e,info:t}}_clearError(){this._lastError=null}_isErrorOccured(){return!Object(r.f)(this._lastError)}_check(e,t=null){return!this._isErrorOccured()}toString(){return console.error("@pure_virtual"),null}toCode(){return console.error("@pure_virtual"),null}$withParent(e){return console.assert(null==this._parent,"parent redefenition detected!"),this.instructionType===a.b.k_SystemType&&"float"===this.name&&this._parent,this._parent=e,this}$withNoParent(){return this}static $withParent(e,t){return Object(r.f)(e)?null:e.$withParent(t)}static $withNoParent(e){return Object(r.f)(e)?null:e.$withNoParent()}}i.INSTRUCTION_COUNTER=0},"2blz":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UNDEF=0]="UNDEF",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.ZERO=3]="ZERO",e[e.ONE=4]="ONE",e[e.SRCCOLOR=5]="SRCCOLOR",e[e.INVSRCCOLOR=6]="INVSRCCOLOR",e[e.SRCALPHA=7]="SRCALPHA",e[e.INVSRCALPHA=8]="INVSRCALPHA",e[e.DESTALPHA=9]="DESTALPHA",e[e.INVDESTALPHA=10]="INVDESTALPHA",e[e.DESTCOLOR=11]="DESTCOLOR",e[e.INVDESTCOLOR=12]="INVDESTCOLOR",e[e.SRCALPHASAT=13]="SRCALPHASAT",e[e.NONE=14]="NONE",e[e.CW=15]="CW",e[e.CCW=16]="CCW",e[e.FRONT=17]="FRONT",e[e.BACK=18]="BACK",e[e.FRONT_AND_BACK=19]="FRONT_AND_BACK",e[e.NEVER=20]="NEVER",e[e.LESS=21]="LESS",e[e.EQUAL=22]="EQUAL",e[e.LESSEQUAL=23]="LESSEQUAL",e[e.GREATER=24]="GREATER",e[e.NOTEQUAL=25]="NOTEQUAL",e[e.GREATEREQUAL=26]="GREATEREQUAL",e[e.ALWAYS=27]="ALWAYS",e[e.FUNCADD=28]="FUNCADD",e[e.FUNCSUBTRACT=29]="FUNCSUBTRACT",e[e.FUNCREVERSESUBTRACT=30]="FUNCREVERSESUBTRACT",e[e.LINELIST=31]="LINELIST",e[e.LINESTRIP=32]="LINESTRIP",e[e.TRIANGLELIST=33]="TRIANGLELIST",e[e.TRAINGLESTRIP=34]="TRAINGLESTRIP",e[e.POINTLIST=35]="POINTLIST"}(r||(r={}))},"2xh7":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({sourceExpr:e,...t}){super({instrType:r.b.k_CastExpr,...t}),this.expr=i.a.$withParent(e,this)}toCode(){return`(${this.type.toCode()})${this.expr.toCode()}`}isUseless(){return this.type.isEqual(this.expr.type)}isConst(){return this.expr.isConst()}}},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"49qt":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4AA8"),a=n("hljw"),i=n("Wl5j"),s=n("FrU9");class o extends r.a{constructor({value:e,scope:t,...n}){super({instrType:s.b.k_FloatExpr,type:a.a.wrapAsConst(i.c,i.a),scope:t,...n}),this.value=e}toString(){return String(this.value)}toCode(){return`${this.value}${this.value%1==0?".":""}`}evaluate(){return this._evalResult=this.value,!0}isConst(){return!0}}},"4AA8":function(e,t,n){"use strict";var r=n("fb8x"),a=n("FrU9"),i=n("2b0+");class s extends i.a{constructor({type:e,...t}){super({instrType:a.b.k_Typed,...t}),this._type=i.a.$withNoParent(e),Object(r.f)(this._type)&&console.warn("Something goes wrong! Type is not specified!",this)}get type(){return this._type}}n.d(t,"a",(function(){return o}));class o extends s{constructor({...e}){super({instrType:a.b.k_Expr,...e}),this._evalResult=null}get type(){return super.type}evaluate(){return console.error("@pure_virtual"),!1}getEvalValue(){return this._evalResult}isConst(){return!1}isConstExpr(){return!0}}},"4cxW":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({decl:e,args:t,callee:n,...a}){super({instrType:r.b.k_FunctionCallExpr,...a}),this.callee=n,this.args=(t||[]).map(e=>i.a.$withParent(e,this)),this.decl=e}toCode(){const{callee:e,decl:{def:t},args:n}=this;return`${e?e.toCode()+".":""}${t.id.toCode()}(${n.map(e=>e.toCode()).join(",")})`}}},"5EX4":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4AA8"),a=n("hljw"),i=n("Wl5j"),s=n("FrU9");class o extends r.a{constructor({value:e,scope:t,...n}){super({instrType:s.b.k_BoolExpr,type:a.a.wrapAsConst(i.b,i.a),scope:t,...n}),this.value=e}toString(){return String(this.value)}toCode(){return this.value?"true":"false"}evaluate(){return this._evalResult=this.value,!0}isConst(){return!0}}},"5fm/":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({id:e,decl:t,...n}){super({instrType:r.b.k_IdExpr,type:t.type,...n}),this.id=i.a.$withParent(e,this),this.decl=t}get name(){return this.id.name}isConst(){return this.type.isConst()}evaluate(){return!1}toCode(){return this.decl.id.toCode()}}},"6dfp":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.BLENDENABLE=0]="BLENDENABLE",e[e.CULLFACEENABLE=1]="CULLFACEENABLE",e[e.ZENABLE=2]="ZENABLE",e[e.ZWRITEENABLE=3]="ZWRITEENABLE",e[e.DITHERENABLE=4]="DITHERENABLE",e[e.SCISSORTESTENABLE=5]="SCISSORTESTENABLE",e[e.STENCILTESTENABLE=6]="STENCILTESTENABLE",e[e.POLYGONOFFSETFILLENABLE=7]="POLYGONOFFSETFILLENABLE",e[e.CULLFACE=8]="CULLFACE",e[e.FRONTFACE=9]="FRONTFACE",e[e.SRCBLENDCOLOR=10]="SRCBLENDCOLOR",e[e.DESTBLENDCOLOR=11]="DESTBLENDCOLOR",e[e.SRCBLENDALPHA=12]="SRCBLENDALPHA",e[e.DESTBLENDALPHA=13]="DESTBLENDALPHA",e[e.BLENDEQUATIONCOLOR=14]="BLENDEQUATIONCOLOR",e[e.BLENDEQUATIONALPHA=15]="BLENDEQUATIONALPHA",e[e.ZFUNC=16]="ZFUNC",e[e.ALPHABLENDENABLE=17]="ALPHABLENDENABLE",e[e.ALPHATESTENABLE=18]="ALPHATESTENABLE",e[e.SRCBLEND=19]="SRCBLEND",e[e.DESTBLEND=20]="DESTBLEND",e[e.BLENDFUNC=21]="BLENDFUNC",e[e.BLENDFUNCSEPARATE=22]="BLENDFUNCSEPARATE",e[e.BLENDEQUATION=23]="BLENDEQUATION",e[e.BLENDEQUATIONSEPARATE=24]="BLENDEQUATIONSEPARATE",e[e.PRIMITIVETOPOLOGY=25]="PRIMITIVETOPOLOGY"}(r||(r={}))},"7VRG":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("oseZ");class i extends a.a{constructor({operator:e="break",...t}){super({instrType:r.b.k_BreakStmt,...t}),this._operator=e}get operator(){return this._operator}toCode(){return console.assert("break"==this.operator),this.operator+";"}}},"9EOq":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({moduleName:e,...t}){super({instrType:r.b.k_Provide,...t}),this._value=e}get moduleName(){return this._value}toString(){return this._value}toCode(){return this._value}}},"9hKy":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("FrU9"),i=n("u2cq"),s=n("2b0+");class o extends s.a{constructor(e){super({instrType:a.b.k_ProxyType,...e}),this._host=null}get host(){return this._host}get writable(){return!this.isResolved()||this.host.writable}get readable(){return!this.isResolved()||this.host.writable}get name(){return this.isResolved()?this.host.name:"auto"}get size(){return this.isResolved()?this.host.size:i.c.UNDEFINE_SIZE}get baseType(){return this.host}get arrayElementType(){return this.isResolved()?this.host.arrayElementType:null}get typeDecl(){return this.parent}get length(){return this.isResolved()?this.host.length:i.c.UNDEFINE_LENGTH}get fieldNames(){return this.isResolved()?this.host.fieldNames:[]}get fields(){return this.isResolved()?this.host.fields:[]}get methods(){return[]}isResolved(){return!Object(r.f)(this.host)}resolve(e){this._host=e}isSampler(){return!!this.isResolved()&&this.host.isSampler()}isTexture(){return!!this.isResolved()&&this.host.isTexture()}isUAV(){return!!this.isResolved()&&this.host.isUAV()}toString(){return this.isResolved()?this.host.toString():this.name}toDeclString(){return this.isResolved()?this.host.toDeclString():null}isEqual(e){return i.d.equals(this,e)}toCode(){return this.isResolved()?this.host.toCode():this.name}isBase(){return!!this.isResolved()&&this.host.isBase()}isArray(){return!!this.isResolved()&&this.host.isArray()}isNotBaseArray(){return!!this.isResolved()&&this.host.isNotBaseArray()}isComplex(){return!!this.isResolved()&&this.host.isComplex()}isConst(){return!!this.isResolved()&&this.host.isConst()}isContainArray(){return!!this.isResolved()&&this.host.isContainArray()}isContainSampler(){return!!this.isResolved()&&this.host.isContainSampler()}isContainComplexType(){return!!this.isResolved()&&this.host.isContainComplexType()}hasField(e){return!!this.isResolved()&&this.host.hasField(e)}hasFieldWithSematics(e){return!!this.isResolved()&&this.host.hasFieldWithSematics(e)}getField(e){return this.isResolved()?this.host.getField(e):null}getMethod(e,t){return this.isResolved()?this.host.getMethod(e,t):null}getFieldBySemantics(e){return this.isResolved()?this.host.getFieldBySemantics(e):null}hasFieldWithoutSemantics(){return!!this.isResolved()&&this.host.hasFieldWithoutSemantics()}hasAllUniqueSemantics(){return!!this.isResolved()&&this.host.hasAllUniqueSemantics()}}},"9vj8":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4AA8"),a=n("hljw"),i=n("Wl5j"),s=n("FrU9");class o extends r.a{constructor({value:e,scope:t,...n}){super({instrType:s.b.k_StringExpr,type:a.a.wrapAsConst(i.g,i.a),scope:t,...n}),this._value=e}get value(){return this._value}toString(){return this._value}toCode(){return this._value}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},BKBR:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("mXWi"),i=n("2b0+");class s extends a.a{constructor({definition:e,implementation:t=null,attributes:n=null,...a}){super({instrType:r.b.k_FunctionDecl,...a}),this.def=i.a.$withParent(e,this),this.impl=i.a.$withParent(t,this),this.attributes=(n||[]).map(e=>i.a.$withParent(e,this))}get name(){return this.def.name}get id(){return this.def.id}get semantic(){return this.def.semantic}toCode(){let e="";return e+=this.def.toCode(),this.impl?e+=this.impl.toCode():e+=";",e}}},C2sc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({name:e,...t}){super({instrType:r.b.k_Id,...t}),this.name=e}toString(){return this.name}toCode(){return this.name}}},C3oy:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({expr:e,operator:t,...n}){super({instrType:r.b.k_PostfixArithmeticExpr,type:e.type,...n}),this._operator=t,this._expr=i.a.$withParent(e,this)}get expr(){return this._expr}get operator(){return this._operator}toCode(){var e="";return e+=this.expr.toCode(),e+=this.operator}isConst(){return this.expr.isConst()}}},DTTp:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("FrU9");function a(e,t){if(!e)return;const n=n=>{n&&(t(n,e),a(n,t))};switch(e.instructionType){case r.b.k_ReturnStmt:n(e.expr);break;case r.b.k_DeclStmt:e.declList.forEach(e=>n(e));break;case r.b.k_ExprStmt:n(e.expr);break;case r.b.k_IfStmt:n(e.cond),n(e.conseq),n(e.contrary);break;case r.b.k_StmtBlock:e.stmtList.forEach(e=>n(e));break;case r.b.k_ForStmt:n(e.init),n(e.cond),n(e.body),n(e.step);break;case r.b.k_WhileStmt:n(e.cond),n(e.body);break;case r.b.k_ArithmeticExpr:case r.b.k_AssignmentExpr:n(e.left),n(e.right);break;case r.b.k_CastExpr:n(e.expr);break;case r.b.k_CompileExpr:e.args.forEach(e=>n(e));break;case r.b.k_ComplexExpr:n(e.expr);break;case r.b.k_ConditionalExpr:n(e.left),n(e.right),n(e.condition);break;case r.b.k_ConstructorCallExpr:case r.b.k_FunctionCallExpr:e.args.forEach(e=>n(e));break;case r.b.k_IdExpr:n(e.id);break;case r.b.k_InitExpr:e.args.forEach(e=>n(e));break;case r.b.k_IntExpr:case r.b.k_FloatExpr:case r.b.k_BoolExpr:case r.b.k_StringExpr:break;case r.b.k_LogicalExpr:n(e.left),n(e.right);break;case r.b.k_PostfixArithmeticExpr:n(e.expr);break;case r.b.k_PostfixIndexExpr:n(e.element),n(e.index);break;case r.b.k_PostfixPointExpr:n(e.element),n(e.postfix);break;case r.b.k_RelationalExpr:n(e.left),n(e.right);break;case r.b.k_SamplerStateBlockExpr:e.params.forEach(e=>n(e)),n(e.texture);break;case r.b.k_UnaryExpr:n(e.expr);break;case r.b.k_ComplexType:e.fields.forEach(e=>n(e));break;case r.b.k_FunctionDef:n(e.returnType),n(e.id),e.params.forEach(e=>n(e));break;case r.b.k_FunctionDecl:n(e.def),n(e.impl);break;case r.b.k_VariableDecl:n(e.type),n(e.initExpr),n(e.id);break;case r.b.k_VariableType:n(e.subType);break;case r.b.k_Id:break;case r.b.k_SystemFunctionDecl:case r.b.k_SystemType:case r.b.k_BreakStmt:break;default:console.error("unsupported instruction type found")}}const i={each:a}},FrU9:function(e,t,n){"use strict";var r,a,i,s,o,l;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),function(e){e[e.k_Instruction=0]="k_Instruction",e[e.k_Id=1]="k_Id",e[e.k_Provide=2]="k_Provide",e[e.k_Collector=3]="k_Collector",e[e.k_Keyword=4]="k_Keyword",e[e.k_Simple=5]="k_Simple",e[e.k_SamplerState=6]="k_SamplerState",e[e.k_Attribute=7]="k_Attribute",e[e.k_Annotation=8]="k_Annotation",e[e.k_UsageType=9]="k_UsageType",e[e.k_Typed=10]="k_Typed",e[e.k_VariableType=11]="k_VariableType",e[e.k_SystemType=12]="k_SystemType",e[e.k_ComplexType=13]="k_ComplexType",e[e.k_ProxyType=14]="k_ProxyType",e[e.k_Expr=15]="k_Expr",e[e.k_IdExpr=16]="k_IdExpr",e[e.k_IntExpr=17]="k_IntExpr",e[e.k_FloatExpr=18]="k_FloatExpr",e[e.k_BoolExpr=19]="k_BoolExpr",e[e.k_StringExpr=20]="k_StringExpr",e[e.k_ArithmeticExpr=21]="k_ArithmeticExpr",e[e.k_AssignmentExpr=22]="k_AssignmentExpr",e[e.k_RelationalExpr=23]="k_RelationalExpr",e[e.k_LogicalExpr=24]="k_LogicalExpr",e[e.k_ConditionalExpr=25]="k_ConditionalExpr",e[e.k_CastExpr=26]="k_CastExpr",e[e.k_UnaryExpr=27]="k_UnaryExpr",e[e.k_PostfixIndexExpr=28]="k_PostfixIndexExpr",e[e.k_PostfixPointExpr=29]="k_PostfixPointExpr",e[e.k_PostfixArithmeticExpr=30]="k_PostfixArithmeticExpr",e[e.k_ComplexExpr=31]="k_ComplexExpr",e[e.k_FunctionCallExpr=32]="k_FunctionCallExpr",e[e.k_ConstructorCallExpr=33]="k_ConstructorCallExpr",e[e.k_CompileExpr=34]="k_CompileExpr",e[e.k_InitExpr=35]="k_InitExpr",e[e.k_SamplerStateBlockExpr=36]="k_SamplerStateBlockExpr",e[e.k_Decl=37]="k_Decl",e[e.k_TypeDecl=38]="k_TypeDecl",e[e.k_VariableDecl=39]="k_VariableDecl",e[e.k_StructDecl=40]="k_StructDecl",e[e.k_FunctionDecl=41]="k_FunctionDecl",e[e.k_SystemFunctionDecl=42]="k_SystemFunctionDecl",e[e.k_FunctionDef=43]="k_FunctionDef",e[e.k_PassDecl=44]="k_PassDecl",e[e.k_TechniqueDecl=45]="k_TechniqueDecl",e[e.k_Stmt=46]="k_Stmt",e[e.k_ExprStmt=47]="k_ExprStmt",e[e.k_BreakStmt=48]="k_BreakStmt",e[e.k_WhileStmt=49]="k_WhileStmt",e[e.k_ForStmt=50]="k_ForStmt",e[e.k_IfStmt=51]="k_IfStmt",e[e.k_DeclStmt=52]="k_DeclStmt",e[e.k_ReturnStmt=53]="k_ReturnStmt",e[e.k_SemicolonStmt=54]="k_SemicolonStmt",e[e.k_StmtBlock=55]="k_StmtBlock",e[e.k_PartFxDecl=56]="k_PartFxDecl",e[e.k_PartFxPass=57]="k_PartFxPass",e[e.k_SpawnStmt=58]="k_SpawnStmt"}(r||(r={})),function(e){e[e.CODE_TARGET_SUPPORT=0]="CODE_TARGET_SUPPORT",e[e.SELF_CONTAINED=1]="SELF_CONTAINED"}(a||(a={})),function(e){e[e.k_Read=0]="k_Read",e[e.k_Write=1]="k_Write",e[e.k_ReadWrite=2]="k_ReadWrite",e[e.k_Undefined=3]="k_Undefined",e[e.k_Default=2]="k_Default"}(i||(i={})),function(e){e[e.k_Header=0]="k_Header",e[e.k_Float=1]="k_Float",e[e.k_Int=2]="k_Int",e[e.k_Bool=3]="k_Bool",e[e.k_Float2=4]="k_Float2",e[e.k_Int2=5]="k_Int2",e[e.k_Bool2=6]="k_Bool2",e[e.k_Float3=7]="k_Float3",e[e.k_Int3=8]="k_Int3",e[e.k_Bool3=9]="k_Bool3",e[e.k_Float4=10]="k_Float4",e[e.k_Int4=11]="k_Int4",e[e.k_Bool4=12]="k_Bool4",e[e.k_Float4x4=13]="k_Float4x4"}(s||(s={})),function(e){e[e.k_System=0]="k_System",e[e.k_Global=1]="k_Global",e[e.k_Default=2]="k_Default",e[e.k_Struct=3]="k_Struct",e[e.k_Annotation=4]="k_Annotation"}(o||(o={})),function(e){e[e.k_BasicFx=0]="k_BasicFx",e[e.k_PartFx=1]="k_PartFx",e[e.k_Unknown=2]="k_Unknown"}(l||(l={}))},GH4Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("fb8x"),a=n("Wl5j"),i=n("FrU9"),s=n("4AA8"),o=n("2b0+");class l extends s.a{constructor({ctor:e,args:t=null,...n}){super({instrType:i.b.k_ConstructorCallExpr,type:e.subType,...n}),this._args=(t||[]).map(e=>o.a.$withParent(e,this)),this._ctor=o.a.$withParent(e,this)}get args(){return this._args}get ctor(){return this._ctor}toCode(){var e="";e+=this.ctor.toCode(),e+="(";for(var t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){for(var e=0;e<this.args.length;e++)if(!this.args[e].isConst())return!1;return!0}evaluate(){if(!this.isConst())return!1;var e=null,t=a.k(this.type),n=new Array(this.args.length);if(Object(r.f)(t))return!1;try{if(a.r(this.type)){var i=this.args[0];if(this.args.length>1||!i.evaluate())return!1;e=t(i.getEvalValue())}else{for(var s=0;s<this.args.length;s++){if(!(i=this.args[s]).evaluate())return!1;n[s-1]=i.getEvalValue()}(e=new t).set.apply(e,n)}}catch(e){return!1}return this._evalResult=e,!0}}},I537:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Wl5j"),a=n("FrU9"),i=n("4AA8"),s=n("2b0+"),o=n("hljw");class l extends i.a{constructor({expr:e,operator:t,...n}){super({instrType:a.b.k_UnaryExpr,type:"!"===t?o.a.wrapAsConst(r.b,r.a):e.type,...n}),this._expr=s.a.$withParent(e,this),this._operator=t}get operator(){return this._operator}get expr(){return this._expr}toCode(){var e="";return e+=this.operator,e+=this.expr.toCode()}isConst(){return this.expr.isConst()}evaluate(){var e=this.operator,t=this.expr;if(!t.evaluate())return!1;var n=null;try{switch(n=t.getEvalValue(),e){case"+":n=+n;break;case"-":n=-n;break;case"!":n=!n;break;case"++":n=++n;break;case"--":n=--n}}catch(e){return!1}return this._evalResult=n,!0}}},IHXS:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("FrU9"),i=n("u2cq");class s{constructor({type:e=a.c.k_Default,parent:t=null,strictMode:n=!1}){this.type=e,this.parent=t,this.strictMode=n,this.variables={},this.types={},this.functions={},this.techniques={},this.typeTemplates={}}isStrict(){return this.filter(e=>e.strictMode)}findVariable(e){return this.filter(t=>t.variables[e]||null)}findTypeTemplate(e){return this.filter(t=>t.typeTemplates[e]||null)}findType(e){return this.filter(t=>t.types[e]||null)}findFunction(e,t=null){return this.filter(n=>i.b.matchList(n.functions[e],t))}findTechnique(e){return this.filter(t=>t.techniques[e]||null)}findFunctionInScope(e){let t=i.b.matchList(this.functions[e.name],e.def.params.map(e=>e?e.type:null));return Object(r.a)(void 0!==t),t}addVariable(e){let t=this.variables,n=e.name;return!this.variables[n]&&(t[n]=e,Object(r.a)(e.scope===this),!0)}addTypeTemplate(e){return!Object(r.e)(this.typeTemplates[e.name])&&(this.typeTemplates[e.name]=e,!0)}addType(e){return!this.types[e.name]&&(this.types[e.name]=e,console.assert(e.scope===this),!0)}addFunction(e){Object(r.a)(this.type<=a.c.k_Global),Object(r.a)(e.scope===this);let t=this.functions,n=e.name;t[n]=t[n]||[];const i=t[n];let s=this.findFunctionInScope(e);if(s){Object(r.a)(!Object(r.f)(e.impl)),Object(r.a)(Object(r.f)(s.impl));let t=i.indexOf(s);i[t]=e}else i.push(e);return!0}addTechnique(e){return Object(r.a)(this.type<=a.c.k_Global),!this.techniques[e.name]&&(this.techniques[e.name]=e,Object(r.a)(e.scope===this),!1)}filter(e){let t=this;for(;!Object(r.f)(t);){let n=e(t);if(!Object(r.f)(n))return n;t=t.parent}return null}}class o{constructor(e){Object(r.a)(null!==e);let t=a.c.k_Global;this.globalScope=new s({parent:e,type:t}),this.currentScope=this.globalScope}validate(){Object(r.a)(this.currentScope===this.globalScope)}push(e=a.c.k_Default){Object(r.a)(null!==this.currentScope),Object(r.a)(e>=a.c.k_Default);let t=this.currentScope,n=new s({parent:t,type:e});this.currentScope=n}pop(){Object(r.a)(null!==this.currentScope),this.currentScope=this.currentScope.parent,Object(r.a)(null!==this.currentScope)}}},M2fT:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("2b0+"),i=n("oseZ");class s extends i.a{constructor({expr:e=null,...t}){super({instrType:r.b.k_ReturnStmt,...t}),this._operator="return",this._expr=a.a.$withParent(e,this)}get operator(){return this._operator}get expr(){return this._expr}toCode(){return this.expr?"return "+this.expr.toCode()+";":"return;"}}},MJEd:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var r,a=n("fb8x"),i=n("FrU9"),s=n("mXWi"),o=n("2b0+");!function(e){e[e.k_Local=1]="k_Local",e[e.k_Global=2]="k_Global",e[e.k_Argument=4]="k_Argument"}(r||(r={}));class l extends s.a{constructor({id:e,type:t,init:n=null,usageFlags:r=0,...s}){super({instrType:i.b.k_VariableDecl,...s}),this._id=o.a.$withParent(e,this),this._type=o.a.$withNoParent(t),this._initExpr=o.a.$withParent(n,this),this._usageFlags=r,Object(a.a)(!this.isParameter()||Object(a.f)(this.parent)||this.parent.instructionType==i.b.k_FunctionDef),Object(a.a)(this.isLocal()||!this.isLocal()),Object(a.a)(!this.isParameter()||this.isLocal())}get initExpr(){return this._initExpr}get defaultValue(){return this._initExpr.evaluate(),this._initExpr.getEvalValue()}get type(){return this._type}get name(){return this._id.name}get id(){return this._id}isGlobal(){return!!(this._usageFlags&r.k_Global)}isLocal(){return!!(this._usageFlags&r.k_Local)}isParameter(){return!!(this._usageFlags&r.k_Argument)}isField(){if(Object(a.f)(this.parent))return!1;var e=this.parent.instructionType;return e===i.b.k_VariableType||e===i.b.k_ComplexType||e===i.b.k_SystemType}toCode(){var e="";(e=this.type.toCode(),e+=" "+this.id.toCode(),this.type.isNotBaseArray())&&(e+="["+this.type.length+"]");return Object(a.f)(this.initExpr)||this.type.isUniform()||(e+="="+this.initExpr.toCode()),e}}},"MT7/":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("2b0+"),i=n("oseZ");class s extends i.a{constructor({cond:e,body:t,operator:n,...i}){super({instrType:r.b.k_WhileStmt,...i}),this._cond=a.a.$withParent(e,this),this._body=a.a.$withParent(t,this),this._operator=n}get cond(){return this.cond}get body(){return this._body}get operator(){return this._operator}toCode(){var e="";return"while"===this.operator?(e+="while(",e+=this.cond.toCode(),e+=")",e+=this.body.toCode()):(e+="do",e+=this.body.toCode(),e+="while(",e+=this.cond.toCode(),e+=");"),e}}},Mg1O:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("4AA8"),a=n("2b0+"),i=n("FrU9");class s extends r.a{constructor({expr:e,...t}){super({instrType:i.b.k_ComplexExpr,type:e.type,...t}),this._expr=a.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return"("+this.expr.toCode()+")"}isConst(){return this.expr.isConst()}evaluate(){return!!this.expr.evaluate()&&(this._evalResult=this.expr.getEvalValue(),!0)}}},"N/7J":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({name:e,value:t,...n}){super({instrType:r.b.k_SamplerState,...n}),this._name=e,this._value=a.a.$withParent(t,this)}get name(){return this._name}get value(){return this.value}toString(){return console.error("@not_implemented"),null}toCode(){return console.error("@not_implmented"),null}}},NzFo:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return fe})),n.d(t,"a",(function(){return me}));var r=n("fb8x"),a=n("zioJ"),i=n("6dfp"),s=n("2blz"),o=n("FrU9"),l=n("/zHR"),u=n("RTx6"),c=n("DTTp"),p=n("u2cq"),d=n("l4+G"),h=n("XQla"),f=n("pq1u"),m=n("5EX4"),E=n("7VRG"),_=n("2xh7"),y=n("fjuh"),g=n("Mg1O"),T=n("i81d"),x=n("bxdW"),b=n("GH4Y"),S=n("Zd6l"),R=n("huhI"),k=n("49qt"),N=n("Wv+o"),A=n("4cxW"),C=n("BKBR"),I=n("hsO8"),O=n("5fm/"),v=n("C2sc"),P=n("1O8D"),F=n("ggRF"),D=n("2b0+"),L=n("iYqf"),w=n("QsPN"),U=n("wEKK"),j=n("jfm7"),B=n("C3oy"),W=n("fuca"),z=n("sQ1Q"),M=n("9EOq"),q=n("9hKy"),V=n("wsMd"),K=n("M2fT"),G=n("PLhK"),$=n("N/7J"),H=n("ip/g"),X=n("kGK+"),Z=n("9vj8"),Q=n("+Z36"),Y=n("onqc"),J=n("I537"),ee=n("MJEd"),te=n("hljw"),ne=n("MT7/"),re=n("IHXS"),ae=n("Wl5j");function ie(e,t,n){return t._check(n)?t:(function(e,t,n){e.error(t,n.code,Object(r.f)(n.info)?{}:n.info)}(e,t.sourceNode,t._getLastError()),null)}const se=e=>e?e.type:null,oe=e=>e?e.type.isEqual(ae.e)||e.type.isEqual(ae.h)?/^int$|^uint$/g:e.type:null;function le(e,t){if(e.subType.instructionType===o.b.k_ProxyType){const n=e.subType;n.isResolved()||n.resolve(t)}}function ue(e,t){let n=s.a.UNDEF;switch(e){case i.a.ALPHABLENDENABLE:case i.a.ALPHATESTENABLE:return console.warn("ALPHABLENDENABLE/ALPHATESTENABLE not supported in WebGL."),s.a.UNDEF;case i.a.BLENDENABLE:case i.a.CULLFACEENABLE:case i.a.ZENABLE:case i.a.ZWRITEENABLE:case i.a.DITHERENABLE:case i.a.SCISSORTESTENABLE:case i.a.STENCILTESTENABLE:case i.a.POLYGONOFFSETFILLENABLE:switch(t){case"TRUE":n=s.a.TRUE;break;case"FALSE":n=s.a.FALSE;break;default:return console.warn("Unsupported render state ALPHABLENDENABLE/ZENABLE/ZWRITEENABLE/DITHERENABLE value used: "+t+"."),n}break;case i.a.CULLFACE:switch(t){case"FRONT":n=s.a.FRONT;break;case"BACK":n=s.a.BACK;break;case"FRONT_AND_BACK":n=s.a.FRONT_AND_BACK;break;default:return console.warn("Unsupported render state CULLFACE value used: "+t+"."),n}break;case i.a.FRONTFACE:switch(t){case"CW":n=s.a.CW;break;case"CCW":n=s.a.CCW;break;default:return console.warn("Unsupported render state FRONTFACE value used: "+t+"."),n}break;case i.a.SRCBLEND:case i.a.DESTBLEND:case i.a.SRCBLENDALPHA:case i.a.DESTBLENDALPHA:case i.a.SRCBLENDCOLOR:case i.a.DESTBLENDCOLOR:case i.a.BLENDFUNC:case i.a.BLENDFUNCSEPARATE:switch(t){case"ZERO":n=s.a.ZERO;break;case"ONE":n=s.a.ONE;break;case"SRCCOLOR":n=s.a.SRCCOLOR;break;case"INVSRCCOLOR":n=s.a.INVSRCCOLOR;break;case"SRCALPHA":n=s.a.SRCALPHA;break;case"INVSRCALPHA":n=s.a.INVSRCALPHA;break;case"DESTALPHA":n=s.a.DESTALPHA;break;case"INVDESTALPHA":n=s.a.INVDESTALPHA;break;case"DESTCOLOR":n=s.a.DESTCOLOR;break;case"INVDESTCOLOR":n=s.a.INVDESTCOLOR;break;case"SRCALPHASAT":n=s.a.SRCALPHASAT;break;default:return console.warn("Unsupported render state SRCBLEND/DESTBLEND value used: "+t+"."),n}break;case i.a.BLENDEQUATION:case i.a.BLENDEQUATIONSEPARATE:case i.a.BLENDEQUATIONCOLOR:case i.a.BLENDEQUATIONALPHA:switch(t){case"FUNCADD":case"ADD":n=s.a.FUNCADD;break;case"FUNCSUBTRACT":case"SUBTRACT":n=s.a.FUNCSUBTRACT;break;case"FUNCREVERSESUBTRACT":case"REVERSESUBTRACT":n=s.a.FUNCREVERSESUBTRACT;break;default:return console.warn("Unsupported render state BLENDEQUATION/BLENDEQUATIONSEPARATE value used: "+t+"."),n}break;case i.a.ZFUNC:switch(t){case"NEVER":n=s.a.NEVER;break;case"LESS":n=s.a.LESS;break;case"EQUAL":n=s.a.EQUAL;break;case"LESSEQUAL":n=s.a.LESSEQUAL;break;case"GREATER":n=s.a.GREATER;break;case"NOTEQUAL":n=s.a.NOTEQUAL;break;case"GREATEREQUAL":n=s.a.GREATEREQUAL;break;case"ALWAYS":n=s.a.ALWAYS;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),n}break;case i.a.PRIMITIVETOPOLOGY:switch(t){case"TRIANGLELIST":n=s.a.TRIANGLELIST;break;case"LINELIST":n=s.a.LINELIST;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),n}}return n}function ce(e,t,n){ae.j(n.name)&&e.error(n.sourceNode,a.a.SystemTypeRedefinition,{typeName:n.name}),t.addType(n.type)||e.error(n.sourceNode,a.a.TypeRedefinition,{typeName:n.name})}function pe(e,t){const n=t.globalScope;let i=!1;return Object(r.i)(n.functions,t=>{t.forEach(t=>{i=i||!function e(t,n,i){if(-1!==i.indexOf(n.instructionID))return t.error(n.sourceNode,a.a.InvalidFunctionRecursionNotAllowed,{funcName:n.name}),!1;let s=!1;return i=[...i,n.instructionID],Object(c.b)(n.impl,n=>{if(n.instructionType===o.b.k_FunctionCallExpr){let l=n.decl;if(l.instructionType===o.b.k_SystemFunctionDecl)return;if(l=l.scope.findFunctionInScope(l),Object(r.f)(l.impl))return void t.error(n.sourceNode,a.a.InvalidFunctionImplementationNotFound,{funcName:l.name});s=s||e(t,l,i)}}),!s}(e,t,[])})}),!i}function de(e){return!!function(e){const t=e.returnType;if(t.isEqual(ae.i))return!0;if(t.isComplex()){if(t.hasFieldWithoutSemantics())return!1;if(!t.hasAllUniqueSemantics())return!1;if(t.isContainSampler())return!1;if(t.isContainComplexType())return!1}else{if(!t.isEqual(ae.d))return!1;if("POSITION"!==e.semantic)return!1}return!0}(e)&&!!function(e){let t=e.params,n=!1,a=!1,i=!1;for(let e=0;e<t.length;e++){let s=t[e];if(!s.type.isUniform())if(i){if(n)return!1;if(a){if(Object(r.f)(s.semantic))return!1;if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1}}else{if(Object(r.f)(s.semantic)){if(s.type.isBase()||s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics())return!1;n=!0}else if(!Object(r.f)(s.semantic)){if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1;a=!0}i=!0}}return!0}(e)}function he(e){return!!function(e){let t=e.returnType;if(t.isEqual(ae.i))return!0;if(!t.isBase())return!1;if(!t.isEqual(ae.d))return!1;if("COLOR"!==e.semantic)return!1;return!0}(e)&&!!function(e){let t=e.params,n=!1,r=!1,a=!1;for(let e=0;e<t.length;e++){let i=t[e];if(!i.type.isUniform())if(a){if(n)return!1;if(r){if(""===i.semantic)return!1;if(i.type.isContainSampler()||ae.q(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1}}else{if(""===i.semantic){if(i.type.isBase()||i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()||i.type.isContainSampler())return!1;n=!0}else if(""!==i.semantic){if(i.type.isContainSampler()||ae.q(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1;r=!0}a=!0}}return!0}(e)}class fe{constructor(e){this.diagnostics=new u.a,this.uri=e,this.moduleName=null,this.haveCurrentFunctionReturnOccur=!1}beginFunc(){this.func=!0,this.haveCurrentFunctionReturnOccur=!1,this.funcDef=null}endFunc(){this.func=!1}beginPass(){this.renderStates=null}endPass(){this.renderStates=null}error(e,t,n={}){let r=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.error(t,{file:a,loc:r,info:n})}critical(e,t,n={}){let r=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.critical(t,{file:a,loc:r,info:n})}warn(e,t,n={}){let r=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.warning(t,{file:a,loc:r,info:n})}resolveNodeSourceLocation(e){return Object(r.e)(e)?Object(r.d)(e.loc)?e.loc:this.resolveNodeSourceLocation(e.children[e.children.length-1]):null}}class me{analyzeUseDecl(e,t,n){t.currentScope.strictMode=!0}analyzeComplexName(e){const t=e.children;let n="";for(let e=t.length-1;e>=0;e--)n+=t[e].value;return n}analyzeProvideDecl(t,n,i){const s=i.children,o=n.currentScope;if(3===s.length){let n=this.analyzeComplexName(s[1]);return Object(r.f)(t.moduleName)||console.warn(`Context module overriding detected '${t.moduleName}' => '${e}'`),t.moduleName=n,Object(r.a)("T_KW_PROVIDE"===s[2].name),new M.a({sourceNode:i,moduleName:n,scope:o})}return t.error(i,a.a.UnsupportedProvideAs),null}analyzeInitExpr(e,t,n){const r=n.children,a=t.currentScope;let i=[];if(1===r.length)i.push(this.analyzeExpr(e,t,r[0]));else for(let n=0;n<r.length;n++)"InitExpr"===r[n].name&&i.push(this.analyzeInitExpr(e,t,r[n]));return new F.a({scope:a,sourceNode:n,args:i,type:null})}analyzeVariableDecl(e,t,n){const a=n.children,i=(t.currentScope,this.analyzeUsageType(e,t,a[a.length-1])),s=[];if(Object(r.f)(i))return null;for(let n=a.length-2;n>=1;n--)"Variable"===a[n].name&&s.push(this.analyzeVariable(e,t,a[n],i));return s}analyzeUsageType(e,t,n){const a=n.children,i=t.currentScope;let s=null,l=[];for(let n=a.length-1;n>=0;n--)if("Type"===a[n].name){if(s=this.analyzeType(e,t,a[n]),Object(r.f)(s))return null}else"Usage"===a[n].name&&l.push(this.analyzeUsage(a[n]));const u=-1!==l.indexOf("in"),c=-1!==l.indexOf("out"),p=-1!==l.indexOf("inout"),d=-1!==l.indexOf("const"),h=-1!==l.indexOf("uniform");let f=[];return p?f.push("inout"):u&&c?f.push("inout"):(u&&f.push("in"),c?f.push("out"):(d&&f.push("const"),h&&f.push("uniform"))),ie(e,new te.a({scope:i,sourceNode:n,type:s,usages:f}),o.a.CODE_TARGET_SUPPORT)}analyzeType(e,t,n){const i=n.children,s=t.currentScope;let l=null;switch(n.name){case"T_TYPE_ID":if("auto"===n.value){l=new q.a({scope:s});break}l=s.findType(n.value),Object(r.f)(l)&&e.error(n,a.a.InvalidTypeNameNotType,{typeName:n.value});break;case"Struct":l=this.analyzeStruct(e,t,n);break;case"T_KW_VOID":l=ae.i;break;case"ScalarType":case"ObjectType":{let u=i[i.length-1].value;if(1!==i.length){Object(r.a)("<"===i[i.length-2].value&&">"===i[0].value);const c=u,p=i.slice(1,-2).reverse().filter((e,t)=>t%2==0).map(n=>this.analyzeType(e,t,n)),d=s.findTypeTemplate(u);if(Object(r.f)(d))return e.error(n,a.a.InvalidTypeNameTemplateNotFound,{tplName:c,args:p.map(e=>e.toCode())}),null;if(-1!==["RWBuffer","RWStructuredBuffer","AppendStructuredBuffer"].indexOf(d.name)&&s.type!=o.c.k_Global)return e.error(n,a.a.InvalidTypeScope,{typeName:d.name,tooltip:"only global scope allowed"}),null;if(u=d.typeName(p),l=s.findType(u),Object(r.f)(l)){if(l=d.produceType(s,p),Object(r.f)(l))return e.error(n,a.a.CannotProduceType,{typeName:u}),null;s.addType(l)}}else l=s.findType(u);if(Object(r.f)(l))return e.error(n,a.a.InvalidTypeNameNotType,{typeName:u}),null}break;case"VectorType":case"MatrixType":e.error(n,a.a.InvalidTypeVectorMatrix);break;case"BaseType":case"Type":return this.analyzeType(e,t,i[0])}return l}analyzeUsage(e){e=e.children[0];return Object(r.a)(-1!==["uniform","const","in","out","inout"].indexOf(e.value)),e.value}analyzeVariable(e,t,n,i){const s=n.children,l=t.currentScope;let u=null,c=null,p="",d=0;e.func?(e.funcDef||(d|=ee.a.k_Argument),d|=ee.a.k_Local):d|=ee.a.k_Global;let h=null,f=null,m=null,E=s[s.length-1];for(;;){let a=E.children;if(1===a.length){const e=a[0].value;h=new v.a({scope:l,sourceNode:n,name:e});break}Object(r.a)(4==a.length),Object(r.f)(f)||(i=new te.a({scope:l,sourceNode:i.sourceNode,type:i,arrayIndex:f})),f=this.analyzeExpr(e,t,a[a.length-3]),E=a[a.length-1]}m=new te.a({scope:l,sourceNode:i.sourceNode,type:i,arrayIndex:f});for(let r=s.length-2;r>=0;r--)if("Annotation"===s[r].name)u=this.analyzeAnnotation(s[r]);else if("Semantic"===s[r].name)p=this.analyzeSemantic(s[r]);else if("Initializer"===s[r].name){let i=this.analyzeInitializerArguments(e,t,s[r]);c=new F.a({scope:l,sourceNode:s[r],args:i,type:m});let o=!1;try{o=c.optimizeForVariableType(m)}catch(e){}o||(e.error(n,a.a.InvalidVariableInitializing,{varName:h.name}),c=null)}const _=new ee.b({sourceNode:n,scope:l,type:m,init:c,id:h,semantic:p,annotation:u,usageFlags:d});if(Object(r.a)(l.type!=o.c.k_System),ae.l(_.name)&&e.error(n,a.a.SystemVariableRedefinition,{varName:_.name}),!l.addVariable(_))switch(l.type){case o.c.k_Global:case o.c.k_Default:e.error(n,a.a.VariableRedefinition,{varName:_.name});break;case o.c.k_Struct:e.error(n,a.a.InvalidNewFieldForStructName,{fieldName:_.name});break;case o.c.k_Annotation:e.error(n,a.a.InvalidNewAnnotationVar,{varName:_.name})}return ie(e,_,o.a.CODE_TARGET_SUPPORT)}analyzeAnnotation(e){return null}analyzeSemantic(e){return e.children.slice(0,-1).reverse().map(e=>e.value).join("")}analyzeInitializerArguments(e,t,n){const r=n.children;t.currentScope;let a=[];if(2===r.length)a.push(this.analyzeExpr(e,t,r[0]));else for(let n=r.length-3;n>=1;n--)"InitExpr"===r[n].name&&a.push(this.analyzeInitExpr(e,t,r[n]));return a}analyzeExpr(e,t,n){const r=n.name;switch(r){case"ObjectExpr":return this.analyzeObjectExpr(e,t,n);case"ComplexExpr":return this.analyzeComplexExpr(e,t,n);case"PostfixExpr":return this.analyzePostfixExpr(e,t,n);case"UnaryExpr":return this.analyzeUnaryExpr(e,t,n);case"CastExpr":return this.analyzeCastExpr(e,t,n);case"ConditionalExpr":return this.analyzeConditionalExpr(e,t,n);case"MulExpr":case"AddExpr":return this.analyzeArithmeticExpr(e,t,n);case"RelationalExpr":case"EqualityExpr":return this.analyzeRelationExpr(e,t,n);case"AndExpr":case"OrExpr":return this.analyzeLogicalExpr(e,t,n);case"AssignmentExpr":return this.analyzeAssignmentExpr(e,t,n);case"T_NON_TYPE_ID":return this.analyzeIdExpr(e,t,n);case"T_STRING":case"T_UINT":case"T_FLOAT":case"T_KW_TRUE":case"T_KW_FALSE":return this.analyzeSimpleExpr(e,t,n);default:e.error(n,a.a.UnsupportedExpr,{exprName:r})}return null}analyzeObjectExpr(e,t,n){switch(n.children[n.children.length-1].name){case"T_KW_COMPILE":return this.analyzeCompileExpr(e,t,n);case"T_KW_SAMPLER_STATE":return this.analyzeSamplerStateBlock(e,t,n)}return null}analyzeCompileExpr(e,t,n,i){const s=n.children,l=s[s.length-2].value,u=t.currentScope;let c=null,p=null,d=null;if(s.length>4){c=[];for(let n=s.length-4;n>0;n--)","!==s[n].value&&c.push(this.analyzeExpr(e,t,s[n]))}d=c?c.map(se):null;let h=null;if(i){for(let e of i)if(d=c?c.map(se):null,p=null,d=e.args||d,p=e.ret||p,h=t.globalScope.findFunction(l,d))break}else h=t.globalScope.findFunction(l,d);if(Object(r.f)(h))return e.error(n,a.a.InvalidCompileNotFunction,{funcName:l}),null;if(p&&!h.def.returnType.isEqual(p))return e.error(n,a.a.InvalidCompileFunctionNotValid,{funcName:l,funcType:p.toCode(),tooltip:`Return type mismatch: expected '${p.toCode()}' a is a '${h.def.returnType.toCode()}' `}),null;let f=te.a.wrap(h.def.returnType,u);return ie(e,new y.a({args:c,scope:u,type:f,operand:h,sourceNode:n}),o.a.CODE_TARGET_SUPPORT)}analyzeSamplerStateBlock(e,t,n){n=n.children[0];let a=t.currentScope,i=n.children,s=[];for(let n=i.length-2;n>=1;n--){let a=this.analyzeSamplerState(e,t,i[n]);Object(r.f)(a)||s.push(a)}let l=new G.a({sourceNode:n,scope:a,operator:"sampler_state",params:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeSamplerState(e,t,n){const i=n.children,s=t.currentScope;if("StateIndex"===i[i.length-2].name)return e.error(n,a.a.UnsupportedStateIndex),null;let o=i[i.length-3],l=o.children[o.children.length-1],u=i[i.length-1].value.toUpperCase(),c="";if(Object(r.f)(l.value))return e.error(l,a.a.InvalidSamplerTexture),null;switch(u){case"TEXTURE":if(3!==o.children.length||"{"===l.value)return e.error(l,a.a.InvalidSamplerTexture),null;let t=o.children[1],i=t.value;if(Object(r.f)(i)||!s.findVariable(i))return e.error(o.children[1],a.a.InvalidSamplerTexture),null;let p=s.findVariable(i),d=new v.a({scope:s,sourceNode:t,name:i}),h=new O.a({scope:s,sourceNode:t,id:d,decl:p});return new $.a({scope:s,sourceNode:n,name:u,value:h});case"ADDRESSU":case"ADDRESSV":switch(c=l.value.toUpperCase()){case"WRAP":case"CLAMP":case"MIRROR":break;default:return null}break;case"MAGFILTER":case"MINFILTER":switch(c=l.value.toUpperCase()){case"POINT":c="NEAREST";break;case"POINT_MIPMAP_POINT":c="NEAREST_MIPMAP_NEAREST";break;case"LINEAR_MIPMAP_POINT":c="LINEAR_MIPMAP_NEAREST";break;case"POINT_MIPMAP_LINEAR":c="NEAREST_MIPMAP_LINEAR";break;case"NEAREST":case"LINEAR":case"NEAREST_MIPMAP_NEAREST":case"LINEAR_MIPMAP_NEAREST":case"NEAREST_MIPMAP_LINEAR":case"LINEAR_MIPMAP_LINEAR":break;default:return null}break;default:return console.warn("Don`t support this texture param: "+u),null}return new $.a({sourceNode:n,scope:s,name:u,value:new Z.a({sourceNode:o,scope:s,value:c})})}analyzeComplexExpr(e,t,n){const r=n.children;switch(r[r.length-1].name){case"PostfixPointExpr":case"T_NON_TYPE_ID":return this.analyzeFunctionCallExpr(e,t,n);case"BaseType":case"T_TYPE_ID":return this.analyzeConstructorCallExpr(e,t,n);default:return this.analyzeSimpleComplexExpr(e,t,n)}}analyzeCallee(e,t,n){const r=n.children;return this.analyzeExpr(e,t,r[r.length-1])}analyzeFunctionCallExpr(e,t,n){const i=n.children,s=t.currentScope,l=t.globalScope,u=i[i.length-1].name,c=[];if(i.length>3)for(let n=i.length-3;n>0;n--)if(","!==i[n].value){const r=this.analyzeExpr(e,t,i[n]);c.push(r)}let d=null,h=null,f=null;switch(u){case"T_NON_TYPE_ID":d=i[i.length-1].value,h=l.findFunction(d,c.map(oe));break;case"PostfixPointExpr":f=this.analyzeCallee(e,t,i[i.length-1]),d=i[i.length-1].children[0].value,h=f.type.getMethod(d,c.map(oe))}if(Object(r.f)(h))return e.error(n,a.a.InvalidComplexNotFunction,{funcName:d}),null;if(!Object(r.d)(h))return e.error(n,a.a.CannotChooseFunction,{funcName:d}),null;if(h.instructionType!==o.b.k_FunctionDecl&&h.instructionType!==o.b.k_SystemFunctionDecl)return console.error("@undefined_behavior"),null;const m=h.def.params;for(let t=0;t<c.length;t++)if(!Object(r.f)(c[t]))if(m[t].type.hasUsage("out")){const n=p.a.unwind(c[t]);if(Object(r.f)(n))return e.error(c[t].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!c[t].type.writable)return e.error(c[t].sourceNode,a.a.InvalidTypeForWriting),null}else if(m[t].type.hasUsage("inout")){const n=p.a.unwind(c[t]);if(Object(r.f)(n))return e.error(c[t].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!c[t].type.writable)return e.error(c[t].sourceNode,a.a.InvalidTypeForWriting),null;if(!c[t].type.readable)return e.error(c[t].sourceNode,a.a.InvalidTypeForReading),null}else if(!c[t].type.readable)return e.error(c[t].sourceNode,a.a.InvalidTypeForReading),null;const E=te.a.wrap(h.def.returnType,s);return ie(e,new A.a({scope:s,type:E,decl:h,args:c,sourceNode:n,callee:f}),o.a.CODE_TARGET_SUPPORT)}analyzeConstructorCallExpr(e,t,n){const i=n.children,s=t.currentScope,l=this.analyzeType(e,t,i[i.length-1]);if(Object(r.f)(l))return e.error(n,a.a.InvalidComplexNotType),null;let u=null;if(i.length>3){let n=null;u=[];for(let r=i.length-3;r>0;r--)","!==i[r].value&&(n=this.analyzeExpr(e,t,i[r]),u.push(n))}const c=(p=l,new te.a({type:p,scope:null}));var p;if(Object(r.f)(c))return e.error(n,a.a.InvalidComplexNotConstructor,{typeName:String(l)}),null;if(!Object(r.f)(u))for(let t=0;t<u.length;t++)if(!u[t].type.readable)return e.error(n,a.a.InvalidTypeForReading),null;return ie(e,new b.a({scope:s,sourceNode:n,ctor:c,args:u}),o.a.CODE_TARGET_SUPPORT)}analyzeSimpleComplexExpr(e,t,n){const a=n.children,i=t.currentScope;let s=this.analyzeExpr(e,t,a[1]);return Object(r.f)(s)?null:ie(e,new g.a({scope:i,sourceNode:n,expr:s}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixExpr(e,t,n){const r=n.children;switch(r[r.length-2].value){case"[":return this.analyzePostfixIndex(e,t,n);case".":return this.analyzePostfixPoint(e,t,n);case"++":case"--":return this.analyzePostfixArithmetic(e,t,n)}return null}analyzePostfixIndex(e,t,n){const i=n.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]);if(Object(r.f)(l))return null;const u=l.type;if(!u.isArray())return e.error(n,a.a.InvalidPostfixNotArray,{typeName:String(u)}),null;const c=this.analyzeExpr(e,t,i[i.length-3]),p=c.type;return p.isEqual(ae.e)||p.isEqual(ae.h)?ie(e,new W.a({scope:s,sourceNode:n,element:l,index:c}),o.a.CODE_TARGET_SUPPORT):(e.error(n,a.a.InvalidPostfixNotIntIndex,{typeName:String(p)}),null)}createFieldDecl(e,t){if(!e.hasField(t))return null;const n=e.scope,{id:r,type:a,type:{padding:i,length:s},semantic:o}=(e.subType||e).getField(t),l=new te.a({type:a,scope:n,padding:i,sourceNode:a.sourceNode}),u=new v.a({scope:n,name:r.name,sourceNode:r.sourceNode}),c=new ee.b({scope:n,id:u,type:l,semantic:o,sourceNode:u.sourceNode});return D.a.$withParent(c,e)}analyzePostfixPointField(e,t,n,a){if(Object(r.f)(a))return null;const i=t.currentScope,s=n.value,l=a.getField(s);if(Object(r.f)(l))return null;const u=new v.a({scope:i,sourceNode:n,name:s});return ie(e,new O.a({scope:i,sourceNode:n,id:u,decl:l}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixPoint(e,t,n){const i=n.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]);if(Object(r.f)(l))return null;const u=this.analyzePostfixPointField(e,t,i[i.length-3],l.type);if(Object(r.f)(u)){const t=i[i.length-3].value;return e.error(n,a.a.InvalidPostfixNotField,{typeName:String(l.type),fieldName:t}),null}return ie(e,new z.a({sourceNode:n,scope:s,element:l,postfix:u}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixArithmetic(e,t,n){const i=n.children,s=t.currentScope,l=i[0].value,u=this.analyzeExpr(e,t,i[1]),c=u.type,p=me.checkOneOperandExprType(e,n,l,c);return Object(r.f)(p)?(e.error(n,a.a.InvalidPostfixArithmetic,{operator:l,typeName:String(c)}),null):ie(e,new B.a({scope:s,sourceNode:n,operator:l,expr:u}),o.a.CODE_TARGET_SUPPORT)}analyzeUnaryExpr(e,t,n){const i=n.children,s=i[1].value,l=t.currentScope;let u=this.analyzeExpr(e,t,i[0]),c=me.checkOneOperandExprType(e,n,s,u.type);if(Object(r.f)(c))return e.error(n,a.a.InvalidUnaryOperation,{operator:s,tyename:String(u.type)}),null;let d=null;if(("-"===s||"+"===s)&&p.c.isLiteral(u))switch(u.instructionType){case o.b.k_IntExpr:{let e=u,t="-"===s||e.signed;d=new w.a({scope:l,sourceNode:n,value:Number(`${s}${e.value}`),signed:t})}break;case o.b.k_FloatExpr:d=new k.a({scope:l,sourceNode:n,value:Number(`${s}${u.value}`)})}return d||(d=new J.a({scope:l,sourceNode:n,expr:u,operator:s})),ie(e,d,o.a.CODE_TARGET_SUPPORT)}analyzeCastExpr(e,t,n){const i=n.children,s=t.currentScope,l=this.analyzeConstTypeDim(e,t,i[2]),u=this.analyzeExpr(e,t,i[0]);return Object(r.f)(u)?null:u.type.readable?ie(e,new _.a({scope:s,sourceNode:n,sourceExpr:u,type:l}),o.a.CODE_TARGET_SUPPORT):(e.error(n,a.a.InvalidTypeForReading),null)}analyzeConditionalExpr(e,t,n){const i=n.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]),u=this.analyzeExpr(e,t,i[i.length-3]),c=this.analyzeExpr(e,t,i[0]);if(Object(r.f)(l)||Object(r.f)(u)||Object(r.f)(c))return e.error(l?l.sourceNode:n,a.a.InvalidConditionType,{typeName:"[unknown]"}),null;const p=l.type,d=u.type,h=c.type,f=ae.b;return p.isEqual(f)?d.isEqual(h)?p.readable?d.readable?h.readable?ie(e,new x.a({scope:s,sourceNode:n,cond:l,left:u,right:c}),o.a.CODE_TARGET_SUPPORT):(e.error(h.sourceNode,a.a.InvalidTypeForReading),null):(e.error(d.sourceNode,a.a.InvalidTypeForReading),null):(e.error(p.sourceNode,a.a.InvalidTypeForReading),null):(e.error(d.sourceNode,a.a.InvalidConditonValueTypes,{leftTypeName:String(d),rightTypeName:String(h)}),null):(e.error(l.sourceNode,a.a.InvalidConditionType,{typeName:String(p)}),null)}analyzeArithmeticExpr(e,t,n){const i=n.children,s=t.currentScope,l=n.children[1].value,u=this.analyzeExpr(e,t,i[i.length-1]),c=this.analyzeExpr(e,t,i[0]);if(!u||!c)return e.error(n,a.a.InvalidArithmeticOperation,{operator:l,leftTypeName:"[unknown]",rightTypeName:"[unknown]"}),null;const p=u.type,h=c.type,f=me.checkTwoOperandExprTypes(e,l,p,h,u.sourceNode,c.sourceNode);return Object(r.f)(f)?(e.error(n,a.a.InvalidArithmeticOperation,{operator:l,leftTypeName:String(p),rightTypeName:String(h)}),null):ie(e,new d.a({scope:s,sourceNode:n,left:u,right:c,operator:l,type:f}),o.a.CODE_TARGET_SUPPORT)}analyzeRelationExpr(e,t,n){const i=n.children,s=t.currentScope,l=n.children[1].value,u=this.analyzeExpr(e,t,i[i.length-1]),c=this.analyzeExpr(e,t,i[0]),d=u?u.type:null,h=c?c.type:null,f=me.checkTwoOperandExprTypes(e,l,d,h,u?u.sourceNode:null,c?c.sourceNode:null);return Object(r.f)(f)?(e.error(n,a.a.InvalidRelationalOperation,{operator:l,leftTypeName:d?p.d.signature(d):"[unknown]",rightTypeName:h?p.d.signature(h):"[unknown]"}),null):u&&c?ie(e,new V.a({sourceNode:n,scope:s,left:u,right:c,operator:l}),o.a.CODE_TARGET_SUPPORT):null}analyzeLogicalExpr(e,t,n){const r=n.children,i=t.currentScope,s=n.children[1].value,l=this.analyzeExpr(e,t,r[r.length-1]),u=this.analyzeExpr(e,t,r[0]),c=l.type,p=u.type,d=ae.b;if(!c.isEqual(d))return e.error(c.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(c)}),null;if(!p.isEqual(d))return e.error(p.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(p)}),null;if(!c.readable)return e.error(n,a.a.InvalidTypeForReading),null;if(!p.readable)return e.error(n,a.a.InvalidTypeForReading),null;return ie(e,new U.a({scope:i,sourceNode:n,left:l,right:u,operator:s}),o.a.CODE_TARGET_SUPPORT)}analyzeAssignmentExpr(e,t,n){const i=n.children,s=t.currentScope,l=i[1].value,u=this.analyzeExpr(e,t,i[i.length-1]);p.a.unwind(u)||e.error(n,a.a.InvalidLeftHandSideInAssignment,{operator:l});const c=this.analyzeExpr(e,t,i[0]);if(Object(r.f)(u)||Object(r.f)(c))return null;const d=u.type,f=c.type;let m=null;return"="!==l?(m=me.checkTwoOperandExprTypes(e,l,d,f,u.sourceNode,c.sourceNode),Object(r.f)(m)&&e.error(n,a.a.InvalidArithmeticAssigmentOperation,{operator:l,leftTypeName:p.d.signature(d),rightTypeName:p.d.signature(f)})):m=f,m=me.checkTwoOperandExprTypes(e,"=",d,m),Object(r.f)(m)&&e.error(n,a.a.InvalidAssigmentOperation,{leftTypeName:p.d.signature(d),rightTypeName:p.d.signature(f)}),ie(e,new h.a({scope:s,sourceNode:n,left:u,right:c,operator:l}),o.a.CODE_TARGET_SUPPORT)}analyzeIdExpr(e,t,n){const i=t.currentScope,s=n.value,l=i.findVariable(s);if(Object(r.f)(l))return e.error(n,a.a.UnknownVarName,{varName:s}),null;const u=new v.a({scope:i,sourceNode:n,name:s});return ie(e,new O.a({scope:i,sourceNode:n,id:u,decl:l}),o.a.CODE_TARGET_SUPPORT)}analyzeSimpleExpr(e,t,n){const r=n.name,a=n.value,i=t.currentScope;switch(r){case"T_UINT":{const e=a.match(/^([0-9]+)(u?)$/),t="u"!==e[2];return new w.a({scope:i,sourceNode:n,value:Number(e[1]),signed:t})}case"T_FLOAT":return new k.a({scope:i,sourceNode:n,value:Number(a)});case"T_STRING":return new Z.a({scope:i,sourceNode:n,value:a});case"T_KW_TRUE":return new m.a({scope:i,sourceNode:n,value:!0});case"T_KW_FALSE":return new m.a({scope:i,sourceNode:n,value:!1})}return null}analyzeConstTypeDim(e,t,n){const r=n.children;if(r.length>1)return e.error(n,a.a.InvalidCastTypeUsage),null;const i=this.analyzeType(e,t,r[0]);return i.isBase()||e.error(n,a.a.InvalidCastTypeNotBase,{typeName:String(i)}),ie(e,i,o.a.CODE_TARGET_SUPPORT)}analyzeVarStructDecl(e,t,n){const r=n.children;let a=this.analyzeUsageStructDecl(e,t,r[r.length-1]),i=[];for(let n=r.length-2;n>=1;n--)"Variable"===r[n].name&&(i=i.concat(this.analyzeVariable(e,t,r[n],a)));return i}analyzeUsageStructDecl(e,t,n){const a=n.children,i=t.currentScope;let s=[],l=null;for(let n=a.length-1;n>=0;n--)if("StructDecl"===a[n].name){l=this.analyzeStructDecl(e,t,a[n]),ce(e,i,new Y.a({scope:i,sourceNode:a[n],type:l}))}else if("Usage"===a[n].name){const e=this.analyzeUsage(a[n]);s.push(e)}return Object(r.a)(!Object(r.f)(l)),ie(e,new te.a({scope:i,sourceNode:n,usages:s,type:l}),o.a.CODE_TARGET_SUPPORT)}analyzeStruct(e,t,n){const r=n.children,a=t.currentScope;let i=null;"T_NON_TYPE_ID"===r[r.length-2].name&&(i=r[r.length-2].value);let s=[];t.push(o.c.k_Struct);for(let n=r.length-4;n>=1;n--)"VariableDecl"===r[n].name&&(s=s.concat(this.analyzeVariableDecl(e,t,r[n])));return t.pop(),ie(e,new T.a({scope:a,sourceNode:n,fields:s,name:i}),o.a.CODE_TARGET_SUPPORT)}analyzeFunctionDecl(e,t,n){const i=n.children,s=t.currentScope,l=t.globalScope,u=i[0].value;let c=null,p=null;t.push(o.c.k_Default);const d=[];for(;"Attribute"===i[i.length-1-d.length].name;)d.push(this.analyzeAttribute(e,t,i[i.length-1-d.length]));const h=this.analyzeFunctionDef(e,t,i[i.length-1-d.length]);let f=l.findFunction(h.name,h.params.map(se));if(!Object(r.d)(f))return e.error(n,a.a.CannotChooseFunction,{funcName:h.name}),t.pop(),null;if(!Object(r.f)(f)&&f.impl)return e.error(n,a.a.FunctionRedefinition,{funcName:h.name}),t.pop(),null;if(!Object(r.f)(f)&&!f.def.returnType.isEqual(h.returnType))return e.error(n,a.a.InvalidFuncDefenitionReturnType,{funcName:h.name}),t.pop(),null;Object(r.a)(null===e.funcDef),e.funcDef=h,3===i.length&&(c=this.analyzeAnnotation(i[1])),";"!==u&&(p=this.analyzeStmtBlock(e,t,i[0])),t.pop();let m=h.returnType.isEqual(ae.i);if(!Object(r.f)(p)){let t=p.stmtList;for(let n=t.length-1;n>=0;--n)if(t[n].instructionType==o.b.k_ReturnStmt){n!=t.length-1&&e.error(t[n+1].sourceNode,a.a.UnreachableCode);break}}return Object(r.a)(s==l),f=new C.a({sourceNode:n,scope:s,definition:h,implementation:p,annotation:c,attributes:d}),l.addFunction(f)||e.error(n,a.a.FunctionRedifinition,{funcName:h.name}),m||e.haveCurrentFunctionReturnOccur||Object(r.f)(p)||e.error(n,a.a.InvalidFunctionReturnStmtNotFound,{funcName:h.name}),f}analyzeFunctionDef(e,t,n){const r=n.children,i=t.currentScope,s=r[r.length-2],l=s.value,u=r[r.length-1];let c=this.analyzeUsageType(e,t,u);if(c.isContainSampler())return e.error(u,a.a.InvalidFunctionReturnType,{funcName:l}),null;let p=new v.a({scope:i,name:l,sourceNode:s}),d=null;4===r.length&&(d=this.analyzeSemantic(r[0]));let h=this.analyzeParamList(e,t,r[r.length-3]),f=new I.a({scope:i,sourceNode:n,returnType:c,id:p,paramList:h,semantic:d});return ie(e,f,o.a.CODE_TARGET_SUPPORT),f}analyzeParamList(e,t,n){const r=n.children;let a=[];for(let n=r.length-2;n>=1;n--)if("ParameterDecl"===r[n].name){let i=this.analyzeParameterDecl(e,t,r[n]);a.push(i)}return a}analyzeParameterDecl(e,t,n){const a=n.children,i=this.analyzeParamUsageType(e,t,a[1]);return Object(r.f)(i)?null:this.analyzeVariable(e,t,a[0],i)}analyzeParamUsageType(e,t,n){const a=n.children,i=t.currentScope;let s=[],l=null;for(let n=a.length-1;n>=0;n--)if("Type"===a[n].name){if(l=this.analyzeType(e,t,a[n]),Object(r.f)(l))return null}else"ParamUsage"===a[n].name&&s.push(this.analyzeUsage(a[n]));let u=new te.a({scope:i,sourceNode:n,type:l,usages:s});return ie(e,u,o.a.CODE_TARGET_SUPPORT),u}analyzeStmtBlock(e,t,n){const a=n.children,i=t.currentScope;if(!a)return null;let s=[];for(let n=a.length-2;n>0;n--){let i=this.analyzeStmt(e,t,a[n]);Object(r.f)(i)||s.push(i)}const l=new X.a({sourceNode:n,scope:i,stmtList:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeStmt(e,t,n){const r=n.children;let a,i=r.length;do{a=r[--i].name}while("Attribute"===a);switch(a){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,r[0]);case"UseDecl":return this.analyzeUseDecl(e,t,r[0]),null;case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,n);case"T_KW_FOR":return this.analyzeForStmt(e,t,n);case"T_KW_IF":return this.analyzeIfStmt(e,t,n)}return null}analyzeSimpleStmt(e,t,n){const r=t.currentScope,a=n.children;switch(a[a.length-1].name){case"T_KW_RETURN":return this.analyzeReturnStmt(e,t,n);case"T_KW_DO":return this.analyzeWhileStmt(e,t,n);case"StmtBlock":{t.push(o.c.k_Default);let n=this.analyzeStmtBlock(e,t,a[0]);return t.pop(),n}case"T_KW_DISCARD":case"T_KW_BREAK":case"T_KW_CONTINUE":return this.analyzeBreakStmt(e,t,n);case"TypeDecl":case"VariableDecl":case"VarStructDecl":return this.analyzeDeclStmt(e,t,a[0]);default:return 2===a.length?this.analyzeExprStmt(e,t,n):new H.a({sourceNode:n,scope:r})}}analyzeReturnStmt(e,t,n){const i=n.children,s=t.currentScope;Object(r.a)(e.func);const l=e.funcDef.returnType;if(e.haveCurrentFunctionReturnOccur=!0,2===i.length&&le(l,ae.i),l.isEqual(ae.i)&&3===i.length)return e.error(n,a.a.InvalidReturnStmtVoid),null;if(!l.isEqual(ae.i)&&2===i.length)return e.error(n,a.a.InvalidReturnStmtEmpty),null;let u=null;if(3===i.length){if(u=this.analyzeExpr(e,t,i[1]),Object(r.f)(u))return e.error(n,a.a.InvalidReturnStmtTypesNotEqual),null;if(le(l,u.type),!l.isEqual(u.type))return e.error(n,a.a.InvalidReturnStmtTypesNotEqual),null}const c=new K.a({sourceNode:n,scope:s,expr:u});return ie(e,c,o.a.CODE_TARGET_SUPPORT),c}analyzeBreakStmt(e,t,n){const a=n.children,i=t.currentScope,s=a[1].value;"discard"===s&&Object(r.f)(e.funcDef);const l=new E.a({sourceNode:n,scope:i,operator:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeDeclStmt(e,t,n){n.children;const r=t.currentScope;let a=[];switch(n.name){case"TypeDecl":a.push(this.analyzeTypeDecl(e,t,n));break;case"VariableDecl":a=a.concat(this.analyzeVariableDecl(e,t,n));break;case"VarStructDecl":a=a.concat(this.analyzeVarStructDecl(e,t,n))}const i=new S.a({sourceNode:n,scope:r,declList:a});return ie(e,i,o.a.CODE_TARGET_SUPPORT),i}analyzeExprStmt(e,t,n){const r=t.currentScope,a=n.children,i=this.analyzeExpr(e,t,a[1]),s=new R.a({sourceNode:n,scope:r,expr:i});return ie(e,s,o.a.CODE_TARGET_SUPPORT),s}analyzeWhileStmt(e,t,n){const r=t.currentScope,i=n.children,s="do"===i[i.length-1].value,l="NonIfStmt"===n.name,u=ae.b;let c=null,p=null,d=null,h="do";if(s){if(h="do",!(p=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(n,a.a.InvalidDoWhileCondition,{typeName:String(p)}),null;d=this.analyzeStmt(e,t,i[0])}else{if(h="while",!(p=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(n,a.a.InvalidWhileCondition,{typeName:String(p)}),null;d=l?this.analyzeNonIfStmt(e,t,i[0]):this.analyzeStmt(e,t,i[0])}const f=new ne.a({sourceNode:n,scope:r,cond:c,body:d,operator:h});return ie(e,f,o.a.CODE_TARGET_SUPPORT),f}analyzeAttribute(e,t,n){const a=t.currentScope,i=n.children,s=i[i.length-2].value;let l=null;if(i.length>3){let n=null;l=[];for(let a=i.length-4;a>1;a--)","!==i[a].value&&(n=this.analyzeSimpleExpr(e,t,i[a]),Object(r.a)(n.instructionType===o.b.k_BoolExpr||n.instructionType===o.b.k_FloatExpr||n.instructionType===o.b.k_IntExpr),l.push(n))}return new f.a({scope:a,sourceNode:n,name:s,args:l})}analyzeIfStmt(e,t,n){const r=t.currentScope,i=n.children;let s=[];for(;"Attribute"===i[i.length-1-s.length].name;)s.push(this.analyzeAttribute(e,t,i[i.length-1-s.length]));const l=i.length-s.length==7,u=this.analyzeExpr(e,t,i[i.length-3-s.length]);u&&u.type.isEqual(ae.b)||e.error(n,a.a.InvalidIfCondition,{typeName:u?String(u.type):"[unknown]"});let c=null,p=null;if(l?(c=this.analyzeNonIfStmt(e,t,i[2]),p=this.analyzeStmt(e,t,i[0])):c=this.analyzeNonIfStmt(e,t,i[0]),!u)return null;const d=new P.a({sourceNode:n,scope:r,cond:u,conseq:c,contrary:p,attributes:s});return ie(e,d,o.a.CODE_TARGET_SUPPORT),d}analyzeNonIfStmt(e,t,n){const r=n.children;switch(r[r.length-1].name){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,r[0]);case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,n);case"T_KW_FOR":return this.analyzeForStmt(e,t,n)}return null}analyzeForStmt(e,t,n){const r=t.currentScope,a=n.children,i="NonIfStmt"===n.name;let s=null,l=null,u=null,c=null;if("ERROR"===a[1].name)return null;t.push(),l=this.analyzeForInit(e,t,a[a.length-3]),u=this.analyzeForCond(e,t,a[a.length-4]),c=null,7===a.length&&(c=this.analyzeForStep(e,t,a[2])),s=i?this.analyzeNonIfStmt(e,t,a[0]):this.analyzeStmt(e,t,a[0]),t.pop();const p=new N.a({sourceNode:n,scope:r,init:l,cond:u,step:c,body:s});return ie(e,p,o.a.CODE_TARGET_SUPPORT),p}analyzeForInit(e,t,n){const r=n.children;switch(r[r.length-1].name){case"VariableDecl":return this.analyzeVariableDecl(e,t,r[0])[0]||null;case"Expr":return this.analyzeExpr(e,t,r[0])}return null}analyzeForCond(e,t,n){const r=n.children;return 1===r.length?null:this.analyzeExpr(e,t,r[1])}analyzeForStep(e,t,n){const r=n.children;return 0==r.length?null:this.analyzeExpr(e,t,r[0])}analyzeTechniqueDecl(e,t,n){const r=n.children,a=this.analyzeComplexName(r[r.length-2]),i=(r[r.length-2].children.length,t.currentScope);let s=null,l=null,u=null,c=o.d.k_BasicFx;for(let n=r.length-3;n>=0;n--)"Annotation"===r[n].name?s=this.analyzeAnnotation(r[n]):"Semantic"===r[n].name?l=this.analyzeSemantic(r[n]):u=this.analyzeTechnique(e,t,r[n]);const p=new Q.a({sourceNode:n,name:a,techniqueType:c,semantic:l,annotation:s,passList:u,scope:i});return me.addTechnique(e,t,p),p}analyzeTechnique(e,t,n){const a=n.children;let i=[];for(let n=a.length-2;n>=1;n--){let s=this.analyzePassDecl(e,t,a[n]);Object(r.a)(!Object(r.f)(s)),i.push(s)}return i}analyzePassDecl(e,t,n){const r=n.children,a=t.currentScope,i=this.analyzePassStateBlockForShaders(e,t,r[0]),s=this.analyzePassStateBlock(e,t,r[0]);let o=null;for(let e=0;e<r.length;++e)if("T_NON_TYPE_ID"===r[e].name){let t=r[e].value;o=new v.a({scope:a,name:t})}return new j.a({scope:a,sourceNode:n,renderStates:s,id:o,pixelShader:i.pixel,vertexShader:i.vertex})}analyzePassStateBlockForShaders(e,t,n){const a=n.children;let i=null,s=null;const o=["vertexshader","pixelshader"];for(let n=a.length-2;n>=1;n--){let l=null;const u=a[n].children,c=u[u.length-1].value.toLowerCase();if(-1!==o.indexOf(c)&&(l=this.analyzePassStateForShader(e,t,a[n],c),!Object(r.f)(l)))switch(c){case"vertexshader":Object(r.a)(null==s),s=l;break;case"pixelshader":Object(r.a)(null==i),i=l;break;default:console.error("function is not suitable as shader entry point")}}return{vertex:s,pixel:i}}analyzePassStateForShader(e,t,n,i){Object(r.a)("vertexshader"===i||"pixelshader"===i);const s=n.children,o=s[s.length-3],l=o.children[o.children.length-1],u=this.analyzeExpr(e,t,l).function;return"vertexshader"===i?de(u.def)||e.error(n,a.a.FunctionIsNotCompatibleWithVertexShader,{funcDef:String(u)}):he(u.def)||e.error(n,a.a.FunctionIsNotCompatibleWithPixelShader,{funcDef:String(u)}),u}analyzePassStateBlock(e,t,n){const r=n.children;let a={};for(let n=r.length-2;n>=1;n--)a={...a,...this.analyzePassState(e,t,r[n])};return a}analyzePassState(e,t,n){const a=n.children,o=a[a.length-1].value.toUpperCase(),l=i.a[o]||null;if(Object(r.f)(l))return{};const u=a[a.length-3],c=u.children[u.children.length-1];if(Object(r.f)(c.value))return console.warn("Pass state is incorrect."),{};let p={};if("{"===c.value&&u.children.length>3){const e=new Array(Math.ceil((u.children.length-2)/2));for(let t=u.children.length-2,n=0;t>=1;t-=2,n++)e[n]=ue(l,u.children[t].value.toUpperCase());switch(l){case i.a.BLENDFUNC:if(2!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.SRCBLENDCOLOR]=e[0],p[i.a.SRCBLENDALPHA]=e[0],p[i.a.DESTBLENDCOLOR]=e[1],p[i.a.DESTBLENDALPHA]=e[1];break;case i.a.BLENDFUNCSEPARATE:if(4!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.SRCBLENDCOLOR]=e[0],p[i.a.SRCBLENDALPHA]=e[2],p[i.a.DESTBLENDCOLOR]=e[1],p[i.a.DESTBLENDALPHA]=e[3];break;case i.a.BLENDEQUATIONSEPARATE:if(2!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.BLENDEQUATIONCOLOR]=e[0],p[i.a.BLENDEQUATIONALPHA]=e[1];break;default:return console.warn("Pass state is incorrect."),{}}}else{let e="";const t=ue(l,e="{"===c.value?u.children[1].value.toUpperCase():c.value.toUpperCase());if(t!==s.a.UNDEF)switch(l){case i.a.SRCBLEND:p[i.a.SRCBLENDCOLOR]=t,p[i.a.SRCBLENDALPHA]=t;break;case i.a.DESTBLEND:p[i.a.DESTBLENDCOLOR]=t,p[i.a.DESTBLENDALPHA]=t;break;case i.a.BLENDEQUATION:p[i.a.BLENDEQUATIONCOLOR]=t,p[i.a.BLENDEQUATIONALPHA]=t;break;default:p[l]=t}}return p}analyzeImportDecl(e,t,n){const r=n.children,i=this.analyzeComplexName(r[r.length-2]);return e.error(n,a.a.ImportedComponentNotExists,{componentName:i}),null}analyzeStructDecl(e,t,n){const r=n.children,a=t.currentScope,i=r[r.length-2].value;t.push(o.c.k_Struct);let s=[];for(let n=r.length-4;n>=1;n--)"VariableDecl"===r[n].name&&(s=s.concat(this.analyzeVariableDecl(e,t,r[n])));return t.pop(),ie(e,new T.a({scope:a,sourceNode:n,name:i,fields:s}),o.a.CODE_TARGET_SUPPORT)}analyzeTypeDecl(e,t,n){const r=n.children,i=t.currentScope;let s=null;2===r.length?s=this.analyzeStructDecl(e,t,r[1]):e.error(n,a.a.UnsupportedTypeDecl);let l=new Y.a({scope:i,sourceNode:n,type:s});return ce(e,i,l),ie(e,l,o.a.CODE_TARGET_SUPPORT)}analyzeUnknDecl(e,t,n){switch(n.name){case"TechniqueDecl":return[this.analyzeTechniqueDecl(e,t,n)];case"UseDecl":return this.analyzeUseDecl(e,t,n),null;case"ImportDecl":return[this.analyzeImportDecl(e,t,n)];case"ProvideDecl":return[this.analyzeProvideDecl(e,t,n)];case"TypeDecl":return[this.analyzeTypeDecl(e,t,n)];case"VariableDecl":return this.analyzeVariableDecl(e,t,n);case"VarStructDecl":return this.analyzeVarStructDecl(e,t,n);case"FunctionDecl":Object(r.a)(t.currentScope==t.globalScope);let a=null;return e.beginFunc(),a=this.analyzeFunctionDecl(e,t,n),e.endFunc(),[a]}return null}analyzeGlobals(e,t,n){if(Object(r.f)(n)||Object(r.f)(n.root))return null;const a=n.root.children;let i=[];if(Object(r.f)(a))return[];for(let n=a.length-1;n>=0;n--)i.push(...this.analyzeUnknDecl(e,t,a[n])||[]);return i.filter(e=>!!e)}createContext(e){return new fe(e)}createProgram(e=null){let t=ae.a;return Object(r.f)(e)||(t=e.root.scope),new re.a(t)}validate(e,t,n){pe(e,t),t.validate()}async parse(e,t){const n=e.uri,r=this.createProgram(t),a=this.createContext(n);let i=null;try{i=this.analyzeGlobals(a,r,e)}catch(e){console.error(e)}const s=new L.a({scope:r.globalScope,instructions:i});return this.validate(a,r,s),{root:s,diagnosticReport:l.b.mergeReports([e.diagnosticReport,a.diagnostics.resolve()]),uri:n}}static addTechnique(e,t,n){let i=n.name;Object(r.f)(t.globalScope.findTechnique(i))?t.globalScope.addTechnique(n):e.error(n.sourceNode,a.a.TechniqueNameRedefinition,{techName:i})}static checkTwoOperandExprTypes(e,t,n,r,i=n.sourceNode,s=r.sourceNode){if(!n||!r)return null;const o=n.isComplex()||r.isComplex(),l=n.isNotBaseArray()||r.isNotBaseArray(),u=ae.q(n)||ae.q(r),c=ae.b;if(l||u)return null;if("%"===t||"%="===t)return null;if(me.isAssignmentOperator(t)){if(!n.writable)return e.error(i,a.a.InvalidTypeForWriting),null;if(!r.readable)return e.error(s,a.a.InvalidTypeForReading),null;"="===t||n.readable||e.error(i,a.a.InvalidTypeForReading)}else{if(!n.readable)return e.error(i,a.a.InvalidTypeForReading),null;if(!r.readable)return e.error(s,a.a.InvalidTypeForReading),null}if(o)return"="===t&&n.isEqual(r)?n:!me.isEqualOperator(t)||n.isContainArray()||n.isContainSampler()?null:c;const p=te.a.wrap(n.baseType,ae.a),d=te.a.wrap(r.baseType,ae.a);if(n.isConst()&&me.isAssignmentOperator(t))return null;if(n.isEqual(r))return me.isArithmeticalOperator(t)?!ae.p(n)||"/"!==t&&"/="!==t?p:null:me.isRelationalOperator(t)?ae.r(n)?c:null:me.isEqualOperator(t)?c:"="===t?p:null;if(me.isRelationalOperator(t)&&(n.isEqual(ae.h)&&r.isEqual(ae.e)||n.isEqual(ae.e)&&r.isEqual(ae.h)))return c;if(me.isArithmeticalOperator(t)){if(ae.m(n)||ae.m(r)||ae.n(n)!==ae.n(r)||ae.o(n)!==ae.o(r)||ae.s(n)!==ae.s(r))return null;if(ae.r(n))return d;if(ae.r(r))return p;if("*"===t||"*="===t)return ae.p(n)&&ae.t(r)&&n.length===r.length?d:ae.p(r)&&ae.t(n)&&n.length===r.length?p:null}return"="===t&&(n.isEqual(ae.e)&&r.isEqual(ae.h)||n.isEqual(ae.h)&&r.isEqual(ae.e))?n:null}static checkOneOperandExprType(e,t,n,r){const i=r.isComplex(),s=r.isNotBaseArray(),o=ae.q(r);if(i||s||o)return null;if(!r.readable)return e.error(t,a.a.InvalidTypeForReading),null;if("++"===n||"--"===n)return r.writable?r:(e.error(t,a.a.InvalidTypeForWriting),null);if("!"===n){const e=ae.b;return r.isEqual(e)?e:null}return ae.m(r)?null:r.baseType}static isAssignmentOperator(e){return"+="===e||"-="===e||"*="===e||"/="===e||"%="===e||"="===e}static isArithmeticalOperator(e){return"+"===e||"+="===e||"-"===e||"-="===e||"*"===e||"*="===e||"/"===e||"/="===e}static isRelationalOperator(e){return">"===e||">="===e||"<"===e||"<="===e}static isEqualOperator(e){return"=="===e||"!="===e}}}).call(this,n("3UD+")(e))},PLhK:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("fb8x"),a=n("Wl5j"),i=n("FrU9"),s=n("gf1s"),o=n("4AA8"),l=n("2b0+");class u extends o.a{constructor({operator:e,params:t=[],...n}){super({instrType:i.b.k_SamplerStateBlockExpr,type:a.f,...n}),this._samplerParams=t.map(e=>l.a.$withParent(e,this)),this._operator=e}get texture(){let e=this._samplerParams;for(let t=0;t<e.length;++t)if("TEXTURE"===e[t].name)return e[t].value;return null}get params(){return this._samplerParams}get operator(){return this._operator}isConst(){return!0}evaluate(){var e={textureName:"",wrap_s:0,wrap_t:0,mag_filter:0,min_filter:0};return Object(r.f)(this.texture)||(e.textureName=this.texture.name),Object(r.f)(this._samplerParams)||(Object(r.d)(this._samplerParams.ADDRESSU)&&(e.wrap_s=u.convertWrapMode(this._samplerParams.ADDRESSU)),Object(r.d)(this._samplerParams.ADDRESSV)&&(e.wrap_t=u.convertWrapMode(this._samplerParams.ADDRESSV)),Object(r.d)(this._samplerParams.MAGFILTER)&&(e.mag_filter=u.convertFilters(this._samplerParams.MAGFILTER)),Object(r.d)(this._samplerParams.MINFILTER)&&(e.min_filter=u.convertFilters(this._samplerParams.MINFILTER))),this._evalResult=e,!0}static convertWrapMode(e){switch(e){case"WRAP":return s.b.REPEAT;case"CLAMP":return s.b.CLAMP_TO_EDGE;case"MIRROR":return s.b.MIRRORED_REPEAT;default:return 0}}static convertFilters(e){switch(e){case"NEAREST":return s.a.NEAREST;case"LINEAR":return s.a.LINEAR;case"NEAREST_MIPMAP_NEAREST":return s.a.NEAREST_MIPMAP_NEAREST;case"LINEAR_MIPMAP_NEAREST":return s.a.LINEAR_MIPMAP_NEAREST;case"NEAREST_MIPMAP_LINEAR":return s.a.NEAREST_MIPMAP_LINEAR;case"LINEAR_MIPMAP_LINEAR":return s.a.LINEAR_MIPMAP_LINEAR;default:return 0}}}},QsPN:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4AA8"),a=n("Wl5j"),i=n("FrU9"),s=n("hljw");class o extends r.a{constructor({value:e,signed:t,scope:n,...r}){super({instrType:i.b.k_IntExpr,type:s.a.wrapAsConst(t?a.e:a.h,a.a),scope:n,...r}),this.value=e,this.signed=t,t||(this.value>>>=0)}toString(){return`${this.value}`}toCode(){return this.toString()}evaluate(){return this._evalResult=this.value,!0}isConst(){return!0}}},RTx6:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("fb8x"),a=n("zioJ"),i=n("a1Km"),s=n("zX2+"),o=n("/zHR");class l extends o.b{constructor(){super("Analyzer Diagnostics","A")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.loc}diagnosticMessages(){return{[a.a.InvalidReturnStmtEmpty]:"Invalid return statement. Expression with '*type*' type expected.",[a.a.InvalidReturnStmtVoid]:"Invalid return statement. Expression with 'void' type expected.",[a.a.FunctionRedefinition]:"Function redefinition. Function with name '{info.funcName}' already declared.",[a.a.InvalidFuncDefenitionReturnType]:"Invalid function defenition return type. Function with the same name '{info.funcName}' but another type already declared.",[a.a.InvalidFunctionReturnStmtNotFound]:"Return statement expected.",[a.a.InvalidVariableInitializing]:"Invalid variable initializing."}}resolveDescription(e,t,n){let o=this.diagnosticMessages();if(Object(r.e)(o[e]))return super.resolveDescription(e,t,n);let{file:l,loc:u,...c}=n;return t==s.a.k_Warning?`${i.a[e]}: ${JSON.stringify(c)}`:`${a.a[e]}: ${JSON.stringify(c)}`}}},"Vs+U":function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"flag",(function(){return d})),n.d(r,"testBit",(function(){return h})),n.d(r,"testAll",(function(){return f})),n.d(r,"testAny",(function(){return m})),n.d(r,"setBit",(function(){return E})),n.d(r,"clearBit",(function(){return _})),n.d(r,"setAll",(function(){return y})),n.d(r,"clearAll",(function(){return g})),n.d(r,"equal",(function(){return T})),n.d(r,"isEqual",(function(){return x})),n.d(r,"isNotEqaul",(function(){return b})),n.d(r,"set",(function(){return S})),n.d(r,"clear",(function(){return R})),n.d(r,"setFlags",(function(){return k})),n.d(r,"clearFlags",(function(){return N})),n.d(r,"isEmpty",(function(){return A})),n.d(r,"totalBits",(function(){return C})),n.d(r,"totalSet",(function(){return I}));var a,i,s,o,l,u,c,p=n("fb8x");!function(e){e[e.k_Default=0]="k_Default",e[e.k_Necessary=1]="k_Necessary",e[e.k_Expose=2]="k_Expose",e[e.k_Skip=3]="k_Skip"}(a||(a={})),function(e){e[e.k_Ok=0]="k_Ok",e[e.k_Error=1]="k_Error"}(i||(i={})),function(e){e[e.k_LR0=0]="k_LR0",e[e.k_LR1=1]="k_LR1",e[e.k_LALR=2]="k_LALR"}(s||(s={})),function(e){e[e.k_Optimize=8]="k_Optimize",e[e.k_DeveloperMode=16]="k_DeveloperMode"}(o||(o={})),function(e){e[e.k_ForceAppendAll=1]="k_ForceAppendAll",e[e.k_AllowExposeMode=2]="k_AllowExposeMode",e[e.k_AllowAddMode=4]="k_AllowAddMode",e[e.k_AllowSkipMode=8]="k_AllowSkipMode",e[e.k_Default=14]="k_Default",e[e.k_Debug=16]="k_Debug"}(l||(l={})),function(e){e[e.k_NumericLiteral=1]="k_NumericLiteral",e[e.k_SinglelineCommentLiteral=2]="k_SinglelineCommentLiteral",e[e.k_MultilineCommentLiteral=3]="k_MultilineCommentLiteral",e[e.k_StringLiteral=4]="k_StringLiteral",e[e.k_PunctuatorLiteral=5]="k_PunctuatorLiteral",e[e.k_WhitespaceLiteral=6]="k_WhitespaceLiteral",e[e.k_NewlineLiteral=7]="k_NewlineLiteral",e[e.k_IdentifierLiteral=8]="k_IdentifierLiteral",e[e.k_KeywordLiteral=9]="k_KeywordLiteral",e[e.k_Unknown=10]="k_Unknown",e[e.k_End=11]="k_End"}(u||(u={})),function(e){e[e.k_Error=100]="k_Error",e[e.k_Shift=101]="k_Shift",e[e.k_Reduce=102]="k_Reduce",e[e.k_Success=103]="k_Success",e[e.k_Ok=104]="k_Ok"}(c||(c={}));var d=e=>1<<e,h=(e,t)=>0!=(e&d(t)),f=(e,t)=>(e&t)==t,m=(e,t)=>0!=(e&t),E=(e,t,n=!0)=>n?e|=d(t):_(e,t),_=(e,t)=>e&=~d(t),y=(e,t,n=!0)=>n?e|=t:e&=~t,g=(e,t)=>e&=~t,T=(e,t)=>{t},x=(e,t)=>e==t,b=(e,t)=>e!=t,S=(e,t)=>{t},R=e=>{0},k=(e,t)=>e|=t,N=(e,t)=>e&=~t,A=e=>0==e,C=e=>32,I=e=>{for(var t=0,n=C(e);n;--n)t+=1&e,e>>=1;return t},O=r,v=n("/zHR");const P="END",F="EMPTY",D="UNKNOWN",L="S",w="##",U="#",j="ERROR",B="$",W="--LEXER--",z="--add",M="--skip",q="--expose",V="--F",K="EOF",G="T_STRING",$="T_FLOAT",H="T_UINT",X="T_TYPE_ID",Z="T_NON_TYPE_ID",Q="T_LINE_TERMINATOR";class Y{constructor(e,t,n){this.rule=e,this.pos=t,this.index=0,this.expectedSymbols=new Set,n&&n.forEach(e=>this.addExpected(e))}isEqual(e,t=s.k_LR0){if(t===s.k_LR0)return this.rule===e.rule&&this.pos===e.pos;if(t===s.k_LR1){if(this.rule!==e.rule||this.pos!==e.pos||this.expectedSymbols.size!==e.expectedSymbols.size)return!1;for(const t of this.expectedSymbols)if(!e.isExpected(t))return!1;return!0}return!1}isParentItem(e){return this.rule===e.rule&&this.pos===e.pos+1}isChildItem(e){return this.rule===e.rule&&this.pos===e.pos-1}symbolName(){const e=this.rule.right;return this.pos===e.length?P:e[this.pos]}isExpected(e){return this.expectedSymbols.has(e)}addExpected(e){return!this.isExpected(e)&&(this.expectedSymbols.add(e),!0)}toString(e=null){const{left:t,right:n}=this.rule;let r=`${t} -> `;if(r+=n.map(t=>Y.decodeSymbol(t,e)).map((e,t)=>t===this.pos?`. ${e}`:`${e}`).join(" "),this.pos===n.length&&(r+=" . "),this.expectedSymbols){const t=Array.from(this.expectedSymbols).map(t=>Y.decodeSymbol(t,e));t.length&&(r+=", "+t.join(" "))}return r}static decodeSymbol(e,t){return t&&t.get(e)&&e!==t.get(e)?`'${t.get(e)}'`:e}}class J{constructor(e){this.content=e}valueOf(){return this.content}toString(){return this.content}toSource(){return this.content}static make(e){return Object(p.h)(e)?new J(`${e}`):e}}var ee,te;!function(e){e[e.UnknownToken=2101]="UnknownToken",e[e.InvalidToken=2102]="InvalidToken"}(ee||(ee={}));class ne extends v.b{constructor(){super("Lexer Diagnostics","L")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.token.loc}diagnosticMessages(){return{[ee.UnknownToken]:"Unknown token: {token.value}.",[ee.InvalidToken]:"Invalid token: {token.value}."}}}class re{constructor(){this.keywords={},this.punctuators={},this.punctuatorsFirstSymbols={}}addPunctuator(e,t=re.getPunctuatorName(e)){return this.punctuators[e]=t,this.punctuatorsFirstSymbols[e[0]]=!0,t}addKeyword(e,t){return this.keywords[e]=t,t}getTerminalValueByName(e){let t="";for(t in this.punctuators)if(this.punctuators[t]===e)return t;for(t in this.keywords)if(this.keywords[t]===e)return t;return e}isLineTerminator(e){return"\n"===e||"\r"===e||"\u2028"===e||"\u2029"===e}isKeyword(e){return!!this.keywords[e]}isPunctuator(e){return!!this.punctuators[e]}isNumberStart(e,t){return e>="0"&&e<="9"||"."===e&&t>="0"&&t<="9"}isCommentStart(e,t){return"/"===e&&("/"===t||"*"===t)}isStringStart(e){return'"'===e||"'"===e}isPunctuatorStart(e){return!!this.punctuatorsFirstSymbols[e]}isWhiteSpaceStart(e){return" "===e||"\t"===e}isNewlineStart(e){return"\n"===e||"\r"===e}isIdentifierStart(e){return"_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"}static getPunctuatorName(e){return"T_PUNCTUATOR_"+e.charCodeAt(0)}}class ae{constructor({engine:e=new re,knownTypes:t=new Set,skipComments:n=!0}){this.lineNumber=0,this.columnNumber=0,this.index=0,this.diagnostics=new ne,this.knownTypes=t,this.engine=e,this.skipComments=n}setup(e){this.uri=J.make(e.uri),this.source=e.source}getDiagnosticReport(){return this.diagnostics.resolve()}getNextToken(e){if(!this.currentChar()){let e=this.pos();return{index:this.index,name:B,value:B,loc:{start:e,end:{...e}}}}let t=null;switch(this.identityTokenType()){case u.k_NumericLiteral:t=this.scanNumber();break;case u.k_SinglelineCommentLiteral:case u.k_MultilineCommentLiteral:t=this.scanComment(),this.skipComments&&(t=this.getNextToken());break;case u.k_StringLiteral:t=this.scanString();break;case u.k_PunctuatorLiteral:t=this.scanPunctuator();break;case u.k_IdentifierLiteral:t=this.scanIdentifier();break;case u.k_NewlineLiteral:t=this.scanLineTerminators(),e||(t=this.getNextToken());break;case u.k_WhitespaceLiteral:this.scanWhiteSpace(),t=this.getNextToken();break;default:{const e=this.pos();let n="";for(;this.identityTokenType()===u.k_Unknown&&this.index<this.source.length;)n+=this.currentChar(),this.readNextChar();return t={index:this.index,name:D,value:n,loc:{start:e,end:this.pos()}},this.emitError(ee.UnknownToken,t),t}}return t}getLocation(){return{line:this.lineNumber,file:this.uri}}setSource(e){this.source=e}setIndex(e){this.index=e}pos(e=0){return{file:this.uri,line:this.lineNumber,column:this.columnNumber+e,offset:this.index+e}}emitError(e,t){this.diagnostics.error(e,{file:`${this.uri}`,token:t})}identityTokenType(){return this.isIdentifierStart()?u.k_IdentifierLiteral:this.isWhiteSpaceStart()?u.k_WhitespaceLiteral:this.isNewlineStart()?u.k_NewlineLiteral:this.isStringStart()?u.k_StringLiteral:this.isCommentStart()?u.k_SinglelineCommentLiteral:this.isNumberStart()?u.k_NumericLiteral:this.isPunctuatorStart()?u.k_PunctuatorLiteral:u.k_Unknown}isNumberStart(){return this.engine.isNumberStart(this.currentChar(),this.nextChar())}isCommentStart(){return this.engine.isCommentStart(this.currentChar(),this.nextChar())}isStringStart(){return this.engine.isStringStart(this.currentChar())}isPunctuatorStart(){return this.engine.isPunctuatorStart(this.currentChar())}isWhiteSpaceStart(){return this.engine.isWhiteSpaceStart(this.currentChar())}isNewlineStart(){return this.engine.isNewlineStart(this.currentChar())}isIdentifierStart(){return this.engine.isIdentifierStart(this.currentChar())}nextChar(){return this.source[this.index+1]}currentChar(){return this.source[this.index]}readNextChar(){return this.index++,this.columnNumber++,this.source[this.index]}scanString(){let e=this.currentChar(),t=e,n="",r=e,a=!1,i=this.pos();for(;n=this.readNextChar();){if(t+=n,n===e&&"\\"!==r){a=!0,this.readNextChar();break}r=n}if(a)return{index:this.index,name:G,value:t,loc:{start:i,end:this.pos()}};{n||(n=K),t+=n;const e={index:this.index,type:u.k_StringLiteral,value:t,loc:{start:i,end:this.pos()}};return this.emitError(ee.InvalidToken,e),ae.makeUnknownToken(e)}}scanPunctuator(){let e,t=this.currentChar(),n=this.pos();for(;e=this.readNextChar();)if(t+=e,!this.engine.isPunctuator(t)){t=t.slice(0,t.length-1);break}return{index:this.index,name:this.engine.punctuators[t],value:t,loc:{start:n,end:this.pos()}}}scanNumber(){let e=this.currentChar(),t="",n=!1,r=e,a=!1,i=!1,s=!1,o=this.pos();for("."===e&&(t+=0,n=!0),t+=e;;){if("."===(e=this.readNextChar())){if(n||s)break;n=!0}else if("e"===e){if(i||s)break;i=!0}else if("u"===e){if(i||s)break;s=!0}else{if(("+"===e||"-"===e)&&"e"===r){t+=e,r=e;continue}if("f"===e&&n){if((e=this.readNextChar())>="a"&&e<="z"||e>="A"&&e<="Z")break;a=!0;break}if(e>="a"&&e<="z"||e>="A"&&e<="Z")break;if(!(e>="0"&&e<="9")||!e||s){(i&&"+"!==r&&"-"!==r&&"e"!==r||!i)&&(a=!0);break}}t+=e,r=e}if(a){let e=n?$:H;return{index:this.index,name:e,value:t,loc:{start:o,end:this.pos()}}}{e||(e=K),t+=e;const n={index:this.index,type:u.k_NumericLiteral,value:t,loc:{start:o,end:this.pos()}};return this.emitError(ee.InvalidToken,n),ae.makeUnknownToken(n)}}scanIdentifier(){let e=this.currentChar(),t=e,n=this.pos(),r=!1;for(;;){if(!(e=this.readNextChar())){r=!0;break}if(!("_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9")){r=!0;break}t+=e}if(r){if(this.engine.isKeyword(t))return{index:this.index,name:this.engine.keywords[t],value:t,loc:{start:n,end:this.pos()}};{let e=this.knownTypes.has(t)?X:Z;return{index:this.index,name:e,value:t,loc:{start:n,end:this.pos()}}}}{e||(e=K),t+=e;const r={index:this.index,type:u.k_IdentifierLiteral,value:t,loc:{start:n,end:this.pos()}};return this.emitError(ee.InvalidToken,r),ae.makeUnknownToken(r)}}scanLineTerminators(){let e=this.currentChar(),t="",n=this.pos();for(;e&&this.engine.isLineTerminator(e);)t+=e,"\r"===e&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,e=this.readNextChar(),this.columnNumber=0;let r=Q;return{index:this.index,name:r,value:t,loc:{start:n,end:this.pos()}}}scanWhiteSpace(){let e=this.currentChar();for(;e;){if("\t"===e)this.columnNumber+=0;else if(" "!==e)break;e=this.readNextChar()}return!0}scanComment(){let e=this.currentChar(),t=this.readNextChar(),n=this.pos();if(e+=t,"/"===t){for(;t=this.readNextChar();){if(this.engine.isLineTerminator(t)){"\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.readNextChar(),this.columnNumber=0;break}e+=t}return{index:this.index,type:u.k_SinglelineCommentLiteral,value:e,loc:{start:n,end:this.pos()}}}{let n=t,r=!1,a=this.pos();for(;t=this.readNextChar();){if(e+=t,"/"===t&&"*"===n){r=!0,this.readNextChar();break}this.engine.isLineTerminator(t)&&("\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.columnNumber=-1),n=t}if(r)return{index:this.index,type:u.k_MultilineCommentLiteral,value:e,loc:{start:a,end:this.pos()}};{t||(t=K),e+=t;const n={index:this.index,type:u.k_MultilineCommentLiteral,value:e,loc:{start:a,end:this.pos()}};return this.emitError(ee.InvalidToken,n),ae.makeUnknownToken(n)}}}static makeUnknownToken(e){return{...e,type:void 0,name:D,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}}class ie{constructor(){this.nextStates={},this.index=0,this.items=[],this.numBaseItems=0,this.numOtherItems=0}eachItem(e){for(let t=0;t<this.items.length;++t)e(this.items[t],t)}eachBaseItem(e){for(let t=0;t<this.numBaseItems;++t)e(this.items[t],t)}isExpected(e){return!!this.items.find(t=>t.isExpected(e))}hasItem(e,t){return this.items.find(n=>n.isEqual(e,t))||null}hasParentItem(e){return this.items.find(t=>t.isParentItem(e))||null}hasChildItem(e){return this.items.find(t=>t.isChildItem(e))||null}hasRule(e,t){for(let n=0;n<this.numBaseItems;++n){const r=this.items[n];if(r.rule===e&&r.pos===t)return!0}return!1}isEmpty(){return!this.items.length}isEqual(e,t){if(this.numBaseItems!==e.numBaseItems)return!1;for(let n=0;n<this.numBaseItems;++n){const r=this.items[n];let a=!1;for(let n=0;n<e.numBaseItems;++n){const i=e.items[n];if(r.isEqual(i,t)){a=!0;break}}if(!a)return!1}return!0}push(e){0===this.items.length||e.pos>0?(Object(p.a)(0===this.numOtherItems),this.numBaseItems++):this.numOtherItems++,this.items.push(e)}tryPush_LR0(e,t){if(this.items.find(n=>n.rule===e&&n.pos===t))return!1;const n=new Y(e,t);return this.push(n),!0}tryPush_LR(e,t,n){const r=this.items.find(n=>n.rule===e&&n.pos===t);if(r)return r.addExpected(n);const a=new Y(e,t,[n]);return this.push(a),!0}addNextState(e,t){return!this.nextStates[e]&&(this.nextStates[e]=t,!0)}deleteNotBase(){this.items.length=this.numBaseItems}toString(e=!0,t=null){const n=e?this.items.slice(0,this.numBaseItems):this.items;return`State ${this.index}:\n`+n.map(e=>`\t\t${e.toString(t)}\n`).join()}}!function(e){e[e.GrammarAddOperation=2001]="GrammarAddOperation",e[e.GrammarAddStateLink=2002]="GrammarAddStateLink",e[e.GrammarUnexpectedSymbol=2003]="GrammarUnexpectedSymbol",e[e.GrammarInvalidAdditionalFuncName=2004]="GrammarInvalidAdditionalFuncName",e[e.GrammarInvalidKeyword=2005]="GrammarInvalidKeyword"}(te||(te={}));class se extends v.b{constructor(){super("Grammar diagnostics","G")}resolveFilename(e,t){return t.file}resolveRange(e,t){return null}resolvePosition(e,t){return{line:t.line,column:0,file:null}}diagnosticMessages(){return{[te.GrammarAddOperation]:'Grammar not LALR(1)! Cannot to generate syntax table. Add operation error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld operation: {oldOperation}\nNew operation: {newOperation}\nFor more info init parser in debug-mode and see syntax table and list of states.\n\n{stateDesc}',[te.GrammarAddStateLink]:'Grammar not LALR(1)! Cannot to generate syntax table. Add state link error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld next state: {oldNextStateIndex}\nNew next state: {newNextStateIndex}\nFor more info init parser in debug-mode and see syntax table and list of states.',[te.GrammarUnexpectedSymbol]:"Grammar error. Can`t generate rules from grammar\nUnexpected symbol: {unexpectedSymbol}\nExpected: {expectedSymbol}",[te.GrammarInvalidAdditionalFuncName]:"Grammar error. Empty additional function name.",[te.GrammarInvalidKeyword]:"Grammar error. Bad keyword: {badKeyword}\nAll keyword must be define in lexer rule block."}}}class oe{constructor({grammar:e,flags:t=l.k_Default,type:n=s.k_LALR}){this._syntaxTable=null,this._productions=null,this._baseItems=null,this._states=null,this._additionalFuncInfoList=null,this._adidtionalFunctByStateDMap=null,this._ruleCreationModeMap=null,this._firstTerminalsCache=null,this._closureForItemsCache=null,this._expectedExtensionDMap=null,this._diag=new se,this.init({grammar:e,flags:t,type:n})}get syntaxTable(){return this._syntaxTable}findFunctionByState(e,t){const n=this._adidtionalFunctByStateDMap;return!Object(p.f)(n)&&Object(p.d)(n[e])&&Object(p.d)(n[e][t])?n[e][t]:null}getRuleCreationMode(e){return this._ruleCreationModeMap[e]}getGrammarSymbols(){return this._grammarSymbols}init({grammar:e,flags:t=l.k_Default,type:n=s.k_LALR}){this.lexerEngine=new re,this.generateRules(e,t),this.buildSyntaxTable(n),this.generateFunctionByStateMap(),O.testAll(t,l.k_Debug)||this.clearMem()}printStates(e=!0){if(!Object(p.d)(this._states))return void console.warn("It`s impossible to print states. You must init parser in debug-mode");const t="\n"+this.statesToString(e);console.log(t)}printState(e,t=!0){if(Object(p.d)(this._states)){var n=this._states[e];Object(p.d)(n)?console.log(`\n${n.toString(t,this.getGrammarSymbols())}`):console.log("Can not print stete with index: "+e.toString())}else console.log("It`s impossible to print states. You must init parser in debug-mode.")}critical(e,t){this._diag.critical(e,t)}grammarError(e,t){let n="grammar";switch(e){case te.GrammarAddOperation:{const{stateIndex:r,grammarSymbol:a,oldOperation:i,newOperation:s}=t;this.critical(e,{file:n,line:0,stateIndex:r,grammarSymbol:a,oldOperation:oe.operationToString(i),newOperation:oe.operationToString(s),stateDesc:this._states[r].toString()})}break;case te.GrammarAddStateLink:{const{stateIndex:r,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s}=t;this.critical(e,{file:n,line:0,stateIndex:r,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s})}break;case te.GrammarUnexpectedSymbol:{const{grammarLine:r,expectedSymbol:a,unexpectedSymbol:i}=t;this.critical(e,{file:n,line:r,expectedSymbol:a,unexpectedSymbol:i})}break;case te.GrammarInvalidAdditionalFuncName:{const{grammarLine:r}=t;this.critical(e,{file:n,line:r})}break;case te.GrammarInvalidKeyword:{const{grammarLine:r,badKeyword:a}=t;this.critical(e,{file:n,line:r,badKeyword:a})}break;default:throw"invalid case!!!!"}}clearMem(){delete this._states,delete this._productions,delete this._baseItems,delete this._firstTerminalsCache,delete this._closureForItemsCache,delete this._expectedExtensionDMap}hasState(e,t){return this._states.find(n=>n.isEqual(e,t))||null}nonTerminals(){return Object.keys(this._productions)}rules(e){const t=this._productions[e];return t?Object.keys(t).map(e=>t[e]):null}ruleCreationMode(e){return this._ruleCreationModeMap[e]}symbols(){return[...this._grammarSymbols.keys()]}isTerminal(e){return!this._productions[e]}pushState(e){e.index=this._states.length,this._states.push(e)}pushBaseItem(e){e.index=this._baseItems.length,this._baseItems.push(e)}tryAddState(e,t){let n=this.hasState(e,t);return Object(p.f)(n)?(t===s.k_LR0&&e.eachItem(e=>this.pushBaseItem(e)),this.pushState(e),this.closure(e,t),e):n}hasEmptyRule(e){return!this.isTerminal(e)&&!!this.rules(e).find(e=>0===e.right.length)}pushInSyntaxTable(e,t,n,r){e[t]=e[t]||{},Object(p.d)(e[t][n])&&this.grammarError(te.GrammarAddOperation,{stateIndex:t,grammarSymbol:this.convertGrammarSymbol(n),oldOperation:this._syntaxTable[t][n],newOperation:r}),e[t][n]=r}addStateLink(e,t,n){e.addNextState(n,t)||this.grammarError(te.GrammarAddStateLink,{stateIndex:e.index,oldNextStateIndex:e.nextStates[n]||null,newNextStateIndex:t.index,grammarSymbol:this.convertGrammarSymbol(n)})}firstTerminals(e){if(this.isTerminal(e))return null;if(Object(p.d)(this._firstTerminalsCache[e]))return this._firstTerminalsCache[e];const t=this.rules(e),n=this._firstTerminalsCache[e]=new Set;if(this.hasEmptyRule(e)&&n.add(F),Object(p.f)(t))return n;for(let r=0;r<t.length;++r){const a=t[r].right;let i=!1;for(let t=0;t<a.length;t++){if(a[t]===e){if(n.has(F))continue;i=!0;break}const r=this.firstTerminals(a[t]);if(Object(p.f)(r))n.add(a[t]);else for(const e of r)n.add(e);if(!this.hasEmptyRule(a[t])){i=!0;break}}i||n.add(F)}return n}firstTerminalsForSet(e,t){const n=new Set;for(let t=0;t<e.length;t++){const r=this.firstTerminals(e[t]);if(Object(p.f)(r))return n.add(e[t]),n;let a=!1;for(const e of r)e!==F?n.add(e):a=!0;if(!a)return n}return Object(p.f)(t)||t.forEach(e=>n.add(e)),n}generateRules(e,t){let n,r,i=e.split(/\r?\n/),s=!1;this._productions={},this._additionalFuncInfoList=[],this._ruleCreationModeMap={},this._grammarSymbols=new Map([["END_SYMBOL",B]]);let o=0,u=0;const c=O.testAll(t,l.k_ForceAppendAll),d=O.testAll(t,l.k_AllowExposeMode),h=O.testAll(t,l.k_AllowAddMode),f=O.testAll(t,l.k_AllowSkipMode);let m,E=this._ruleCreationModeMap,_=0;for(o=0;o<i.length;o++)if(""!==i[o]&&"\r"!==i[o]&&(n=i[o].trim().split(/\s* \s*/))[0][0]!=U)if(s){if((3===n.length||4===n.length&&""===n[3])&&('"'===n[2][0]||"'"===n[2][0])&&n[2].length>3){n[2][0]!==n[2][n[2].length-1]&&this.grammarError(te.GrammarUnexpectedSymbol,{unexpectedSymbol:n[2][n[2].length-1],expectedSymbol:n[2][0],grammarLine:o}),n[2]=n[2].slice(1,n[2].length-1);var y=n[2][0];m="_"===y||y>="a"&&y<="z"||y>="A"&&y<="Z"?this.lexerEngine.addKeyword(n[2],n[0]):this.lexerEngine.addPunctuator(n[2],n[0]),this._grammarSymbols.set(m,n[2])}}else if(n[0]!==W){for(Object(p.d)(this._productions[n[0]])||(this._productions[n[0]]={}),r={left:n[0],right:[],index:0},this._grammarSymbols.set(n[0],n[0]),c?E[n[0]]=a.k_Default:d&&!Object(p.d)(E[n[0]])?E[n[0]]=a.k_Default:h&&!Object(p.d)(E[n[0]])?E[n[0]]=a.k_Expose:f&&!Object(p.d)(E[n[0]])&&(E[n[0]]=a.k_Skip),u=2;u<n.length;u++)if(""!==n[u])if(n[u]!==z)if(n[u]!==M)if(n[u]!==q)if(n[u]!==V)"'"===n[u][0]||'"'===n[u][0]?(3!==n[u].length&&this.grammarError(te.GrammarInvalidKeyword,{badKeyword:n[u],grammarLine:o}),n[u][0]!==n[u][2]&&this.grammarError(te.GrammarUnexpectedSymbol,{unexpectedSymbol:n[u][2],expectedSymbol:n[u][0],grammarLine:o}),m=this.lexerEngine.addPunctuator(n[u][1]),r.right.push(m),this._grammarSymbols.set(m,n[u][1])):(r.right.push(n[u]),this._grammarSymbols.set(n[u],n[u]));else{n[u+1]&&0!==n[u+1].length||this.grammarError(te.GrammarInvalidAdditionalFuncName,{grammarLine:o});const e={name:n[u+1],position:r.right.length,rule:r};this._additionalFuncInfoList.push(e),u++}else d&&!c&&(E[n[0]]=a.k_Expose);else f&&!c&&(E[n[0]]=a.k_Skip);else h&&(E[n[0]]=a.k_Necessary);r.index=_,this._productions[n[0]][r.index]=r,_++,Object(p.a)(1!=_||Object(p.d)(this._productions[L][0]))}else s=!0}generateFunctionByStateMap(){const e=this._states,t=this._additionalFuncInfoList,n=this._adidtionalFunctByStateDMap={};for(let r=0;r<t.length;r++){const a=t[r],i=a.rule,s=a.position,o=i.right[s-1];for(let t=0;t<e.length;t++)e[t].hasRule(i,s)&&(n[e[t].index]=n[e[t].index]||{},n[e[t].index][o]=a.name)}}generateFirstState_LR0(){const e=new ie,t=this._productions[L][0],n=new Y(t,0);this.pushBaseItem(n),e.push(n),this.closure_LR0(e),this.pushState(e)}generateFirstState_LR(){const e=new ie,t=this._productions[L][0];e.push(new Y(t,0,[B])),this.closure_LR(e),this.pushState(e)}closure(e,t){t===s.k_LR0?this.closure_LR0(e):this.closure_LR(e)}closure_LR0(e){e.eachItem(t=>{const n=t.symbolName();n===P||this.isTerminal(n)||this.rules(n).forEach(t=>e.tryPush_LR0(t,0))})}closure_LR(e){let t;do{t=!1,e.eachItem(n=>{const r=n.symbolName();if(r!==P&&!this.isTerminal(r)){const a=n.rule.right.slice(n.pos+1),i=this.firstTerminalsForSet(a,n.expectedSymbols);this.rules(r).forEach(n=>{i.forEach(r=>{e.tryPush_LR(n,0,r)&&(t=!0)})})}})}while(t)}static nextState_LR0(e,t){const n=new ie;return e.eachItem(e=>{e.symbolName()===t&&n.push(new Y(e.rule,e.pos+1))}),n}static nextState_LR(e,t){const n=new ie;return e.eachItem(e=>{if(e.symbolName()===t){const t=Array.from(e.expectedSymbols);n.push(new Y(e.rule,e.pos+1,t))}}),n}deleteNotBaseItems(){this._states.forEach(e=>e.deleteNotBase())}closureForItem({rule:e,pos:t}){const n=e.index+"_"+t;let r=this._closureForItemsCache[n];return Object(p.d)(r)?r:((r=new ie).push(new Y(e,t,[w])),this.closure_LR(r),this._closureForItemsCache[n]=r,r)}addLinkExpected(e,t){let n=this._expectedExtensionDMap,r=e.index;n[r]=n[r]||{},n[r][t.index]=!0}determineExpected(e,t){const n=e.nextStates[t]||null;Object(p.f)(n)||e.eachBaseItem(e=>{const t=this.closureForItem(e);n.eachBaseItem(n=>{const r=t.hasChildItem(n);r&&r.expectedSymbols.forEach(t=>{t===w?this.addLinkExpected(e,n):n.addExpected(t)})})})}generateLinksExpected(){const e=this._states,t=this.symbols();e.forEach(e=>t.forEach(t=>this.determineExpected(e,t)))}expandExpected(){const e=this._baseItems,t=e.map(e=>!0),n=this._expectedExtensionDMap;let r;e[0].addExpected(B),t[0]=!0;do{r=!1,e.forEach(a=>{if(t[a.index]&&Object(p.e)(n[a.index])){let i=Object.keys(n[a.index]).map(e=>Number(e));a.expectedSymbols.forEach(n=>{i.forEach(a=>{e[a].addExpected(n)&&(t[a]=!0,r=!0)})})}t[a.index]=!1})}while(r)}generateStates(e){e===s.k_LR0?this.generateStates_LR0():e===s.k_LR1?this.generateStates_LR():e===s.k_LALR&&this.generateStates_LALR()}generateStates_LR0(){this.generateFirstState_LR0();const e=this._states,t=this.symbols();for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<t.length;e++){const n=t[e];let a=oe.nextState_LR0(r,n);a.isEmpty()||(a=this.tryAddState(a,s.k_LR0),this.addStateLink(r,a,n))}}}generateStates_LR(){this._firstTerminalsCache={},this.generateFirstState_LR();const e=this._states,t=this.symbols();for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<t.length;e++){let n=t[e],a=oe.nextState_LR(r,n);a.isEmpty()||(a=this.tryAddState(a,s.k_LR1),this.addStateLink(r,a,n))}}}generateStates_LALR(){this._baseItems=[],this._expectedExtensionDMap={},this._closureForItemsCache={},this._firstTerminalsCache={},this.generateStates_LR0(),this.deleteNotBaseItems(),this.generateLinksExpected(),this.expandExpected(),this._states.forEach(e=>this.closure_LR(e))}addReducing(e,t,n){t.eachItem(r=>{if(r.symbolName()===P)if(r.rule.left===L)this.pushInSyntaxTable(e,t.index,B,{type:c.k_Success});else for(const a of r.expectedSymbols)this.pushInSyntaxTable(e,t.index,a,n[r.rule.index])})}addShift(e,t,n){const r=t.nextStates,a=Object.keys(r);for(let i=0;i<a.length;i++){const s=r[a[i]];this.pushInSyntaxTable(e,t.index,a[i],n[s.index])}}buildSyntaxTable(e){this._states=[],this._syntaxTable={};const t=this._states,n=this._syntaxTable;this.generateStates(e);const r={},a={};t.forEach(e=>{a[e.index]={type:c.k_Shift,stateIndex:e.index}}),this.nonTerminals().forEach(e=>{this.rules(e).forEach(e=>{r[e.index]={type:c.k_Reduce,rule:e}})}),t.forEach(e=>{this.addReducing(n,e,r),this.addShift(n,e,a)})}statesToString(e=!0){if(!this._states)return"";let t="";for(let n=0;n<this._states.length;n++)t+=this._states[n].toString(e,this._grammarSymbols),t+=" ";return t}static operationToString(e){let t="";switch(e.type){case c.k_Shift:t="SHIFT to state "+e.stateIndex.toString();break;case c.k_Reduce:t="REDUCE by rule { "+oe.ruleToString(e.rule)+" }";break;case c.k_Success:t="SUCCESS"}return t}static ruleToString(e){let t;return t=e.left+" : "+e.right.join(" ")}convertGrammarSymbol(e){return this.isTerminal(e)?this.lexerEngine.getTerminalValueByName(e):e}}oe.$parserEngine=null,oe.$parserParams=null;var le="S : Program\r\nProgram : --add\r\nProgram : Decls\r\n\r\nDecls : Decl --expose\r\nDecls : Decls Decl\r\n\r\nDecl : ';'\r\nDecl : TypeDecl\r\nDecl : VariableDecl\r\nDecl : VarStructDecl\r\nDecl : FunctionDecl\r\nDecl : TechniqueDecl\r\n#if FX_PART\r\n    Decl : PartFxDecl\r\n#endif \r\nDecl : UseDecl\r\nDecl : ImportDecl\r\nDecl : ProvideDecl\r\nDecl : IncludeDecl\r\nDecl : ERROR\r\n\r\nIncludeDecl : '#' T_KW_INCLUDE String --skip --F includeCode\r\n\r\nImportDecl : T_KW_IMPORT String ';'\r\n\r\nProvideDecl : T_KW_PROVIDE ComplexNameOpt ';'\r\nProvideDecl : T_KW_PROVIDE ComplexNameOpt T_KW_AS ComplexNameOpt ';'\r\n\r\nUseDecl : T_KW_USE Mode\r\nMode : T_KW_STRICT\r\n\r\nUsages : Usage --expose\r\nUsages : Usages Usage\r\nUsage : T_KW_STATIC --add\r\nUsage : T_KW_UNIFORM\r\nUsage : T_KW_EXTERN\r\nUsage : T_KW_VOLATILE\r\nUsage : T_KW_INLINE\r\nUsage : ConstUsage\r\n\r\nConstUsages : ConstUsage --expose\r\nConstUsages : ConstUsages ConstUsage\r\nConstUsage : T_KW_CONST\r\nConstUsage : T_KW_ROW_MAJOR\r\nConstUsage : T_KW_COLUMN_MAJOR\r\n\r\nUsageType : Type --add\r\nUsageType : Usages Type\r\n\r\nUsageStructDecl : StructDecl --add\r\nUsageStructDecl : Usages StructDecl\r\n\r\nTypeDecl : T_KW_TYPEDEF ConstType TypeDefs ';' --add\r\nTypeDecl : T_KW_TYPEDEF ConstStructDecl TypeDefs ';'\r\nTypeDecl : StructDecl --F addType ';'\r\nTypeDefs : VariableDim\r\nTypeDefs : VariableDim ',' TypeDefs\r\n\r\n# GenericParams : '<' Arguments '>'\r\n# GenericParamsOpt: --expose\r\n# GenericParamsOpt: GenericParams\r\n\r\nType : BaseType --add\r\nType : Struct\r\nType : TypeId\r\nType : T_KW_STRUCT TypeId\r\n\r\nConstType : Type --add\r\nConstType : ConstUsages Type\r\nConstTypeDim : ConstType --expose\r\nConstTypeDim : ConstTypeDim '[' ConstantExpr ']'\r\n\r\nBaseType : T_KW_VOID --add\r\nBaseType : ScalarType\r\nBaseType : VectorType\r\nBaseType : MatrixType\r\nBaseType : ObjectType\r\n\r\nScalarType : T_KW_BOOL --add\r\nScalarType : T_KW_INT\r\nScalarType : T_KW_UINT\r\nScalarType : T_KW_HALF\r\nScalarType : T_KW_FLOAT\r\nScalarType : T_KW_DOUBLE\r\n\r\nVectorType : T_KW_VECTOR --add\r\nVectorType : T_KW_VECTOR '<' ScalarType ',' AddExpr '>'\r\n\r\nMatrixType : T_KW_MATRIX --add\r\nMatrixType : T_KW_MATRIX '<' ScalarType ',' ConstantExpr ',' AddExpr '>'\r\n\r\nObjectType : T_KW_STRING --add\r\nObjectType : T_KW_TEXTURE\r\nObjectType : T_KW_TEXTURE1D\r\nObjectType : T_KW_TEXTURE2D\r\nObjectType : T_KW_TEXTURE3D\r\nObjectType : T_KW_TEXTURECUBE\r\nObjectType : T_KW_SAMPLER\r\nObjectType : T_KW_SAMPLER1D\r\nObjectType : T_KW_SAMPLER2D\r\nObjectType : T_KW_SAMPLER3D\r\nObjectType : T_KW_SAMPLERCUBE\r\nObjectType : T_KW_PIXELSHADER\r\nObjectType : T_KW_VERTEXSHADER\r\nObjectType : T_KW_PIXELFRAGMENT\r\nObjectType : T_KW_VERTEXFRAGMENT\r\nObjectType : T_KW_STATEBLOCK\r\nObjectType : T_KW_RWBUFFER '<' Type '>'\r\nObjectType : T_KW_RWSTRUCTUREDBUFFER '<' Type '>'\r\nObjectType : T_KW_APPENDSTRUCTUREDBUFFER '<' Type '>'\r\n\r\n\r\n# struct Name\r\n# {\r\n#     [InterpolationModifier] Type[RxC] MemberName;\r\n#     ...\r\n# };\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509668(v=vs.85).aspx\r\n\r\nStruct : T_KW_STRUCT '{' '}' --add\r\nStruct : T_KW_STRUCT '{' StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id '{' '}' --add\r\nStructDecl : T_KW_STRUCT Id '{' UseDecl StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id '{' StructDecls '}'\r\n\r\nConstStructDecl : StructDecl\r\nConstStructDecl : ConstUsages StructDecl\r\n\r\nStructDecls : VariableDecl --expose\r\nStructDecls : VariableDecl StructDecls\r\n\r\nSemantic : ':' Id --add\r\nSemantic : ':' T_KW_REGISTER '(' Register ')'\r\nSemantics : Semantic\r\nSemantics : Semantics Semantic\r\nSemanticsOpt :\r\nSemanticsOpt : Semantics\r\n\r\nRegister : Id\r\nRegister : Target ',' Id\r\n\r\nAnnotation : AnnotationBegin AnnotationEnd  --add\r\nAnnotation : AnnotationBegin AnnotationDecls AnnotationEnd\r\nAnnotationOpt :\r\nAnnotationOpt : Annotation\r\nAnnotationBegin : '<'\r\nAnnotationDecls : VariableDecl\r\nAnnotationDecls : VariableDecl AnnotationDecls\r\nAnnotationEnd : '>'\r\n\r\nInitializer : '=' AssignmentExpr --add\r\nInitializer : '=' ERROR --add\r\nInitializer : '=' '{' InitExprs '}'\r\nInitializer : '=' '{' InitExprs ',' '}'\r\n\r\n# InitializerOpt :\r\n# InitializerOpt : Initializer\r\n\r\n\r\n# [Storage_Class] [Type_Modifier] Type Name[Index]\r\n#    [: Semantic]\r\n#    [: Packoffset]\r\n#    [: Register];\r\n#    [Annotations]\r\n#    [= Initial_Value]\r\n#\r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509706(v=vs.85).aspx\r\n\r\nVariableDecl : UsageType Variables ';' --add\r\nVariableDecl : UsageType Variables ERROR --add\r\nVarStructDecl : UsageStructDecl Variables ';' --add\r\nVariables : Variable --expose\r\nVariables : Variables ',' Variable\r\n# Variables : Variables ERROR Variable\r\nVariables : Variables ',' ERROR\r\nVariable : VariableDim SemanticsOpt AnnotationOpt Initializer --add\r\nVariable : VariableDim SemanticsOpt AnnotationOpt --add\r\nVariableDim : NonTypeId --add\r\nVariableDim : VariableDim '[' ConstantExpr ']'\r\n\r\n\r\n# [StorageClass] [clipplanes()] [precise] Return_Value Name ( [ArgumentList] ) [: Semantic]\r\n# {\r\n#   [StatementBlock]\r\n# };\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509607(v=vs.85).aspx\r\n\r\nFunctionDecl : Attributes FunctionDef ';' --add\r\nFunctionDecl : FunctionDef ';' --add\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt StmtBlock\r\nFunctionDecl : FunctionDef AnnotationOpt StmtBlock\r\n\r\n# TODO: remove it;\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt ERROR\r\nFunctionDecl : FunctionDef AnnotationOpt ERROR\r\n\r\nFunctionDef : UsageType NonTypeId ParamList SemanticsOpt\r\n\r\nAttribute : '[' Id '(' ArgumentsOpt ')' ']'\r\nAttribute : '[' Id ']'\r\nAttributes : Attribute --expose\r\nAttributes : Attributes Attribute\r\nAttributesOpt : --expose\r\nAttributesOpt : Attributes\r\n\r\nParamList : '(' ')'\r\nParamList : '(' T_KW_VOID ')'\r\nParamList : '(' ParameterDecls ')'\r\n\r\n\r\n# [InputModifier] Type Name [: Semantic] [InterpolationModifier] [= Initializers]\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509606(v=vs.85).aspx\r\n\r\nParameterDecls : ParameterDecl --expose\r\nParameterDecls : ParameterDecls ',' ParameterDecl\r\nParameterDecls : ParameterDecls ERROR ParameterDecl\r\nParameterDecls : ParameterDecls ',' ERROR\r\nParameterDecls : ERROR\r\nParameterDecl : ParamUsageType Variable\r\n\r\nParamUsageType : Type --add\r\nParamUsageType : ParamUsages Type\r\n\r\nParamUsages : ParamUsage --expose\r\nParamUsages : ParamUsages ParamUsage\r\nParamUsage : T_KW_IN --add\r\nParamUsage : T_KW_OUT\r\nParamUsage : T_KW_INOUT\r\nParamUsage : T_KW_UNIFORM\r\nParamUsage : ConstUsage\r\n\r\n\r\nTechniqueDecl : T_KW_TECHNIQUE ComplexNameOpt SemanticsOpt AnnotationOpt TechniqueBody --add\r\nTechniqueBody : '{' '}'  --add\r\nTechniqueBody : '{' PassDecls '}'\r\n\r\nComplexNameOpt : ComplexName --add\r\nComplexName : Id --expose\r\nComplexName : ComplexName '.' Id\r\n\r\nPassDecls : PassDecl --expose\r\nPassDecls : PassDecls PassDecl\r\nPassDecl : T_KW_PASS IdOpt AnnotationOpt PassStateBlock --add\r\nPassDecl : ';'\r\n\r\nPassStateBlock : '{' '}' --add\r\nPassStateBlock : '{' PassStates '}'\r\nPassStates : PassState --expose\r\nPassStates : PassStates PassState\r\n\r\nPassState : Id StateIndex '=' PassStateExpr ';' --add\r\n\r\n# todo: move all particles declarations to separate grammar!\r\n#if FX_PART\r\n\r\nPartFxDecl : T_KW_FXPART ComplexNameOpt SemanticsOpt AnnotationOpt PartFxBody --add\r\n\r\nPartFxBody : '{' '}' \r\nPartFxBody : '{' PartFxProperties '}'\r\n\r\nPartFxProperties : PartFxProperty --expose\r\nPartFxProperties : PartFxProperties PartFxProperty\r\n\r\nPartFxProperty : PassState\r\nPartFxProperty : PassDecl\r\n\r\n#endif // FX_PART\r\n\r\nStateBlock : '{' '}' --add\r\nStateBlock : '{' States '}'\r\n\r\n\r\nStates : State --expose\r\nStates : States State\r\nState : Id StateIndex '=' StateExpr ';' --add\r\n\r\nStateIndex :\r\nStateIndex : '[' Uint ']'\r\n\r\nStmtBlock : '{' '}' --add\r\nStmtBlock : '{' Stmts '}'  \r\n\r\nStmts : Stmt --expose\r\nStmts : Stmts Stmt\r\n\r\n# SimpleStmt : ERROR ';' \r\n# SimpleStmt : ';' --add\r\n\r\nSimpleStmt : Expr ';'\r\nSimpleStmt : Expr ERROR\r\nSimpleStmt : T_KW_RETURN ';'\r\nSimpleStmt : T_KW_RETURN Expr ';'\r\nSimpleStmt : T_KW_RETURN ERROR ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' Expr ')' ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' ERROR ')' ';'\r\nSimpleStmt : StmtBlock\r\nSimpleStmt : T_KW_DISCARD ';'\r\nSimpleStmt : TypeDecl\r\nSimpleStmt : VariableDecl --add\r\nSimpleStmt : VarStructDecl\r\nSimpleStmt : T_KW_BREAK ';'\r\nSimpleStmt : T_KW_BREAK ERROR\r\nSimpleStmt : T_KW_CONTINUE ';'\r\nSimpleStmt : T_KW_CONTINUE ERROR\r\n\r\n#if FX_PART\r\nSimpleStmt : T_KW_SPAWN '(' Uint ')' NonTypeId '(' ArgumentsOpt ')' ';'\r\n#endif\r\n\r\n\r\nNonIfStmt : SimpleStmt --add\r\nNonIfStmt : WhileStmt NonIfStmt\r\nNonIfStmt : ForStmt NonIfStmt\r\n\r\nStmt : SimpleStmt --add\r\nStmt : UseDecl\r\nStmt : WhileStmt Stmt\r\nStmt : ForStmt Stmt\r\nStmt : IfStmt Stmt\r\nStmt : IfStmt NonIfStmt T_KW_ELSE Stmt\r\nStmt : ERROR\r\nStmt : ';'\r\n\r\nIfStmt : AttributesOpt T_KW_IF '(' Expr ')' --expose\r\nIfStmt : AttributesOpt T_KW_IF '(' ERROR ')' --expose\r\n\r\nWhileStmt : T_KW_WHILE '(' Expr ')' --expose\r\nWhileStmt : T_KW_WHILE '(' ERROR ')' --expose\r\n\r\nForStmt : For '(' ForInit ForCond ForStep ')' --expose\r\nForStmt : For ERROR --expose\r\n\r\nFor : T_KW_FOR\r\n\r\nForInit : ';' --add\r\nForInit : Expr ';'\r\nForInit : VariableDecl\r\nForInit : ERROR ';'\r\n\r\nForCond : ';' --add\r\nForCond : Expr ';'\r\nForCond : ERROR ';'\r\n\r\nForStep : --add\r\nForStep : Expr\r\nForStep : ERROR\r\n\r\nDwordExpr : Dword\r\nDwordExpr : Dword '|' DwordExpr\r\n\r\nDwordExprSeq : DwordExpr --expose\r\nDwordExprSeq : DwordExpr ',' DwordExprSeq\r\n\r\nPassStateExpr : DwordExpr --add\r\nPassStateExpr : ComplexExpr\r\nPassStateExpr : '{' DwordExprSeq '}'\r\n\r\nStateExpr : DwordExpr --add\r\nStateExpr : ComplexExpr\r\nStateExpr : '{' InitExprs '}'\r\nStateExpr : '{' InitExprs ',' '}'\r\nStateExpr : '<' RelationalExpr '>'\r\n\r\nSimpleExpr : T_KW_TRUE\r\nSimpleExpr : T_KW_FALSE\r\nSimpleExpr : Uint\r\nSimpleExpr : Float\r\nSimpleExpr : String\r\nSimpleExpr : NonTypeId\r\n\r\nComplexExpr : '(' Expr ')'\r\nComplexExpr : TypeId '(' ArgumentsOpt ')'\r\nComplexExpr : BaseType '(' ArgumentsOpt ')'\r\nComplexExpr : NonTypeId '(' ArgumentsOpt ')'\r\nComplexExpr : PostfixPointExpr '(' ArgumentsOpt ')'\r\nComplexExpr : ObjectExpr\r\n\r\nObjectExpr : T_KW_COMPILE NonTypeId '(' ArgumentsOpt ')'\r\nObjectExpr : T_KW_SAMPLER_STATE StateBlock\r\nObjectExpr : T_KW_COMPILE_FRAGMENT Target NonTypeId '(' ArgumentsOpt ')'\r\nObjectExpr : T_KW_STATEBLOCK_STATE StateBlock\r\n\r\nPrimaryExpr : ComplexExpr\r\nPrimaryExpr : SimpleExpr\r\nPostfixExpr : PrimaryExpr\r\nPostfixExpr : PostfixExpr '[' Expr ']'\r\nPostfixExpr : PostfixExpr '[' ERROR ']'\r\nPostfixExpr : PostfixExpr '.' Id\r\nPostfixExpr : PostfixExpr T_OP_INC\r\nPostfixExpr : PostfixExpr T_OP_DEC\r\n\r\nPostfixPointExpr : PostfixExpr '.' Id\r\n\r\nUnaryExpr : PostfixExpr\r\nUnaryExpr : T_OP_INC UnaryExpr\r\nUnaryExpr : T_OP_DEC UnaryExpr\r\n# UnaryExpr : T_OP_INC ERROR\r\n# UnaryExpr : T_OP_DEC ERROR\r\nUnaryExpr : '!' CastExpr\r\n# UnaryExpr : '!' ERROR\r\nUnaryExpr : '-' CastExpr\r\nUnaryExpr : '+' CastExpr\r\n\r\nCastExpr : UnaryExpr\r\nCastExpr : '(' ConstTypeDim ')' CastExpr\r\nCastExpr : '(' ERROR ')' CastExpr\r\n\r\nMulExpr : CastExpr\r\nMulExpr : MulExpr '*' CastExpr\r\nMulExpr : MulExpr '/' CastExpr\r\nMulExpr : MulExpr '%' CastExpr\r\n\r\nMulExpr : ERROR '*' CastExpr\r\nMulExpr : ERROR '/' CastExpr\r\nMulExpr : ERROR '%' CastExpr\r\nMulExpr : MulExpr '*' ERROR\r\nMulExpr : MulExpr '/' ERROR\r\nMulExpr : MulExpr '%' ERROR\r\n# MulExpr : ERROR '*' ERROR\r\n# MulExpr : ERROR '/' ERROR\r\n# MulExpr : ERROR '%' ERROR\r\n\r\nAddExpr : MulExpr\r\nAddExpr : AddExpr '+' MulExpr\r\nAddExpr : AddExpr '-' MulExpr\r\n\r\nAddExpr : AddExpr '+' ERROR\r\nAddExpr : AddExpr '-' ERROR\r\n\r\nRelationalExpr : AddExpr\r\nRelationalExpr : RelationalExpr '<' AddExpr\r\nRelationalExpr : RelationalExpr '>' AddExpr\r\nRelationalExpr : RelationalExpr T_OP_LE AddExpr\r\nRelationalExpr : RelationalExpr T_OP_GE AddExpr\r\n\r\nRelationalExpr : ERROR '<' AddExpr\r\nRelationalExpr : RelationalExpr '<' ERROR\r\nRelationalExpr : ERROR '<' ERROR\r\n\r\nRelationalExpr : RelationalExpr '>' ERROR\r\nRelationalExpr : ERROR '>' AddExpr\r\nRelationalExpr : ERROR '>' ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_LE ERROR\r\nRelationalExpr : ERROR T_OP_LE AddExpr\r\nRelationalExpr : ERROR T_OP_LE ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_GE ERROR\r\nRelationalExpr : ERROR T_OP_GE AddExpr\r\nRelationalExpr : ERROR T_OP_GE ERROR\r\n\r\nEqualityExpr : RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE RelationalExpr\r\nEqualityExpr : ERROR T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE ERROR\r\nEqualityExpr : ERROR T_OP_NE ERROR\r\n\r\nAndExpr : EqualityExpr\r\nAndExpr : AndExpr T_OP_AND EqualityExpr\r\nAndExpr : ERROR T_OP_AND EqualityExpr\r\nAndExpr : AndExpr T_OP_AND ERROR\r\n\r\nOrExpr : AndExpr\r\nOrExpr : OrExpr T_OP_OR AndExpr\r\nOrExpr : OrExpr T_OP_OR ERROR\r\nOrExpr : ERROR T_OP_OR AndExpr\r\n\r\nConditionalExpr : OrExpr\r\nConditionalExpr : OrExpr '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : ERROR '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : OrExpr '?' ERROR ':' ConditionalExpr\r\nConditionalExpr : OrExpr '?' AssignmentExpr ':' ERROR\r\nConditionalExpr : OrExpr '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ConditionalExpr\r\n\r\nAssignmentExpr : ConditionalExpr\r\nAssignmentExpr : CastExpr '=' AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_ME AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_DE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_RE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_AE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_SE AssignmentExpr\r\n\r\nArguments : AssignmentExpr --expose\r\nArguments : Arguments ',' AssignmentExpr\r\nArguments : Arguments ERROR AssignmentExpr\r\nArguments : Arguments ',' ERROR\r\nArgumentsOpt : --expose\r\nArgumentsOpt : Arguments\r\n\r\nInitExpr : AssignmentExpr --add\r\nInitExpr : '{' InitExprs '}'\r\nInitExpr : '{' InitExprs ',' '}'\r\nInitExprs : InitExpr --expose\r\nInitExprs : InitExprs ',' InitExpr\r\n\r\nConstantExpr : AssignmentExpr\r\nExpr : AssignmentExpr\r\nExpr : Expr ',' AssignmentExpr\r\nExpr : Expr ',' ERROR\r\nExpr : ERROR ',' ERROR\r\nExpr : ERROR ',' AssignmentExpr\r\n\r\nDword : Uint\r\nDword : '-' Uint\r\nDword : Float\r\nDword : '-' Float\r\nDword : DwordId\r\nDword : Uint DwordId\r\nDwordId : Id\r\nDwordId : T_KW_TRUE\r\nDwordId : T_KW_FALSE\r\nDwordId : T_KW_TEXTURE\r\n\r\nId : TypeId\r\nId : NonTypeId\r\nIdOpt :\r\nIdOpt : Id\r\n\r\nTarget : NonTypeId\r\n\r\nUint : T_UINT\r\nFloat : T_FLOAT\r\n\r\nStrings : String\r\nStrings : Strings String\r\nString : T_STRING\r\n\r\nTypeId : T_TYPE_ID\r\nNonTypeId : T_NON_TYPE_ID\r\nLineTerminator : T_LINE_TERMINATOR\r\n\r\nAsmDecl : T_KW_DECL '{'\r\nAsm : T_KW_ASM '{'\r\nAsmFragment : T_KW_ASM_FRAGMENT '{'\r\n\r\n--LEXER--\r\n\r\nT_KW_STATIC : \"static\"\r\nT_KW_UNIFORM : \"uniform\"\r\nT_KW_EXTERN : \"extern\"\r\nT_KW_VOLATILE : \"volatile\"\r\nT_KW_INLINE : \"inline\"\r\nT_KW_CONST : \"const\"\r\nT_KW_ROW_MAJOR : \"row_major\"\r\nT_KW_COLUMN_MAJOR : \"column_major\"\r\nT_KW_TYPEDEF : \"typedef\"\r\nT_KW_STRUCT : \"struct\"\r\nT_KW_VOID : \"void\"\r\nT_KW_BOOL : \"bool\"\r\nT_KW_INT : \"int\"\r\nT_KW_UINT : \"uint\"\r\nT_KW_HALF : \"half\"\r\nT_KW_FLOAT : \"float\"\r\nT_KW_DOUBLE : \"double\"\r\nT_KW_VECTOR : \"vector\"\r\nT_KW_MATRIX : \"matrix\"\r\nT_KW_STRING : \"string\"\r\nT_KW_TEXTURE : \"texture\"\r\nT_KW_TEXTURE1D : \"texture1D\"\r\nT_KW_TEXTURE2D : \"texture2D\"\r\nT_KW_TEXTURE3D : \"texture3D\"\r\nT_KW_TEXTURECUBE : \"texturecube\"\r\nT_KW_SAMPLER : \"sampler\"\r\nT_KW_SAMPLER1D : \"sampler1D\"\r\nT_KW_SAMPLER2D : \"sampler2D\"\r\nT_KW_SAMPLER3D : \"sampler3D\"\r\nT_KW_SAMPLERCUBE : \"samplerCUBE\"\r\nT_KW_RWBUFFER : \"RWBuffer\"\r\nT_KW_RWSTRUCTUREDBUFFER : \"RWStructuredBuffer\"\r\nT_KW_APPENDSTRUCTUREDBUFFER : \"AppendStructuredBuffer\"\r\nT_KW_PIXELSHADER : \"pixelshader\"\r\nT_KW_VERTEXSHADER : \"vertexshader\"\r\nT_KW_PIXELFRAGMENT : \"pixelfragment\"\r\nT_KW_VERTEXFRAGMENT : \"vertexfragment\"\r\nT_KW_STATEBLOCK : \"stateblock\"\r\nT_KW_REGISTER : \"register\"\r\nT_KW_IN : \"in\"\r\nT_KW_OUT : \"out\"\r\nT_KW_INOUT : \"inout\"\r\nT_KW_TECHNIQUE : \"technique\"\r\n#if FX_PART\r\n    T_KW_FXPART : \"partFx\"\r\n#endif\r\nT_KW_PASS : \"pass\"\r\nT_KW_RETURN : \"return\"\r\nT_KW_DO : \"do\"\r\nT_KW_DISCARD : \"discard\"\r\nT_KW_WHILE : \"while\"\r\nT_KW_IF : \"if\"\r\nT_KW_ELSE : \"else\"\r\nT_KW_FOR : \"for\"\r\nT_KW_TRUE : \"true\"\r\nT_KW_FALSE : \"false\"\r\nT_KW_COMPILE : \"compile\"\r\nT_KW_SAMPLER_STATE : \"sampler_state\"\r\nT_KW_COMPILE_FRAGMENT : \"compile_fragment\"\r\nT_KW_STATEBLOCK_STATE : \"stateblock_state\"\r\nT_KW_DECL : \"decl\"\r\nT_KW_ASM : \"asm\"\r\nT_KW_ASM_FRAGMENT : \"asm_fragment\"\r\nT_KW_USE : \"use\"\r\nT_KW_STRICT : \"strict\"\r\nT_KW_IMPORT : \"import\"\r\nT_KW_PROVIDE : \"provide\"\r\nT_KW_SWITCH : \"switch\"\r\nT_KW_CASE : \"case\"\r\nT_KW_DEFAULT : \"default\"\r\nT_KW_BREAK : \"break\"\r\n#if FX_PART\r\nT_KW_SPAWN : \"spawn\"\r\n#endif\r\nT_KW_CONTINUE : \"continue\"\r\nT_KW_AS : \"as\"\r\nT_KW_INCLUDE : \"include\"\r\nT_OP_INC : \"++\"\r\nT_OP_DEC : \"--\"\r\nT_OP_LE : \">=\"\r\nT_OP_GE : \"<=\"\r\nT_OP_EQ : \"==\"\r\nT_OP_NE : \"!=\"\r\nT_OP_AND : \"&&\"\r\nT_OP_OR : \"||\"\r\nT_OP_ME : \"*=\"\r\nT_OP_DE : \"/=\"\r\nT_OP_RE : \"%=\"\r\nT_OP_AE : \"+=\"\r\nT_OP_SE : \"-=\"";class ue extends oe{init({grammar:e=le,type:t=s.k_LALR,flags:n=l.k_Default}){super.init({grammar:e,type:t,flags:n})}}let ce=null,pe=null;function de(e={grammar:le}){Object(p.b)(ce,e)||(ce=e,pe=new ue(e))}var he,fe=n("zX2+"),me=n("zioJ"),Ee=n("a1Km"),_e=n("FrU9");!function(e){e[e.k_Billboard=0]="k_Billboard",e[e.k_Cylinder=1]="k_Cylinder",e[e.k_Box=2]="k_Box",e[e.k_Sphere=3]="k_Sphere",e[e.k_Line=4]="k_Line"}(he||(he={}));var ye=n("NzFo"),ge=n("C2sc"),Te=n("+Z36");class xe extends Te.a{constructor({spawnRoutine:e,initRoutine:t,updateRoutine:n,particle:r,capacity:a=-1,...i}){super({instrType:_e.b.k_PartFxDecl,techniqueType:_e.d.k_PartFx,...i}),this._spawnRoutine=e,this._initRoutine=t,this._updateRoutine=n,this._particle=r,this._capacity=a}get spawnRoutine(){return this._spawnRoutine}get initRoutine(){return this._initRoutine}get updateRoutine(){return this._updateRoutine}get particle(){return this._particle}get capacity(){return this._capacity}isValid(){const e=!!this.spawnRoutine&&!!this.initRoutine&&!!this.updateRoutine,t=!!this.particle,n=this.passList&&this.passList.filter(e=>e.isValid()).length>0;return e&&t&&n}}var be=n("jfm7");class Se extends be.a{constructor({sorting:e=!1,instanceCount:t=1,prerenderRoutine:n,geometry:r,...a}){super({instrType:_e.b.k_PartFxPass,...a}),this.sorting=e,this.prerenderRoutine=n,this.geometry=r,this.instanceCount=t}get particleInstance(){return Object(p.f)(this.prerenderRoutine)?null:this.prerenderRoutine.function.def.params[1].type.subType}isValid(){return!!this.particleInstance&&!!this.prerenderRoutine}}var Re=n("oseZ");class ke extends Re.a{constructor({count:e,name:t,args:n,...r}){super({instrType:_e.b.k_SpawnStmt,...r}),this._fx=null,this._init=null,this.count=e,this.args=n,this.name=t}get fx(){return this._fx}get init(){return this._init}toCode(){return`spawn(${this.count}) ${this.name}(${this.args.map(e=>e.toCode()).join(", ")});`}$resolve(e,t){this._fx=e,this._init=t}}var Ne=n("Wl5j");const Ae=e=>e?e.type:null;class Ce extends ye.b{constructor(){super(...arguments),this.spawnStmts=[]}beginPartFxPass(){this.beginPass(),this.particleInstance=null}endPartFxPass(){this.particleInstance=null,this.endPass()}beginPartFx(){this.particleCore=null}endPartFx(){this.particleCore=null}}class Ie extends ye.a{analyzeSpawnStmt(e,t,n){const r=n.children,a=t.currentScope,i=Number(r.slice(-3,-2)[0].value),s=r.slice(-5,-4)[0].value,o=[];for(let n=r.length-7;n>=2;n--)if(","!==r[n].value){const a=this.analyzeExpr(e,t,r[n]);o.push(a)}const l=new ke({sourceNode:n,scope:a,name:s,args:o,count:i});return e.spawnStmts.push(l),l}analyzeSimpleStmt(e,t,n){const r=n.children;switch(r[r.length-1].name){case"T_KW_SPAWN":return this.analyzeSpawnStmt(e,t,n);default:return super.analyzeSimpleStmt(e,t,n)}}analyzePartFXProperty(e,t,n){n.children;console.log(n)}analyzePartFXPassDecl(e,t,n){e.beginPartFxPass();const r=n.children,a=t.currentScope,i=this.analyzePassStateBlockForShaders(e,t,r[0]),s=this.analyzePassStateBlock(e,t,r[0]);e.renderStates=s;const o=this.analyzePartFxStateBlock(e,t,r[0]),l=!Object(p.c)(o.sorting)||o.sorting,u=o.prerenderRoutine||null,c=o.geometry||he.k_Billboard,d=o.instanceCount||1;let h=i.pixel,f=i.vertex;if(f){const t=["POSITION","POSITION0"];let r=!1,a=!1;for(const n of f.def.params)r=r||n.type.subType===e.particleInstance,a=a||!!t.find(e=>n.type.hasFieldWithSematics(e));r||(e.error(n,me.a.PartFx_VertexShaderParametersMismatch,{tooltip:"vertex shader must have a valid material param which is compatible with prerender routine."}),f=h=null)}let m=null;for(let e=0;e<r.length;++e)if("T_NON_TYPE_ID"===r[e].name){let t=r[e].value;m=new ge.a({sourceNode:r[e],scope:a,name:t})}const E=new Se({scope:a,sourceNode:n,id:m,sorting:l,geometry:c,instanceCount:d,prerenderRoutine:u,renderStates:s,pixelShader:h,vertexShader:f});return e.endPartFxPass(),E}analyzePartFxStateBlock(e,t,n){const r=n.children;let a={};for(let n=r.length-2;n>=1;n--)a={...a,...this.analyzePartFXPassProperies(e,t,r[n])};return a}analyzePartFXPassProperies(e,t,n){const r=n.children,a=r[r.length-1].value.toUpperCase(),i=r[r.length-3],s=i.children[i.children.length-1];let o={};if(Object(p.f)(s.value)||Object(p.f)(a))return console.warn("Pass state is incorrect."),o;if("{"===s.value&&i.children.length>3){const e=new Array(Math.ceil((i.children.length-2)/2));for(let t=i.children.length-2,n=0;t>=1;t-=2,n++)e[n]=i.children[t].value.toUpperCase();return console.warn("Pass fx state is incorrect."),o}{let n=null;switch(n="{"===s.value?i.children[1].value.toUpperCase():s.value.toUpperCase(),a){case"InstanceCount".toUpperCase():o.instanceCount=Number(n)||1;break;case"Geometry".toUpperCase():const r=["Billboard","Cylinder","Box","Sphere","Line"].map(e=>e.toUpperCase());o.geometry=Math.max(0,r.indexOf(n));break;case"Sorting".toUpperCase():Object(p.a)("TRUE"==n||"FALSE"==n),o.sorting="TRUE"===n;break;case"PrerenderRoutine".toUpperCase():{let n=[{ret:Ne.i,args:[e.particleCore,null]},{ret:Ne.i,args:[e.particleCore,null,Ne.e]}],r=this.analyzeCompileExpr(e,t,s,n);if(!r)break;let a=r.function,i=a.def.params.map(e=>e.type);i.length<2&&(e.error(s,me.a.InvalidCompileFunctionNotValid,{funcName:a.name,tooltip:"'PrerenderRoutine' arguments' count mismatch."}),r=null),i[0].readable&&i[0].subType===e.particleCore&&!i[0].isNotBaseArray()&&i[1].hasUsage("out")&&i[1].writable&&!i[1].isNotBaseArray()||(e.error(s,me.a.InvalidCompileFunctionNotValid,{funcName:a.name,tooltip:"'PrerenderRoutine' arguments' type mismatch."}),r=null),e.particleInstance=i[1].subType,o.prerenderRoutine=r}}}return o}analyzePartFXBody(e,t,n){let r=[],a=null,i=null,s=null,o=null,l=null;const u=n.children;for(let n=u.length-2;n>0;n--)switch(u[n].name){case"PassState":{let r=u[n];switch(r.children[3].value.toUpperCase()){case"Capacity".toUpperCase():{const e=r.children[1].children[0].value;Object(p.a)(Object(p.g)(Number(e))),l=Number(e)||-1;break}case"SpawnRoutine".toUpperCase():{let n={ret:Ne.e,args:[]},i=r.children[1].children[0];a=this.analyzeCompileExpr(e,t,i,[n])}break;case"InitRoutine".toUpperCase():{let n=[{ret:Ne.i,args:[null,Ne.e]},{ret:Ne.i,args:[null,Ne.h]},{ret:Ne.i,args:[null]}],a=r.children[1].children[0];if(!(i=this.analyzeCompileExpr(e,t,a,n)))break;let l=i.function,u=l.def.params[0].type;(!u.hasUsage("out")&&!u.hasUsage("inout")||u.isNotBaseArray())&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),i=null),o&&u.subType!==o&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),s=null),o=u.subType}break;case"UpdateRoutine".toUpperCase():{let n=[{ret:Ne.b,args:[null,Ne.e]},{ret:Ne.b,args:[null]}],a=r.children[1].children[0];if(!(s=this.analyzeCompileExpr(e,t,a,n)))break;const i=s.function,l=i.def,u=l.params;(u.length<1||u.length>2)&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null);let c=u[0].type;if((!c.hasUsage("out")&&!c.hasUsage("inout")||c.isNotBaseArray())&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null),o&&c.subType!==o&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null),l.returnType.isEqual(Ne.b)||(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' return type mismatch. 'boolean' is expected."}),s=null),!s)break;o=c.subType}}}}e.particleCore=o;for(let n=u.length-2;n>0;n--)switch(u[n].name){case"PassDecl":{let a=this.analyzePartFXPassDecl(e,t,u[n]);a.isValid()||e.warn(a.id&&a.id.sourceNode||u[n],Ee.a.IncompletePass,{techniqueName:a.name,tooltip:"The pass is not completed. Not all required parameters are specified."}),Object(p.a)(!Object(p.f)(a)),r.push(a)}}return{passList:r,spawnRoutine:a,initRoutine:i,updateRoutine:s,particle:o,capacity:l}}analyzePartFXDecl(e,t,n){const r=n.children,a=this.analyzeComplexName(r[r.length-2]),i=(r[r.length-2].children.length,t.currentScope);let s=null,o=null,l=null;e.beginPartFx();for(let n=r.length-3;n>=0;n--)switch(r[n].name){case"Annotation":s=this.analyzeAnnotation(r[n]);break;case"Semantic":o=this.analyzeSemantic(r[n]);break;case"PartFxBody":l=this.analyzePartFXBody(e,t,r[n])}e.endPartFx();const u=new xe({sourceNode:n,name:a,semantic:o,annotation:s,scope:i,...l});return u.isValid()||e.warn(r[r.length-2],Ee.a.IncompleteTechnique,{techniqueName:u.name,tooltip:"The technique is not completed. Not all required parameters are specified."}),Ie.addTechnique(e,t,u),u}analyzeUnknDecl(e,t,n){switch(n.name){case"PartFxDecl":return[this.analyzePartFXDecl(e,t,n)];default:return super.analyzeUnknDecl(e,t,n)}}createContext(e){return new Ce(e)}validate(e,t,n){super.validate(e,t,n);const r=t.globalScope,a=n.instructions.filter(e=>e.instructionType===_e.b.k_PartFxDecl);for(const t of e.spawnStmts){const n=!1;if(Object(p.a)(!n,"unsupported"),!n){let n=null;for(const e of a){let a=[e.particle,Ne.e,...t.args.map(Ae)];if((n=r.findFunction(t.name,a))||(a=[e.particle,...t.args.map(Ae)],n=r.findFunction(t.name,a)),n){t.$resolve(e,n);break}}n||e.error(t.sourceNode,me.a.PartFx_InvalidSpawnStmtInitializerNotFound,{tooltip:"Invalid spawn statement. Effect initializer not found."})}}}}function Oe(e,t){return Object(p.a)(String(e.file)===String(t.file)),{offset:Math.min(e.offset,t.offset),line:Math.min(e.line,t.line),column:Math.min(e.column,t.column),file:e.file}}function ve(e,t){return Object(p.a)(String(e.file)===String(t.file)),{offset:Math.max(e.offset,t.offset),line:Math.max(e.line,t.line),column:Math.max(e.column,t.column),file:e.file}}function Pe(e,t){return t.start.file!==e.start.file?e:(t.start.line<e.start.line?e.start={...t.start}:t.start.line===e.start.line&&(e.start=Oe(t.start,e.start)),t.end.line>e.end.line?e.end={...t.end}:t.end.line===e.end.line&&(e.end=ve(t.end,e.end)),e)}const Fe=(e,t)=>e.start.offset<=t&&e.end.offset>t;class De{constructor(e,t=null){this.root=t,this.nodes=[],this.optimized=e,this.nodesCountStack=[]}get lastNode(){return this.nodes[this.nodes.length-1]}finishTree(){this.root=this.nodes.pop()}addToken({name:e,value:t,loc:n}){this.addNode({name:e,value:t,loc:n,children:null,parent:null})}reduceByRule(e,t=a.k_Default){let n=0,r=this.nodesCountStack,i=e.right.length,s=this.nodes,o=this.optimized?1:0;for(;i;)n+=r.pop(),i--;if(t===a.k_Skip&&n>o)s.length-=n,r.push(0);else if(t===a.k_Default&&n>o||t===a.k_Necessary){Object(p.a)(n>0);let t=s.pop();n--;const a={name:e.left,children:null,parent:null,value:"",loc:{...t.loc}};for(this.addLink(a,t);n;)Object(p.a)(s.length>0),this.addLink(a,s.pop()),n--;s.push(a),r.push(1)}else r.push(n)}addNode(e){this.nodes.push(e),this.nodesCountStack.push(1)}$pop(e=null){let t=this.nodesCountStack.pop();for(;t;){let n=this.nodes.pop();e&&Pe(e,n.loc),t--}}addLink(e,t){e.children=e.children||[],Pe(e.loc,t.loc),e.children.push(t),t.parent=e}clone(){return new De(this.optimized,this.cloneNode(this.root))}cloneNode({name:e,value:t,children:n}){const r={name:e,value:t,children:null,parent:null};return n&&n.forEach(e=>this.addLink(r,this.cloneNode(e))),r}toString(){return this.root?this.toStringNode(this.root):""}toStringNode(e,t=""){let n=t+"{\n",r=t;if(t+="  ",e.value)n+=t+'name : "'+e.name+'",\n',n+=t+'value : "'+e.value+'"\n';else{n+=t+'name : "'+e.name+'"\n',n+=t+"children : [";let a=e.children;if(a){n+="\n",t+="  ";for(let e=a.length-1;e>=0;e--)n+=this.toStringNode(a[e],t),n+=",\n";n=n.slice(0,n.length-2),n+="\n",n+=r+"  ]\n"}else n+=" ]\n"}return n+=r+"}"}toHTMLString(e,t=""){let n=t+"{\n",r=t;if(t+="  ",(e=e||this.root).value)n+=t+'<b style="color: #458383;">name</b>: "'+e.name+'",\n',n+=t+'<b style="color: #458383;">value</b>: "'+e.value+'",\n',n+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',n+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n';else{let a;if(n+=t+'<i style="color: #8A2BE2;">name</i>: "'+e.name+'"\n',n+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',n+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n',n+=t+'<i style="color: #8A2BE2;">children</i>: [',e.children){for(n+="\n",t+="  ",a=e.children.length-1;a>=0;a--)n+=this.toHTMLString(e.children[a],t),n+=",\n";n=n.slice(0,n.length-2),n+="\n",n+=r+"  ]\n"}else n+=" ]\n"}return n+=r+"}"}}var Le;!function(e){e[e.SyntaxUnknownError=2051]="SyntaxUnknownError",e[e.SyntaxUnexpectedEOF=2052]="SyntaxUnexpectedEOF",e[e.SyntaxRecoverableStateNotFound=2053]="SyntaxRecoverableStateNotFound",e[e.GeneralCouldNotReadFile=2200]="GeneralCouldNotReadFile",e[e.GeneralParsingLimitIsReached=2201]="GeneralParsingLimitIsReached"}(Le||(Le={}));class we extends v.b{constructor(){super("Parsing diagnostics","P")}resolveFilename(e,t){return t.file}resolveRange(e,t){switch(e){case Le.SyntaxUnknownError:case Le.SyntaxUnexpectedEOF:return t.token.loc;case Le.GeneralCouldNotReadFile:return t.loc}return null}resolvePosition(e,t){return console.assert(e!=Le.SyntaxUnknownError),{line:t.line,column:0,file:null}}diagnosticMessages(){return{[Le.SyntaxUnknownError]:"Syntax error during parsing. Token: '{token.value}'\nLine: {token.loc.start.line}. Column: {token.loc.start.column}.",[Le.SyntaxUnexpectedEOF]:"Syntax error. Unexpected EOF.",[Le.GeneralCouldNotReadFile]:"Could not read file '{target}'.",[Le.GeneralParsingLimitIsReached]:"Parsing limit is reached.",[Le.SyntaxRecoverableStateNotFound]:"Recoverable state not found."}}}function Ue(e){return{...e,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}class je{constructor(e){Object(p.a)(e.parser,"parser engine is not defined"),this.init(e)}init({parser:e,knownTypes:t=new Set,ruleFunctions:n=new Map}){const r=e.lexerEngine;this.parser=e,this.knownTypes=t,this.ruleFunctions=n,this.lexer=new ae({engine:r,knownTypes:t})}get uri(){return this.lexer.uri.toString()}get diagnosticReport(){let e=this.lexer.getDiagnosticReport(),t=this.diag.resolve();return v.b.mergeReports([e,t])}get root(){return this.tree.root}async parse(e,t=o.k_Optimize){const n=O.testAll(t,o.k_DeveloperMode),r=O.testAll(t,o.k_Optimize);return this.diag=new we,this.tree=new De(r),this.stack=[0],this.lexer.setup(e),this.token=this.readToken(),this.token.value===B?i.k_Ok:(await this.run({developerMode:n,allowErrorRecoverty:!0}),this.diag.hasErrors()?(console.error("parsing was ended with errors."),i.k_Error):i.k_Ok)}readToken(){return this.lexer.getNextToken()}emitError(e,t){this.diag.error(e,{...this.lexer.getLocation(),token:t})}emitCritical(e,t=null){this.diag.critical(e,{...this.lexer.getLocation(),token:t})}restoreState(e,t,n,r,a){for(;;){let i=-1;for(let t=n.length-1;t>=0;--t){const a=e[n[t]][j];if(Object(p.d)(a)&&a.type===c.k_Shift&&e[a.stateIndex][r.name]){i=t;break}}if(-1!==i){const e=n[i];let r=n.length-1-i;for(;0!=r;)t.$pop(a.loc),n.pop(),r--;return e}if(Pe(a.loc,r.loc),r.value===B)break;const s=this.readToken();Object.keys(s).forEach(e=>r[e]=s[e])}return-1}async operationAdditionalAction(e,t){const n=this.parser.findFunctionByState(e,t);return Object(p.f)(n)?c.k_Ok:(Object(p.a)(!!this.ruleFunctions.has(n)),await this.ruleFunctions.get(n)())}async run({developerMode:e=!1,allowErrorRecoverty:t=!0}){const{syntaxTable:n}=this.parser,{stack:r,tree:a}=this,i={index:-1,name:null,value:null};let s=i;let o=0;try{e:for(;;){e&&(o>1e4&&this.emitCritical(Le.GeneralParsingLimitIsReached),o++);let l=r[r.length-1],u=n[l][this.token.name];if(t){if(!u){if(s.index===this.token.index){this.token=this.readToken(),s=i;continue}this.token.value===B?this.emitError(Le.SyntaxUnexpectedEOF,this.token):this.emitError(Le.SyntaxUnknownError,this.token),s=Ue(this.token),this.token={...Ue(this.token),name:j}}u=n[l][this.token.name];const e=this.token.name===j;if(!u||e&&u.type===c.k_Shift){let e=Ue(s);for(;e.name===D;)e=this.readToken();-1===(l=this.restoreState(n,a,r,e,this.token))&&this.emitCritical(Le.SyntaxRecoverableStateNotFound),u=n[l][this.token.name],r.push(u.stateIndex),a.addToken(this.token),this.token=e;continue}}if(Object(p.d)(u))switch(u.type){case c.k_Success:break e;case c.k_Shift:{const e=u.stateIndex;r.push(e),a.addToken(this.token);const t=await this.operationAdditionalAction(e,this.token.name);t===c.k_Error?this.emitCritical(Le.SyntaxUnknownError,this.token):t===c.k_Ok&&(this.token=this.readToken())}break;case c.k_Reduce:{const e=u.rule.right.length;r.length-=e;const t=n[r[r.length-1]][u.rule.left].stateIndex;r.push(t),a.reduceByRule(u.rule,this.parser.getRuleCreationMode(u.rule.left)),await this.operationAdditionalAction(t,u.rule.left)===c.k_Error&&this.emitCritical(Le.SyntaxUnknownError,this.token)}}else Object(p.a)(!t,"unexpected end, something went wrong :/"),this.emitCritical(Le.SyntaxUnknownError,this.token)}a.finishTree()}catch(e){if(!(e instanceof v.a))throw e}}}class Be{constructor(e){this._dirname=null,this._extension=null,this._filename=null,Object(p.d)(e)&&this.set(e)}get path(){return this.toString()}set path(e){this.set(e)}get dirname(){return this._dirname}set dirname(e){this._dirname=e}get filename(){return this._filename}set filename(e){this._filename=e}get ext(){return this._extension}set ext(e){this._extension=e}get basename(){return this._filename?this._filename+(this._extension?"."+this._extension:""):""}set basename(e){var t=e.lastIndexOf(".");t<0?(this._filename=e.substr(0),this._extension=null):(this._filename=e.substr(0,t),this._extension=e.substr(t+1))}set(e){if(Object(p.h)(e)){var t=e.replace("\\","/").split("/");this.basename=t.pop(),this._dirname=t.join("/")}else{if(!(e instanceof Be)){if(Object(p.f)(e))return null;throw new Error(`Unexpected data type was used: ${e}`)}this._dirname=e.dirname,this._filename=e.filename,this._extension=e.ext}}isAbsolute(){return"/"===this._dirname[0]}toString(){return(this._dirname?this._dirname+"/":"")+this.basename}}function We(e){var t=ze(e),n=t.isAbsolute(),r=t.dirname,a=/[\\\/]$/.test(r);return(r=function(e,t){for(var n=0,r=e.length-1;r>=0;r--){var a=e[r];"."===a?e.splice(r,1):".."===a?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}(r.split(/[\\\/]+/).filter((function(e){return!!e})),!n).join("/"))&&a&&(r+="/"),t.dirname=(n?"/":"")+r,t.toString()}function ze(e){return new Be(e)}class Me{constructor(e){this._scheme=null,this._userinfo=null,this._host=null,this._port=0,this._path=null,this._query=null,this._fragment=null,e&&this.set(e)}get urn(){return(this._path?this._path:"")+(this._query?"?"+this._query:"")+(this._fragment?"#"+this._fragment:"")}get url(){return(this._scheme?this._scheme:"")+this.authority}get authority(){return this._host?"//"+(this._userinfo?this._userinfo+"@":"")+this._host+(this._port?":"+this._port:""):""}get scheme(){return this._scheme}get protocol(){return this._scheme?this._scheme.substr(0,this._scheme.lastIndexOf(":")):this._scheme}get userInfo(){return this._userinfo}get host(){return this._host}set host(e){this._host=e}get port(){return this._port}set port(e){this._port=e}get path(){return this._path}set path(e){this._path=e}get query(){return this._query}set query(e){this._query=e}get fragment(){return this._fragment}set(e){if(Object(p.h)(e)){var t=Me.uriExp.exec(e);return console.assert(null!==t,"Invalid URI format used.\nused uri: "+e),t?(this._scheme=t[1]||null,this._userinfo=t[2]||null,this._host=t[3]||null,this._port=parseInt(t[4])||null,this._path=t[5]||t[6]||null,this._query=t[7]||null,this._fragment=t[8]||null,this):null}return e instanceof Me?this.set(e.toString()):(console.error("Unexpected data type was used."),null)}toString(){return this.url+this.urn}}function qe(e){if(!Object(p.f)(e.path))if("filesystem:"===e.scheme){var t=Ve(e.path);t.path=We(t.path),e.path=t.toString()}else e.path=We(e.path);return e}function Ve(e){return new Me(e)}Me.uriExp=new RegExp("^([a-z0-9+.-]+:)?(?:\\/\\/(?:((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*)@)?((?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*)(?::(\\d*))?(\\/(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?|(\\/?(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?)(?:\\?((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?$","i");const Ke=["float2","float3","float4","float2x2","float3x3","float4x4","int2","int3","int4","uint2","uint3","uint4","bool2","bool3","bool4","auto"];class Ge extends je{constructor({parser:e=(pe||de(),pe)}={}){super({parser:e,knownTypes:new Set(Ke)})}get includes(){return this.includeList}async parse(e,t){return this.includeList.set(e.uri,null),await super.parse(e,t)}init(e){super.init(e),this.includeList=new Map,this.lexers=[],this.tokens=[],this.ruleFunctions.set("addType",this._addType.bind(this)),this.ruleFunctions.set("includeCode",this._includeCode.bind(this))}_addType(){const e=this.tree.lastNode,t=e.children[e.children.length-2].value;return this.knownTypes.add(t),c.k_Ok}emitFileNotFound(e,t){this.diag.error(Le.GeneralCouldNotReadFile,{...this.lexer.getLocation(),loc:t,target:e})}readToken(){const e=super.readToken();return e.value===B&&this.lexers.length>0?(this.lexer=this.lexers.pop(),this.tokens.pop()):e}async _includeCode(){let e=this.tree.lastNode,t=e.value;const n=function(e,t=document.location.href){var n,r=Ve(t),a=Ve(e);return qe(a),qe(r),Object(p.f)(a.scheme)&&Object(p.f)(a.host)&&!ze(a.path).isAbsolute()?(n=ze(r.path).dirname,r.path=n?n+"/"+e:e,qe(r).toString()):e}(t.substr(1,t.length-2),`${this.uri}`);if(this.includeList.has(n))return console.warn(`'${n}' file has already been included previously.`),c.k_Ok;this.includeList.set(n,e.loc);try{const t=await fetch(n);if(!t.ok)return this.emitFileNotFound(n,e.loc),c.k_Error;const r=await t.text();return this.lexers.push(this.lexer),this.tokens.push(this.token),this.lexer=new ae({engine:this.parser.lexerEngine,knownTypes:this.knownTypes}),this.lexer.setup({source:r,uri:n}),this.token=this.readToken(),c.k_Ok}catch(n){console.error(n),this.emitFileNotFound(t,e.loc)}return c.k_Error}}async function $e(e,t,n){let r,a,i;if(Object(p.h)(arguments[0].source)){const e=Object(p.g)(arguments[1])?arguments[1]:void 0;r=arguments[0],a=await async function(e,t){const n=new Ge;return await n.parse(e,t),n}(r,e),i=arguments[2]}else a=arguments[0],i=arguments[1];const s=new Ie;return await s.parse(a,i)}var He,Xe,Ze,Qe,Ye,Je,et,tt,nt,rt,at,it,st,ot,lt,ut,ct,pt,dt;!function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return Wt.objectLiteral(t)&&Wt.number(t.line)&&Wt.number(t.character)}}(He||(He={})),function(e){e.create=function(e,t,n,r){if(Wt.number(e)&&Wt.number(t)&&Wt.number(n)&&Wt.number(r))return{start:He.create(e,t),end:He.create(n,r)};if(He.is(e)&&He.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+r+"]")},e.is=function(e){var t=e;return Wt.objectLiteral(t)&&He.is(t.start)&&He.is(t.end)}}(Xe||(Xe={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Wt.defined(t)&&Xe.is(t.range)&&(Wt.string(t.uri)||Wt.undefined(t.uri))}}(Ze||(Ze={})),function(e){e.create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},e.is=function(e){var t=e;return Wt.defined(t)&&Xe.is(t.targetRange)&&Wt.string(t.targetUri)&&(Xe.is(t.targetSelectionRange)||Wt.undefined(t.targetSelectionRange))&&(Xe.is(t.originSelectionRange)||Wt.undefined(t.originSelectionRange))}}(Qe||(Qe={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){var t=e;return Wt.number(t.red)&&Wt.number(t.green)&&Wt.number(t.blue)&&Wt.number(t.alpha)}}(Ye||(Ye={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return Xe.is(t.range)&&Ye.is(t.color)}}(Je||(Je={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return Wt.string(t.label)&&(Wt.undefined(t.textEdit)||ot.is(t))&&(Wt.undefined(t.additionalTextEdits)||Wt.typedArray(t.additionalTextEdits,ot.is))}}(et||(et={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(tt||(tt={})),function(e){e.create=function(e,t,n,r,a){var i={startLine:e,endLine:t};return Wt.defined(n)&&(i.startCharacter=n),Wt.defined(r)&&(i.endCharacter=r),Wt.defined(a)&&(i.kind=a),i},e.is=function(e){var t=e;return Wt.number(t.startLine)&&Wt.number(t.startLine)&&(Wt.undefined(t.startCharacter)||Wt.number(t.startCharacter))&&(Wt.undefined(t.endCharacter)||Wt.number(t.endCharacter))&&(Wt.undefined(t.kind)||Wt.string(t.kind))}}(nt||(nt={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Wt.defined(t)&&Ze.is(t.location)&&Wt.string(t.message)}}(rt||(rt={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(at||(at={})),function(e){e.create=function(e,t,n,r,a,i){var s={range:e,message:t};return Wt.defined(n)&&(s.severity=n),Wt.defined(r)&&(s.code=r),Wt.defined(a)&&(s.source=a),Wt.defined(i)&&(s.relatedInformation=i),s},e.is=function(e){var t=e;return Wt.defined(t)&&Xe.is(t.range)&&Wt.string(t.message)&&(Wt.number(t.severity)||Wt.undefined(t.severity))&&(Wt.number(t.code)||Wt.string(t.code)||Wt.undefined(t.code))&&(Wt.string(t.source)||Wt.undefined(t.source))&&(Wt.undefined(t.relatedInformation)||Wt.typedArray(t.relatedInformation,rt.is))}}(it||(it={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={title:e,command:t};return Wt.defined(n)&&n.length>0&&(a.arguments=n),a},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.string(t.title)&&Wt.string(t.command)}}(st||(st={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Wt.objectLiteral(t)&&Wt.string(t.newText)&&Xe.is(t.range)}}(ot||(ot={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Wt.defined(t)&&ft.is(t.textDocument)&&Array.isArray(t.edits)}}(lt||(lt={})),function(e){e.create=function(e,t){var n={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"create"===t.kind&&Wt.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Wt.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Wt.boolean(t.options.ignoreIfExists)))}}(ut||(ut={})),function(e){e.create=function(e,t,n){var r={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(r.options=n),r},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Wt.string(t.oldUri)&&Wt.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Wt.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Wt.boolean(t.options.ignoreIfExists)))}}(ct||(ct={})),function(e){e.create=function(e,t){var n={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(n.options=t),n},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Wt.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Wt.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Wt.boolean(t.options.ignoreIfNotExists)))}}(pt||(pt={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Wt.string(e.kind)?ut.is(e)||ct.is(e)||pt.is(e):lt.is(e)})))}}(dt||(dt={}));var ht,ft,mt,Et,_t,yt,gt,Tt,xt,bt,St,Rt,kt,Nt,At,Ct,It,Ot=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(ot.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(ot.replace(e,t))},e.prototype.delete=function(e){this.edits.push(ot.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}();!function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(lt.is(e)){var n=new Ot(e.edits);t._textEditChanges[e.textDocument.uri]=n}})):e.changes&&Object.keys(e.changes).forEach((function(n){var r=new Ot(e.changes[n]);t._textEditChanges[n]=r})))}Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(ft.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(r=this._textEditChanges[t.uri])){var n={textDocument:t,edits:a=[]};this._workspaceEdit.documentChanges.push(n),r=new Ot(a),this._textEditChanges[t.uri]=r}return r}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var r;if(!(r=this._textEditChanges[e])){var a=[];this._workspaceEdit.changes[e]=a,r=new Ot(a),this._textEditChanges[e]=r}return r},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(ut.create(e,t))},e.prototype.renameFile=function(e,t,n){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(ct.create(e,t,n))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(pt.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")}}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.string(t.uri)}}(ht||(ht={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.string(t.uri)&&(null===t.version||Wt.number(t.version))}}(ft||(ft={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.string(t.uri)&&Wt.string(t.languageId)&&Wt.number(t.version)&&Wt.string(t.text)}}(mt||(mt={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(Et||(Et={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(Et||(Et={})),function(e){e.is=function(e){var t=e;return Wt.objectLiteral(e)&&Et.is(t.kind)&&Wt.string(t.value)}}(_t||(_t={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(yt||(yt={})),function(e){e.PlainText=1,e.Snippet=2}(gt||(gt={})),function(e){e.create=function(e){return{label:e}}}(Tt||(Tt={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(xt||(xt={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Wt.string(t)||Wt.objectLiteral(t)&&Wt.string(t.language)&&Wt.string(t.value)}}(bt||(bt={})),function(e){e.is=function(e){var t=e;return!!t&&Wt.objectLiteral(t)&&(_t.is(t.contents)||bt.is(t.contents)||Wt.typedArray(t.contents,bt.is))&&(void 0===e.range||Xe.is(e.range))}}(St||(St={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(Rt||(Rt={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={label:e};return Wt.defined(t)&&(a.documentation=t),Wt.defined(n)?a.parameters=n:a.parameters=[],a}}(kt||(kt={})),function(e){e.Text=1,e.Read=2,e.Write=3}(Nt||(Nt={})),function(e){e.create=function(e,t){var n={range:e};return Wt.number(t)&&(n.kind=t),n}}(At||(At={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(Ct||(Ct={})),function(e){e.create=function(e,t,n,r,a){var i={name:e,kind:t,location:{uri:r,range:n}};return a&&(i.containerName=a),i}}(It||(It={}));var vt,Pt,Ft,Dt,Lt,wt=function(){};!function(e){e.create=function(e,t,n,r,a,i){var s={name:e,detail:t,kind:n,range:r,selectionRange:a};return void 0!==i&&(s.children=i),s},e.is=function(e){var t=e;return t&&Wt.string(t.name)&&Wt.number(t.kind)&&Xe.is(t.range)&&Xe.is(t.selectionRange)&&(void 0===t.detail||Wt.string(t.detail))&&(void 0===t.deprecated||Wt.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(wt||(wt={})),function(e){e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports"}(vt||(vt={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.typedArray(t.diagnostics,it.is)&&(void 0===t.only||Wt.typedArray(t.only,Wt.string))}}(Pt||(Pt={})),function(e){e.create=function(e,t,n){var r={title:e};return st.is(t)?r.command=t:r.edit=t,void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return t&&Wt.string(t.title)&&(void 0===t.diagnostics||Wt.typedArray(t.diagnostics,it.is))&&(void 0===t.kind||Wt.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||st.is(t.command))&&(void 0===t.edit||dt.is(t.edit))}}(Ft||(Ft={})),function(e){e.create=function(e,t){var n={range:e};return Wt.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return Wt.defined(t)&&Xe.is(t.range)&&(Wt.undefined(t.command)||st.is(t.command))}}(Dt||(Dt={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Wt.defined(t)&&Wt.number(t.tabSize)&&Wt.boolean(t.insertSpaces)}}(Lt||(Lt={}));var Ut=function(){};!function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return Wt.defined(t)&&Xe.is(t.range)&&(Wt.undefined(t.target)||Wt.string(t.target))}}(Ut||(Ut={}));var jt,Bt;!function(e){e.create=function(e,t,n,r){return new zt(e,t,n,r)},e.is=function(e){var t=e;return!!(Wt.defined(t)&&Wt.string(t.uri)&&(Wt.undefined(t.languageId)||Wt.string(t.languageId))&&Wt.number(t.lineCount)&&Wt.func(t.getText)&&Wt.func(t.positionAt)&&Wt.func(t.offsetAt))},e.applyEdits=function(e,t){for(var n=e.getText(),r=function e(t,n){if(t.length<=1)return t;var r=t.length/2|0,a=t.slice(0,r),i=t.slice(r);e(a,n),e(i,n);var s=0,o=0,l=0;for(;s<a.length&&o<i.length;){var u=n(a[s],i[o]);t[l++]=u<=0?a[s++]:i[o++]}for(;s<a.length;)t[l++]=a[s++];for(;o<i.length;)t[l++]=i[o++];return t}(t,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),a=n.length,i=r.length-1;i>=0;i--){var s=r[i],o=e.offsetAt(s.range.start),l=e.offsetAt(s.range.end);if(!(l<=a))throw new Error("Overlapping edit");n=n.substring(0,o)+s.newText+n.substring(l,n.length),a=o}return n}}(jt||(jt={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(Bt||(Bt={}));var Wt,zt=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=null},e.prototype.getLineOffsets=function(){if(null===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var a=t.charAt(r);n="\r"===a||"\n"===a,"\r"===a&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return He.create(0,e);for(;n<r;){var a=Math.floor((n+r)/2);t[a]>e?r=a:n=a+1}var i=n-1;return He.create(i,e-t[i])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Wt||(Wt={}));class Mt{doProvide(e,t){if(!t)return[];const n=[],r=t.root.scope,a=(e,t)=>{const n=He.create(t.start.line,t.start.column),r=Xe.create(n,n),a=Dt.create(r);return a.command=st.create(e,null),a};if(!Object(p.f)(r))for(const e in r.techniques){const t=r.techniques[e];if(t.type===_e.d.k_PartFx){const e=t;if(e.spawnRoutine){const t=e.spawnRoutine.function.def.sourceNode;n.push(a("[spawn routine]",t.loc))}if(e.initRoutine){const t=e.initRoutine.function.def.sourceNode;n.push(a("[init routine]",t.loc))}if(e.updateRoutine){const t=e.updateRoutine.function.def.sourceNode;n.push(a("[update routine]",t.loc))}if(e.particle&&e.particle.instructionType!==_e.b.k_SystemType){const t=e.particle.sourceNode;n.push(a("[particle]",t.loc))}for(const t of e.passList)if(t.prerenderRoutine){{const e=t.prerenderRoutine.function.def.sourceNode;n.push(a("[prerender routine]",e.loc))}{const e=t.particleInstance.sourceNode;n.push(a("[material]",e.loc))}}}}return n}}var qt=n("DTTp");const Vt=e=>e.sourceNode.loc;class Kt{doSignatureHelp(e,t,n){if(!n)return null;const r=e.offsetAt(t),a=n.root.instructions.find(e=>Fe(Vt(e),r));if(a&&a.instructionType===_e.b.k_FunctionDecl){let e=null;if(qt.a.each(a,t=>{t.instructionType===_e.b.k_FunctionCallExpr&&Fe(Vt(t),r)&&(e=t)}),!e)return null;const t=e.decl,n=t.scope.functions[t.name],i=n.map(e=>kt.create(e.def.toCode(),null,...e.def.params.map(e=>Rt.create(e.name))));let s=n.indexOf(t),o=0;return-1!==s?o=e.args.findIndex(e=>Fe(Vt(e),r)):(s=0,console.error(`could not find active signature for: '${t.def.toCode()}'`)),{signatures:i,activeParameter:o,activeSignature:s}}return null}}const Gt=Symbol("Comlink.proxy"),$t=Symbol("Comlink.endpoint"),Ht=Symbol("Comlink.releaseProxy"),Xt=new WeakSet,Zt=new Map([["proxy",{canHandle:e=>e&&e[Gt],serialize(e){const{port1:t,port2:n}=new MessageChannel;return Qt(e,t),[n,[n]]},deserialize:e=>(e.start(),function(e){return function e(t,n=[]){let r=!1;const a=new Proxy((function(){}),{get(i,s){if(Jt(r),s===Ht)return()=>an(t,{type:5,path:n.map(e=>e.toString())}).then(()=>{Yt(t),r=!0});if("then"===s){if(0===n.length)return{then:()=>a};const e=an(t,{type:0,path:n.map(e=>e.toString())}).then(rn);return e.then.bind(e)}return e(t,[...n,s])},set(e,a,i){Jt(r);const[s,o]=nn(i);return an(t,{type:1,path:[...n,a].map(e=>e.toString()),value:s},o).then(rn)},apply(a,i,s){Jt(r);const o=n[n.length-1];if(o===$t)return an(t,{type:4}).then(rn);if("bind"===o)return e(t,n.slice(0,-1));const[l,u]=en(s);return an(t,{type:2,path:n.map(e=>e.toString()),argumentList:l},u).then(rn)},construct(e,a){Jt(r);const[i,s]=en(a);return an(t,{type:3,path:n.map(e=>e.toString()),argumentList:i},s).then(rn)}});return a}(e)}(e))}],["throw",{canHandle:e=>Xt.has(e),serialize(e){const t=e instanceof Error;let n=e;return t&&(n={isError:t,message:e.message,stack:e.stack}),[n,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error,e);throw e}}]]);function Qt(e,t=self){t.addEventListener("message",(function n(r){if(!r||!r.data)return;const{id:a,type:i,path:s}=Object.assign({path:[]},r.data),o=(r.data.argumentList||[]).map(rn);let l;try{const t=s.slice(0,-1).reduce((e,t)=>e[t],e),n=s.reduce((e,t)=>e[t],e);switch(i){case 0:l=n;break;case 1:t[s.slice(-1)[0]]=rn(r.data.value),l=!0;break;case 2:l=n.apply(t,o);break;case 3:l=function(e){return Object.assign(e,{[Gt]:!0})}(new n(...o));break;case 4:{const{port1:t,port2:n}=new MessageChannel;Qt(e,n),l=function(e,t){return tn.set(e,t),e}(t,[t])}break;case 5:l=void 0}}catch(e){l=e,Xt.add(e)}Promise.resolve(l).catch(e=>(Xt.add(e),e)).then(e=>{const[r,s]=nn(e);t.postMessage(Object.assign(Object.assign({},r),{id:a}),s),5===i&&(t.removeEventListener("message",n),Yt(t))})})),t.start&&t.start()}function Yt(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function Jt(e){if(e)throw new Error("Proxy has been released and is not useable")}function en(e){const t=e.map(nn);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const tn=new WeakMap;function nn(e){for(const[t,n]of Zt)if(n.canHandle(e)){const[r,a]=n.serialize(e);return[{type:3,name:t,value:r},a]}return[{type:0,value:e},tn.get(e)||[]]}function rn(e){switch(e.type){case 3:return Zt.get(e.name).deserialize(e.value);case 0:return e.value}}function an(e,t,n){return new Promise(r=>{const a=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===a&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),n)})}function sn(e){const{code:t,content:n,start:r,end:a,category:i}=e,s={[fe.a.k_Error]:at.Error,[fe.a.k_Warning]:at.Warning};return{range:Xe.create(r.line,r.column,(a||r).line,(a||r).column),severity:s[i],code:t,message:n}}Qt(new class{constructor(){this.documents=new Map}init(e,t){console.log("%c Creating parser for language service provider...","background: #222; color: #bada55");try{de(e),console.log("%c [ DONE ]","background: #222; color: #bada55")}catch(e){return console.error("could not initialize parser."),null}this.service=function(e){const t=new Kt,n=new Mt;return{async parseDocument(t){const n=t.uri,r=t.getText();return await $e({uri:n,source:r},e)},doResolve:e=>null,doComplete:(e,t,n)=>null,findDocumentSymbols:(e,t)=>[],findDocumentColors:(e,t)=>null,getColorPresentations:(e,t,n,r)=>[],doHover:(e,t,n)=>null,format:(e,t,n)=>[],getFoldingRanges:e=>[],getSelectionRanges:(e,t,n)=>[],doSignatureHelp:t.doSignatureHelp.bind(t),doFxCodeLenses:n.doProvide.bind(n)}}(t)}async validate(e){const t=function({_content:e,_languageId:t,_lineOffsets:n,_uri:r,_version:a}){return jt.create(r,t,a,e)}(e),n=await this.service.parseDocument(t);return this.documents.set(t.uri,{textDocument:t,slDocument:n}),n.diagnosticReport.messages.map(sn)}async provideFxCodeLenses(e){if(!this.service)return[];const{textDocument:t,slDocument:n}=await this.getDocument(e);return this.service.doFxCodeLenses(t,n)}async provideSignatureHelp(e,t){if(!this.service)return null;const{textDocument:n,slDocument:r}=await this.getDocument(e);return this.service.doSignatureHelp(n,t,r)}getDocument(e){return this.documents.has(e.uri)?this.documents.get(e.uri):(console.warn("could not find document",e.uri),{textDocument:null,slDocument:null})}})},Wl5j:function(e,t,n){"use strict";var r=n("fb8x"),a=n("u2cq"),i=n("hsO8"),s=n("C2sc"),o=n("FrU9"),l=n("BKBR");class u extends l.a{constructor({vertex:e=!0,pixel:t=!0,implementation:n=null,...a}){super({instrType:o.b.k_SystemFunctionDecl,implementation:null,...a}),Object(r.a)(Object(r.f)(n)),this._bForVertex=e,this._bForPixel=t}checkVertexUsage(){return this._bForVertex}checkPixelUsage(){return this._bForPixel}$makeVertexCompatible(e){console.warn("@deprecated"),this._bForVertex=e}$makePixelCompatible(e){console.warn("@deprecated"),this._bForPixel=e}}var c=n("2b0+");class p extends c.a{constructor({name:e,size:t=0,elementType:n=null,length:r=1,fields:a=[],methods:i=[],writable:s=!0,readable:l=!0,complex:u=!1,sampler:p=!1,texture:d=!1,uav:h=!1,...f}){super({instrType:o.b.k_SystemType,...f}),this._name=e,this._size=t,this._elementType=c.a.$withNoParent(n),this._length=r,this._fields=[],this._methods=[],this._bIsWritable=s,this._bIsReadable=l,this._bIsComplex=u,this._bIsSampler=p,this._bIsTexture=d,this._bIsUAV=h,a.forEach(e=>this.addField(e)),i.forEach(e=>this.addMethod(e))}get writable(){return this._bIsWritable}get readable(){return this._bIsReadable}set name(e){this._name=e}get name(){return this._name}get hash(){return this._name}get strongHash(){return this._name}get size(){return this.isArray()?this.length===a.c.UNDEFINE_LENGTH?a.c.UNDEFINE_LENGTH:this.arrayElementType.size*this.length:this._size}get baseType(){return this}get arrayElementType(){return this._elementType}get typeDecl(){return this.parent}get length(){return this._length}get fields(){return this._fields}get methods(){return this._methods}get fieldNames(){return this._fields.map(e=>e.name)}isSampler(){return this._bIsSampler}isTexture(){return this._bIsTexture}isUAV(){return this._bIsUAV}isEqual(e){return a.d.equals(this,e)}toDeclString(){return console.warn("@pure_virtual"),""}isBase(){return!0}isArray(){return!Object(r.f)(this.arrayElementType)}isNotBaseArray(){return!1}isComplex(){return this._bIsComplex}isConst(){return!1}isContainArray(){return!1}isContainSampler(){return!1}isContainPointer(){return!1}isContainComplexType(){return!1}toString(){return this.name||a.d.hash(this)}toCode(){return this._name}hasField(e){return!!this.getField(e)}hasFieldWithSematics(e){return!1}hasAllUniqueSemantics(){return!1}hasFieldWithoutSemantics(){return!1}getField(e){return this._fields.find(t=>t.name===e)||null}getMethod(e,t){const n=this._methods.filter(t=>t.name===e);return a.b.matchList(n,t)}getFieldBySemantics(e){return console.error("@undefined_behavior"),null}addField(e){console.assert(null===this.getField(e.name)),this._fields.push(c.a.$withParent(e,this))}addMethod(e){console.assert(Object(r.f)(this.getMethod(e.name,e.def.params.map(e=>e.type)))),this._methods.push(c.a.$withParent(e,this))}}var d,h=n("MJEd"),f=n("hljw"),m=n("IHXS"),E=n("zioJ");n.d(t,"a",(function(){return P})),n.d(t,"i",(function(){return F})),n.d(t,"g",(function(){return D})),n.d(t,"c",(function(){return L})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return M})),n.d(t,"e",(function(){return X})),n.d(t,"h",(function(){return J})),n.d(t,"f",(function(){return se})),n.d(t,"j",(function(){return oe})),n.d(t,"l",(function(){return le})),n.d(t,"p",(function(){return ue})),n.d(t,"t",(function(){return ce})),n.d(t,"r",(function(){return pe})),n.d(t,"n",(function(){return de})),n.d(t,"o",(function(){return he})),n.d(t,"s",(function(){return fe})),n.d(t,"m",(function(){return me})),n.d(t,"q",(function(){return Ee})),n.d(t,"k",(function(){return _e})),function(e){e[e.k_Sampler=0]="k_Sampler",e[e.k_Sampler2D=1]="k_Sampler2D",e[e.k_Sampler3D=2]="k_Sampler3D",e[e.k_SamplerCube=3]="k_SamplerCube",e[e.k_RWBuffer=4]="k_RWBuffer",e[e.k_RWStructuredBuffer=5]="k_RWStructuredBuffer",e[e.k_AppendStructuredBuffer=6]="k_AppendStructuredBuffer"}(d||(d={}));const _=new m.b({type:o.c.k_System}),y={},g="template";function T(e){throw new Error(e)}function x(e,t={}){T(E.a[e])}function b(...e){let t,n,r,a,i,s;if([t,n,r,a,i,s]=e,v(t))return console.error(`type already exists: ${t}`),null;const o=new p({scope:_,name:t,elementType:r,length:a,fields:i,size:n,methods:s});return _.addType(o),o}class S{constructor(e,t){this.name=e,this.scope=t}produceType(e,t){return null}typeName(e){return e?`${this.name}<${e.map(e=>e.name).join(", ")}>`:this.name}}class R extends S{constructor(){super("RWBuffer",_)}produceType(e,t){if(1!==t.length)return null;if(!t[0].isBase())return null;const n=this.typeName(t),r=t[0],i=a.c.UNDEFINE_LENGTH;return new p({scope:e,name:n,elementType:r,length:i,fields:[],size:-1,methods:[],uav:!0})}}class k extends S{constructor(){super("RWStructuredBuffer",_)}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],o=a.c.UNDEFINE_LENGTH,l=[];{let t=new f.a({type:e.findType("uint"),scope:e}),n=new s.a({scope:e,name:"IncrementCounter"}),r=new i.a({scope:e,returnType:t,id:n}),a=new u({scope:e,definition:r,pixel:!1,vertex:!1});l.push(a)}{let t=new f.a({type:e.findType("uint"),scope:e}),n=new s.a({scope:e,name:"DecrementCounter"}),r=new i.a({scope:e,returnType:t,id:n}),a=new u({scope:e,definition:r,pixel:!1,vertex:!1});l.push(a)}return new p({scope:e,name:n,elementType:r,length:o,fields:[],size:-1,methods:l,uav:!0})}}class N extends S{constructor(){super("AppendStructuredBuffer",_)}produceType(e,t){if(1!==t.length)return null;const n=this.typeName(t),r=t[0],o=a.c.UNDEFINE_LENGTH,l=[];{const n=[];{const r=new f.a({type:t[0],scope:e}),a=new s.a({scope:e,name:"Append"}),i=h.a.k_Argument|h.a.k_Local,o=new h.b({scope:e,type:r,id:a,usageFlags:i});n.push(o)}const r=new f.a({type:e.findType("void"),scope:e}),a=new s.a({scope:e,name:"Append"}),o=new i.a({scope:e,returnType:r,id:a,paramList:n}),c=new u({scope:e,definition:o,pixel:!1,vertex:!1});l.push(c)}return new p({scope:e,name:n,elementType:r,length:o,fields:[],size:-1,methods:l,uav:!0})}}function A(e,t,n){for(let a in t){const i=v(n+(a.length>1?a.length.toString():""));Object(r.a)(i);const o=new s.a({scope:_,name:a}),l=new f.a({scope:_,type:i,writable:t[a]});e.push(new h.b({scope:_,id:o,type:l}))}}function C(e,t,n=0){if(n>=e.length)return;if(0===n){for(let n=0;n<e.length;n++)t[e[n]]=!0;n=1}const r=Object.keys(t);for(let n=0;n<e.length;n++)for(let a=0;a<r.length;a++)-1!==r[a].indexOf(e[n])?t[r[a]+e[n]]=!1:t[r[a]+e[n]]=!1!==t[r[a]];C(e,t,++n)}function I(e,t,n,r,a){let o=n.map((e,t)=>new h.b({type:new f.a({type:e,scope:_}),id:new s.a({name:`p${t}`,scope:_}),scope:_})),l=new f.a({type:e,scope:_}),c=new s.a({scope:_,name:t}),p=new i.a({scope:_,returnType:l,id:c,paramList:o}),d=new u({scope:_,definition:p,pixel:a,vertex:r});_.addFunction(d)}function O(e,t,n,a,i=!0,s=!0){if(Object(r.f)(a)){t===g&&T("Bad return type(TEMPLATE_TYPE) for system function '"+e+"'.");let r=e+"(",a=v(t),o=[];for(let t=0;t<n.length;t++)n[t]===g?T("Bad argument type(TEMPLATE_TYPE) for system function '"+e+"'."):(o.push(v(n[t])),r+=n[t]+",");y[r+=")"]&&x(E.a.SystemFunctionRedefinition,{funcName:r}),I(a,e,o,i,s),y[r]=!0}else for(let r=0;r<a.length;r++){let o=e+"(",l=v(t===g?a[r]:t),u=[];for(let e=0;e<n.length;e++)n[e]===g?(u.push(v(a[r])),o+=a[r]+","):(u.push(v(n[e])),o+=n[e]+",");y[o+=")"]&&x(E.a.SystemFunctionRedefinition,{funcName:o}),I(l,e,u,i,s),y[o]=!0}}function v(e){let t=_.findType(e);return Object(r.a)(!t||t.instructionType===o.b.k_SystemType),t}b("void",0),b("int",4),b("uint",4),b("bool",4),b("float",4),b("string"),b("texture"),b("sampler"),b("sampler2D"),b("samplerCUBE"),function(){let e={},t={},n={},r={},a={},i={},s={},o={},l={};C(["x","y"],e),C(["x","y","z"],t),C(["x","y","z","w"],n),C(["r","g"],r),C(["r","g","b"],a),C(["r","g","b","a"],i),C(["s","t"],s),C(["s","t","p"],o),C(["s","t","p","q"],l);let u=v("float"),c=v("int"),p=v("uint"),d=v("bool"),h=b("float2",-1,u,2),f=b("float3",-1,u,3),m=b("float4",-1,u,4),E=b("int2",-1,c,2),_=b("int3",-1,c,3),y=b("int4",-1,c,4),g=b("uint2",-1,p,2),T=b("uint3",-1,p,3),x=b("uint4",-1,p,4),S=b("bool2",-1,d,2),R=b("bool3",-1,d,3),k=b("bool4",-1,d,4);{let t=[];A(t,e,"float"),A(t,r,"float"),A(t,s,"float"),t.forEach(e=>h.addField(e))}{let e=[];A(e,t,"float"),A(e,a,"float"),A(e,o,"float"),e.forEach(e=>f.addField(e))}{let e=[];A(e,n,"float"),A(e,i,"float"),A(e,l,"float"),e.forEach(e=>m.addField(e))}{let t=[];A(t,e,"int"),A(t,r,"int"),A(t,s,"int"),t.forEach(e=>E.addField(e))}{let e=[];A(e,t,"int"),A(e,a,"int"),A(e,o,"int"),e.forEach(e=>_.addField(e))}{let e=[];A(e,n,"int"),A(e,i,"int"),A(e,l,"int"),e.forEach(e=>y.addField(e))}{let t=[];A(t,e,"uint"),A(t,r,"uint"),A(t,s,"uint"),t.forEach(e=>g.addField(e))}{let e=[];A(e,t,"uint"),A(e,a,"uint"),A(e,o,"uint"),e.forEach(e=>T.addField(e))}{let e=[];A(e,n,"uint"),A(e,i,"uint"),A(e,l,"uint"),e.forEach(e=>x.addField(e))}{let t=[];A(t,e,"bool"),A(t,r,"bool"),A(t,s,"bool"),t.forEach(e=>S.addField(e))}{let e=[];A(e,t,"bool"),A(e,a,"bool"),A(e,o,"bool"),e.forEach(e=>R.addField(e))}{let e=[];A(e,n,"bool"),A(e,i,"bool"),A(e,l,"bool"),e.forEach(e=>k.addField(e))}}(),function(){let e=v("float2"),t=v("float3"),n=v("float4"),r=v("int2"),a=v("int3"),i=v("int4"),s=(v("uint2"),v("uint3"),v("uint4"),v("bool2")),o=v("bool3"),l=v("bool4");b("float2x2",-1,e,2),b("float2x3",-1,e,3),b("float2x4",-1,e,4),b("float3x2",-1,t,2),b("float3x3",-1,t,3),b("float3x4",-1,t,4),b("float4x2",-1,n,2),b("float4x3",-1,n,3),b("float4x4",-1,n,4),b("int2x2",-1,r,2),b("int2x3",-1,r,3),b("int2x4",-1,r,4),b("int3x2",-1,a,2),b("int3x3",-1,a,3),b("int3x4",-1,a,4),b("int4x2",-1,i,2),b("int4x3",-1,i,3),b("int4x4",-1,i,4),b("bool2x2",-1,s,2),b("bool2x3",-1,s,3),b("bool2x4",-1,s,4),b("bool3x2",-1,o,2),b("bool3x3",-1,o,3),b("bool3x4",-1,o,4),b("bool4x2",-1,l,2),b("bool4x3",-1,l,3),b("bool4x4",-1,l,4)}(),_.addTypeTemplate(new R),_.addTypeTemplate(new k),_.addTypeTemplate(new N),O("dot","float",[g,g],["float","float2","float3","float4"]),O("mul",g,[g,g],["float","int"]),O("mul",g,[g,"float"],["float2","float3","float4","float2x2","float3x3","float4x4"]),O("mul",g,["float",g],["float2","float3","float4","float2x2","float3x3","float4x4"]),O("mul","float4",["float4",g],["float4x4","float4x3","float4x2"]),O("mul","float3",["float3",g],["float3x4","float3x3","float3x2"]),O("mul","float2",["float2",g],["float2x4","float2x3","float2x2"]),O("mul","float4",[g,"float4"],["float4x4","float3x4","float2x4"]),O("mul","float3",[g,"float3"],["float4x3","float3x3","float2x3"]),O("mul","float2",[g,"float2"],["float4x2","float3x2","float2x2"]),O("mod","float",["float","float"],null),O("floor",g,[g],["float","float2","float3","float4"]),O("ceil",g,[g],["float","float2","float3","float4"]),O("abs",g,[g],["float","float2","float3","float4"]),O("sign",g,[g],["float","float2","float3","float4"]),O("normalize",g,[g],["float","float2","float3","float4"]),O("length","float",[g],["float","float2","float3","float4"]),O("cross","float3",["float3","float3"],null),O("reflect",g,[g,g],["float","float2","float3","float4"]),O("max",g,[g,g],["float","float2","float3","float4"]),O("max",g,[g,g],["int","int2","int3","int4"]),O("min",g,[g,g],["float","float2","float3","float4"]),O("min",g,[g,g],["int","int2","int3","int4"]),O("clamp",g,[g,g,g],["float","float2","float3","float4"]),O("clamp",g,[g,"float","float"],["float2","float3","float4"]),O("pow",g,[g,g],["float","float2","float3","float4"]),O("mod",g,[g,g],["float2","float3","float4"]),O("mod",g,[g,"float"],["float2","float3","float4"]),O("exp",g,[g],["float","float2","float3","float4"]),O("exp2",g,[g],["float","float2","float3","float4"]),O("log",g,[g],["float","float2","float3","float4"]),O("log2",g,[g],["float","float2","float3","float4"]),O("inversesqrt",g,[g],["float","float2","float3","float4"]),O("sqrt",g,[g],["float","float2","float3","float4"]),O("all","bool",[g],["bool2","bool3","bool4"]),O("any","bool",[g],["bool2","bool3","bool4"]),O("not",g,[g],["bool2","bool3","bool4"]),O("distance","float",[g,g],["float","float2","float3","float4"]),O("lessThan","bool2",[g,g],["float2","int2","uint2"]),O("lessThan","bool3",[g,g],["float3","int3","uint3"]),O("lessThan","bool4",[g,g],["float4","int4","uint4"]),O("lessThanEqual","bool2",[g,g],["float2","int2","uint2"]),O("lessThanEqual","bool3",[g,g],["float3","int3","uint3"]),O("lessThanEqual","bool4",[g,g],["float4","int4","uint4"]),O("equal","bool2",[g,g],["float2","int2","uint2"]),O("equal","bool3",[g,g],["float3","int3","uint3"]),O("equal","bool4",[g,g],["float4","int4","uint4"]),O("equal",g,[g,g],["bool2","bool3","bool4"]),O("notEqual","bool2",[g,g],["float2","int2","uint2"]),O("notEqual","bool3",[g,g],["float3","int3","uint3"]),O("notEqual","bool4",[g,g],["float4","int4","uint4"]),O("notEqual",g,[g,g],["bool2","bool3","bool4"]),O("greaterThan","bool2",[g,g],["float2","int2","uint2"]),O("greaterThan","bool3",[g,g],["float3","int3","uint3"]),O("greaterThan","bool4",[g,g],["float4","int4","uint4"]),O("greaterThanEqual","bool2",[g,g],["float2","int2","uint2"]),O("greaterThanEqual","bool3",[g,g],["float3","int3","uint3"]),O("greaterThanEqual","bool4",[g,g],["float4","int4","uint4"]),O("radians",g,[g],["float","float2","float3","float4"]),O("degrees",g,[g],["float","float2","float3","float4"]),O("sin",g,[g],["float","float2","float3","float4"]),O("cos",g,[g],["float","float2","float3","float4"]),O("tan",g,[g],["float","float2","float3","float4"]),O("asin",g,[g],["float","float2","float3","float4"]),O("acos",g,[g],["float","float2","float3","float4"]),O("atan",g,[g],["float","float2","float3","float4"]),O("atan",g,[g,g],["float","float2","float3","float4"]),O("tex2D","float4",["sampler","float2"],null),O("tex2D","float4",["sampler2D","float2"],null),O("tex2DProj","float4",["sampler","float3"],null),O("tex2DProj","float4",["sampler2D","float3"],null),O("tex2DProj","float4",["sampler","float4"],null),O("tex2DProj","float4",["sampler2D","float4"],null),O("texCUBE","float4",["sampler","float3"],null),O("texCUBE","float4",["samplerCUBE","float3"],null),O("tex2D","float4",["sampler","float2","float"],null,!1,!0),O("tex2D","float4",["sampler2D","float2","float"],null,!1,!0),O("tex2DProj","float4",["sampler","float3","float"],null,!1,!0),O("tex2DProj","float4",["sampler2D","float3","float"],null,!1,!0),O("tex2DProj","float4",["sampler","float4","float"],null,!1,!0),O("tex2DProj","float4",["sampler2D","float4","float"],null,!1,!0),O("texCUBE","float4",["sampler","float3","float"],null,!1,!0),O("texCUBE","float4",["samplerCUBE","float3","float"],null,!1,!0),O("tex2DLod","float4",["sampler","float2","float"],null,!0,!1),O("tex2DLod","float4",["sampler2D","float2","float"],null,!0,!1),O("tex2DProjLod","float4",["sampler","float3","float"],null,!0,!1),O("tex2DProjLod","float4",["sampler2D","float3","float"],null,!0,!1),O("tex2DProjLod","float4",["sampler","float4","float"],null,!0,!1),O("tex2DProjLod","float4",["sampler2D","float4","float"],null,!0,!1),O("texCUBELod","float4",["sampler","float3","float"],null,!0,!1),O("texCUBELod","float4",["samplerCUBE","float3","float"],null,!0,!1),O("dFdx",g,[g],["float","float2","float3","float4"]),O("dFdy",g,[g],["float","float2","float3","float4"]),O("width",g,[g],["float","float2","float3","float4"]),O("fwidth",g,[g],["float","float2","float3","float4"]),O("smoothstep",g,[g,g,g],["float","float2","float3","float4"]),O("smoothstep",g,["float","float",g],["float2","float3","float4"]),O("frac",g,[g],["float","float2","float3","float4"]),O("lerp",g,[g,g,g],["float","float2","float3","float4"]),O("lerp",g,[g,g,"float"],["float2","float3","float4"]),O("saturate",g,[g],["float","float2","float3","float4"]),O("asfloat","float",[g],["float"]),O("asfloat","float",[g],["int"]),O("asfloat","float2",[g],["int2"]),O("asfloat","float3",[g],["int3"]),O("asfloat","float4",[g],["int4"]),O("asint","int",[g],["float","uint"]),O("asint","int2",[g],["float2","uint2"]),O("asint","int3",[g],["float3","uint3"]),O("asint","int4",[g],["float4","uint4"]),O("asuint","uint",[g],["float","int"]),O("asuint","uint2",[g],["float2","int2"]),O("asuint","uint3",[g],["float3","int3"]),O("asuint","uint4",[g],["float4","int4"]),O("InterlockedAdd",g,[g,g,g],["int"]);const P=_,F=_.findType("void"),D=_.findType("string"),L=_.findType("float"),w=_.findType("float2"),U=_.findType("float3"),j=_.findType("float4"),B=_.findType("float2x2"),W=_.findType("float3x3"),z=_.findType("float4x4"),M=_.findType("bool"),q=_.findType("bool2"),V=_.findType("bool3"),K=_.findType("bool4"),G=_.findType("bool2x2"),$=_.findType("bool3x3"),H=_.findType("bool4x4"),X=_.findType("int"),Z=_.findType("int2"),Q=_.findType("int3"),Y=_.findType("int4"),J=_.findType("uint"),ee=_.findType("uint2"),te=_.findType("uint3"),ne=_.findType("uint4"),re=_.findType("int2x2"),ae=_.findType("int3x3"),ie=_.findType("int4x4"),se=_.findType("sampler"),oe=(_.findType("sampler2D"),_.findType("samplerCUBE"),e=>_.findType(e)),le=e=>!Object(r.f)(_.findVariable(e));function ue(e){return e.isEqual(v("float2x2"))||e.isEqual(v("float3x3"))||e.isEqual(v("float4x4"))||e.isEqual(v("int2x2"))||e.isEqual(v("int3x3"))||e.isEqual(v("int4x4"))||e.isEqual(v("bool2x2"))||e.isEqual(v("bool3x3"))||e.isEqual(v("bool4x4"))}function ce(e){return e.isEqual(v("float2"))||e.isEqual(v("float3"))||e.isEqual(v("float4"))||e.isEqual(v("bool2"))||e.isEqual(v("bool3"))||e.isEqual(v("bool4"))||e.isEqual(v("int2"))||e.isEqual(v("int3"))||e.isEqual(v("int4"))||e.isEqual(v("uint2"))||e.isEqual(v("uint3"))||e.isEqual(v("uint4"))}function pe(e){return e.isEqual(M)||e.isEqual(X)||e.isEqual(J)||e.isEqual(L)}function de(e){return e.isEqual(L)||e.isEqual(w)||e.isEqual(U)||e.isEqual(j)||e.isEqual(B)||e.isEqual(W)||e.isEqual(z)}function he(e){return e.isEqual(X)||e.isEqual(Z)||e.isEqual(Q)||e.isEqual(Y)||e.isEqual(re)||e.isEqual(ae)||e.isEqual(ie)}function fe(e){return e.isEqual(J)||e.isEqual(ee)||e.isEqual(te)||e.isEqual(ne)}function me(e){return e.isEqual(M)||e.isEqual(q)||e.isEqual(V)||e.isEqual(K)||e.isEqual(G)||e.isEqual($)||e.isEqual(H)}function Ee(e){return e.isEqual(se)||e.isEqual(v("sampler2D"))||e.isEqual(v("samplerCUBE"))}function _e(e){return e.isEqual(X)||e.isEqual(J)||e.isEqual(L)?Number:e.isEqual(M)?"Boolean":e.isEqual(w)||e.isEqual(q)||e.isEqual(Z)||e.isEqual(ee)?"Vec2":e.isEqual(U)||e.isEqual(V)||e.isEqual(Q)||e.isEqual(te)?"Vec3":e.isEqual(j)||e.isEqual(K)||e.isEqual(Y)||e.isEqual(ne)?"Vec4":e.isEqual(B)||e.isEqual(G)||e.isEqual(re)?"Vec2":e.isEqual(W)||e.isEqual($)||e.isEqual(ae)?"Mat3":e.isEqual(z)||e.isEqual(H)||e.isEqual(ie)?"Mat4":null}},"Wv+o":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("fb8x"),a=n("zioJ"),i=n("FrU9"),s=n("2b0+"),o=n("oseZ");class l extends o.a{constructor({init:e=null,cond:t=null,step:n=null,body:r=null,...a}){super({instrType:i.b.k_ForStmt,...a}),this._init=s.a.$withParent(e,this),this._cond=s.a.$withParent(t,this),this._step=s.a.$withParent(n,this),this._body=s.a.$withParent(r,this)}get init(){return this._init}get cond(){return this._cond}get step(){return this._step}get body(){return this._body}toCode(){var e="for(";return e+=this._init.toCode()+";",e+=this._cond.toCode()+";",e+=this._step.toCode()+")",e+=this._body.toCode()}check(e,t=null){return Object(r.f)(this._step)?(this._setError(a.a.InvalidForStepEmpty),!1):Object(r.f)(this._init)?(this._setError(a.a.InvalidForInitEmptyIterator),!1):this._init.instructionType!==i.b.k_VariableDecl?(this._setError(a.a.InvalidForInitExpr),!1):Object(r.f)(this._cond)?(this._setError(a.a.InvalidForConditionEmpty),!1):this._cond.instructionType!==i.b.k_RelationalExpr?(this._setError(a.a.InvalidForConditionRelation),!1):this._step.instructionType===i.b.k_UnaryExpr||this._step.instructionType===i.b.k_AssignmentExpr||this._step.instructionType===i.b.k_PostfixArithmeticExpr||(this._setError(a.a.InvalidForStepExpr),!1)}}},XQla:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({left:e,right:t,operator:n,...a}){super({instrType:r.b.k_AssignmentExpr,type:e.type,...a}),this._leftValue=i.a.$withParent(e,this),this._rightValue=i.a.$withParent(t,this),this._operator=n}get left(){return this._leftValue}get right(){return this._rightValue}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}}},Zd6l:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("2b0+"),i=n("oseZ");class s extends i.a{constructor({declList:e=null,...t}){super({instrType:r.b.k_DeclStmt,...t}),this._declList=(e||[]).map(e=>a.a.$withParent(e,this))}get declList(){return this._declList}toCode(){for(var e="",t=this.declList,n=0;n<this.declList.length;n++)e+=t[n].toCode()+";\n";return e}}},a1Km:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UnsupportedRenderStateTypeUsed=3e3]="UnsupportedRenderStateTypeUsed",e[e.IncompleteTechnique=3001]="IncompleteTechnique",e[e.IncompletePass=3002]="IncompletePass",e[e.UselessPassState=3003]="UselessPassState"}(r||(r={}))},bxdW:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("FrU9"),a=n("u2cq"),i=n("4AA8"),s=n("2b0+");class o extends i.a{constructor({cond:e,left:t,right:n,...i}){super({instrType:r.b.k_ConditionalExpr,type:t.type,...i}),console.assert(a.d.equals(t.type,n.type,!0)),this._cond=s.a.$withParent(e,this),this._leftValue=s.a.$withParent(t,this),this._rightValue=s.a.$withParent(n,this)}get condition(){return this._cond}get left(){return this._leftValue}get right(){return this._rightValue}toCode(){var e="(";return e+=this.condition.toCode(),e+="?",e+=this.left.toCode(),e+=":",e+=this.right.toCode(),e+=")"}isConst(){return this.condition.isConst()&&this.left.isConst()}}},fb8x:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"i",(function(){return p}));let r=e=>void 0!==e,a=e=>null!=e,i=e=>null===e,s=e=>"boolean"==typeof e,o=e=>"string"==typeof e,l=e=>"number"==typeof e,u=(e,t)=>JSON.stringify(e)===JSON.stringify(t);const c=console.assert.bind(console);console.log.bind(console);function p(e,t){let n=0;for(const r in e)if(!1===t(e[r],r,n++))break}},fjuh:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({operand:e,args:t=null,...n}){super({instrType:r.b.k_CompileExpr,...n}),this._operand=i.a.$withParent(e,this),this._args=(t||[]).map(e=>i.a.$withParent(e,this))}get function(){return this._operand}get args(){return this._args}}},fuca:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({element:e,index:t,...n}){super({instrType:r.b.k_PostfixIndexExpr,type:e.type.arrayElementType,...n}),this.element=i.a.$withParent(e,this),this.index=i.a.$withParent(t,this)}toCode(){return`${this.element.toCode()}[${this.index.toCode()}]`}isConst(){return this.element.isConst()&&this.index.isConst()}}},gf1s:function(e,t,n){"use strict";var r,a,i,s,o,l,u;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.UNDEF=0]="UNDEF",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(r||(r={})),function(e){e[e.UNDEF=0]="UNDEF",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(a||(a={})),function(e){e[e.MAG_FILTER=10240]="MAG_FILTER",e[e.MIN_FILTER=10241]="MIN_FILTER",e[e.WRAP_S=10242]="WRAP_S",e[e.WRAP_T=10243]="WRAP_T"}(i||(i={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP"}(s||(s={})),function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.NEGATIVE_X=1]="NEGATIVE_X",e[e.POSITIVE_Y=2]="POSITIVE_Y",e[e.NEGATIVE_Y=3]="NEGATIVE_Y",e[e.POSITIVE_Z=4]="POSITIVE_Z",e[e.NEGATIVE_Z=5]="NEGATIVE_Z"}(o||(o={})),function(e){e[e.POSITIVE_X=1]="POSITIVE_X",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.POSITIVE_Y=4]="POSITIVE_Y",e[e.NEGATIVE_Y=8]="NEGATIVE_Y",e[e.POSITIVE_Z=12]="POSITIVE_Z",e[e.NEGATIVE_Z=16]="NEGATIVE_Z"}(l||(l={})),function(e){e[e.TEXTURE0=33984]="TEXTURE0"}(u||(u={}))},ggRF:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("fb8x"),a=n("u2cq"),i=n("Wl5j"),s=n("FrU9"),o=n("4AA8"),l=n("2b0+");class u extends o.a{constructor({type:e,args:t=[],...n}){super({instrType:s.b.k_InitExpr,type:e,...n}),this._isArray=!1,this._args=t.map(e=>l.a.$withParent(e,this))}get args(){return this._args}isArray(){return this._isArray}toCode(){let e="";Object(r.f)(this.type)||(e+=this.type.toCode()),e+="(";for(let t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){let e=this.args;for(let t=0;t<e.length;t++)if(!e[t].isConst())return!1;return!0}optimizeForVariableType(e){if(e.isNotBaseArray()&&e.scope.type<=s.c.k_Global||e.isArray()&&this.args.length>1){if(e.length===a.c.UNDEFINE_LENGTH||e.isNotBaseArray()&&this.args.length!==e.length||!e.isNotBaseArray()&&this.args.length!==e.baseType.length)return!1;e.isNotBaseArray()&&(this._isArray=!0);let t=e.arrayElementType,n=!1,r=null;for(let e=0;e<this.args.length;e++)if((r=this.args[e]).instructionType===s.b.k_InitExpr){if(!(n=r.optimizeForVariableType(t)))return!1}else if(i.q(t)){if(r.instructionType!==s.b.k_SamplerStateBlockExpr)return!1}else if(!(n=r.type.isEqual(t)))return!1;return this._type=e.baseType,!0}{let t=this.args[0];if(1===this.args.length&&t.instructionType!==s.b.k_InitExpr)return i.q(e)?t.instructionType===s.b.k_SamplerStateBlockExpr:!!t.type.isEqual(e);if(1===this.args.length)return!1;let n=this.args,r=e.fieldNames;for(let t=0;t<n.length;t++){let a=e.getField(r[t]).type;if(!n[t].optimizeForVariableType(a))return!1}return this._type=e.baseType,!0}}evaluate(){if(!this.isConst())return this._evalResult=null,!1;let e=null;if(this._isArray){e=new Array(this.args.length);for(let t=0;t<this.args.length;t++){let n=this.args[t];n.evaluate()&&(e[t]=n.getEvalValue())}}else if(1===this.args.length){let t=this.args[0];t.evaluate(),e=t.getEvalValue()}else{let t=i.k(this.type),n=new Array(this.args.length);if(Object(r.f)(t))return!1;try{if(i.r(this.type)){let n=this.args[1];if(this.args.length>2||!n.evaluate())return!1;e=t(n.getEvalValue())}else{for(let e=0;e<this.args.length;e++){let t=this.args[e];if(!t.evaluate())return!1;n[e]=t.getEvalValue()}(e=new t).set.apply(e,n)}}catch(e){return!1}}return this._evalResult=e,!0}}},hljw:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("u2cq"),i=n("FrU9"),s=n("2b0+");class o extends s.a{constructor({type:e,usages:t=[],arrayIndex:n=null,writable:l=!0,readable:u=!0,padding:c=a.c.UNDEFINE_PADDING,...p}){super({instrType:i.b.k_VariableType,...p}),e=e.$withNoParent(),this._usageList=[];let d=e.instructionType;if(d===i.b.k_ProxyType||d===i.b.k_SystemType||d===i.b.k_ComplexType)this._subType=e;else{let t=e;t.isNotBaseArray()?this._subType=e:(this._subType=t.subType,t.usages.forEach(e=>this.addUsage(e)))}Object(r.a)(Object(r.e)(this._subType)),Object(r.a)(Object(r.e)(this._usageList)),this._isWritable=l,this._isReadable=u,this._arrayIndexExpr=null,this._arrayElementType=null,this._padding=c,n&&(this._arrayElementType=s.a.$withParent(new o({scope:this.scope,type:this.subType,usages:this._usageList}),this),this._arrayIndexExpr=s.a.$withParent(n,this)),t.forEach(e=>this.addUsage(e))}get name(){return this.baseType.name}get writable(){return!!this._isWritable&&(!(this.isArray()&&!this.isBase()||this.isUniform())&&(!this.isConst()&&this.subType.writable))}get readable(){return!!this._isReadable&&(!this.hasUsage("out")&&this.subType.readable)}get methods(){return this.subType.methods}get size(){if(!Object(r.f)(this._arrayElementType)){const e=this._arrayElementType.size,t=this.length;return t===a.c.UNDEFINE_LENGTH||e===a.c.UNDEFINE_SIZE?a.c.UNDEFINE_SIZE:e*t}return this.subType.size}get baseType(){return this.subType.baseType}get length(){if(!this.isNotBaseArray())return this.subType.length;if(this.isNotBaseArray()&&Object(r.f)(this._arrayElementType))return this.subType.length;if(this._arrayIndexExpr.evaluate()){let e=this._arrayIndexExpr.getEvalValue();if(Object(r.g)(e))return e}return a.c.UNDEFINE_LENGTH}get padding(){return this._padding}get arrayElementType(){return this.isArray()?this._arrayElementType||this.subType.arrayElementType:null}get fieldNames(){return this.subType.fieldNames}get usages(){return this._usageList}get subType(){return this._subType}get fields(){return this.subType.fields}toString(){return this.name||this.subType.toString()||a.d.hash(this)}toCode(){let e="";if(!Object(r.f)(this._usageList))for(let t=0;t<this._usageList.length;t++)e+=this._usageList[t]+" ";return e+=this.subType.toCode()}isEqual(e){return a.d.equals(this,e)}toDeclString(){return this.subType.toDeclString()}isBase(){return this.subType.isBase()&&Object(r.f)(this._arrayElementType)}isArray(){return!Object(r.f)(this._arrayElementType)||this.subType.isArray()}isNotBaseArray(){return!Object(r.f)(this._arrayElementType)||this.subType.isNotBaseArray()}isComplex(){return this.subType.isComplex()}isContainArray(){return this.subType.isContainArray()}isContainSampler(){return this.subType.isContainSampler()}isContainComplexType(){return this.subType.isContainComplexType()}isUniform(){return this.hasUsage("uniform")}isConst(){return this.hasUsage("const")}isSampler(){return!this.isNotBaseArray()&&this.subType.isSampler()}isTexture(){return!this.isNotBaseArray()&&this.subType.isTexture()}isUAV(){return!this.isNotBaseArray()&&this.subType.isUAV()}$overwritePadding(e){this._padding=e}addUsage(e){this.hasUsage(e)||this._usageList.push(e)}hasField(e){return this.subType.hasField(e)}hasFieldWithSematics(e){return this.subType.hasFieldWithSematics(e)}hasAllUniqueSemantics(){return this.subType.hasAllUniqueSemantics()}hasFieldWithoutSemantics(){return this.subType.hasFieldWithoutSemantics()}getField(e){return this.subType.getField(e)}getMethod(e,t){return this.subType.getMethod(e,t)}getFieldBySemantics(e){return this.subType.getFieldBySemantics(e)}hasUsage(e){return!!this._usageList.find(t=>t===e)||!Object(r.f)(this.subType)&&this.subType.instructionType===i.b.k_VariableType&&this.subType.hasUsage(e)}static wrap(e,t){return new o({type:e,scope:t})}static wrapAsConst(e,t){return new o({type:e,scope:t,writable:!1,usages:["const"]})}}},hsO8:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("mXWi"),a=n("2b0+"),i=n("FrU9"),s=n("u2cq");class o extends r.a{constructor({returnType:e,id:t,paramList:n=[],...r}){super({instrType:i.b.k_FunctionDef,...r}),this.params=n.map(e=>a.a.$withParent(e,this)),this.returnType=a.a.$withParent(e,this),this._id=a.a.$withParent(t,this)}get id(){return this._id}get name(){return this._id.name}toString(){let e=s.d.signature(this.returnType)+" "+this.name+"(";for(let t=0;t<this.params.length;t++)e+=s.d.signature(this.params[t].type)+",";return e+=")"}toCode(){const{_id:e,returnType:t,params:n}=this;return`${t.toCode()} ${e.toCode()}(${n.map(e=>e.toCode()).join(", ")})`}}},huhI:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("2b0+"),a=n("oseZ"),i=n("FrU9");class s extends a.a{constructor({expr:e,...t}){super({instrType:i.b.k_ExprStmt,...t}),this._expr=r.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return this._expr.toCode()+";"}}},i81d:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("fb8x"),a=n("Wl5j"),i=n("zioJ"),s=n("FrU9"),o=n("u2cq"),l=n("2b0+");class u extends l.a{constructor({name:e=null,fields:t,...n}){super({instrType:s.b.k_ComplexType,...n}),this._name=e,this._fields={},this._isContainArray=!1,this._isContainSampler=!1,this._isContainComplexType=!1,this.addFields(t.filter(e=>!Object(r.f)(e)).map(e=>l.a.$withParent(e,this)))}get writable(){return!0}get readable(){return!0}get name(){return this._name}get size(){return this.calcSize()}get baseType(){return this}get arrayElementType(){return null}get typeDecl(){return this.parent}get length(){return 0}get fieldNames(){return Object.keys(this._fields)}get fields(){return this.fieldNames.map(e=>this._fields[e])}get methods(){return[]}isSampler(){return!1}isTexture(){return!1}isUAV(){return!1}toString(){return this.name||o.d.hash(this)}toDeclString(){for(var e="struct "+this._name+"{",t=0;t<this.fields.length;t++)e+="\t"+this.fields[t].toCode()+";\n";return e+="}"}isEqual(e){return o.d.equals(this,e)}toCode(){return this._name}isBase(){return!1}isArray(){return!1}isNotBaseArray(){return!1}isComplex(){return!0}isConst(){return!1}isContainArray(){return this._isContainArray}isContainSampler(){return this._isContainSampler}isContainComplexType(){return this._isContainComplexType}addField(e){var t=e.name;this._fields[t]=e;var n=e.type;(n.isNotBaseArray()||n.isContainArray())&&(this._isContainArray=!0),(a.q(n)||n.isContainSampler())&&(this._isContainSampler=!0),n.isComplex()&&(this._isContainComplexType=!0)}addFields(e){for(var t=0;t<e.length;t++)this.addField(e[t]);this.calculatePaddings()}hasField(e){return Object(r.d)(this._fields[e])}hasFieldWithSematics(e){return!!this.getFieldBySemantics(e)}getField(e){return this._fields[e]||null}getMethod(e,t){return null}getFieldBySemantics(e){for(let t in this._fields){let n=this._fields[t];if(e==n.semantic)return n}return null}calcSize(){let e=0;for(let t=0;t<this.fields.length;t++){let n=this.fields[t].type.size;if(n===o.c.UNDEFINE_SIZE){e=o.c.UNDEFINE_SIZE;break}e+=n}return e}hasFieldWithoutSemantics(){for(let e in this._fields){let t=this._fields[e],n=t.semantic;if(null==n||""==n)return!0;if(t.type.hasFieldWithoutSemantics())return!0}return!1}hasAllUniqueSemantics(){let e={};for(let t in this._fields){let n=this._fields[t],a=n.semantic;if(Object(r.e)(e[a]))return!1;if(e[a]=n,n.type.isComplex()&&!n.type.hasAllUniqueSemantics())return!1}return!0}calculatePaddings(){let e=0;for(let t=0;t<this.fields.length;t++){let n=this.fields[t].type,r=n.size;if(r===o.c.UNDEFINE_SIZE)return void this._setError(i.a.CannotCalcPadding,{typeName:this.name});n.$overwritePadding(e),e+=r}}}},iYqf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({instructions:e=[],...t}){super({instrType:r.b.k_Collector,...t}),this._instructions=e}get instructions(){return this._instructions}push(e){this._instructions.push(e)}toCode(){let e="";for(const t of this.instructions)switch(t.instructionType){case r.b.k_VariableDecl:e+=t.toCode()+";\n";break;default:e+=t.toCode()+"\n"}return e}}},"ip/g":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("oseZ");class i extends a.a{constructor({...e}){super({instrType:r.b.k_SemicolonStmt,...e})}toCode(){return";"}}},jfm7:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("fb8x"),a=n("6dfp"),i=n("2blz"),s=n("FrU9"),o=n("gf1s"),l=n("mXWi"),u=n("2b0+");class c extends l.a{constructor({id:e=null,vertexShader:t=null,pixelShader:n=null,renderStates:r={},...a}){super({instrType:s.b.k_PassDecl,...a}),this._passStateMap={},c.clearRenderStateMap(this._passStateMap),c.copyRenderStateMap(r,this._passStateMap),this._vertexShader=u.a.$withNoParent(t),this._pixelShader=u.a.$withNoParent(n),this._id=e}get id(){return this._id}get name(){return Object(r.f)(this._id)?null:this._id.name}get vertexShader(){return this._vertexShader}get pixelShader(){return this._pixelShader}getState(e){return this._passStateMap[e]}get renderStates(){return this._passStateMap}static createRenderStateMap(){let e={};return c.clearRenderStateMap(e),e}static copyRenderStateMap(e,t){Object(r.f)(e)||Object.keys(a.a).filter(e=>Object(r.g)(a.a[e])).map(e=>a.a[e]).forEach(n=>{t[n]=e[n]||t[n]})}static clearRenderStateMap(e){Object.keys(a.a).filter(e=>Object(r.g)(a.a[e])).map(e=>a.a[e]).forEach(t=>{e[t]=i.a.UNDEF})}static createSamplerState(){return{textureName:"",texture:null,wrap_s:o.b.UNDEF,wrap_t:o.b.UNDEF,mag_filter:o.a.UNDEF,min_filter:o.a.UNDEF}}}},"kGK+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("2b0+"),i=n("oseZ");class s extends i.a{constructor({stmtList:e,...t}){super({instrType:r.b.k_StmtBlock,...t}),this._stmtList=e.map(e=>a.a.$withParent(e,this))}get stmtList(){return this._stmtList}toCode(){for(var e="{\n",t=0;t<this.stmtList.length;t++)e+="\t"+this.stmtList[t].toCode()+"\n";return e+="}"}}},"l4+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("FrU9"),i=n("4AA8"),s=n("2b0+");class o extends i.a{constructor({left:e,right:t,operator:n,...r}){super({instrType:a.b.k_ArithmeticExpr,...r}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=n}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}evaluate(){var e=this._leftOperand.evaluate()?this._leftOperand.getEvalValue():null,t=this._rightOperand.evaluate()?this._rightOperand.getEvalValue():null;if(Object(r.f)(e)||Object(r.f)(t))return!1;try{switch(this.operator){case"+":this._evalResult=e+t;break;case"-":this._evalResult=e-t;break;case"*":this._evalResult=e*t;break;case"/":this._evalResult=e/t;break;case"%":this._evalResult=e%t}return!0}catch(e){return!1}}toCode(){var e="";return e+=this._leftOperand.toCode(),e+=this.operator,e+=this._rightOperand.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},mXWi:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({semantic:e=null,annotation:t=null,...n}){super({instrType:r.b.k_Decl,...n}),this._semantic=e,this._annotation=a.a.$withParent(t,this)}get semantic(){return this._semantic}get annotation(){return this._annotation}get name(){return null}get id(){return null}}},onqc:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fb8x"),a=n("FrU9"),i=n("mXWi"),s=n("2b0+");class o extends i.a{constructor({type:e,...t}){super({instrType:a.b.k_TypeDecl,...t}),this.type=s.a.$withParent(e,this),Object(r.a)(Object(r.d)(this.type))}get name(){return this.type.name}toCode(){return this.type.toDeclString()+";"}}},oseZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({...e}){super({instrType:r.b.k_Stmt,...e})}}},pq1u:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FrU9"),a=n("2b0+");class i extends a.a{constructor({name:e,args:t,...n}){super({instrType:r.b.k_Attribute,...n}),this.name=e,this.args=t}toCode(){return`[${this.name}${this.args.length>0?`(${this.args.map(e=>e.toCode()).join(", ")})`:""}]`}}},sQ1Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("FrU9"),a=n("4AA8"),i=n("2b0+");class s extends a.a{constructor({element:e,postfix:t,...n}){super({instrType:r.b.k_PostfixPointExpr,type:t.type,...n}),this.element=i.a.$withParent(e,this),this.postfix=i.a.$withParent(t,this)}toCode(){return`${this.element.toCode()}.${this.postfix.toCode()}`}isConst(){return this.element.isConst()}}},u2cq:function(e,t,n){"use strict";var r,a,i,s,o,l,u=n("fb8x"),c=n("FrU9");(r||(r={})).unwind=function e(t){if(Object(u.f)(t))return null;switch(t.instructionType){case c.b.k_PostfixPointExpr:case c.b.k_PostfixIndexExpr:return e(t.element);case c.b.k_IdExpr:return t.decl;case c.b.k_ArithmeticExpr:return null;case c.b.k_InitExpr:return Object(u.a)(!1,"init expression doesn't support unwind operation"),null;case c.b.k_AssignmentExpr:return e(t.left);case c.b.k_CastExpr:case c.b.k_UnaryExpr:case c.b.k_RelationalExpr:case c.b.k_ConstructorCallExpr:return null;case c.b.k_ComplexExpr:return e(t.expr);case c.b.k_IntExpr:case c.b.k_FloatExpr:case c.b.k_StringExpr:case c.b.k_BoolExpr:case c.b.k_FunctionCallExpr:return null;default:return Object(u.a)(!1,"unsupported expr found"),null}},function(e){function t(e,t){return`${l.signature(e.type,t)}${e.initExpr?"?":""}`}function n(e){return e.params.filter(e=>!e||!e.initExpr).length}e.signature=function(e,n=!1){const{name:r,params:a}=e;return`${r}(${a.map(e=>t(e,n)).join(", ")})`},e.signatureEx=function(e,n=!1){const{name:r,returnType:a,params:i}=e;return`${l.signature(a,n)} ${r}(${i.map(e=>t(e,n)).join(", ")})`},e.numArgsRequired=n,e.match=function(e,t,r=!1){return!(r||!Object(u.f)(t))||!(t.length>e.params.length||n(e)>t.length)&&t.every((t,n)=>!r&&Object(u.f)(t)||!r&&Object(u.f)(e.params[n].type)||l.equals(t,e.params[n].type,r))},e.matchList=function(t,n,r=!1){if(!t)return null;const a=t.filter(t=>e.match(t.def,n,r));return a.length>1?void 0:1===a.length?a[0]:null}}(a||(a={})),(s=i||(i={})).UNDEFINE_LENGTH=16777215,s.UNDEFINE_SIZE=16777215,s.UNDEFINE_PADDING=16777215,s.UNDEFINE_NAME="undef",s.isExpression=function(e){switch(e.instructionType){case c.b.k_ConditionalExpr:case c.b.k_ConstructorCallExpr:case c.b.k_AssignmentExpr:case c.b.k_ArithmeticExpr:case c.b.k_InitExpr:case c.b.k_IdExpr:case c.b.k_FunctionCallExpr:case c.b.k_FloatExpr:case c.b.k_IntExpr:case c.b.k_BoolExpr:case c.b.k_PostfixArithmeticExpr:case c.b.k_PostfixIndexExpr:case c.b.k_PostfixPointExpr:case c.b.k_ComplexExpr:case c.b.k_CastExpr:case c.b.k_UnaryExpr:return!0}return!1},s.isStatement=function(e){switch(e.instructionType){case c.b.k_Stmt:case c.b.k_DeclStmt:case c.b.k_ReturnStmt:case c.b.k_IfStmt:case c.b.k_StmtBlock:case c.b.k_ExprStmt:case c.b.k_WhileStmt:case c.b.k_ForStmt:case c.b.k_BreakStmt:case c.b.k_SemicolonStmt:return!0}return!1},s.isLiteral=function(e){switch(e.instructionType){case c.b.k_IntExpr:case c.b.k_FloatExpr:case c.b.k_BoolExpr:case c.b.k_StringExpr:return!0}return!1},function(e){function t(e){return e.isParameter()?(Object(u.a)(e.parent.instructionType===c.b.k_FunctionDef),e.parent.params.indexOf(e)):(console.error("invalid call."),-1)}e.parameterIndex=t,e.parameterOffset=function(e){if(!e.isParameter())return console.error("invalid call."),0;let n=t(e),r=0;for(let t=0;t<n;++t)r+=e.parent.params[t].type.size;return r},e.fullName=function(e){if(e.isField()&&l.findParentVariableDecl(e.parent)){let t="";return e.parent.instructionType===c.b.k_VariableType&&(t=l.resolveVariableDeclFullName(e.parent)),t+="."+e.name}return e.name},e.resolveRegister=function(e){let t=null,n=-1;const r=e.semantic;if(r){const e=r.match(/^register\(([utbs]{1})([\d]+)\)$/);e&&(t=e[1],n=Number(e[2]))}return e.type.isUAV()&&(Object(u.a)(null===t||"u"===t),t="u"),e.type.isTexture()&&(Object(u.a)(null===t||"t"===t),t="t"),e.type.isSampler()&&(Object(u.a)(null===t||"s"===t),t="s"),{type:t,index:n}}}(o||(o={})),function(e){function t(e){if(Object(u.f)(e.parent))return!1;const n=e.parent.instructionType;return n===c.b.k_VariableDecl||n===c.b.k_VariableType&&t(e.parent)}function n(e){if(Object(u.f)(e.parent))return!1;if(e.parent.instructionType===c.b.k_VariableDecl){return e.parent.isField()}return!1}function r(e){if(!t(e))return null;return e.parent.instructionType===c.b.k_VariableDecl?e.parent:r(e.parent)}function a(e){if(!t(e))return null;return e.parent.instructionType===c.b.k_TypeDecl?e.parent:a(e.parent)}function s(e,t=!1){if(Object(u.f)(e))return Object(u.a)(!t),"*";switch(e.instructionType){case c.b.k_VariableType:return function(e,t){let n="";t&&e.usages.length>0&&(n=`${e.usages.join("_")}_`);let r="";return e.isNotBaseArray()&&(r="[]",e.length!==i.UNDEFINE_LENGTH&&(r=`[${e.length}]`)),`${n}${s(e.subType)}${r}`}(e,t);case c.b.k_ComplexType:return`${e.name}${e.instructionID}`;case c.b.k_ProxyType:return e.baseType?s(e.baseType):e.name;case c.b.k_SystemType:return e.name;default:return Object(u.a)(!1,"unsupported type"),null}}function l(e,t=!1){switch(e.instructionType){case c.b.k_VariableType:return function(e,t){let n="";return(t?e.isArray():e.isNotBaseArray())&&(n="[]",e.length!==i.UNDEFINE_LENGTH&&(n=`[${e.length}]`)),`${l(e.subType)}${n}`}(e,t);case c.b.k_ComplexType:return function(e,t){return`{${e.fields.map(e=>l(e.type,t)).join(";")}}`}(e,t);case c.b.k_ProxyType:return e.baseType?l(e.baseType):e.name;case c.b.k_SystemType:return e.name;default:return Object(u.a)(!1,"unsupported type"),null}}function p(e,t,n=!1){if(Object(u.f)(e)||Object(u.f)(t))return!1;if(e instanceof RegExp&&t instanceof RegExp)return Object(u.a)(!1),!1;if(e instanceof RegExp){let r=e;return!!s(t,n).match(r)}if(t instanceof RegExp){let r=t;return!!s(e,n).match(r)}let r=e,a=t;return(!r.isArray()||!a.isArray()||r.length!==i.UNDEFINE_LENGTH&&a.length!==i.UNDEFINE_LENGTH)&&s(r,n)===s(a,n)}e.isInheritedFromVariableDecl=t,e.isTypeOfField=n,e.findParentContainer=function(e){if(!t(e)||!n(e))return null;let a=r(e).parent;return t(a)?r(a):null},e.findParentVariableDecl=r,e.findParentVariableDeclName=function(e){let t=r(e);return Object(u.f)(t)?null:t.name},e.finParentTypeDecl=a,e.finParentTypeDeclName=function(e){let t=a(e);return Object(u.f)(t)?null:t.name},e.resolveVariableDeclFullName=function(e){return t(e)?o.fullName(r(e)):(console.error("Not from variable decl"),null)},e.findMainVariable=function e(a){return t(a)?n(a)?e(a.parent.parent):r(a):null},e.signature=s,e.hash=l,e.compareRelaxed=function(e,t,n=!1){return l(e,n)===l(t,n)},e.compare=p,e.equals=function(e,t,n=!1){return p(e,t,n)}}(l||(l={})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return l}))},wEKK:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("Wl5j"),a=n("FrU9"),i=n("4AA8"),s=n("2b0+");class o extends i.a{constructor({left:e,right:t,operator:n,...i}){super({instrType:a.b.k_LogicalExpr,type:r.b,...i}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=n}get operator(){return this._operator}get left(){return this._leftOperand}get right(){return this._rightOperand}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},wsMd:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("4AA8"),a=n("Wl5j"),i=n("FrU9");class s extends r.a{constructor({left:e,right:t,operator:n,...r}){super({instrType:i.b.k_RelationalExpr,type:a.b,...r}),this._leftOperand=e,this._rightOperand=t,this._operator=n}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},"zX2+":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.k_Warning=0]="k_Warning",e[e.k_Error=1]="k_Error"}(r||(r={}))},zioJ:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.SystemTypeRedefinition=2202]="SystemTypeRedefinition",e[e.TypeRedefinition=2203]="TypeRedefinition",e[e.VariableRedefinition=2204]="VariableRedefinition",e[e.SystemVariableRedefinition=2205]="SystemVariableRedefinition",e[e.FunctionRedifinition=2206]="FunctionRedifinition",e[e.SystemFunctionRedefinition=2207]="SystemFunctionRedefinition",e[e.UnsupportedTypeDecl=2208]="UnsupportedTypeDecl",e[e.UnsupportedExpr=2209]="UnsupportedExpr",e[e.UnknownVarName=2210]="UnknownVarName",e[e.InvalidArithmeticOperation=2211]="InvalidArithmeticOperation",e[e.InvalidArithmeticAssigmentOperation=2212]="InvalidArithmeticAssigmentOperation",e[e.InvalidAssigmentOperation=2213]="InvalidAssigmentOperation",e[e.InvalidLeftHandSideInAssignment=2214]="InvalidLeftHandSideInAssignment",e[e.InvalidRelationalOperation=2215]="InvalidRelationalOperation",e[e.InvalidLogicOperation=2216]="InvalidLogicOperation",e[e.InvalidConditionType=2217]="InvalidConditionType",e[e.InvalidConditonValueTypes=2218]="InvalidConditonValueTypes",e[e.InvalidCastTypeUsage=2219]="InvalidCastTypeUsage",e[e.InvalidCastTypeNotBase=2220]="InvalidCastTypeNotBase",e[e.InvalidCastUnknownType=2221]="InvalidCastUnknownType",e[e.InvalidUnaryOperation=2222]="InvalidUnaryOperation",e[e.InvalidPostfixNotArray=2223]="InvalidPostfixNotArray",e[e.InvalidPostfixNotIntIndex=2224]="InvalidPostfixNotIntIndex",e[e.InvalidPostfixNotField=2225]="InvalidPostfixNotField",e[e.InvalidPostfixArithmetic=2226]="InvalidPostfixArithmetic",e[e.InvalidComplexNotFunction=2227]="InvalidComplexNotFunction",e[e.InvalidComplexNotType=2228]="InvalidComplexNotType",e[e.InvalidComplexNotConstructor=2229]="InvalidComplexNotConstructor",e[e.InvalidCompileNotFunction=2230]="InvalidCompileNotFunction",e[e.InvalidCompileFunctionNotValid=2231]="InvalidCompileFunctionNotValid",e[e.FunctionRedefinition=2232]="FunctionRedefinition",e[e.InvalidWhileCondition=2233]="InvalidWhileCondition",e[e.InvalidDoWhileCondition=2234]="InvalidDoWhileCondition",e[e.InvalidIfCondition=2235]="InvalidIfCondition",e[e.InvalidForInitExpr=2236]="InvalidForInitExpr",e[e.InvalidForInitEmptyIterator=2237]="InvalidForInitEmptyIterator",e[e.InvalidForConditionEmpty=2238]="InvalidForConditionEmpty",e[e.InvalidForConditionRelation=2239]="InvalidForConditionRelation",e[e.InvalidForStepEmpty=2240]="InvalidForStepEmpty",e[e.InvalidForStepOperator=2241]="InvalidForStepOperator",e[e.InvalidForStepExpr=2242]="InvalidForStepExpr",e[e.InvalidNewFieldForStructName=2243]="InvalidNewFieldForStructName",e[e.InvalidNewFieldForStructSematic=2244]="InvalidNewFieldForStructSematic",e[e.InvalidNewAnnotationVar=2245]="InvalidNewAnnotationVar",e[e.InvalidFunctionParameterDefenitionDefaultNeeded=2246]="InvalidFunctionParameterDefenitionDefaultNeeded",e[e.CannotChooseFunction=2247]="CannotChooseFunction",e[e.InvalidFuncDefenitionReturnType=2248]="InvalidFuncDefenitionReturnType",e[e.InvalidSystemFunctionReturnType=2249]="InvalidSystemFunctionReturnType",e[e.InvalidTypeNameNotType=2250]="InvalidTypeNameNotType",e[e.InvalidTypeNameTemplateNotFound=2251]="InvalidTypeNameTemplateNotFound",e[e.InvalidTypeScope=2252]="InvalidTypeScope",e[e.CannotProduceType=2253]="CannotProduceType",e[e.InvalidTypeVectorMatrix=2254]="InvalidTypeVectorMatrix",e[e.TechniqueNameRedefinition=2255]="TechniqueNameRedefinition",e[e.InvalidFunctionRecursionNotAllowed=2256]="InvalidFunctionRecursionNotAllowed",e[e.InvalidFunctionImplementationNotFound=2257]="InvalidFunctionImplementationNotFound",e[e.FunctionIsNotCompatibleWithVertexShader=2258]="FunctionIsNotCompatibleWithVertexShader",e[e.FunctionIsNotCompatibleWithPixelShader=2259]="FunctionIsNotCompatibleWithPixelShader",e[e.InvalidReturnStmtVoid=2260]="InvalidReturnStmtVoid",e[e.InvalidReturnStmtEmpty=2261]="InvalidReturnStmtEmpty",e[e.InvalidReturnStmtTypesNotEqual=2262]="InvalidReturnStmtTypesNotEqual",e[e.InvalidFunctionReturnType=2263]="InvalidFunctionReturnType",e[e.InvalidFunctionParameterUsage=2264]="InvalidFunctionParameterUsage",e[e.InvalidTypeForWriting=2265]="InvalidTypeForWriting",e[e.InvalidTypeForReading=2266]="InvalidTypeForReading",e[e.InvalidExprIsNotLValue=2267]="InvalidExprIsNotLValue",e[e.InvalidVariableInitializing=2268]="InvalidVariableInitializing",e[e.UnsupportedStateIndex=2269]="UnsupportedStateIndex",e[e.InvalidSamplerTexture=2270]="InvalidSamplerTexture",e[e.CannotCalcPadding=2271]="CannotCalcPadding",e[e.ImportedComponentNotExists=2272]="ImportedComponentNotExists",e[e.InvalidFunctionReturnStmtNotFound=2273]="InvalidFunctionReturnStmtNotFound",e[e.UnsupportedProvideAs=2274]="UnsupportedProvideAs",e[e.UnreachableCode=2275]="UnreachableCode",e[e.PartFx_VertexShaderParametersMismatch=2276]="PartFx_VertexShaderParametersMismatch",e[e.PartFx_InvalidSpawnStmtInitializerNotFound=2277]="PartFx_InvalidSpawnStmtInitializerNotFound"}(r||(r={}))}});
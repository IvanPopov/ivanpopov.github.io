/*! For license information please see 46e4858df39b7f78bf8b.worker.js.LICENSE */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="Vs+U")}({"+Z36":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("mXWi"),i=r("2b0+");class s extends a.a{constructor({name:e,techniqueType:t,passList:r,...a}){super({instrType:n.b.k_TechniqueDecl,...a}),this._name=e,this._passList=r.map(e=>i.a.$withParent(e,this)),this._techniqueType=t}get name(){return this._name}get passList(){return this._passList}get type(){return this._techniqueType}}},"/zHR":function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("zX2+");function a(e){return`${e.line},${e.column}`}function i(e,t){return e.replace(/{([a-zA-Z.]+)}/g,(e,r)=>(function e(t,r){let n=r.split(".");return n.length>1?e(t[n[0]],n.splice(1).join(".")):t[n[0]]})(t,r))}class s extends Error{constructor(e,t){super(t.content),Error.captureStackTrace(this,s)}}class o{constructor(e,t){this._name=e,this._codePrefix=(t||"").toUpperCase(),this.reset()}emitException(){throw new s(this,this.getLastError())}reset(){this._entries=[]}resolve(){let e={errors:0,warnings:0,messages:[]};for(let t of this._entries){let r=this.resolveEntry(t);switch(r.category){case n.a.k_Warning:e.warnings++;break;case n.a.k_Error:e.errors++}e.messages.push(r)}return e}resolveEntry(e){let t,r,n,i=null,s=this.resolveFilename(e.code,e.desc);(t=this.resolveRange(e.code,e.desc))?(({start:r,end:n}=t),i=function(e){return`${a(e.start)}:${a(e.end)}`}(t)):i=a(r=this.resolvePosition(e.code,e.desc));let o=`${this.resolveDescription(e.code,e.category,e.desc)}`;return{code:`${this._codePrefix}${e.code}`,category:e.category,content:o,file:s,start:r,end:n}}resolveFilename(e,t){return"[unknown]"}resolvePosition(e,t){return{file:null,line:0,column:0}}resolveRange(e,t){return null}resolveDescription(e,t,r){let n=this.diagnosticMessages();return n?n[e]?i(n[e],r):`[no description found for code '${e}']`:(console.error(`Diagnostic messages of '${this._name}' not found.`),"[no description found]")}diagnosticMessages(){return null}error(e,t){this._entries.push({category:n.a.k_Error,code:e,desc:t})}warning(e,t){this._entries.push({category:n.a.k_Warning,code:e,desc:t})}critical(e,t){this.error(e,t),this.emitException()}prettyPrint(){return null}hasErrors(){return this._entries.filter(e=>e.category===n.a.k_Error).length>0}getLastError(){for(let e=this._entries.length-1;e>=0;--e)if(this._entries[e].category===n.a.k_Error)return this.resolveEntry(this._entries[e]);return null}static mergeReports(e){let t={errors:0,warnings:0,messages:[]};return e.forEach(e=>{t.errors+=e.errors,t.warnings+=e.warnings,t.messages=t.messages.concat(e.messages)}),t}static stringify(e){return e.messages.map(e=>e.content).join("\n")}static asRange(e){let t={start:e.start,end:e.end};t.end||(t.end={...t.start});const{start:r,end:n}=t;return n.line==r.line&&n.column==r.column&&(n.column+=1),t}}},"1O8D":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("2b0+"),s=r("oseZ");class o extends s.a{constructor({cond:e,conseq:t,attributes:r=null,contrary:n=null,...s}){super({instrType:a.b.k_IfStmt,...s}),this.cond=i.a.$withParent(e,this),this.conseq=i.a.$withParent(t,this),this.contrary=i.a.$withParent(n,this),this.attributes=(r||[]).map(e=>i.a.$withParent(e,this))}toCode(){var e="";return Object(n.f)(this.contrary)?(e+="if(",e+=this.cond.toCode()+")",e+=this.conseq.toCode()):(e+="if(",e+=this.cond.toCode()+") ",e+=this.conseq.toCode(),e+="else ",e+=this.contrary.toCode()),e}}},"2b0+":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fb8x"),a=r("FrU9");class i{constructor({scope:e,instrType:t,sourceNode:r=null,visible:n=!0}){this._sourceNode=r,this._instructionType=t,this._instructionID=i.INSTRUCTION_COUNTER++,this._scope=e,this._parent=null,this._lastError=null}get parent(){return this._parent}get instructionType(){return console.assert(this._instructionType!=a.b.k_Instruction,"Instruction type 'k_Instruction' is forbidden."),this._instructionType}get instructionName(){return a.b[this.instructionType]}get instructionID(){return this._instructionID}get scope(){return Object(n.f)(this._scope)?Object(n.f)(this.parent)?null:this.parent.scope:this._scope}get sourceNode(){return this._sourceNode}_getLastError(){return this._lastError}_setError(e,t=null){this._lastError={code:e,info:t}}_clearError(){this._lastError=null}_isErrorOccured(){return!Object(n.f)(this._lastError)}_check(e,t=null){return!this._isErrorOccured()}toString(){return console.error("@pure_virtual"),null}toCode(){return console.error("@pure_virtual"),null}$withParent(e){return console.assert(null==this._parent,"parent redefenition detected!"),this.instructionType===a.b.k_SystemType&&"float"===this.name&&this._parent,this._parent=e,this}$withNoParent(){return this}static $withParent(e,t){return Object(n.f)(e)?null:e.$withParent(t)}static $withNoParent(e){return Object(n.f)(e)?null:e.$withNoParent()}}i.INSTRUCTION_COUNTER=0},"2blz":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.UNDEF=0]="UNDEF",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.ZERO=3]="ZERO",e[e.ONE=4]="ONE",e[e.SRCCOLOR=5]="SRCCOLOR",e[e.INVSRCCOLOR=6]="INVSRCCOLOR",e[e.SRCALPHA=7]="SRCALPHA",e[e.INVSRCALPHA=8]="INVSRCALPHA",e[e.DESTALPHA=9]="DESTALPHA",e[e.INVDESTALPHA=10]="INVDESTALPHA",e[e.DESTCOLOR=11]="DESTCOLOR",e[e.INVDESTCOLOR=12]="INVDESTCOLOR",e[e.SRCALPHASAT=13]="SRCALPHASAT",e[e.NONE=14]="NONE",e[e.CW=15]="CW",e[e.CCW=16]="CCW",e[e.FRONT=17]="FRONT",e[e.BACK=18]="BACK",e[e.FRONT_AND_BACK=19]="FRONT_AND_BACK",e[e.NEVER=20]="NEVER",e[e.LESS=21]="LESS",e[e.EQUAL=22]="EQUAL",e[e.LESSEQUAL=23]="LESSEQUAL",e[e.GREATER=24]="GREATER",e[e.NOTEQUAL=25]="NOTEQUAL",e[e.GREATEREQUAL=26]="GREATEREQUAL",e[e.ALWAYS=27]="ALWAYS",e[e.FUNCADD=28]="FUNCADD",e[e.FUNCSUBTRACT=29]="FUNCSUBTRACT",e[e.FUNCREVERSESUBTRACT=30]="FUNCREVERSESUBTRACT",e[e.LINELIST=31]="LINELIST",e[e.LINESTRIP=32]="LINESTRIP",e[e.TRIANGLELIST=33]="TRIANGLELIST",e[e.TRAINGLESTRIP=34]="TRAINGLESTRIP",e[e.POINTLIST=35]="POINTLIST"}(n||(n={}))},"2xh7":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({sourceExpr:e,...t}){super({instrType:n.b.k_CastExpr,...t}),this.expr=i.a.$withParent(e,this)}toCode(){return`(${this.type.toCode()})${this.expr.toCode()}`}isUseless(){return this.type.isEqual(this.expr.type)}isConst(){return this.expr.isConst()}}},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"49qt":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("4AA8"),a=r("hljw"),i=r("Wl5j"),s=r("FrU9");class o extends n.a{constructor({value:e,scope:t,...r}){super({instrType:s.b.k_FloatExpr,type:a.a.wrapAsConst(i.c,i.a),scope:t,...r}),this._value=1*e}get value(){return this._value}toString(){return String(this._value)}toCode(){var e="";return e+=this._value.toString(),this._value%1==0&&(e+="."),e}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},"4AA8":function(e,t,r){"use strict";var n=r("fb8x"),a=r("FrU9"),i=r("2b0+");class s extends i.a{constructor({type:e,...t}){super({instrType:a.b.k_Typed,...t}),this._type=i.a.$withNoParent(e),Object(n.f)(this._type)&&console.warn("Something goes wrong! Type is not specified!",this)}get type(){return this._type}}r.d(t,"a",(function(){return o}));class o extends s{constructor({...e}){super({instrType:a.b.k_Expr,...e}),this._evalResult=null}get type(){return super.type}evaluate(){return console.error("@pure_virtual"),!1}getEvalValue(){return this._evalResult}isConst(){return!1}isConstExpr(){return!0}}},"4cxW":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({decl:e,args:t,callee:r,...a}){super({instrType:n.b.k_FunctionCallExpr,...a}),this.callee=r,this.args=(t||[]).map(e=>i.a.$withParent(e,this)),this.decl=e}toCode(){const{callee:e,decl:{def:t},args:r}=this;return`${e?e.toCode()+".":""}${t.id.toCode()}(${r.map(e=>e.toCode()).join(",")})`}}},"5EX4":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("4AA8"),a=r("hljw"),i=r("Wl5j"),s=r("FrU9");class o extends n.a{constructor({value:e,scope:t,...r}){super({instrType:s.b.k_BoolExpr,type:a.a.wrapAsConst(i.b,i.a),scope:t,...r}),this._value="true"===e}set value(e){this._value=e}get value(){return this._value}toString(){return String(this._value)}toCode(){return this._value?"true":"false"}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},"5fm/":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({id:e,decl:t,...r}){super({instrType:n.b.k_IdExpr,type:t.type,...r}),this.id=i.a.$withParent(e,this),this.decl=t}get name(){return this.id.name}isConst(){return this.type.isConst()}evaluate(){return!1}toCode(){return this.decl.id.toCode()}}},"6dfp":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.BLENDENABLE=0]="BLENDENABLE",e[e.CULLFACEENABLE=1]="CULLFACEENABLE",e[e.ZENABLE=2]="ZENABLE",e[e.ZWRITEENABLE=3]="ZWRITEENABLE",e[e.DITHERENABLE=4]="DITHERENABLE",e[e.SCISSORTESTENABLE=5]="SCISSORTESTENABLE",e[e.STENCILTESTENABLE=6]="STENCILTESTENABLE",e[e.POLYGONOFFSETFILLENABLE=7]="POLYGONOFFSETFILLENABLE",e[e.CULLFACE=8]="CULLFACE",e[e.FRONTFACE=9]="FRONTFACE",e[e.SRCBLENDCOLOR=10]="SRCBLENDCOLOR",e[e.DESTBLENDCOLOR=11]="DESTBLENDCOLOR",e[e.SRCBLENDALPHA=12]="SRCBLENDALPHA",e[e.DESTBLENDALPHA=13]="DESTBLENDALPHA",e[e.BLENDEQUATIONCOLOR=14]="BLENDEQUATIONCOLOR",e[e.BLENDEQUATIONALPHA=15]="BLENDEQUATIONALPHA",e[e.ZFUNC=16]="ZFUNC",e[e.ALPHABLENDENABLE=17]="ALPHABLENDENABLE",e[e.ALPHATESTENABLE=18]="ALPHATESTENABLE",e[e.SRCBLEND=19]="SRCBLEND",e[e.DESTBLEND=20]="DESTBLEND",e[e.BLENDFUNC=21]="BLENDFUNC",e[e.BLENDFUNCSEPARATE=22]="BLENDFUNCSEPARATE",e[e.BLENDEQUATION=23]="BLENDEQUATION",e[e.BLENDEQUATIONSEPARATE=24]="BLENDEQUATIONSEPARATE",e[e.PRIMITIVETOPOLOGY=25]="PRIMITIVETOPOLOGY"}(n||(n={}))},"7VRG":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("oseZ");class i extends a.a{constructor({operator:e="break",...t}){super({instrType:n.b.k_BreakStmt,...t}),this._operator=e}get operator(){return this._operator}toCode(){return console.assert("break"==this.operator),this.operator+";"}}},"9EOq":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({moduleName:e,...t}){super({instrType:n.b.k_Provide,...t}),this._value=e}get moduleName(){return this._value}toString(){return this._value}toCode(){return this._value}}},"9hKy":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("u2cq"),s=r("2b0+");class o extends s.a{constructor(e){super({instrType:a.b.k_ProxyType,...e}),this._host=null}get host(){return this._host}get writable(){return!this.isResolved()||this.host.writable}get readable(){return!this.isResolved()||this.host.writable}get name(){return this.isResolved()?this.host.name:"auto"}get size(){return this.isResolved()?this.host.size:i.c.UNDEFINE_SIZE}get baseType(){return this.host}get arrayElementType(){return this.isResolved()?this.host.arrayElementType:null}get typeDecl(){return this.parent}get length(){return this.isResolved()?this.host.length:i.c.UNDEFINE_LENGTH}get fieldNames(){return this.isResolved()?this.host.fieldNames:[]}get fields(){return this.isResolved()?this.host.fields:[]}get methods(){return[]}isResolved(){return!Object(n.f)(this.host)}resolve(e){this._host=e}isSampler(){return!!this.isResolved()&&this.host.isSampler()}isTexture(){return!!this.isResolved()&&this.host.isTexture()}isUAV(){return!!this.isResolved()&&this.host.isUAV()}toString(){return this.isResolved()?this.host.toString():this.name}toDeclString(){return this.isResolved()?this.host.toDeclString():null}isEqual(e){return i.d.equals(this,e)}toCode(){return this.isResolved()?this.host.toCode():this.name}isBase(){return!!this.isResolved()&&this.host.isBase()}isArray(){return!!this.isResolved()&&this.host.isArray()}isNotBaseArray(){return!!this.isResolved()&&this.host.isNotBaseArray()}isComplex(){return!!this.isResolved()&&this.host.isComplex()}isConst(){return!!this.isResolved()&&this.host.isConst()}isContainArray(){return!!this.isResolved()&&this.host.isContainArray()}isContainSampler(){return!!this.isResolved()&&this.host.isContainSampler()}isContainComplexType(){return!!this.isResolved()&&this.host.isContainComplexType()}hasField(e){return!!this.isResolved()&&this.host.hasField(e)}hasFieldWithSematics(e){return!!this.isResolved()&&this.host.hasFieldWithSematics(e)}getField(e){return this.isResolved()?this.host.getField(e):null}getMethod(e,t){return this.isResolved()?this.host.getMethod(e,t):null}getFieldBySemantics(e){return this.isResolved()?this.host.getFieldBySemantics(e):null}hasFieldWithoutSemantics(){return!!this.isResolved()&&this.host.hasFieldWithoutSemantics()}hasAllUniqueSemantics(){return!!this.isResolved()&&this.host.hasAllUniqueSemantics()}}},"9vj8":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("4AA8"),a=r("hljw"),i=r("Wl5j"),s=r("FrU9");class o extends n.a{constructor({value:e,scope:t,...r}){super({instrType:s.b.k_StringExpr,type:a.a.wrapAsConst(i.g,i.a),scope:t,...r}),this._value=e}get value(){return this._value}toString(){return this._value}toCode(){return this._value}evaluate(){return this._evalResult=this._value,!0}isConst(){return!0}}},BKBR:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("mXWi"),i=r("2b0+");class s extends a.a{constructor({definition:e,implementation:t=null,attributes:r=null,...a}){super({instrType:n.b.k_FunctionDecl,...a}),this.def=i.a.$withParent(e,this),this.impl=i.a.$withParent(t,this),this.attributes=(r||[]).map(e=>i.a.$withParent(e,this))}get name(){return this.def.name}get id(){return this.def.id}get semantic(){return this.def.semantic}toCode(){let e="";return e+=this.def.toCode(),this.impl?e+=this.impl.toCode():e+=";",e}}},C2sc:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({name:e,...t}){super({instrType:n.b.k_Id,...t}),this.name=e}toString(){return this.name}toCode(){return this.name}}},C3oy:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({expr:e,operator:t,...r}){super({instrType:n.b.k_PostfixArithmeticExpr,type:e.type,...r}),this._operator=t,this._expr=i.a.$withParent(e,this)}get expr(){return this._expr}get operator(){return this._operator}toCode(){var e="";return e+=this.expr.toCode(),e+=this.operator}isConst(){return this.expr.isConst()}}},DTTp:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r("FrU9");function a(e,t){if(!e)return;const r=r=>{r&&(t(r,e),a(r,t))};switch(e.instructionType){case n.b.k_ReturnStmt:r(e.expr);break;case n.b.k_DeclStmt:e.declList.forEach(e=>r(e));break;case n.b.k_ExprStmt:r(e.expr);break;case n.b.k_IfStmt:r(e.cond),r(e.conseq),r(e.contrary);break;case n.b.k_StmtBlock:e.stmtList.forEach(e=>r(e));break;case n.b.k_ForStmt:r(e.init),r(e.cond),r(e.body),r(e.step);break;case n.b.k_WhileStmt:r(e.cond),r(e.body);break;case n.b.k_ArithmeticExpr:case n.b.k_AssignmentExpr:r(e.left),r(e.right);break;case n.b.k_CastExpr:r(e.expr);break;case n.b.k_CompileExpr:e.args.forEach(e=>r(e));break;case n.b.k_ComplexExpr:r(e.expr);break;case n.b.k_ConditionalExpr:r(e.left),r(e.right),r(e.condition);break;case n.b.k_ConstructorCallExpr:case n.b.k_FunctionCallExpr:e.args.forEach(e=>r(e));break;case n.b.k_IdExpr:r(e.id);break;case n.b.k_InitExpr:e.args.forEach(e=>r(e));break;case n.b.k_IntExpr:case n.b.k_FloatExpr:case n.b.k_BoolExpr:case n.b.k_StringExpr:break;case n.b.k_LogicalExpr:r(e.left),r(e.right);break;case n.b.k_PostfixArithmeticExpr:r(e.expr);break;case n.b.k_PostfixIndexExpr:r(e.element),r(e.index);break;case n.b.k_PostfixPointExpr:r(e.element),r(e.postfix);break;case n.b.k_RelationalExpr:r(e.left),r(e.right);break;case n.b.k_SamplerStateBlockExpr:e.params.forEach(e=>r(e)),r(e.texture);break;case n.b.k_UnaryExpr:r(e.expr);break;case n.b.k_ComplexType:e.fields.forEach(e=>r(e));break;case n.b.k_FunctionDef:r(e.returnType),r(e.id),e.params.forEach(e=>r(e));break;case n.b.k_FunctionDecl:r(e.def),r(e.impl);break;case n.b.k_VariableDecl:r(e.type),r(e.initExpr),r(e.id);break;case n.b.k_VariableType:r(e.subType);break;case n.b.k_Id:break;case n.b.k_SystemFunctionDecl:case n.b.k_SystemType:case n.b.k_BreakStmt:break;default:console.error("unsupported instruction type found")}}const i={each:a}},FrU9:function(e,t,r){"use strict";var n,a,i,s,o,l;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return l})),function(e){e[e.k_Instruction=0]="k_Instruction",e[e.k_Id=1]="k_Id",e[e.k_Provide=2]="k_Provide",e[e.k_Collector=3]="k_Collector",e[e.k_Keyword=4]="k_Keyword",e[e.k_Simple=5]="k_Simple",e[e.k_SamplerState=6]="k_SamplerState",e[e.k_Attribute=7]="k_Attribute",e[e.k_Annotation=8]="k_Annotation",e[e.k_UsageType=9]="k_UsageType",e[e.k_Typed=10]="k_Typed",e[e.k_VariableType=11]="k_VariableType",e[e.k_SystemType=12]="k_SystemType",e[e.k_ComplexType=13]="k_ComplexType",e[e.k_ProxyType=14]="k_ProxyType",e[e.k_Expr=15]="k_Expr",e[e.k_IdExpr=16]="k_IdExpr",e[e.k_IntExpr=17]="k_IntExpr",e[e.k_FloatExpr=18]="k_FloatExpr",e[e.k_BoolExpr=19]="k_BoolExpr",e[e.k_StringExpr=20]="k_StringExpr",e[e.k_ArithmeticExpr=21]="k_ArithmeticExpr",e[e.k_AssignmentExpr=22]="k_AssignmentExpr",e[e.k_RelationalExpr=23]="k_RelationalExpr",e[e.k_LogicalExpr=24]="k_LogicalExpr",e[e.k_ConditionalExpr=25]="k_ConditionalExpr",e[e.k_CastExpr=26]="k_CastExpr",e[e.k_UnaryExpr=27]="k_UnaryExpr",e[e.k_PostfixIndexExpr=28]="k_PostfixIndexExpr",e[e.k_PostfixPointExpr=29]="k_PostfixPointExpr",e[e.k_PostfixArithmeticExpr=30]="k_PostfixArithmeticExpr",e[e.k_ComplexExpr=31]="k_ComplexExpr",e[e.k_FunctionCallExpr=32]="k_FunctionCallExpr",e[e.k_ConstructorCallExpr=33]="k_ConstructorCallExpr",e[e.k_CompileExpr=34]="k_CompileExpr",e[e.k_InitExpr=35]="k_InitExpr",e[e.k_SamplerStateBlockExpr=36]="k_SamplerStateBlockExpr",e[e.k_Decl=37]="k_Decl",e[e.k_TypeDecl=38]="k_TypeDecl",e[e.k_VariableDecl=39]="k_VariableDecl",e[e.k_StructDecl=40]="k_StructDecl",e[e.k_FunctionDecl=41]="k_FunctionDecl",e[e.k_SystemFunctionDecl=42]="k_SystemFunctionDecl",e[e.k_FunctionDef=43]="k_FunctionDef",e[e.k_PassDecl=44]="k_PassDecl",e[e.k_TechniqueDecl=45]="k_TechniqueDecl",e[e.k_Stmt=46]="k_Stmt",e[e.k_ExprStmt=47]="k_ExprStmt",e[e.k_BreakStmt=48]="k_BreakStmt",e[e.k_WhileStmt=49]="k_WhileStmt",e[e.k_ForStmt=50]="k_ForStmt",e[e.k_IfStmt=51]="k_IfStmt",e[e.k_DeclStmt=52]="k_DeclStmt",e[e.k_ReturnStmt=53]="k_ReturnStmt",e[e.k_SemicolonStmt=54]="k_SemicolonStmt",e[e.k_StmtBlock=55]="k_StmtBlock",e[e.k_PartFxDecl=56]="k_PartFxDecl",e[e.k_PartFxPass=57]="k_PartFxPass"}(n||(n={})),function(e){e[e.CODE_TARGET_SUPPORT=0]="CODE_TARGET_SUPPORT",e[e.SELF_CONTAINED=1]="SELF_CONTAINED"}(a||(a={})),function(e){e[e.k_Read=0]="k_Read",e[e.k_Write=1]="k_Write",e[e.k_ReadWrite=2]="k_ReadWrite",e[e.k_Undefined=3]="k_Undefined",e[e.k_Default=2]="k_Default"}(i||(i={})),function(e){e[e.k_Header=0]="k_Header",e[e.k_Float=1]="k_Float",e[e.k_Int=2]="k_Int",e[e.k_Bool=3]="k_Bool",e[e.k_Float2=4]="k_Float2",e[e.k_Int2=5]="k_Int2",e[e.k_Bool2=6]="k_Bool2",e[e.k_Float3=7]="k_Float3",e[e.k_Int3=8]="k_Int3",e[e.k_Bool3=9]="k_Bool3",e[e.k_Float4=10]="k_Float4",e[e.k_Int4=11]="k_Int4",e[e.k_Bool4=12]="k_Bool4",e[e.k_Float4x4=13]="k_Float4x4"}(s||(s={})),function(e){e[e.k_System=0]="k_System",e[e.k_Global=1]="k_Global",e[e.k_Default=2]="k_Default",e[e.k_Struct=3]="k_Struct",e[e.k_Annotation=4]="k_Annotation"}(o||(o={})),function(e){e[e.k_BasicFx=0]="k_BasicFx",e[e.k_PartFx=1]="k_PartFx",e[e.k_Unknown=2]="k_Unknown"}(l||(l={}))},GH4Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("fb8x"),a=r("Wl5j"),i=r("FrU9"),s=r("4AA8"),o=r("2b0+");class l extends s.a{constructor({ctor:e,args:t=null,...r}){super({instrType:i.b.k_ConstructorCallExpr,type:e.subType,...r}),this._args=(t||[]).map(e=>o.a.$withParent(e,this)),this._ctor=o.a.$withParent(e,this)}get args(){return this._args}get ctor(){return this._ctor}toCode(){var e="";e+=this.ctor.toCode(),e+="(";for(var t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){for(var e=0;e<this.args.length;e++)if(!this.args[e].isConst())return!1;return!0}evaluate(){if(!this.isConst())return!1;var e=null,t=a.k(this.type),r=new Array(this.args.length);if(Object(n.f)(t))return!1;try{if(a.r(this.type)){var i=this.args[0];if(this.args.length>1||!i.evaluate())return!1;e=t(i.getEvalValue())}else{for(var s=0;s<this.args.length;s++){if(!(i=this.args[s]).evaluate())return!1;r[s-1]=i.getEvalValue()}(e=new t).set.apply(e,r)}}catch(e){return!1}return this._evalResult=e,!0}}},I537:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("Wl5j"),a=r("FrU9"),i=r("4AA8"),s=r("2b0+"),o=r("hljw");class l extends i.a{constructor({expr:e,operator:t,...r}){super({instrType:a.b.k_UnaryExpr,type:"!"===t?o.a.wrapAsConst(n.b,n.a):e.type,...r}),this._expr=s.a.$withParent(e,this),this._operator=t}get operator(){return this._operator}get expr(){return this._expr}toCode(){var e="";return e+=this.operator,e+=this.expr.toCode()}isConst(){return this.expr.isConst()}evaluate(){var e=this.operator,t=this.expr;if(!t.evaluate())return!1;var r=null;try{switch(r=t.getEvalValue(),e){case"+":r=+r;break;case"-":r=-r;break;case"!":r=!r;break;case"++":r=++r;break;case"--":r=--r}}catch(e){return!1}return this._evalResult=r,!0}}},IHXS:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("u2cq");class s{constructor({type:e=a.c.k_Default,parent:t=null,strictMode:r=!1}){this.type=e,this.parent=t,this.strictMode=r,this.variables={},this.types={},this.functions={},this.techniques={},this.typeTemplates={}}isStrict(){return this.filter(e=>e.strictMode)}findVariable(e){return this.filter(t=>t.variables[e]||null)}findTypeTemplate(e){return this.filter(t=>t.typeTemplates[e]||null)}findType(e){return this.filter(t=>t.types[e]||null)}findFunction(e,t=null){return this.filter(r=>i.b.matchList(r.functions[e],t))}findTechnique(e){return this.filter(t=>t.techniques[e]||null)}findFunctionInScope(e){let t=i.b.matchList(this.functions[e.name],e.def.params.map(e=>e?e.type:null));return Object(n.a)(void 0!==t),t}addVariable(e){let t=this.variables,r=e.name;return!this.variables[r]&&(t[r]=e,Object(n.a)(e.scope===this),!0)}addTypeTemplate(e){return!Object(n.e)(this.typeTemplates[e.name])&&(this.typeTemplates[e.name]=e,!0)}addType(e){return!this.types[e.name]&&(this.types[e.name]=e,console.assert(e.scope===this),!0)}addFunction(e){Object(n.a)(this.type<=a.c.k_Global),Object(n.a)(e.scope===this);let t=this.functions,r=e.name;t[r]=t[r]||[];const i=t[r];let s=this.findFunctionInScope(e);if(s){Object(n.a)(!Object(n.f)(e.impl)),Object(n.a)(Object(n.f)(s.impl));let t=i.indexOf(s);i[t]=e}else i.push(e);return!0}addTechnique(e){return Object(n.a)(this.type<=a.c.k_Global),!this.techniques[e.name]&&(this.techniques[e.name]=e,Object(n.a)(e.scope===this),!1)}filter(e){let t=this;for(;!Object(n.f)(t);){let r=e(t);if(!Object(n.f)(r))return r;t=t.parent}return null}}class o{constructor(e){Object(n.a)(null!==e);let t=a.c.k_Global;this.globalScope=new s({parent:e,type:t}),this.currentScope=this.globalScope}validate(){Object(n.a)(this.currentScope===this.globalScope)}push(e=a.c.k_Default){Object(n.a)(null!==this.currentScope),Object(n.a)(e>=a.c.k_Default);let t=this.currentScope,r=new s({parent:t,type:e});this.currentScope=r}pop(){Object(n.a)(null!==this.currentScope),this.currentScope=this.currentScope.parent,Object(n.a)(null!==this.currentScope)}}},M2fT:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("2b0+"),i=r("oseZ");class s extends i.a{constructor({expr:e=null,...t}){super({instrType:n.b.k_ReturnStmt,...t}),this._operator="return",this._expr=a.a.$withParent(e,this)}get operator(){return this._operator}get expr(){return this._expr}toCode(){return this.expr?"return "+this.expr.toCode()+";":"return;"}}},MJEd:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return l}));var n,a=r("fb8x"),i=r("FrU9"),s=r("mXWi"),o=r("2b0+");!function(e){e[e.k_Local=1]="k_Local",e[e.k_Global=2]="k_Global",e[e.k_Argument=4]="k_Argument"}(n||(n={}));class l extends s.a{constructor({id:e,type:t,init:r=null,usageFlags:n=0,...s}){super({instrType:i.b.k_VariableDecl,...s}),this._id=o.a.$withParent(e,this),this._type=o.a.$withNoParent(t),this._initExpr=o.a.$withParent(r,this),this._usageFlags=n,Object(a.a)(!this.isParameter()||Object(a.f)(this.parent)||this.parent.instructionType==i.b.k_FunctionDef),Object(a.a)(this.isLocal()||!this.isLocal()),Object(a.a)(!this.isParameter()||this.isLocal())}get initExpr(){return this._initExpr}get defaultValue(){return this._initExpr.evaluate(),this._initExpr.getEvalValue()}get type(){return this._type}get name(){return this._id.name}get id(){return this._id}isGlobal(){return!!(this._usageFlags&n.k_Global)}isLocal(){return!!(this._usageFlags&n.k_Local)}isParameter(){return!!(this._usageFlags&n.k_Argument)}isField(){if(Object(a.f)(this.parent))return!1;var e=this.parent.instructionType;return e===i.b.k_VariableType||e===i.b.k_ComplexType||e===i.b.k_SystemType}toCode(){var e="";(e=this.type.toCode(),e+=" "+this.id.toCode(),this.type.isNotBaseArray())&&(e+="["+this.type.length+"]");return Object(a.f)(this.initExpr)||this.type.isUniform()||(e+="="+this.initExpr.toCode()),e}}},"MT7/":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("2b0+"),i=r("oseZ");class s extends i.a{constructor({cond:e,body:t,operator:r,...i}){super({instrType:n.b.k_WhileStmt,...i}),this._cond=a.a.$withParent(e,this),this._body=a.a.$withParent(t,this),this._operator=r}get cond(){return this.cond}get body(){return this._body}get operator(){return this._operator}toCode(){var e="";return"while"===this.operator?(e+="while(",e+=this.cond.toCode(),e+=")",e+=this.body.toCode()):(e+="do",e+=this.body.toCode(),e+="while(",e+=this.cond.toCode(),e+=");"),e}}},Mg1O:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("4AA8"),a=r("2b0+"),i=r("FrU9");class s extends n.a{constructor({expr:e,...t}){super({instrType:i.b.k_ComplexExpr,type:e.type,...t}),this._expr=a.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return"("+this.expr.toCode()+")"}isConst(){return this.expr.isConst()}evaluate(){return!!this.expr.evaluate()&&(this._evalResult=this.expr.getEvalValue(),!0)}}},"N/7J":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({name:e,value:t,...r}){super({instrType:n.b.k_SamplerState,...r}),this._name=e,this._value=a.a.$withParent(t,this)}get name(){return this._name}get value(){return this.value}toString(){return console.error("@not_implemented"),null}toCode(){return console.error("@not_implmented"),null}}},NzFo:function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return fe})),r.d(t,"a",(function(){return me}));var n=r("fb8x"),a=r("zioJ"),i=r("6dfp"),s=r("2blz"),o=r("FrU9"),l=r("/zHR"),u=r("RTx6"),c=r("DTTp"),p=r("u2cq"),d=r("l4+G"),h=r("XQla"),f=r("pq1u"),m=r("5EX4"),E=r("7VRG"),_=r("2xh7"),y=r("fjuh"),T=r("Mg1O"),g=r("i81d"),x=r("bxdW"),b=r("GH4Y"),S=r("Zd6l"),R=r("huhI"),k=r("49qt"),N=r("Wv+o"),A=r("4cxW"),C=r("BKBR"),O=r("hsO8"),I=r("5fm/"),v=r("C2sc"),P=r("1O8D"),D=r("ggRF"),F=r("2b0+"),L=r("iYqf"),w=r("QsPN"),U=r("wEKK"),j=r("jfm7"),B=r("C3oy"),W=r("fuca"),z=r("sQ1Q"),M=r("9EOq"),V=r("9hKy"),q=r("wsMd"),K=r("M2fT"),G=r("PLhK"),$=r("N/7J"),H=r("ip/g"),X=r("kGK+"),Z=r("9vj8"),Q=r("+Z36"),Y=r("onqc"),J=r("I537"),ee=r("MJEd"),te=r("hljw"),re=r("MT7/"),ne=r("IHXS"),ae=r("Wl5j");function ie(e,t,r){return t._check(r)?t:(function(e,t,r){e.error(t,r.code,Object(n.f)(r.info)?{}:r.info)}(e,t.sourceNode,t._getLastError()),null)}const se=e=>e?e.type:null,oe=e=>e?e.type.isEqual(ae.e)||e.type.isEqual(ae.h)?/int|uint/g:e.type:null;function le(e,t){if(e.subType.instructionType===o.b.k_ProxyType){const r=e.subType;r.isResolved()||r.resolve(t)}}function ue(e,t){let r=s.a.UNDEF;switch(e){case i.a.ALPHABLENDENABLE:case i.a.ALPHATESTENABLE:return console.warn("ALPHABLENDENABLE/ALPHATESTENABLE not supported in WebGL."),s.a.UNDEF;case i.a.BLENDENABLE:case i.a.CULLFACEENABLE:case i.a.ZENABLE:case i.a.ZWRITEENABLE:case i.a.DITHERENABLE:case i.a.SCISSORTESTENABLE:case i.a.STENCILTESTENABLE:case i.a.POLYGONOFFSETFILLENABLE:switch(t){case"TRUE":r=s.a.TRUE;break;case"FALSE":r=s.a.FALSE;break;default:return console.warn("Unsupported render state ALPHABLENDENABLE/ZENABLE/ZWRITEENABLE/DITHERENABLE value used: "+t+"."),r}break;case i.a.CULLFACE:switch(t){case"FRONT":r=s.a.FRONT;break;case"BACK":r=s.a.BACK;break;case"FRONT_AND_BACK":r=s.a.FRONT_AND_BACK;break;default:return console.warn("Unsupported render state CULLFACE value used: "+t+"."),r}break;case i.a.FRONTFACE:switch(t){case"CW":r=s.a.CW;break;case"CCW":r=s.a.CCW;break;default:return console.warn("Unsupported render state FRONTFACE value used: "+t+"."),r}break;case i.a.SRCBLEND:case i.a.DESTBLEND:case i.a.SRCBLENDALPHA:case i.a.DESTBLENDALPHA:case i.a.SRCBLENDCOLOR:case i.a.DESTBLENDCOLOR:case i.a.BLENDFUNC:case i.a.BLENDFUNCSEPARATE:switch(t){case"ZERO":r=s.a.ZERO;break;case"ONE":r=s.a.ONE;break;case"SRCCOLOR":r=s.a.SRCCOLOR;break;case"INVSRCCOLOR":r=s.a.INVSRCCOLOR;break;case"SRCALPHA":r=s.a.SRCALPHA;break;case"INVSRCALPHA":r=s.a.INVSRCALPHA;break;case"DESTALPHA":r=s.a.DESTALPHA;break;case"INVDESTALPHA":r=s.a.INVDESTALPHA;break;case"DESTCOLOR":r=s.a.DESTCOLOR;break;case"INVDESTCOLOR":r=s.a.INVDESTCOLOR;break;case"SRCALPHASAT":r=s.a.SRCALPHASAT;break;default:return console.warn("Unsupported render state SRCBLEND/DESTBLEND value used: "+t+"."),r}break;case i.a.BLENDEQUATION:case i.a.BLENDEQUATIONSEPARATE:case i.a.BLENDEQUATIONCOLOR:case i.a.BLENDEQUATIONALPHA:switch(t){case"FUNCADD":case"ADD":r=s.a.FUNCADD;break;case"FUNCSUBTRACT":case"SUBTRACT":r=s.a.FUNCSUBTRACT;break;case"FUNCREVERSESUBTRACT":case"REVERSESUBTRACT":r=s.a.FUNCREVERSESUBTRACT;break;default:return console.warn("Unsupported render state BLENDEQUATION/BLENDEQUATIONSEPARATE value used: "+t+"."),r}break;case i.a.ZFUNC:switch(t){case"NEVER":r=s.a.NEVER;break;case"LESS":r=s.a.LESS;break;case"EQUAL":r=s.a.EQUAL;break;case"LESSEQUAL":r=s.a.LESSEQUAL;break;case"GREATER":r=s.a.GREATER;break;case"NOTEQUAL":r=s.a.NOTEQUAL;break;case"GREATEREQUAL":r=s.a.GREATEREQUAL;break;case"ALWAYS":r=s.a.ALWAYS;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),r}break;case i.a.PRIMITIVETOPOLOGY:switch(t){case"TRIANGLELIST":r=s.a.TRIANGLELIST;break;case"LINELIST":r=s.a.LINELIST;break;default:return console.warn("Unsupported render state ZFUNC value used: "+t+"."),r}}return r}function ce(e,t,r){ae.j(r.name)&&e.error(r.sourceNode,a.a.SystemTypeRedefinition,{typeName:r.name}),t.addType(r.type)||e.error(r.sourceNode,a.a.TypeRedefinition,{typeName:r.name})}function pe(e,t){const r=t.globalScope;let i=!1;return Object(n.i)(r.functions,t=>{t.forEach(t=>{i=i||!function e(t,r,i){if(-1!==i.indexOf(r.instructionID))return t.error(r.sourceNode,a.a.InvalidFunctionRecursionNotAllowed,{funcName:r.name}),!1;let s=!1;return i=[...i,r.instructionID],Object(c.b)(r.impl,r=>{if(r.instructionType===o.b.k_FunctionCallExpr){let l=r.decl;if(l.instructionType===o.b.k_SystemFunctionDecl)return;if(l=l.scope.findFunctionInScope(l),Object(n.f)(l.impl))return void t.error(r.sourceNode,a.a.InvalidFunctionImplementationNotFound,{funcName:l.name});s=s||e(t,l,i)}}),!s}(e,t,[])})}),!i}function de(e){return!!function(e){const t=e.returnType;if(t.isEqual(ae.i))return!0;if(t.isComplex()){if(t.hasFieldWithoutSemantics())return!1;if(!t.hasAllUniqueSemantics())return!1;if(t.isContainSampler())return!1;if(t.isContainComplexType())return!1}else{if(!t.isEqual(ae.d))return!1;if("POSITION"!==e.semantic)return!1}return!0}(e)&&!!function(e){let t=e.params,r=!1,a=!1,i=!1;for(let e=0;e<t.length;e++){let s=t[e];if(!s.type.isUniform())if(i){if(r)return!1;if(a){if(Object(n.f)(s.semantic))return!1;if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1}}else{if(Object(n.f)(s.semantic)){if(s.type.isBase()||s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics())return!1;r=!0}else if(!Object(n.f)(s.semantic)){if(s.type.isComplex()&&(s.type.hasFieldWithoutSemantics()||!s.type.hasAllUniqueSemantics()))return!1;a=!0}i=!0}}return!0}(e)}function he(e){return!!function(e){let t=e.returnType;if(t.isEqual(ae.i))return!0;if(!t.isBase())return!1;if(!t.isEqual(ae.d))return!1;if("COLOR"!==e.semantic)return!1;return!0}(e)&&!!function(e){let t=e.params,r=!1,n=!1,a=!1;for(let e=0;e<t.length;e++){let i=t[e];if(!i.type.isUniform())if(a){if(r)return!1;if(n){if(""===i.semantic)return!1;if(i.type.isContainSampler()||ae.q(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1}}else{if(""===i.semantic){if(i.type.isBase()||i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()||i.type.isContainSampler())return!1;r=!0}else if(""!==i.semantic){if(i.type.isContainSampler()||ae.q(i.type))return!1;if(i.type.isComplex()&&(i.type.hasFieldWithoutSemantics()||!i.type.hasAllUniqueSemantics()))return!1;n=!0}a=!0}}return!0}(e)}class fe{constructor(e){this.diagnostics=new u.a,this.uri=e,this.moduleName=null,this.haveCurrentFunctionReturnOccur=!1}beginFunc(){this.func=!0,this.haveCurrentFunctionReturnOccur=!1,this.funcDef=null}endFunc(){this.func=!1}beginPass(){this.renderStates=null}endPass(){this.renderStates=null}error(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.error(t,{file:a,loc:n,info:r})}critical(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.critical(t,{file:a,loc:n,info:r})}warn(e,t,r={}){let n=this.resolveNodeSourceLocation(e),a=this.uri;this.diagnostics.warning(t,{file:a,loc:n,info:r})}resolveNodeSourceLocation(e){return Object(n.e)(e)?Object(n.d)(e.loc)?e.loc:this.resolveNodeSourceLocation(e.children[e.children.length-1]):null}}class me{analyzeUseDecl(e,t,r){t.currentScope.strictMode=!0}analyzeComplexName(e){const t=e.children;let r="";for(let e=t.length-1;e>=0;e--)r+=t[e].value;return r}analyzeProvideDecl(t,r,i){const s=i.children,o=r.currentScope;if(3===s.length){let r=this.analyzeComplexName(s[1]);return Object(n.f)(t.moduleName)||console.warn(`Context module overriding detected '${t.moduleName}' => '${e}'`),t.moduleName=r,Object(n.a)("T_KW_PROVIDE"===s[2].name),new M.a({sourceNode:i,moduleName:r,scope:o})}return t.error(i,a.a.UnsupportedProvideAs),null}analyzeInitExpr(e,t,r){const n=r.children,a=t.currentScope;let i=[];if(1===n.length)i.push(this.analyzeExpr(e,t,n[0]));else for(let r=0;r<n.length;r++)"InitExpr"===n[r].name&&i.push(this.analyzeInitExpr(e,t,n[r]));return new D.a({scope:a,sourceNode:r,args:i,type:null})}analyzeVariableDecl(e,t,r){const a=r.children,i=(t.currentScope,this.analyzeUsageType(e,t,a[a.length-1])),s=[];if(Object(n.f)(i))return null;for(let r=a.length-2;r>=1;r--)"Variable"===a[r].name&&s.push(this.analyzeVariable(e,t,a[r],i));return s}analyzeUsageType(e,t,r){const a=r.children,i=t.currentScope;let s=null,l=[];for(let r=a.length-1;r>=0;r--)if("Type"===a[r].name){if(s=this.analyzeType(e,t,a[r]),Object(n.f)(s))return null}else"Usage"===a[r].name&&l.push(this.analyzeUsage(a[r]));const u=-1!==l.indexOf("in"),c=-1!==l.indexOf("out"),p=-1!==l.indexOf("inout"),d=-1!==l.indexOf("const"),h=-1!==l.indexOf("uniform");let f=[];return p?f.push("inout"):u&&c?f.push("inout"):(u&&f.push("in"),c?f.push("out"):(d&&f.push("const"),h&&f.push("uniform"))),ie(e,new te.a({scope:i,sourceNode:r,type:s,usages:f}),o.a.CODE_TARGET_SUPPORT)}analyzeType(e,t,r){const i=r.children,s=t.currentScope;let l=null;switch(r.name){case"T_TYPE_ID":if("auto"===r.value){l=new V.a({scope:s});break}l=s.findType(r.value),Object(n.f)(l)&&e.error(r,a.a.InvalidTypeNameNotType,{typeName:r.value});break;case"Struct":l=this.analyzeStruct(e,t,r);break;case"T_KW_VOID":l=ae.i;break;case"ScalarType":case"ObjectType":{let u=i[i.length-1].value;if(1!==i.length){Object(n.a)("<"===i[i.length-2].value&&">"===i[0].value);const c=u,p=i.slice(1,-2).reverse().filter((e,t)=>t%2==0).map(r=>this.analyzeType(e,t,r)),d=s.findTypeTemplate(u);if(Object(n.f)(d))return e.error(r,a.a.InvalidTypeNameTemplateNotFound,{tplName:c,args:p.map(e=>e.toCode())}),null;if(-1!==["RWBuffer","RWStructuredBuffer","AppendStructuredBuffer"].indexOf(d.name)&&s.type!=o.c.k_Global)return e.error(r,a.a.InvalidTypeScope,{typeName:d.name,tooltip:"only global scope allowed"}),null;if(u=d.typeName(p),l=s.findType(u),Object(n.f)(l)){if(l=d.produceType(s,p),Object(n.f)(l))return e.error(r,a.a.CannotProduceType,{typeName:u}),null;s.addType(l)}}else l=s.findType(u);if(Object(n.f)(l))return e.error(r,a.a.InvalidTypeNameNotType,{typeName:u}),null}break;case"VectorType":case"MatrixType":e.error(r,a.a.InvalidTypeVectorMatrix);break;case"BaseType":case"Type":return this.analyzeType(e,t,i[0])}return l}analyzeUsage(e){e=e.children[0];return Object(n.a)(-1!==["uniform","const","in","out","inout"].indexOf(e.value)),e.value}analyzeVariable(e,t,r,i){const s=r.children,l=t.currentScope;let u=null,c=null,p="",d=0;e.func?(e.funcDef||(d|=ee.a.k_Argument),d|=ee.a.k_Local):d|=ee.a.k_Global;let h=null,f=null,m=null,E=s[s.length-1];for(;;){let a=E.children;if(1===a.length){const e=a[0].value;h=new v.a({scope:l,sourceNode:r,name:e});break}Object(n.a)(4==a.length),Object(n.f)(f)||(i=new te.a({scope:l,sourceNode:i.sourceNode,type:i,arrayIndex:f})),f=this.analyzeExpr(e,t,a[a.length-3]),E=a[a.length-1]}m=new te.a({scope:l,sourceNode:i.sourceNode,type:i,arrayIndex:f});for(let n=s.length-2;n>=0;n--)if("Annotation"===s[n].name)u=this.analyzeAnnotation(s[n]);else if("Semantic"===s[n].name)p=this.analyzeSemantic(s[n]);else if("Initializer"===s[n].name){let i=this.analyzeInitializerArguments(e,t,s[n]);c=new D.a({scope:l,sourceNode:s[n],args:i,type:m});let o=!1;try{o=c.optimizeForVariableType(m)}catch(e){}o||(e.error(r,a.a.InvalidVariableInitializing,{varName:h.name}),c=null)}const _=new ee.b({sourceNode:r,scope:l,type:m,init:c,id:h,semantic:p,annotation:u,usageFlags:d});if(Object(n.a)(l.type!=o.c.k_System),ae.l(_.name)&&e.error(r,a.a.SystemVariableRedefinition,{varName:_.name}),!l.addVariable(_))switch(l.type){case o.c.k_Global:case o.c.k_Default:e.error(r,a.a.VariableRedefinition,{varName:_.name});break;case o.c.k_Struct:e.error(r,a.a.InvalidNewFieldForStructName,{fieldName:_.name});break;case o.c.k_Annotation:e.error(r,a.a.InvalidNewAnnotationVar,{varName:_.name})}return ie(e,_,o.a.CODE_TARGET_SUPPORT)}analyzeAnnotation(e){return null}analyzeSemantic(e){return e.children.slice(0,-1).reverse().map(e=>e.value).join("")}analyzeInitializerArguments(e,t,r){const n=r.children;t.currentScope;let a=[];if(2===n.length)a.push(this.analyzeExpr(e,t,n[0]));else for(let r=n.length-3;r>=1;r--)"InitExpr"===n[r].name&&a.push(this.analyzeInitExpr(e,t,n[r]));return a}analyzeExpr(e,t,r){const n=r.name;switch(n){case"ObjectExpr":return this.analyzeObjectExpr(e,t,r);case"ComplexExpr":return this.analyzeComplexExpr(e,t,r);case"PostfixExpr":return this.analyzePostfixExpr(e,t,r);case"UnaryExpr":return this.analyzeUnaryExpr(e,t,r);case"CastExpr":return this.analyzeCastExpr(e,t,r);case"ConditionalExpr":return this.analyzeConditionalExpr(e,t,r);case"MulExpr":case"AddExpr":return this.analyzeArithmeticExpr(e,t,r);case"RelationalExpr":case"EqualityExpr":return this.analyzeRelationExpr(e,t,r);case"AndExpr":case"OrExpr":return this.analyzeLogicalExpr(e,t,r);case"AssignmentExpr":return this.analyzeAssignmentExpr(e,t,r);case"T_NON_TYPE_ID":return this.analyzeIdExpr(e,t,r);case"T_STRING":case"T_UINT":case"T_FLOAT":case"T_KW_TRUE":case"T_KW_FALSE":return this.analyzeSimpleExpr(e,t,r);default:e.error(r,a.a.UnsupportedExpr,{exprName:n})}return null}analyzeObjectExpr(e,t,r){switch(r.children[r.children.length-1].name){case"T_KW_COMPILE":return this.analyzeCompileExpr(e,t,r);case"T_KW_SAMPLER_STATE":return this.analyzeSamplerStateBlock(e,t,r)}return null}analyzeCompileExpr(e,t,r,i){const s=r.children,l=s[s.length-2].value,u=t.currentScope;let c=null,p=null,d=null;if(s.length>4){c=[];for(let r=s.length-4;r>0;r--)","!==s[r].value&&c.push(this.analyzeExpr(e,t,s[r]))}d=c?c.map(se):null;let h=null;if(i){for(let e of i)if(d=c?c.map(se):null,p=null,d=e.args||d,p=e.ret||p,h=t.globalScope.findFunction(l,d))break}else h=t.globalScope.findFunction(l,d);if(Object(n.f)(h))return e.error(r,a.a.InvalidCompileNotFunction,{funcName:l}),null;if(p&&!h.def.returnType.isEqual(p))return e.error(r,a.a.InvalidCompileFunctionNotValid,{funcName:l,funcType:p.toCode(),tooltip:`Return type mismatch: expected '${p.toCode()}' a is a '${h.def.returnType.toCode()}' `}),null;let f=te.a.wrap(h.def.returnType,u);return ie(e,new y.a({args:c,scope:u,type:f,operand:h,sourceNode:r}),o.a.CODE_TARGET_SUPPORT)}analyzeSamplerStateBlock(e,t,r){r=r.children[0];let a=t.currentScope,i=r.children,s=[];for(let r=i.length-2;r>=1;r--){let a=this.analyzeSamplerState(e,t,i[r]);Object(n.f)(a)||s.push(a)}let l=new G.a({sourceNode:r,scope:a,operator:"sampler_state",params:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeSamplerState(e,t,r){const i=r.children,s=t.currentScope;if("StateIndex"===i[i.length-2].name)return e.error(r,a.a.UnsupportedStateIndex),null;let o=i[i.length-3],l=o.children[o.children.length-1],u=i[i.length-1].value.toUpperCase(),c="";if(Object(n.f)(l.value))return e.error(l,a.a.InvalidSamplerTexture),null;switch(u){case"TEXTURE":if(3!==o.children.length||"{"===l.value)return e.error(l,a.a.InvalidSamplerTexture),null;let t=o.children[1],i=t.value;if(Object(n.f)(i)||!s.findVariable(i))return e.error(o.children[1],a.a.InvalidSamplerTexture),null;let p=s.findVariable(i),d=new v.a({scope:s,sourceNode:t,name:i}),h=new I.a({scope:s,sourceNode:t,id:d,decl:p});return new $.a({scope:s,sourceNode:r,name:u,value:h});case"ADDRESSU":case"ADDRESSV":switch(c=l.value.toUpperCase()){case"WRAP":case"CLAMP":case"MIRROR":break;default:return null}break;case"MAGFILTER":case"MINFILTER":switch(c=l.value.toUpperCase()){case"POINT":c="NEAREST";break;case"POINT_MIPMAP_POINT":c="NEAREST_MIPMAP_NEAREST";break;case"LINEAR_MIPMAP_POINT":c="LINEAR_MIPMAP_NEAREST";break;case"POINT_MIPMAP_LINEAR":c="NEAREST_MIPMAP_LINEAR";break;case"NEAREST":case"LINEAR":case"NEAREST_MIPMAP_NEAREST":case"LINEAR_MIPMAP_NEAREST":case"NEAREST_MIPMAP_LINEAR":case"LINEAR_MIPMAP_LINEAR":break;default:return null}break;default:return console.warn("Don`t support this texture param: "+u),null}return new $.a({sourceNode:r,scope:s,name:u,value:new Z.a({sourceNode:o,scope:s,value:c})})}analyzeComplexExpr(e,t,r){const n=r.children;switch(n[n.length-1].name){case"PostfixPointExpr":case"T_NON_TYPE_ID":return this.analyzeFunctionCallExpr(e,t,r);case"BaseType":case"T_TYPE_ID":return this.analyzeConstructorCallExpr(e,t,r);default:return this.analyzeSimpleComplexExpr(e,t,r)}}analyzeCallee(e,t,r){const n=r.children;return this.analyzeExpr(e,t,n[n.length-1])}analyzeFunctionCallExpr(e,t,r){const i=r.children,s=t.currentScope,l=t.globalScope,u=i[i.length-1].name,c=[];if(i.length>3)for(let r=i.length-3;r>0;r--)if(","!==i[r].value){const n=this.analyzeExpr(e,t,i[r]);c.push(n)}let d=null,h=null,f=null;switch(u){case"T_NON_TYPE_ID":d=i[i.length-1].value,h=l.findFunction(d,c.map(oe));break;case"PostfixPointExpr":f=this.analyzeCallee(e,t,i[i.length-1]),d=i[i.length-1].children[0].value,h=f.type.getMethod(d,c.map(oe))}if(Object(n.f)(h))return e.error(r,a.a.InvalidComplexNotFunction,{funcName:d}),null;if(!Object(n.d)(h))return e.error(r,a.a.CannotChooseFunction,{funcName:d}),null;if(h.instructionType!==o.b.k_FunctionDecl&&h.instructionType!==o.b.k_SystemFunctionDecl)return console.error("@undefined_behavior"),null;const m=h.def.params;for(let t=0;t<c.length;t++)if(!Object(n.f)(c[t]))if(m[t].type.hasUsage("out")){const r=p.a.unwind(c[t]);if(Object(n.f)(r))return e.error(c[t].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!c[t].type.writable)return e.error(c[t].sourceNode,a.a.InvalidTypeForWriting),null}else if(m[t].type.hasUsage("inout")){const r=p.a.unwind(c[t]);if(Object(n.f)(r))return e.error(c[t].sourceNode,a.a.InvalidExprIsNotLValue),null;if(!c[t].type.writable)return e.error(c[t].sourceNode,a.a.InvalidTypeForWriting),null;if(!c[t].type.readable)return e.error(c[t].sourceNode,a.a.InvalidTypeForReading),null}else if(!c[t].type.readable)return e.error(c[t].sourceNode,a.a.InvalidTypeForReading),null;const E=te.a.wrap(h.def.returnType,s);return ie(e,new A.a({scope:s,type:E,decl:h,args:c,sourceNode:r,callee:f}),o.a.CODE_TARGET_SUPPORT)}analyzeConstructorCallExpr(e,t,r){const i=r.children,s=t.currentScope,l=this.analyzeType(e,t,i[i.length-1]);if(Object(n.f)(l))return e.error(r,a.a.InvalidComplexNotType),null;let u=null;if(i.length>3){let r=null;u=[];for(let n=i.length-3;n>0;n--)","!==i[n].value&&(r=this.analyzeExpr(e,t,i[n]),u.push(r))}const c=(p=l,new te.a({type:p,scope:null}));var p;if(Object(n.f)(c))return e.error(r,a.a.InvalidComplexNotConstructor,{typeName:String(l)}),null;if(!Object(n.f)(u))for(let t=0;t<u.length;t++)if(!u[t].type.readable)return e.error(r,a.a.InvalidTypeForReading),null;return ie(e,new b.a({scope:s,sourceNode:r,ctor:c,args:u}),o.a.CODE_TARGET_SUPPORT)}analyzeSimpleComplexExpr(e,t,r){const a=r.children,i=t.currentScope;let s=this.analyzeExpr(e,t,a[1]);return Object(n.f)(s)?null:ie(e,new T.a({scope:i,sourceNode:r,expr:s}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixExpr(e,t,r){const n=r.children;switch(n[n.length-2].value){case"[":return this.analyzePostfixIndex(e,t,r);case".":return this.analyzePostfixPoint(e,t,r);case"++":case"--":return this.analyzePostfixArithmetic(e,t,r)}return null}analyzePostfixIndex(e,t,r){const i=r.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]);if(Object(n.f)(l))return null;const u=l.type;if(!u.isArray())return e.error(r,a.a.InvalidPostfixNotArray,{typeName:String(u)}),null;const c=this.analyzeExpr(e,t,i[i.length-3]),p=c.type;return p.isEqual(ae.e)||p.isEqual(ae.h)?ie(e,new W.a({scope:s,sourceNode:r,element:l,index:c}),o.a.CODE_TARGET_SUPPORT):(e.error(r,a.a.InvalidPostfixNotIntIndex,{typeName:String(p)}),null)}createFieldDecl(e,t){if(!e.hasField(t))return null;const r=e.scope,{id:n,type:a,type:{padding:i,length:s},semantic:o}=(e.subType||e).getField(t),l=new te.a({type:a,scope:r,padding:i,sourceNode:a.sourceNode}),u=new v.a({scope:r,name:n.name,sourceNode:n.sourceNode}),c=new ee.b({scope:r,id:u,type:l,semantic:o,sourceNode:u.sourceNode});return F.a.$withParent(c,e)}analyzePostfixPointField(e,t,r,a){if(Object(n.f)(a))return null;const i=t.currentScope,s=r.value,l=a.getField(s);if(Object(n.f)(l))return null;const u=new v.a({scope:i,sourceNode:r,name:s});return ie(e,new I.a({scope:i,sourceNode:r,id:u,decl:l}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixPoint(e,t,r){const i=r.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]);if(Object(n.f)(l))return null;const u=this.analyzePostfixPointField(e,t,i[i.length-3],l.type);if(Object(n.f)(u)){const t=i[i.length-3].value;return e.error(r,a.a.InvalidPostfixNotField,{typeName:String(l.type),fieldName:t}),null}return ie(e,new z.a({sourceNode:r,scope:s,element:l,postfix:u}),o.a.CODE_TARGET_SUPPORT)}analyzePostfixArithmetic(e,t,r){const i=r.children,s=t.currentScope,l=i[0].value,u=this.analyzeExpr(e,t,i[1]),c=u.type,p=me.checkOneOperandExprType(e,r,l,c);return Object(n.f)(p)?(e.error(r,a.a.InvalidPostfixArithmetic,{operator:l,typeName:String(c)}),null):ie(e,new B.a({scope:s,sourceNode:r,operator:l,expr:u}),o.a.CODE_TARGET_SUPPORT)}analyzeUnaryExpr(e,t,r){const i=r.children,s=i[1].value,l=t.currentScope;let u=this.analyzeExpr(e,t,i[0]),c=me.checkOneOperandExprType(e,r,s,u.type);if(Object(n.f)(c))return e.error(r,a.a.InvalidUnaryOperation,{operator:s,tyename:String(u.type)}),null;let d=null;if(("-"===s||"+"===s)&&p.c.isLiteral(u))switch(u.instructionType){case o.b.k_IntExpr:d=new w.a({scope:l,sourceNode:r,value:`${s}${u.value}`});break;case o.b.k_FloatExpr:d=new k.a({scope:l,sourceNode:r,value:`${s}${u.value}`})}return d||(d=new J.a({scope:l,sourceNode:r,expr:u,operator:s})),ie(e,d,o.a.CODE_TARGET_SUPPORT)}analyzeCastExpr(e,t,r){const i=r.children,s=t.currentScope,l=this.analyzeConstTypeDim(e,t,i[2]),u=this.analyzeExpr(e,t,i[0]);return Object(n.f)(u)?null:u.type.readable?ie(e,new _.a({scope:s,sourceNode:r,sourceExpr:u,type:l}),o.a.CODE_TARGET_SUPPORT):(e.error(r,a.a.InvalidTypeForReading),null)}analyzeConditionalExpr(e,t,r){const i=r.children,s=t.currentScope,l=this.analyzeExpr(e,t,i[i.length-1]),u=this.analyzeExpr(e,t,i[i.length-3]),c=this.analyzeExpr(e,t,i[0]);if(Object(n.f)(l)||Object(n.f)(u)||Object(n.f)(c))return e.error(l?l.sourceNode:r,a.a.InvalidConditionType,{typeName:"[unknown]"}),null;const p=l.type,d=u.type,h=c.type,f=ae.b;return p.isEqual(f)?d.isEqual(h)?p.readable?d.readable?h.readable?ie(e,new x.a({scope:s,sourceNode:r,cond:l,left:u,right:c}),o.a.CODE_TARGET_SUPPORT):(e.error(h.sourceNode,a.a.InvalidTypeForReading),null):(e.error(d.sourceNode,a.a.InvalidTypeForReading),null):(e.error(p.sourceNode,a.a.InvalidTypeForReading),null):(e.error(d.sourceNode,a.a.InvalidConditonValueTypes,{leftTypeName:String(d),rightTypeName:String(h)}),null):(e.error(l.sourceNode,a.a.InvalidConditionType,{typeName:String(p)}),null)}analyzeArithmeticExpr(e,t,r){const i=r.children,s=t.currentScope,l=r.children[1].value,u=this.analyzeExpr(e,t,i[i.length-1]),c=this.analyzeExpr(e,t,i[0]);if(!u||!c)return e.error(r,a.a.InvalidArithmeticOperation,{operator:l,leftTypeName:"[unknown]",rightTypeName:"[unknown]"}),null;const p=u.type,h=c.type,f=me.checkTwoOperandExprTypes(e,l,p,h,u.sourceNode,c.sourceNode);return Object(n.f)(f)?(e.error(r,a.a.InvalidArithmeticOperation,{operator:l,leftTypeName:String(p),rightTypeName:String(h)}),null):ie(e,new d.a({scope:s,sourceNode:r,left:u,right:c,operator:l,type:f}),o.a.CODE_TARGET_SUPPORT)}analyzeRelationExpr(e,t,r){const i=r.children,s=t.currentScope,l=r.children[1].value,u=this.analyzeExpr(e,t,i[i.length-1]),c=this.analyzeExpr(e,t,i[0]),d=u?u.type:null,h=c?c.type:null,f=me.checkTwoOperandExprTypes(e,l,d,h,u?u.sourceNode:null,c?c.sourceNode:null);return Object(n.f)(f)?(e.error(r,a.a.InvalidRelationalOperation,{operator:l,leftTypeName:d?p.d.signature(d):"[unknown]",rightTypeName:h?p.d.signature(h):"[unknown]"}),null):u&&c?ie(e,new q.a({sourceNode:r,scope:s,left:u,right:c,operator:l}),o.a.CODE_TARGET_SUPPORT):null}analyzeLogicalExpr(e,t,r){const n=r.children,i=t.currentScope,s=r.children[1].value,l=this.analyzeExpr(e,t,n[n.length-1]),u=this.analyzeExpr(e,t,n[0]),c=l.type,p=u.type,d=ae.b;if(!c.isEqual(d))return e.error(c.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(c)}),null;if(!p.isEqual(d))return e.error(p.sourceNode,a.a.InvalidLogicOperation,{operator:s,typeName:String(p)}),null;if(!c.readable)return e.error(r,a.a.InvalidTypeForReading),null;if(!p.readable)return e.error(r,a.a.InvalidTypeForReading),null;return ie(e,new U.a({scope:i,sourceNode:r,left:l,right:u,operator:s}),o.a.CODE_TARGET_SUPPORT)}analyzeAssignmentExpr(e,t,r){const i=r.children,s=t.currentScope,l=i[1].value,u=this.analyzeExpr(e,t,i[i.length-1]);p.a.unwind(u)||e.error(r,a.a.InvalidLeftHandSideInAssignment,{operator:l});const c=this.analyzeExpr(e,t,i[0]);if(Object(n.f)(u)||Object(n.f)(c))return null;const d=u.type,f=c.type;let m=null;return"="!==l?(m=me.checkTwoOperandExprTypes(e,l,d,f,u.sourceNode,c.sourceNode),Object(n.f)(m)&&e.error(r,a.a.InvalidArithmeticAssigmentOperation,{operator:l,leftTypeName:p.d.signature(d),rightTypeName:p.d.signature(f)})):m=f,m=me.checkTwoOperandExprTypes(e,"=",d,m),Object(n.f)(m)&&e.error(r,a.a.InvalidAssigmentOperation,{leftTypeName:p.d.signature(d),rightTypeName:p.d.signature(f)}),ie(e,new h.a({scope:s,sourceNode:r,left:u,right:c,operator:l}),o.a.CODE_TARGET_SUPPORT)}analyzeIdExpr(e,t,r){const i=t.currentScope,s=r.value,l=i.findVariable(s);if(Object(n.f)(l))return e.error(r,a.a.UnknownVarName,{varName:s}),null;const u=new v.a({scope:i,sourceNode:r,name:s});return ie(e,new I.a({scope:i,sourceNode:r,id:u,decl:l}),o.a.CODE_TARGET_SUPPORT)}analyzeSimpleExpr(e,t,r){const n=r.name,a=r.value,i=t.currentScope;switch(n){case"T_UINT":return new w.a({scope:i,sourceNode:r,value:a});case"T_FLOAT":return new k.a({scope:i,sourceNode:r,value:a});case"T_STRING":return new Z.a({scope:i,sourceNode:r,value:a});case"T_KW_TRUE":return new m.a({scope:i,sourceNode:r,value:"true"});case"T_KW_FALSE":return new m.a({scope:i,sourceNode:r,value:"false"})}return null}analyzeConstTypeDim(e,t,r){const n=r.children;if(n.length>1)return e.error(r,a.a.InvalidCastTypeUsage),null;const i=this.analyzeType(e,t,n[0]);return i.isBase()||e.error(r,a.a.InvalidCastTypeNotBase,{typeName:String(i)}),ie(e,i,o.a.CODE_TARGET_SUPPORT)}analyzeVarStructDecl(e,t,r){const n=r.children;let a=this.analyzeUsageStructDecl(e,t,n[n.length-1]),i=[];for(let r=n.length-2;r>=1;r--)"Variable"===n[r].name&&(i=i.concat(this.analyzeVariable(e,t,n[r],a)));return i}analyzeUsageStructDecl(e,t,r){const a=r.children,i=t.currentScope;let s=[],l=null;for(let r=a.length-1;r>=0;r--)if("StructDecl"===a[r].name){l=this.analyzeStructDecl(e,t,a[r]),ce(e,i,new Y.a({scope:i,sourceNode:a[r],type:l}))}else if("Usage"===a[r].name){const e=this.analyzeUsage(a[r]);s.push(e)}return Object(n.a)(!Object(n.f)(l)),ie(e,new te.a({scope:i,sourceNode:r,usages:s,type:l}),o.a.CODE_TARGET_SUPPORT)}analyzeStruct(e,t,r){const n=r.children,a=t.currentScope;let i=null;"T_NON_TYPE_ID"===n[n.length-2].name&&(i=n[n.length-2].value);let s=[];t.push(o.c.k_Struct);for(let r=n.length-4;r>=1;r--)"VariableDecl"===n[r].name&&(s=s.concat(this.analyzeVariableDecl(e,t,n[r])));return t.pop(),ie(e,new g.a({scope:a,sourceNode:r,fields:s,name:i}),o.a.CODE_TARGET_SUPPORT)}analyzeFunctionDecl(e,t,r){const i=r.children,s=t.currentScope,l=t.globalScope,u=i[0].value;let c=null,p=null;t.push(o.c.k_Default);const d=[];for(;"Attribute"===i[i.length-1-d.length].name;)d.push(this.analyzeAttribute(e,t,i[i.length-1-d.length]));const h=this.analyzeFunctionDef(e,t,i[i.length-1-d.length]);let f=l.findFunction(h.name,h.params.map(se));if(!Object(n.d)(f))return e.error(r,a.a.CannotChooseFunction,{funcName:h.name}),t.pop(),null;if(!Object(n.f)(f)&&f.impl)return e.error(r,a.a.FunctionRedefinition,{funcName:h.name}),t.pop(),null;if(!Object(n.f)(f)&&!f.def.returnType.isEqual(h.returnType))return e.error(r,a.a.InvalidFuncDefenitionReturnType,{funcName:h.name}),t.pop(),null;Object(n.a)(null===e.funcDef),e.funcDef=h,3===i.length&&(c=this.analyzeAnnotation(i[1])),";"!==u&&(p=this.analyzeStmtBlock(e,t,i[0])),t.pop();let m=h.returnType.isEqual(ae.i);if(!Object(n.f)(p)){let t=p.stmtList;for(let r=t.length-1;r>=0;--r)if(t[r].instructionType==o.b.k_ReturnStmt){r!=t.length-1&&e.error(t[r+1].sourceNode,a.a.UnreachableCode);break}}return Object(n.a)(s==l),f=new C.a({sourceNode:r,scope:s,definition:h,implementation:p,annotation:c,attributes:d}),l.addFunction(f)||e.error(r,a.a.FunctionRedifinition,{funcName:h.name}),m||e.haveCurrentFunctionReturnOccur||Object(n.f)(p)||e.error(r,a.a.InvalidFunctionReturnStmtNotFound,{funcName:h.name}),f}analyzeFunctionDef(e,t,r){const n=r.children,i=t.currentScope,s=n[n.length-2],l=s.value,u=n[n.length-1];let c=this.analyzeUsageType(e,t,u);if(c.isContainSampler())return e.error(u,a.a.InvalidFunctionReturnType,{funcName:l}),null;let p=new v.a({scope:i,name:l,sourceNode:s}),d=null;4===n.length&&(d=this.analyzeSemantic(n[0]));let h=this.analyzeParamList(e,t,n[n.length-3]),f=new O.a({scope:i,sourceNode:r,returnType:c,id:p,paramList:h,semantic:d});return ie(e,f,o.a.CODE_TARGET_SUPPORT),f}analyzeParamList(e,t,r){const n=r.children;let a=[];for(let r=n.length-2;r>=1;r--)if("ParameterDecl"===n[r].name){let i=this.analyzeParameterDecl(e,t,n[r]);a.push(i)}return a}analyzeParameterDecl(e,t,r){const a=r.children,i=this.analyzeParamUsageType(e,t,a[1]);return Object(n.f)(i)?null:this.analyzeVariable(e,t,a[0],i)}analyzeParamUsageType(e,t,r){const a=r.children,i=t.currentScope;let s=[],l=null;for(let r=a.length-1;r>=0;r--)if("Type"===a[r].name){if(l=this.analyzeType(e,t,a[r]),Object(n.f)(l))return null}else"ParamUsage"===a[r].name&&s.push(this.analyzeUsage(a[r]));let u=new te.a({scope:i,sourceNode:r,type:l,usages:s});return ie(e,u,o.a.CODE_TARGET_SUPPORT),u}analyzeStmtBlock(e,t,r){const a=r.children,i=t.currentScope;if(!a)return null;let s=[];for(let r=a.length-2;r>0;r--){let i=this.analyzeStmt(e,t,a[r]);Object(n.f)(i)||s.push(i)}const l=new X.a({sourceNode:r,scope:i,stmtList:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeStmt(e,t,r){const n=r.children;let a,i=n.length;do{a=n[--i].name}while("Attribute"===a);switch(a){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,n[0]);case"UseDecl":return this.analyzeUseDecl(e,t,n[0]),null;case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,r);case"T_KW_FOR":return this.analyzeForStmt(e,t,r);case"T_KW_IF":return this.analyzeIfStmt(e,t,r)}return null}analyzeSimpleStmt(e,t,r){const n=t.currentScope,a=r.children;switch(a[a.length-1].name){case"T_KW_RETURN":return this.analyzeReturnStmt(e,t,r);case"T_KW_DO":return this.analyzeWhileStmt(e,t,r);case"StmtBlock":{t.push(o.c.k_Default);let r=this.analyzeStmtBlock(e,t,a[0]);return t.pop(),r}case"T_KW_DISCARD":case"T_KW_BREAK":case"T_KW_CONTINUE":return this.analyzeBreakStmt(e,t,r);case"TypeDecl":case"VariableDecl":case"VarStructDecl":return this.analyzeDeclStmt(e,t,a[0]);default:return 2===a.length?this.analyzeExprStmt(e,t,r):new H.a({sourceNode:r,scope:n})}}analyzeReturnStmt(e,t,r){const i=r.children,s=t.currentScope;Object(n.a)(e.func);const l=e.funcDef.returnType;if(e.haveCurrentFunctionReturnOccur=!0,2===i.length&&le(l,ae.i),l.isEqual(ae.i)&&3===i.length)return e.error(r,a.a.InvalidReturnStmtVoid),null;if(!l.isEqual(ae.i)&&2===i.length)return e.error(r,a.a.InvalidReturnStmtEmpty),null;let u=null;if(3===i.length){if(u=this.analyzeExpr(e,t,i[1]),Object(n.f)(u))return e.error(r,a.a.InvalidReturnStmtTypesNotEqual),null;if(le(l,u.type),!l.isEqual(u.type))return e.error(r,a.a.InvalidReturnStmtTypesNotEqual),null}const c=new K.a({sourceNode:r,scope:s,expr:u});return ie(e,c,o.a.CODE_TARGET_SUPPORT),c}analyzeBreakStmt(e,t,r){const a=r.children,i=t.currentScope,s=a[1].value;"discard"===s&&Object(n.f)(e.funcDef);const l=new E.a({sourceNode:r,scope:i,operator:s});return ie(e,l,o.a.CODE_TARGET_SUPPORT),l}analyzeDeclStmt(e,t,r){r.children;const n=t.currentScope;let a=[];switch(r.name){case"TypeDecl":a.push(this.analyzeTypeDecl(e,t,r));break;case"VariableDecl":a=a.concat(this.analyzeVariableDecl(e,t,r));break;case"VarStructDecl":a=a.concat(this.analyzeVarStructDecl(e,t,r))}const i=new S.a({sourceNode:r,scope:n,declList:a});return ie(e,i,o.a.CODE_TARGET_SUPPORT),i}analyzeExprStmt(e,t,r){const n=t.currentScope,a=r.children,i=this.analyzeExpr(e,t,a[1]),s=new R.a({sourceNode:r,scope:n,expr:i});return ie(e,s,o.a.CODE_TARGET_SUPPORT),s}analyzeWhileStmt(e,t,r){const n=t.currentScope,i=r.children,s="do"===i[i.length-1].value,l="NonIfStmt"===r.name,u=ae.b;let c=null,p=null,d=null,h="do";if(s){if(h="do",!(p=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(r,a.a.InvalidDoWhileCondition,{typeName:String(p)}),null;d=this.analyzeStmt(e,t,i[0])}else{if(h="while",!(p=(c=this.analyzeExpr(e,t,i[2])).type).isEqual(u))return e.error(r,a.a.InvalidWhileCondition,{typeName:String(p)}),null;d=l?this.analyzeNonIfStmt(e,t,i[0]):this.analyzeStmt(e,t,i[0])}const f=new re.a({sourceNode:r,scope:n,cond:c,body:d,operator:h});return ie(e,f,o.a.CODE_TARGET_SUPPORT),f}analyzeAttribute(e,t,r){const a=t.currentScope,i=r.children,s=i[i.length-2].value;let l=null;if(i.length>3){let r=null;l=[];for(let a=i.length-4;a>1;a--)","!==i[a].value&&(r=this.analyzeSimpleExpr(e,t,i[a]),Object(n.a)(r.instructionType===o.b.k_BoolExpr||r.instructionType===o.b.k_FloatExpr||r.instructionType===o.b.k_IntExpr),l.push(r))}return new f.a({scope:a,sourceNode:r,name:s,args:l})}analyzeIfStmt(e,t,r){const n=t.currentScope,i=r.children;let s=[];for(;"Attribute"===i[i.length-1-s.length].name;)s.push(this.analyzeAttribute(e,t,i[i.length-1-s.length]));const l=i.length-s.length==7,u=this.analyzeExpr(e,t,i[i.length-3-s.length]);u&&u.type.isEqual(ae.b)||e.error(r,a.a.InvalidIfCondition,{typeName:u?String(u.type):"[unknown]"});let c=null,p=null;if(l?(c=this.analyzeNonIfStmt(e,t,i[2]),p=this.analyzeStmt(e,t,i[0])):c=this.analyzeNonIfStmt(e,t,i[0]),!u)return null;const d=new P.a({sourceNode:r,scope:n,cond:u,conseq:c,contrary:p,attributes:s});return ie(e,d,o.a.CODE_TARGET_SUPPORT),d}analyzeNonIfStmt(e,t,r){const n=r.children;switch(n[n.length-1].name){case"SimpleStmt":return this.analyzeSimpleStmt(e,t,n[0]);case"T_KW_WHILE":return this.analyzeWhileStmt(e,t,r);case"T_KW_FOR":return this.analyzeForStmt(e,t,r)}return null}analyzeForStmt(e,t,r){const n=t.currentScope,a=r.children,i="NonIfStmt"===r.name;let s=null,l=null,u=null,c=null;if("ERROR"===a[1].name)return null;t.push(),l=this.analyzeForInit(e,t,a[a.length-3]),u=this.analyzeForCond(e,t,a[a.length-4]),c=null,7===a.length&&(c=this.analyzeForStep(e,t,a[2])),s=i?this.analyzeNonIfStmt(e,t,a[0]):this.analyzeStmt(e,t,a[0]),t.pop();const p=new N.a({sourceNode:r,scope:n,init:l,cond:u,step:c,body:s});return ie(e,p,o.a.CODE_TARGET_SUPPORT),p}analyzeForInit(e,t,r){const n=r.children;switch(n[n.length-1].name){case"VariableDecl":return this.analyzeVariableDecl(e,t,n[0])[0]||null;case"Expr":return this.analyzeExpr(e,t,n[0])}return null}analyzeForCond(e,t,r){const n=r.children;return 1===n.length?null:this.analyzeExpr(e,t,n[1])}analyzeForStep(e,t,r){const n=r.children;return 0==n.length?null:this.analyzeExpr(e,t,n[0])}analyzeTechniqueDecl(e,t,r){const n=r.children,a=this.analyzeComplexName(n[n.length-2]),i=(n[n.length-2].children.length,t.currentScope);let s=null,l=null,u=null,c=o.d.k_BasicFx;for(let r=n.length-3;r>=0;r--)"Annotation"===n[r].name?s=this.analyzeAnnotation(n[r]):"Semantic"===n[r].name?l=this.analyzeSemantic(n[r]):u=this.analyzeTechnique(e,t,n[r]);const p=new Q.a({sourceNode:r,name:a,techniqueType:c,semantic:l,annotation:s,passList:u,scope:i});return me.addTechnique(e,t,p),p}analyzeTechnique(e,t,r){const a=r.children;let i=[];for(let r=a.length-2;r>=1;r--){let s=this.analyzePassDecl(e,t,a[r]);Object(n.a)(!Object(n.f)(s)),i.push(s)}return i}analyzePassDecl(e,t,r){const n=r.children,a=t.currentScope,i=this.analyzePassStateBlockForShaders(e,t,n[0]),s=this.analyzePassStateBlock(e,t,n[0]);let o=null;for(let e=0;e<n.length;++e)if("T_NON_TYPE_ID"===n[e].name){let t=n[e].value;o=new v.a({scope:a,name:t})}return new j.a({scope:a,sourceNode:r,renderStates:s,id:o,pixelShader:i.pixel,vertexShader:i.vertex})}analyzePassStateBlockForShaders(e,t,r){const a=r.children;let i=null,s=null;const o=["vertexshader","pixelshader"];for(let r=a.length-2;r>=1;r--){let l=null;const u=a[r].children,c=u[u.length-1].value.toLowerCase();if(-1!==o.indexOf(c)&&(l=this.analyzePassStateForShader(e,t,a[r],c),!Object(n.f)(l)))switch(c){case"vertexshader":Object(n.a)(null==s),s=l;break;case"pixelshader":Object(n.a)(null==i),i=l;break;default:console.error("function is not suitable as shader entry point")}}return{vertex:s,pixel:i}}analyzePassStateForShader(e,t,r,i){Object(n.a)("vertexshader"===i||"pixelshader"===i);const s=r.children,o=s[s.length-3],l=o.children[o.children.length-1],u=this.analyzeExpr(e,t,l).function;return"vertexshader"===i?de(u.def)||e.error(r,a.a.FunctionIsNotCompatibleWithVertexShader,{funcDef:String(u)}):he(u.def)||e.error(r,a.a.FunctionIsNotCompatibleWithPixelShader,{funcDef:String(u)}),u}analyzePassStateBlock(e,t,r){const n=r.children;let a={};for(let r=n.length-2;r>=1;r--)a={...a,...this.analyzePassState(e,t,n[r])};return a}analyzePassState(e,t,r){const a=r.children,o=a[a.length-1].value.toUpperCase(),l=i.a[o]||null;if(Object(n.f)(l))return{};const u=a[a.length-3],c=u.children[u.children.length-1];if(Object(n.f)(c.value))return console.warn("Pass state is incorrect."),{};let p={};if("{"===c.value&&u.children.length>3){const e=new Array(Math.ceil((u.children.length-2)/2));for(let t=u.children.length-2,r=0;t>=1;t-=2,r++)e[r]=ue(l,u.children[t].value.toUpperCase());switch(l){case i.a.BLENDFUNC:if(2!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.SRCBLENDCOLOR]=e[0],p[i.a.SRCBLENDALPHA]=e[0],p[i.a.DESTBLENDCOLOR]=e[1],p[i.a.DESTBLENDALPHA]=e[1];break;case i.a.BLENDFUNCSEPARATE:if(4!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.SRCBLENDCOLOR]=e[0],p[i.a.SRCBLENDALPHA]=e[2],p[i.a.DESTBLENDCOLOR]=e[1],p[i.a.DESTBLENDALPHA]=e[3];break;case i.a.BLENDEQUATIONSEPARATE:if(2!==e.length)return console.warn("Pass state are incorrect."),{};p[i.a.BLENDEQUATIONCOLOR]=e[0],p[i.a.BLENDEQUATIONALPHA]=e[1];break;default:return console.warn("Pass state is incorrect."),{}}}else{let e="";const t=ue(l,e="{"===c.value?u.children[1].value.toUpperCase():c.value.toUpperCase());if(t!==s.a.UNDEF)switch(l){case i.a.SRCBLEND:p[i.a.SRCBLENDCOLOR]=t,p[i.a.SRCBLENDALPHA]=t;break;case i.a.DESTBLEND:p[i.a.DESTBLENDCOLOR]=t,p[i.a.DESTBLENDALPHA]=t;break;case i.a.BLENDEQUATION:p[i.a.BLENDEQUATIONCOLOR]=t,p[i.a.BLENDEQUATIONALPHA]=t;break;default:p[l]=t}}return p}analyzeImportDecl(e,t,r){const n=r.children,i=this.analyzeComplexName(n[n.length-2]);return e.error(r,a.a.ImportedComponentNotExists,{componentName:i}),null}analyzeStructDecl(e,t,r){const n=r.children,a=t.currentScope,i=n[n.length-2].value;t.push(o.c.k_Struct);let s=[];for(let r=n.length-4;r>=1;r--)"VariableDecl"===n[r].name&&(s=s.concat(this.analyzeVariableDecl(e,t,n[r])));return t.pop(),ie(e,new g.a({scope:a,sourceNode:r,name:i,fields:s}),o.a.CODE_TARGET_SUPPORT)}analyzeTypeDecl(e,t,r){const n=r.children,i=t.currentScope;let s=null;2===n.length?s=this.analyzeStructDecl(e,t,n[1]):e.error(r,a.a.UnsupportedTypeDecl);let l=new Y.a({scope:i,sourceNode:r,type:s});return ce(e,i,l),ie(e,l,o.a.CODE_TARGET_SUPPORT)}analyzeUnknDecl(e,t,r){switch(r.name){case"TechniqueDecl":return[this.analyzeTechniqueDecl(e,t,r)];case"UseDecl":return this.analyzeUseDecl(e,t,r),null;case"ImportDecl":return[this.analyzeImportDecl(e,t,r)];case"ProvideDecl":return[this.analyzeProvideDecl(e,t,r)];case"TypeDecl":return[this.analyzeTypeDecl(e,t,r)];case"VariableDecl":return this.analyzeVariableDecl(e,t,r);case"VarStructDecl":return this.analyzeVarStructDecl(e,t,r);case"FunctionDecl":Object(n.a)(t.currentScope==t.globalScope);let a=null;return e.beginFunc(),a=this.analyzeFunctionDecl(e,t,r),e.endFunc(),[a]}return null}analyzeGlobals(e,t,r){if(Object(n.f)(r)||Object(n.f)(r.root))return null;const a=r.root.children;let i=[];if(Object(n.f)(a))return[];for(let r=a.length-1;r>=0;r--)i.push(...this.analyzeUnknDecl(e,t,a[r])||[]);return i.filter(e=>!!e)}createContext(e){return new fe(e)}createProgram(e=null){let t=ae.a;return Object(n.f)(e)||(t=e.root.scope),new ne.a(t)}async parse(e,t){const r=e.uri,a=this.createProgram(t),i=this.createContext(r);let s=null;try{s=this.analyzeGlobals(i,a,e),pe(i,a),a.validate()}catch(e){console.error(e)}return Object(n.a)(a.currentScope==a.globalScope),{root:new L.a({scope:a.globalScope,instructions:s}),diagnosticReport:l.b.mergeReports([e.diagnosticReport,i.diagnostics.resolve()]),uri:r}}static addTechnique(e,t,r){let i=r.name;Object(n.f)(t.globalScope.findTechnique(i))?t.globalScope.addTechnique(r):e.error(r.sourceNode,a.a.TechniqueNameRedefinition,{techName:i})}static checkTwoOperandExprTypes(e,t,r,n,i=r.sourceNode,s=n.sourceNode){if(!r||!n)return null;const o=r.isComplex()||n.isComplex(),l=r.isNotBaseArray()||n.isNotBaseArray(),u=ae.q(r)||ae.q(n),c=ae.b;if(l||u)return null;if("%"===t||"%="===t)return null;if(me.isAssignmentOperator(t)){if(!r.writable)return e.error(i,a.a.InvalidTypeForWriting),null;if(!n.readable)return e.error(s,a.a.InvalidTypeForReading),null;"="===t||r.readable||e.error(i,a.a.InvalidTypeForReading)}else{if(!r.readable)return e.error(i,a.a.InvalidTypeForReading),null;if(!n.readable)return e.error(s,a.a.InvalidTypeForReading),null}if(o)return"="===t&&r.isEqual(n)?r:!me.isEqualOperator(t)||r.isContainArray()||r.isContainSampler()?null:c;const p=te.a.wrap(r.baseType,ae.a),d=te.a.wrap(n.baseType,ae.a);if(r.isConst()&&me.isAssignmentOperator(t))return null;if(r.isEqual(n))return me.isArithmeticalOperator(t)?!ae.p(r)||"/"!==t&&"/="!==t?p:null:me.isRelationalOperator(t)?ae.r(r)?c:null:me.isEqualOperator(t)?c:"="===t?p:null;if(me.isRelationalOperator(t)&&(r.isEqual(ae.h)&&n.isEqual(ae.e)||r.isEqual(ae.e)&&n.isEqual(ae.h)))return c;if(me.isArithmeticalOperator(t)){if(ae.m(r)||ae.m(n)||ae.n(r)!==ae.n(n)||ae.o(r)!==ae.o(n))return null;if(ae.r(r))return d;if(ae.r(n))return p;if("*"===t||"*="===t)return ae.p(r)&&ae.s(n)&&r.length===n.length?d:ae.p(n)&&ae.s(r)&&r.length===n.length?p:null}return"="===t&&(r.isEqual(ae.e)&&n.isEqual(ae.h)||r.isEqual(ae.h)&&n.isEqual(ae.e))?r:null}static checkOneOperandExprType(e,t,r,n){const i=n.isComplex(),s=n.isNotBaseArray(),o=ae.q(n);if(i||s||o)return null;if(!n.readable)return e.error(t,a.a.InvalidTypeForReading),null;if("++"===r||"--"===r)return n.writable?n:(e.error(t,a.a.InvalidTypeForWriting),null);if("!"===r){const e=ae.b;return n.isEqual(e)?e:null}return ae.m(n)?null:n.baseType}static isAssignmentOperator(e){return"+="===e||"-="===e||"*="===e||"/="===e||"%="===e||"="===e}static isArithmeticalOperator(e){return"+"===e||"+="===e||"-"===e||"-="===e||"*"===e||"*="===e||"/"===e||"/="===e}static isRelationalOperator(e){return">"===e||">="===e||"<"===e||"<="===e}static isEqualOperator(e){return"=="===e||"!="===e}}}).call(this,r("3UD+")(e))},PLhK:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("fb8x"),a=r("Wl5j"),i=r("FrU9"),s=r("gf1s"),o=r("4AA8"),l=r("2b0+");class u extends o.a{constructor({operator:e,params:t=[],...r}){super({instrType:i.b.k_SamplerStateBlockExpr,type:a.f,...r}),this._samplerParams=t.map(e=>l.a.$withParent(e,this)),this._operator=e}get texture(){let e=this._samplerParams;for(let t=0;t<e.length;++t)if("TEXTURE"===e[t].name)return e[t].value;return null}get params(){return this._samplerParams}get operator(){return this._operator}isConst(){return!0}evaluate(){var e={textureName:"",wrap_s:0,wrap_t:0,mag_filter:0,min_filter:0};return Object(n.f)(this.texture)||(e.textureName=this.texture.name),Object(n.f)(this._samplerParams)||(Object(n.d)(this._samplerParams.ADDRESSU)&&(e.wrap_s=u.convertWrapMode(this._samplerParams.ADDRESSU)),Object(n.d)(this._samplerParams.ADDRESSV)&&(e.wrap_t=u.convertWrapMode(this._samplerParams.ADDRESSV)),Object(n.d)(this._samplerParams.MAGFILTER)&&(e.mag_filter=u.convertFilters(this._samplerParams.MAGFILTER)),Object(n.d)(this._samplerParams.MINFILTER)&&(e.min_filter=u.convertFilters(this._samplerParams.MINFILTER))),this._evalResult=e,!0}static convertWrapMode(e){switch(e){case"WRAP":return s.b.REPEAT;case"CLAMP":return s.b.CLAMP_TO_EDGE;case"MIRROR":return s.b.MIRRORED_REPEAT;default:return 0}}static convertFilters(e){switch(e){case"NEAREST":return s.a.NEAREST;case"LINEAR":return s.a.LINEAR;case"NEAREST_MIPMAP_NEAREST":return s.a.NEAREST_MIPMAP_NEAREST;case"LINEAR_MIPMAP_NEAREST":return s.a.LINEAR_MIPMAP_NEAREST;case"NEAREST_MIPMAP_LINEAR":return s.a.NEAREST_MIPMAP_LINEAR;case"LINEAR_MIPMAP_LINEAR":return s.a.LINEAR_MIPMAP_LINEAR;default:return 0}}}},QsPN:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("4AA8"),a=r("Wl5j"),i=r("FrU9"),s=r("hljw");class o extends n.a{constructor({value:e,signed:t=!0,scope:r,...n}){super({instrType:i.b.k_IntExpr,type:s.a.wrapAsConst(a.e,a.a),scope:r,...n}),this.value=1*e}toString(){return`${this.value}`}toCode(){return this.toString()}evaluate(){return this._evalResult=this.value,!0}isConst(){return!0}}},RTx6:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("fb8x"),a=r("zioJ"),i=r("a1Km"),s=r("zX2+"),o=r("/zHR");class l extends o.b{constructor(){super("Analyzer Diagnostics","A")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.loc}diagnosticMessages(){return{[a.a.InvalidReturnStmtEmpty]:"Invalid return statement. Expression with '*type*' type expected.",[a.a.InvalidReturnStmtVoid]:"Invalid return statement. Expression with 'void' type expected.",[a.a.FunctionRedefinition]:"Function redefinition. Function with name '{info.funcName}' already declared.",[a.a.InvalidFuncDefenitionReturnType]:"Invalid function defenition return type. Function with the same name '{info.funcName}' but another type already declared.",[a.a.InvalidFunctionReturnStmtNotFound]:"Return statement expected.",[a.a.InvalidVariableInitializing]:"Invalid variable initializing."}}resolveDescription(e,t,r){let o=this.diagnosticMessages();if(Object(n.e)(o[e]))return super.resolveDescription(e,t,r);let{file:l,loc:u,...c}=r;return t==s.a.k_Warning?`${i.a[e]}: ${JSON.stringify(c)}`:`${a.a[e]}: ${JSON.stringify(c)}`}}},"Vs+U":function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"flag",(function(){return d})),r.d(n,"testBit",(function(){return h})),r.d(n,"testAll",(function(){return f})),r.d(n,"testAny",(function(){return m})),r.d(n,"setBit",(function(){return E})),r.d(n,"clearBit",(function(){return _})),r.d(n,"setAll",(function(){return y})),r.d(n,"clearAll",(function(){return T})),r.d(n,"equal",(function(){return g})),r.d(n,"isEqual",(function(){return x})),r.d(n,"isNotEqaul",(function(){return b})),r.d(n,"set",(function(){return S})),r.d(n,"clear",(function(){return R})),r.d(n,"setFlags",(function(){return k})),r.d(n,"clearFlags",(function(){return N})),r.d(n,"isEmpty",(function(){return A})),r.d(n,"totalBits",(function(){return C})),r.d(n,"totalSet",(function(){return O}));var a,i,s,o,l,u,c,p=r("fb8x");!function(e){e[e.k_Default=0]="k_Default",e[e.k_Necessary=1]="k_Necessary",e[e.k_Expose=2]="k_Expose",e[e.k_Skip=3]="k_Skip"}(a||(a={})),function(e){e[e.k_Ok=0]="k_Ok",e[e.k_Error=1]="k_Error"}(i||(i={})),function(e){e[e.k_LR0=0]="k_LR0",e[e.k_LR1=1]="k_LR1",e[e.k_LALR=2]="k_LALR"}(s||(s={})),function(e){e[e.k_Optimize=8]="k_Optimize",e[e.k_DeveloperMode=16]="k_DeveloperMode"}(o||(o={})),function(e){e[e.k_ForceAppendAll=1]="k_ForceAppendAll",e[e.k_AllowExposeMode=2]="k_AllowExposeMode",e[e.k_AllowAddMode=4]="k_AllowAddMode",e[e.k_AllowSkipMode=8]="k_AllowSkipMode",e[e.k_Default=14]="k_Default",e[e.k_Debug=16]="k_Debug"}(l||(l={})),function(e){e[e.k_NumericLiteral=1]="k_NumericLiteral",e[e.k_SinglelineCommentLiteral=2]="k_SinglelineCommentLiteral",e[e.k_MultilineCommentLiteral=3]="k_MultilineCommentLiteral",e[e.k_StringLiteral=4]="k_StringLiteral",e[e.k_PunctuatorLiteral=5]="k_PunctuatorLiteral",e[e.k_WhitespaceLiteral=6]="k_WhitespaceLiteral",e[e.k_NewlineLiteral=7]="k_NewlineLiteral",e[e.k_IdentifierLiteral=8]="k_IdentifierLiteral",e[e.k_KeywordLiteral=9]="k_KeywordLiteral",e[e.k_Unknown=10]="k_Unknown",e[e.k_End=11]="k_End"}(u||(u={})),function(e){e[e.k_Error=100]="k_Error",e[e.k_Shift=101]="k_Shift",e[e.k_Reduce=102]="k_Reduce",e[e.k_Success=103]="k_Success",e[e.k_Ok=104]="k_Ok"}(c||(c={}));var d=e=>1<<e,h=(e,t)=>0!=(e&d(t)),f=(e,t)=>(e&t)==t,m=(e,t)=>0!=(e&t),E=(e,t,r=!0)=>r?e|=d(t):_(e,t),_=(e,t)=>e&=~d(t),y=(e,t,r=!0)=>r?e|=t:e&=~t,T=(e,t)=>e&=~t,g=(e,t)=>{t},x=(e,t)=>e==t,b=(e,t)=>e!=t,S=(e,t)=>{t},R=e=>{0},k=(e,t)=>e|=t,N=(e,t)=>e&=~t,A=e=>0==e,C=e=>32,O=e=>{for(var t=0,r=C(e);r;--r)t+=1&e,e>>=1;return t},I=n,v=r("/zHR");const P="END",D="EMPTY",F="UNKNOWN",L="S",w="##",U="#",j="ERROR",B="$",W="--LEXER--",z="--add",M="--skip",V="--expose",q="--F",K="EOF",G="T_STRING",$="T_FLOAT",H="T_UINT",X="T_TYPE_ID",Z="T_NON_TYPE_ID",Q="T_LINE_TERMINATOR";class Y{constructor(e,t,r){this.rule=e,this.pos=t,this.index=0,this.expectedSymbols=new Set,r&&r.forEach(e=>this.addExpected(e))}isEqual(e,t=s.k_LR0){if(t===s.k_LR0)return this.rule===e.rule&&this.pos===e.pos;if(t===s.k_LR1){if(this.rule!==e.rule||this.pos!==e.pos||this.expectedSymbols.size!==e.expectedSymbols.size)return!1;for(const t of this.expectedSymbols)if(!e.isExpected(t))return!1;return!0}return!1}isParentItem(e){return this.rule===e.rule&&this.pos===e.pos+1}isChildItem(e){return this.rule===e.rule&&this.pos===e.pos-1}symbolName(){const e=this.rule.right;return this.pos===e.length?P:e[this.pos]}isExpected(e){return this.expectedSymbols.has(e)}addExpected(e){return!this.isExpected(e)&&(this.expectedSymbols.add(e),!0)}toString(e=null){const{left:t,right:r}=this.rule;let n=`${t} -> `;if(n+=r.map(t=>Y.decodeSymbol(t,e)).map((e,t)=>t===this.pos?`. ${e}`:`${e}`).join(" "),this.pos===r.length&&(n+=" . "),this.expectedSymbols){const t=Array.from(this.expectedSymbols).map(t=>Y.decodeSymbol(t,e));t.length&&(n+=", "+t.join(" "))}return n}static decodeSymbol(e,t){return t&&t.get(e)&&e!==t.get(e)?`'${t.get(e)}'`:e}}class J{constructor(e){this.content=e}valueOf(){return this.content}toString(){return this.content}toSource(){return this.content}static make(e){return Object(p.h)(e)?new J(`${e}`):e}}var ee,te;!function(e){e[e.UnknownToken=2101]="UnknownToken",e[e.InvalidToken=2102]="InvalidToken"}(ee||(ee={}));class re extends v.b{constructor(){super("Lexer Diagnostics","L")}resolveFilename(e,t){return t.file}resolveRange(e,t){return t.token.loc}diagnosticMessages(){return{[ee.UnknownToken]:"Unknown token: {token.value}.",[ee.InvalidToken]:"Invalid token: {token.value}."}}}class ne{constructor(){this.keywords={},this.punctuators={},this.punctuatorsFirstSymbols={}}addPunctuator(e,t=ne.getPunctuatorName(e)){return this.punctuators[e]=t,this.punctuatorsFirstSymbols[e[0]]=!0,t}addKeyword(e,t){return this.keywords[e]=t,t}getTerminalValueByName(e){let t="";for(t in this.punctuators)if(this.punctuators[t]===e)return t;for(t in this.keywords)if(this.keywords[t]===e)return t;return e}isLineTerminator(e){return"\n"===e||"\r"===e||"\u2028"===e||"\u2029"===e}isKeyword(e){return!!this.keywords[e]}isPunctuator(e){return!!this.punctuators[e]}isNumberStart(e,t){return e>="0"&&e<="9"||"."===e&&t>="0"&&t<="9"}isCommentStart(e,t){return"/"===e&&("/"===t||"*"===t)}isStringStart(e){return'"'===e||"'"===e}isPunctuatorStart(e){return!!this.punctuatorsFirstSymbols[e]}isWhiteSpaceStart(e){return" "===e||"\t"===e}isNewlineStart(e){return"\n"===e||"\r"===e}isIdentifierStart(e){return"_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"}static getPunctuatorName(e){return"T_PUNCTUATOR_"+e.charCodeAt(0)}}class ae{constructor({engine:e=new ne,knownTypes:t=new Set,skipComments:r=!0}){this.lineNumber=0,this.columnNumber=0,this.index=0,this.diagnostics=new re,this.knownTypes=t,this.engine=e,this.skipComments=r}setup(e){this.uri=J.make(e.uri),this.source=e.source}getDiagnosticReport(){return this.diagnostics.resolve()}getNextToken(e){if(!this.currentChar()){let e=this.pos();return{index:this.index,name:B,value:B,loc:{start:e,end:{...e}}}}let t=null;switch(this.identityTokenType()){case u.k_NumericLiteral:t=this.scanNumber();break;case u.k_SinglelineCommentLiteral:case u.k_MultilineCommentLiteral:t=this.scanComment(),this.skipComments&&(t=this.getNextToken());break;case u.k_StringLiteral:t=this.scanString();break;case u.k_PunctuatorLiteral:t=this.scanPunctuator();break;case u.k_IdentifierLiteral:t=this.scanIdentifier();break;case u.k_NewlineLiteral:t=this.scanLineTerminators(),e||(t=this.getNextToken());break;case u.k_WhitespaceLiteral:this.scanWhiteSpace(),t=this.getNextToken();break;default:{const e=this.pos();let r="";for(;this.identityTokenType()===u.k_Unknown&&this.index<this.source.length;)r+=this.currentChar(),this.readNextChar();return t={index:this.index,name:F,value:r,loc:{start:e,end:this.pos()}},this.emitError(ee.UnknownToken,t),t}}return t}getLocation(){return{line:this.lineNumber,file:this.uri}}setSource(e){this.source=e}setIndex(e){this.index=e}pos(e=0){return{file:this.uri,line:this.lineNumber,column:this.columnNumber+e,offset:this.index+e}}emitError(e,t){this.diagnostics.error(e,{file:`${this.uri}`,token:t})}identityTokenType(){return this.isIdentifierStart()?u.k_IdentifierLiteral:this.isWhiteSpaceStart()?u.k_WhitespaceLiteral:this.isNewlineStart()?u.k_NewlineLiteral:this.isStringStart()?u.k_StringLiteral:this.isCommentStart()?u.k_SinglelineCommentLiteral:this.isNumberStart()?u.k_NumericLiteral:this.isPunctuatorStart()?u.k_PunctuatorLiteral:u.k_Unknown}isNumberStart(){return this.engine.isNumberStart(this.currentChar(),this.nextChar())}isCommentStart(){return this.engine.isCommentStart(this.currentChar(),this.nextChar())}isStringStart(){return this.engine.isStringStart(this.currentChar())}isPunctuatorStart(){return this.engine.isPunctuatorStart(this.currentChar())}isWhiteSpaceStart(){return this.engine.isWhiteSpaceStart(this.currentChar())}isNewlineStart(){return this.engine.isNewlineStart(this.currentChar())}isIdentifierStart(){return this.engine.isIdentifierStart(this.currentChar())}nextChar(){return this.source[this.index+1]}currentChar(){return this.source[this.index]}readNextChar(){return this.index++,this.columnNumber++,this.source[this.index]}scanString(){let e=this.currentChar(),t=e,r="",n=e,a=!1,i=this.pos();for(;r=this.readNextChar();){if(t+=r,r===e&&"\\"!==n){a=!0,this.readNextChar();break}n=r}if(a)return{index:this.index,name:G,value:t,loc:{start:i,end:this.pos()}};{r||(r=K),t+=r;const e={index:this.index,type:u.k_StringLiteral,value:t,loc:{start:i,end:this.pos()}};return this.emitError(ee.InvalidToken,e),ae.makeUnknownToken(e)}}scanPunctuator(){let e,t=this.currentChar(),r=this.pos();for(;e=this.readNextChar();)if(t+=e,!this.engine.isPunctuator(t)){t=t.slice(0,t.length-1);break}return{index:this.index,name:this.engine.punctuators[t],value:t,loc:{start:r,end:this.pos()}}}scanNumber(){let e=this.currentChar(),t="",r=!1,n=e,a=!1,i=!1,s=this.pos();for("."===e&&(t+=0,r=!0),t+=e;;){if("."===(e=this.readNextChar())){if(r)break;r=!0}else if("e"===e){if(i)break;i=!0}else{if(("+"===e||"-"===e)&&"e"===n){t+=e,n=e;continue}if("f"===e&&r){if((e=this.readNextChar())>="a"&&e<="z"||e>="A"&&e<="Z")break;a=!0;break}if(e>="a"&&e<="z"||e>="A"&&e<="Z")break;if(!(e>="0"&&e<="9"&&e)){(i&&"+"!==n&&"-"!==n&&"e"!==n||!i)&&(a=!0);break}}t+=e,n=e}if(a){let e=r?$:H;return{index:this.index,name:e,value:t,loc:{start:s,end:this.pos()}}}{e||(e=K),t+=e;const r={index:this.index,type:u.k_NumericLiteral,value:t,loc:{start:s,end:this.pos()}};return this.emitError(ee.InvalidToken,r),ae.makeUnknownToken(r)}}scanIdentifier(){let e=this.currentChar(),t=e,r=this.pos(),n=!1;for(;;){if(!(e=this.readNextChar())){n=!0;break}if(!("_"===e||e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9")){n=!0;break}t+=e}if(n){if(this.engine.isKeyword(t))return{index:this.index,name:this.engine.keywords[t],value:t,loc:{start:r,end:this.pos()}};{let e=this.knownTypes.has(t)?X:Z;return{index:this.index,name:e,value:t,loc:{start:r,end:this.pos()}}}}{e||(e=K),t+=e;const n={index:this.index,type:u.k_IdentifierLiteral,value:t,loc:{start:r,end:this.pos()}};return this.emitError(ee.InvalidToken,n),ae.makeUnknownToken(n)}}scanLineTerminators(){let e=this.currentChar(),t="",r=this.pos();for(;e&&this.engine.isLineTerminator(e);)t+=e,"\r"===e&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,e=this.readNextChar(),this.columnNumber=0;let n=Q;return{index:this.index,name:n,value:t,loc:{start:r,end:this.pos()}}}scanWhiteSpace(){let e=this.currentChar();for(;e;){if("\t"===e)this.columnNumber+=0;else if(" "!==e)break;e=this.readNextChar()}return!0}scanComment(){let e=this.currentChar(),t=this.readNextChar(),r=this.pos();if(e+=t,"/"===t){for(;t=this.readNextChar();){if(this.engine.isLineTerminator(t)){"\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.readNextChar(),this.columnNumber=0;break}e+=t}return{index:this.index,type:u.k_SinglelineCommentLiteral,value:e,loc:{start:r,end:this.pos()}}}{let r=t,n=!1,a=this.pos();for(;t=this.readNextChar();){if(e+=t,"/"===t&&"*"===r){n=!0,this.readNextChar();break}this.engine.isLineTerminator(t)&&("\r"===t&&"\n"===this.nextChar()&&this.lineNumber--,this.lineNumber++,this.columnNumber=-1),r=t}if(n)return{index:this.index,type:u.k_MultilineCommentLiteral,value:e,loc:{start:a,end:this.pos()}};{t||(t=K),e+=t;const r={index:this.index,type:u.k_MultilineCommentLiteral,value:e,loc:{start:a,end:this.pos()}};return this.emitError(ee.InvalidToken,r),ae.makeUnknownToken(r)}}}static makeUnknownToken(e){return{...e,type:void 0,name:F,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}}class ie{constructor(){this.nextStates={},this.index=0,this.items=[],this.numBaseItems=0,this.numOtherItems=0}eachItem(e){for(let t=0;t<this.items.length;++t)e(this.items[t],t)}eachBaseItem(e){for(let t=0;t<this.numBaseItems;++t)e(this.items[t],t)}isExpected(e){return!!this.items.find(t=>t.isExpected(e))}hasItem(e,t){return this.items.find(r=>r.isEqual(e,t))||null}hasParentItem(e){return this.items.find(t=>t.isParentItem(e))||null}hasChildItem(e){return this.items.find(t=>t.isChildItem(e))||null}hasRule(e,t){for(let r=0;r<this.numBaseItems;++r){const n=this.items[r];if(n.rule===e&&n.pos===t)return!0}return!1}isEmpty(){return!this.items.length}isEqual(e,t){if(this.numBaseItems!==e.numBaseItems)return!1;for(let r=0;r<this.numBaseItems;++r){const n=this.items[r];let a=!1;for(let r=0;r<e.numBaseItems;++r){const i=e.items[r];if(n.isEqual(i,t)){a=!0;break}}if(!a)return!1}return!0}push(e){0===this.items.length||e.pos>0?(Object(p.a)(0===this.numOtherItems),this.numBaseItems++):this.numOtherItems++,this.items.push(e)}tryPush_LR0(e,t){if(this.items.find(r=>r.rule===e&&r.pos===t))return!1;const r=new Y(e,t);return this.push(r),!0}tryPush_LR(e,t,r){const n=this.items.find(r=>r.rule===e&&r.pos===t);if(n)return n.addExpected(r);const a=new Y(e,t,[r]);return this.push(a),!0}addNextState(e,t){return!this.nextStates[e]&&(this.nextStates[e]=t,!0)}deleteNotBase(){this.items.length=this.numBaseItems}toString(e=!0,t=null){const r=e?this.items.slice(0,this.numBaseItems):this.items;return`State ${this.index}:\n`+r.map(e=>`\t\t${e.toString(t)}\n`).join()}}!function(e){e[e.GrammarAddOperation=2001]="GrammarAddOperation",e[e.GrammarAddStateLink=2002]="GrammarAddStateLink",e[e.GrammarUnexpectedSymbol=2003]="GrammarUnexpectedSymbol",e[e.GrammarInvalidAdditionalFuncName=2004]="GrammarInvalidAdditionalFuncName",e[e.GrammarInvalidKeyword=2005]="GrammarInvalidKeyword"}(te||(te={}));class se extends v.b{constructor(){super("Grammar diagnostics","G")}resolveFilename(e,t){return t.file}resolveRange(e,t){return null}resolvePosition(e,t){return{line:t.line,column:0,file:null}}diagnosticMessages(){return{[te.GrammarAddOperation]:'Grammar not LALR(1)! Cannot to generate syntax table. Add operation error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld operation: {oldOperation}\nNew operation: {newOperation}\nFor more info init parser in debug-mode and see syntax table and list of states.\n\n{stateDesc}',[te.GrammarAddStateLink]:'Grammar not LALR(1)! Cannot to generate syntax table. Add state link error.\nConflict in state with index: {stateIndex}. With grammar symbol: "{grammarSymbol}"\nOld next state: {oldNextStateIndex}\nNew next state: {newNextStateIndex}\nFor more info init parser in debug-mode and see syntax table and list of states.',[te.GrammarUnexpectedSymbol]:"Grammar error. Can`t generate rules from grammar\nUnexpected symbol: {unexpectedSymbol}\nExpected: {expectedSymbol}",[te.GrammarInvalidAdditionalFuncName]:"Grammar error. Empty additional function name.",[te.GrammarInvalidKeyword]:"Grammar error. Bad keyword: {badKeyword}\nAll keyword must be define in lexer rule block."}}}class oe{constructor({grammar:e,flags:t=l.k_Default,type:r=s.k_LALR}){this._syntaxTable=null,this._productions=null,this._baseItems=null,this._states=null,this._additionalFuncInfoList=null,this._adidtionalFunctByStateDMap=null,this._ruleCreationModeMap=null,this._firstTerminalsCache=null,this._closureForItemsCache=null,this._expectedExtensionDMap=null,this._diag=new se,this.init({grammar:e,flags:t,type:r})}get syntaxTable(){return this._syntaxTable}findFunctionByState(e,t){const r=this._adidtionalFunctByStateDMap;return!Object(p.f)(r)&&Object(p.d)(r[e])&&Object(p.d)(r[e][t])?r[e][t]:null}getRuleCreationMode(e){return this._ruleCreationModeMap[e]}getGrammarSymbols(){return this._grammarSymbols}init({grammar:e,flags:t=l.k_Default,type:r=s.k_LALR}){this.lexerEngine=new ne,this.generateRules(e,t),this.buildSyntaxTable(r),this.generateFunctionByStateMap(),I.testAll(t,l.k_Debug)||this.clearMem()}printStates(e=!0){if(!Object(p.d)(this._states))return void console.warn("It`s impossible to print states. You must init parser in debug-mode");const t="\n"+this.statesToString(e);console.log(t)}printState(e,t=!0){if(Object(p.d)(this._states)){var r=this._states[e];Object(p.d)(r)?console.log(`\n${r.toString(t,this.getGrammarSymbols())}`):console.log("Can not print stete with index: "+e.toString())}else console.log("It`s impossible to print states. You must init parser in debug-mode.")}critical(e,t){this._diag.critical(e,t)}grammarError(e,t){let r="grammar";switch(e){case te.GrammarAddOperation:{const{stateIndex:n,grammarSymbol:a,oldOperation:i,newOperation:s}=t;this.critical(e,{file:r,line:0,stateIndex:n,grammarSymbol:a,oldOperation:oe.operationToString(i),newOperation:oe.operationToString(s),stateDesc:this._states[n].toString()})}break;case te.GrammarAddStateLink:{const{stateIndex:n,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s}=t;this.critical(e,{file:r,line:0,stateIndex:n,grammarSymbol:a,oldNextStateIndex:i,newNextStateIndex:s})}break;case te.GrammarUnexpectedSymbol:{const{grammarLine:n,expectedSymbol:a,unexpectedSymbol:i}=t;this.critical(e,{file:r,line:n,expectedSymbol:a,unexpectedSymbol:i})}break;case te.GrammarInvalidAdditionalFuncName:{const{grammarLine:n}=t;this.critical(e,{file:r,line:n})}break;case te.GrammarInvalidKeyword:{const{grammarLine:n,badKeyword:a}=t;this.critical(e,{file:r,line:n,badKeyword:a})}break;default:throw"invalid case!!!!"}}clearMem(){delete this._states,delete this._productions,delete this._baseItems,delete this._firstTerminalsCache,delete this._closureForItemsCache,delete this._expectedExtensionDMap}hasState(e,t){return this._states.find(r=>r.isEqual(e,t))||null}nonTerminals(){return Object.keys(this._productions)}rules(e){const t=this._productions[e];return t?Object.keys(t).map(e=>t[e]):null}ruleCreationMode(e){return this._ruleCreationModeMap[e]}symbols(){return[...this._grammarSymbols.keys()]}isTerminal(e){return!this._productions[e]}pushState(e){e.index=this._states.length,this._states.push(e)}pushBaseItem(e){e.index=this._baseItems.length,this._baseItems.push(e)}tryAddState(e,t){let r=this.hasState(e,t);return Object(p.f)(r)?(t===s.k_LR0&&e.eachItem(e=>this.pushBaseItem(e)),this.pushState(e),this.closure(e,t),e):r}hasEmptyRule(e){return!this.isTerminal(e)&&!!this.rules(e).find(e=>0===e.right.length)}pushInSyntaxTable(e,t,r,n){e[t]=e[t]||{},Object(p.d)(e[t][r])&&this.grammarError(te.GrammarAddOperation,{stateIndex:t,grammarSymbol:this.convertGrammarSymbol(r),oldOperation:this._syntaxTable[t][r],newOperation:n}),e[t][r]=n}addStateLink(e,t,r){e.addNextState(r,t)||this.grammarError(te.GrammarAddStateLink,{stateIndex:e.index,oldNextStateIndex:e.nextStates[r]||null,newNextStateIndex:t.index,grammarSymbol:this.convertGrammarSymbol(r)})}firstTerminals(e){if(this.isTerminal(e))return null;if(Object(p.d)(this._firstTerminalsCache[e]))return this._firstTerminalsCache[e];const t=this.rules(e),r=this._firstTerminalsCache[e]=new Set;if(this.hasEmptyRule(e)&&r.add(D),Object(p.f)(t))return r;for(let n=0;n<t.length;++n){const a=t[n].right;let i=!1;for(let t=0;t<a.length;t++){if(a[t]===e){if(r.has(D))continue;i=!0;break}const n=this.firstTerminals(a[t]);if(Object(p.f)(n))r.add(a[t]);else for(const e of n)r.add(e);if(!this.hasEmptyRule(a[t])){i=!0;break}}i||r.add(D)}return r}firstTerminalsForSet(e,t){const r=new Set;for(let t=0;t<e.length;t++){const n=this.firstTerminals(e[t]);if(Object(p.f)(n))return r.add(e[t]),r;let a=!1;for(const e of n)e!==D?r.add(e):a=!0;if(!a)return r}return Object(p.f)(t)||t.forEach(e=>r.add(e)),r}generateRules(e,t){let r,n,i=e.split(/\r?\n/),s=!1;this._productions={},this._additionalFuncInfoList=[],this._ruleCreationModeMap={},this._grammarSymbols=new Map([["END_SYMBOL",B]]);let o=0,u=0;const c=I.testAll(t,l.k_ForceAppendAll),d=I.testAll(t,l.k_AllowExposeMode),h=I.testAll(t,l.k_AllowAddMode),f=I.testAll(t,l.k_AllowSkipMode);let m,E=this._ruleCreationModeMap,_=0;for(o=0;o<i.length;o++)if(""!==i[o]&&"\r"!==i[o]&&(r=i[o].trim().split(/\s* \s*/))[0][0]!=U)if(s){if((3===r.length||4===r.length&&""===r[3])&&('"'===r[2][0]||"'"===r[2][0])&&r[2].length>3){r[2][0]!==r[2][r[2].length-1]&&this.grammarError(te.GrammarUnexpectedSymbol,{unexpectedSymbol:r[2][r[2].length-1],expectedSymbol:r[2][0],grammarLine:o}),r[2]=r[2].slice(1,r[2].length-1);var y=r[2][0];m="_"===y||y>="a"&&y<="z"||y>="A"&&y<="Z"?this.lexerEngine.addKeyword(r[2],r[0]):this.lexerEngine.addPunctuator(r[2],r[0]),this._grammarSymbols.set(m,r[2])}}else if(r[0]!==W){for(Object(p.d)(this._productions[r[0]])||(this._productions[r[0]]={}),n={left:r[0],right:[],index:0},this._grammarSymbols.set(r[0],r[0]),c?E[r[0]]=a.k_Default:d&&!Object(p.d)(E[r[0]])?E[r[0]]=a.k_Default:h&&!Object(p.d)(E[r[0]])?E[r[0]]=a.k_Expose:f&&!Object(p.d)(E[r[0]])&&(E[r[0]]=a.k_Skip),u=2;u<r.length;u++)if(""!==r[u])if(r[u]!==z)if(r[u]!==M)if(r[u]!==V)if(r[u]!==q)"'"===r[u][0]||'"'===r[u][0]?(3!==r[u].length&&this.grammarError(te.GrammarInvalidKeyword,{badKeyword:r[u],grammarLine:o}),r[u][0]!==r[u][2]&&this.grammarError(te.GrammarUnexpectedSymbol,{unexpectedSymbol:r[u][2],expectedSymbol:r[u][0],grammarLine:o}),m=this.lexerEngine.addPunctuator(r[u][1]),n.right.push(m),this._grammarSymbols.set(m,r[u][1])):(n.right.push(r[u]),this._grammarSymbols.set(r[u],r[u]));else{r[u+1]&&0!==r[u+1].length||this.grammarError(te.GrammarInvalidAdditionalFuncName,{grammarLine:o});const e={name:r[u+1],position:n.right.length,rule:n};this._additionalFuncInfoList.push(e),u++}else d&&!c&&(E[r[0]]=a.k_Expose);else f&&!c&&(E[r[0]]=a.k_Skip);else h&&(E[r[0]]=a.k_Necessary);n.index=_,this._productions[r[0]][n.index]=n,_++,Object(p.a)(1!=_||Object(p.d)(this._productions[L][0]))}else s=!0}generateFunctionByStateMap(){const e=this._states,t=this._additionalFuncInfoList,r=this._adidtionalFunctByStateDMap={};for(let n=0;n<t.length;n++){const a=t[n],i=a.rule,s=a.position,o=i.right[s-1];for(let t=0;t<e.length;t++)e[t].hasRule(i,s)&&(r[e[t].index]=r[e[t].index]||{},r[e[t].index][o]=a.name)}}generateFirstState_LR0(){const e=new ie,t=this._productions[L][0],r=new Y(t,0);this.pushBaseItem(r),e.push(r),this.closure_LR0(e),this.pushState(e)}generateFirstState_LR(){const e=new ie,t=this._productions[L][0];e.push(new Y(t,0,[B])),this.closure_LR(e),this.pushState(e)}closure(e,t){t===s.k_LR0?this.closure_LR0(e):this.closure_LR(e)}closure_LR0(e){e.eachItem(t=>{const r=t.symbolName();r===P||this.isTerminal(r)||this.rules(r).forEach(t=>e.tryPush_LR0(t,0))})}closure_LR(e){let t;do{t=!1,e.eachItem(r=>{const n=r.symbolName();if(n!==P&&!this.isTerminal(n)){const a=r.rule.right.slice(r.pos+1),i=this.firstTerminalsForSet(a,r.expectedSymbols);this.rules(n).forEach(r=>{i.forEach(n=>{e.tryPush_LR(r,0,n)&&(t=!0)})})}})}while(t)}static nextState_LR0(e,t){const r=new ie;return e.eachItem(e=>{e.symbolName()===t&&r.push(new Y(e.rule,e.pos+1))}),r}static nextState_LR(e,t){const r=new ie;return e.eachItem(e=>{if(e.symbolName()===t){const t=Array.from(e.expectedSymbols);r.push(new Y(e.rule,e.pos+1,t))}}),r}deleteNotBaseItems(){this._states.forEach(e=>e.deleteNotBase())}closureForItem({rule:e,pos:t}){const r=e.index+"_"+t;let n=this._closureForItemsCache[r];return Object(p.d)(n)?n:((n=new ie).push(new Y(e,t,[w])),this.closure_LR(n),this._closureForItemsCache[r]=n,n)}addLinkExpected(e,t){let r=this._expectedExtensionDMap,n=e.index;r[n]=r[n]||{},r[n][t.index]=!0}determineExpected(e,t){const r=e.nextStates[t]||null;Object(p.f)(r)||e.eachBaseItem(e=>{const t=this.closureForItem(e);r.eachBaseItem(r=>{const n=t.hasChildItem(r);n&&n.expectedSymbols.forEach(t=>{t===w?this.addLinkExpected(e,r):r.addExpected(t)})})})}generateLinksExpected(){const e=this._states,t=this.symbols();e.forEach(e=>t.forEach(t=>this.determineExpected(e,t)))}expandExpected(){const e=this._baseItems,t=e.map(e=>!0),r=this._expectedExtensionDMap;let n;e[0].addExpected(B),t[0]=!0;do{n=!1,e.forEach(a=>{if(t[a.index]&&Object(p.e)(r[a.index])){let i=Object.keys(r[a.index]).map(e=>Number(e));a.expectedSymbols.forEach(r=>{i.forEach(a=>{e[a].addExpected(r)&&(t[a]=!0,n=!0)})})}t[a.index]=!1})}while(n)}generateStates(e){e===s.k_LR0?this.generateStates_LR0():e===s.k_LR1?this.generateStates_LR():e===s.k_LALR&&this.generateStates_LALR()}generateStates_LR0(){this.generateFirstState_LR0();const e=this._states,t=this.symbols();for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<t.length;e++){const r=t[e];let a=oe.nextState_LR0(n,r);a.isEmpty()||(a=this.tryAddState(a,s.k_LR0),this.addStateLink(n,a,r))}}}generateStates_LR(){this._firstTerminalsCache={},this.generateFirstState_LR();const e=this._states,t=this.symbols();for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<t.length;e++){let r=t[e],a=oe.nextState_LR(n,r);a.isEmpty()||(a=this.tryAddState(a,s.k_LR1),this.addStateLink(n,a,r))}}}generateStates_LALR(){this._baseItems=[],this._expectedExtensionDMap={},this._closureForItemsCache={},this._firstTerminalsCache={},this.generateStates_LR0(),this.deleteNotBaseItems(),this.generateLinksExpected(),this.expandExpected(),this._states.forEach(e=>this.closure_LR(e))}addReducing(e,t,r){t.eachItem(n=>{if(n.symbolName()===P)if(n.rule.left===L)this.pushInSyntaxTable(e,t.index,B,{type:c.k_Success});else for(const a of n.expectedSymbols)this.pushInSyntaxTable(e,t.index,a,r[n.rule.index])})}addShift(e,t,r){const n=t.nextStates,a=Object.keys(n);for(let i=0;i<a.length;i++){const s=n[a[i]];this.pushInSyntaxTable(e,t.index,a[i],r[s.index])}}buildSyntaxTable(e){this._states=[],this._syntaxTable={};const t=this._states,r=this._syntaxTable;this.generateStates(e);const n={},a={};t.forEach(e=>{a[e.index]={type:c.k_Shift,stateIndex:e.index}}),this.nonTerminals().forEach(e=>{this.rules(e).forEach(e=>{n[e.index]={type:c.k_Reduce,rule:e}})}),t.forEach(e=>{this.addReducing(r,e,n),this.addShift(r,e,a)})}statesToString(e=!0){if(!this._states)return"";let t="";for(let r=0;r<this._states.length;r++)t+=this._states[r].toString(e,this._grammarSymbols),t+=" ";return t}static operationToString(e){let t="";switch(e.type){case c.k_Shift:t="SHIFT to state "+e.stateIndex.toString();break;case c.k_Reduce:t="REDUCE by rule { "+oe.ruleToString(e.rule)+" }";break;case c.k_Success:t="SUCCESS"}return t}static ruleToString(e){let t;return t=e.left+" : "+e.right.join(" ")}convertGrammarSymbol(e){return this.isTerminal(e)?this.lexerEngine.getTerminalValueByName(e):e}}oe.$parserEngine=null,oe.$parserParams=null;var le="S : Program\r\nProgram : --add\r\nProgram : Decls\r\n\r\nDecls : Decl --expose\r\nDecls : Decls Decl\r\n\r\nDecl : ';'\r\nDecl : TypeDecl\r\nDecl : VariableDecl\r\nDecl : VarStructDecl\r\nDecl : FunctionDecl\r\nDecl : TechniqueDecl\r\n#if FX_PART\r\n    Decl : PartFxDecl\r\n#endif \r\nDecl : UseDecl\r\nDecl : ImportDecl\r\nDecl : ProvideDecl\r\nDecl : IncludeDecl\r\nDecl : ERROR\r\n\r\nIncludeDecl : '#' T_KW_INCLUDE String --skip --F includeCode\r\n\r\nImportDecl : T_KW_IMPORT String ';'\r\n\r\nProvideDecl : T_KW_PROVIDE ComplexNameOpt ';'\r\nProvideDecl : T_KW_PROVIDE ComplexNameOpt T_KW_AS ComplexNameOpt ';'\r\n\r\nUseDecl : T_KW_USE Mode\r\nMode : T_KW_STRICT\r\n\r\nUsages : Usage --expose\r\nUsages : Usages Usage\r\nUsage : T_KW_STATIC --add\r\nUsage : T_KW_UNIFORM\r\nUsage : T_KW_EXTERN\r\nUsage : T_KW_VOLATILE\r\nUsage : T_KW_INLINE\r\nUsage : ConstUsage\r\n\r\nConstUsages : ConstUsage --expose\r\nConstUsages : ConstUsages ConstUsage\r\nConstUsage : T_KW_CONST\r\nConstUsage : T_KW_ROW_MAJOR\r\nConstUsage : T_KW_COLUMN_MAJOR\r\n\r\nUsageType : Type --add\r\nUsageType : Usages Type\r\n\r\nUsageStructDecl : StructDecl --add\r\nUsageStructDecl : Usages StructDecl\r\n\r\nTypeDecl : T_KW_TYPEDEF ConstType TypeDefs ';' --add\r\nTypeDecl : T_KW_TYPEDEF ConstStructDecl TypeDefs ';'\r\nTypeDecl : StructDecl --F addType ';'\r\nTypeDefs : VariableDim\r\nTypeDefs : VariableDim ',' TypeDefs\r\n\r\n# GenericParams : '<' Arguments '>'\r\n# GenericParamsOpt: --expose\r\n# GenericParamsOpt: GenericParams\r\n\r\nType : BaseType --add\r\nType : Struct\r\nType : TypeId\r\nType : T_KW_STRUCT TypeId\r\n\r\nConstType : Type --add\r\nConstType : ConstUsages Type\r\nConstTypeDim : ConstType --expose\r\nConstTypeDim : ConstTypeDim '[' ConstantExpr ']'\r\n\r\nBaseType : T_KW_VOID --add\r\nBaseType : ScalarType\r\nBaseType : VectorType\r\nBaseType : MatrixType\r\nBaseType : ObjectType\r\n\r\nScalarType : T_KW_BOOL --add\r\nScalarType : T_KW_INT\r\nScalarType : T_KW_UINT\r\nScalarType : T_KW_HALF\r\nScalarType : T_KW_FLOAT\r\nScalarType : T_KW_DOUBLE\r\n\r\nVectorType : T_KW_VECTOR --add\r\nVectorType : T_KW_VECTOR '<' ScalarType ',' AddExpr '>'\r\n\r\nMatrixType : T_KW_MATRIX --add\r\nMatrixType : T_KW_MATRIX '<' ScalarType ',' ConstantExpr ',' AddExpr '>'\r\n\r\nObjectType : T_KW_STRING --add\r\nObjectType : T_KW_TEXTURE\r\nObjectType : T_KW_TEXTURE1D\r\nObjectType : T_KW_TEXTURE2D\r\nObjectType : T_KW_TEXTURE3D\r\nObjectType : T_KW_TEXTURECUBE\r\nObjectType : T_KW_SAMPLER\r\nObjectType : T_KW_SAMPLER1D\r\nObjectType : T_KW_SAMPLER2D\r\nObjectType : T_KW_SAMPLER3D\r\nObjectType : T_KW_SAMPLERCUBE\r\nObjectType : T_KW_PIXELSHADER\r\nObjectType : T_KW_VERTEXSHADER\r\nObjectType : T_KW_PIXELFRAGMENT\r\nObjectType : T_KW_VERTEXFRAGMENT\r\nObjectType : T_KW_STATEBLOCK\r\nObjectType : T_KW_RWBUFFER '<' Type '>'\r\nObjectType : T_KW_RWSTRUCTUREDBUFFER '<' Type '>'\r\nObjectType : T_KW_APPENDSTRUCTUREDBUFFER '<' Type '>'\r\n\r\n\r\n# struct Name\r\n# {\r\n#     [InterpolationModifier] Type[RxC] MemberName;\r\n#     ...\r\n# };\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509668(v=vs.85).aspx\r\n\r\nStruct : T_KW_STRUCT '{' '}' --add\r\nStruct : T_KW_STRUCT '{' StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id '{' '}' --add\r\nStructDecl : T_KW_STRUCT Id '{' UseDecl StructDecls '}'\r\nStructDecl : T_KW_STRUCT Id '{' StructDecls '}'\r\n\r\nConstStructDecl : StructDecl\r\nConstStructDecl : ConstUsages StructDecl\r\n\r\nStructDecls : VariableDecl --expose\r\nStructDecls : VariableDecl StructDecls\r\n\r\nSemantic : ':' Id --add\r\nSemantic : ':' T_KW_REGISTER '(' Register ')'\r\nSemantics : Semantic\r\nSemantics : Semantics Semantic\r\nSemanticsOpt :\r\nSemanticsOpt : Semantics\r\n\r\nRegister : Id\r\nRegister : Target ',' Id\r\n\r\nAnnotation : AnnotationBegin AnnotationEnd  --add\r\nAnnotation : AnnotationBegin AnnotationDecls AnnotationEnd\r\nAnnotationOpt :\r\nAnnotationOpt : Annotation\r\nAnnotationBegin : '<'\r\nAnnotationDecls : VariableDecl\r\nAnnotationDecls : VariableDecl AnnotationDecls\r\nAnnotationEnd : '>'\r\n\r\nInitializer : '=' AssignmentExpr --add\r\nInitializer : '=' ERROR --add\r\nInitializer : '=' '{' InitExprs '}'\r\nInitializer : '=' '{' InitExprs ',' '}'\r\n\r\n# InitializerOpt :\r\n# InitializerOpt : Initializer\r\n\r\n\r\n# [Storage_Class] [Type_Modifier] Type Name[Index]\r\n#    [: Semantic]\r\n#    [: Packoffset]\r\n#    [: Register];\r\n#    [Annotations]\r\n#    [= Initial_Value]\r\n#\r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509706(v=vs.85).aspx\r\n\r\nVariableDecl : UsageType Variables ';' --add\r\nVariableDecl : UsageType Variables ERROR --add\r\nVarStructDecl : UsageStructDecl Variables ';' --add\r\nVariables : Variable --expose\r\nVariables : Variables ',' Variable\r\n# Variables : Variables ERROR Variable\r\nVariables : Variables ',' ERROR\r\nVariable : VariableDim SemanticsOpt AnnotationOpt Initializer --add\r\nVariable : VariableDim SemanticsOpt AnnotationOpt --add\r\nVariableDim : NonTypeId --add\r\nVariableDim : VariableDim '[' ConstantExpr ']'\r\n\r\n\r\n# [StorageClass] [clipplanes()] [precise] Return_Value Name ( [ArgumentList] ) [: Semantic]\r\n# {\r\n#   [StatementBlock]\r\n# };\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509607(v=vs.85).aspx\r\n\r\nFunctionDecl : Attributes FunctionDef ';' --add\r\nFunctionDecl : FunctionDef ';' --add\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt StmtBlock\r\nFunctionDecl : FunctionDef AnnotationOpt StmtBlock\r\n\r\n# TODO: remove it;\r\nFunctionDecl : Attributes FunctionDef AnnotationOpt ERROR\r\nFunctionDecl : FunctionDef AnnotationOpt ERROR\r\n\r\nFunctionDef : UsageType NonTypeId ParamList SemanticsOpt\r\n\r\nAttribute : '[' Id '(' ArgumentsOpt ')' ']'\r\nAttribute : '[' Id ']'\r\nAttributes : Attribute --expose\r\nAttributes : Attributes Attribute\r\nAttributesOpt : --expose\r\nAttributesOpt : Attributes\r\n\r\nParamList : '(' ')'\r\nParamList : '(' T_KW_VOID ')'\r\nParamList : '(' ParameterDecls ')'\r\n\r\n\r\n# [InputModifier] Type Name [: Semantic] [InterpolationModifier] [= Initializers]\r\n# \r\n# https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509606(v=vs.85).aspx\r\n\r\nParameterDecls : ParameterDecl --expose\r\nParameterDecls : ParameterDecls ',' ParameterDecl\r\nParameterDecls : ParameterDecls ERROR ParameterDecl\r\nParameterDecls : ParameterDecls ',' ERROR\r\nParameterDecls : ERROR\r\nParameterDecl : ParamUsageType Variable\r\n\r\nParamUsageType : Type --add\r\nParamUsageType : ParamUsages Type\r\n\r\nParamUsages : ParamUsage --expose\r\nParamUsages : ParamUsages ParamUsage\r\nParamUsage : T_KW_IN --add\r\nParamUsage : T_KW_OUT\r\nParamUsage : T_KW_INOUT\r\nParamUsage : T_KW_UNIFORM\r\nParamUsage : ConstUsage\r\n\r\n\r\nTechniqueDecl : T_KW_TECHNIQUE ComplexNameOpt SemanticsOpt AnnotationOpt TechniqueBody --add\r\nTechniqueBody : '{' '}'  --add\r\nTechniqueBody : '{' PassDecls '}'\r\n\r\nComplexNameOpt : ComplexName --add\r\nComplexName : Id --expose\r\nComplexName : ComplexName '.' Id\r\n\r\nPassDecls : PassDecl --expose\r\nPassDecls : PassDecls PassDecl\r\nPassDecl : T_KW_PASS IdOpt AnnotationOpt PassStateBlock --add\r\nPassDecl : ';'\r\n\r\nPassStateBlock : '{' '}' --add\r\nPassStateBlock : '{' PassStates '}'\r\nPassStates : PassState --expose\r\nPassStates : PassStates PassState\r\n\r\nPassState : Id StateIndex '=' PassStateExpr ';' --add\r\n\r\n# todo: move all particles declarations to separate grammar!\r\n#if FX_PART\r\n\r\nPartFxDecl : T_KW_FXPART ComplexNameOpt SemanticsOpt AnnotationOpt PartFxBody --add\r\n\r\nPartFxBody : '{' '}' \r\nPartFxBody : '{' PartFxProperties '}'\r\n\r\nPartFxProperties : PartFxProperty --expose\r\nPartFxProperties : PartFxProperties PartFxProperty\r\n\r\nPartFxProperty : PassState\r\nPartFxProperty : PassDecl\r\n\r\n#endif // FX_PART\r\n\r\nStateBlock : '{' '}' --add\r\nStateBlock : '{' States '}'\r\n\r\n\r\nStates : State --expose\r\nStates : States State\r\nState : Id StateIndex '=' StateExpr ';' --add\r\n\r\nStateIndex :\r\nStateIndex : '[' Uint ']'\r\n\r\nStmtBlock : '{' '}' --add\r\nStmtBlock : '{' Stmts '}'  \r\n\r\nStmts : Stmt --expose\r\nStmts : Stmts Stmt\r\n\r\n# SimpleStmt : ERROR ';' \r\n# SimpleStmt : ';' --add\r\n\r\nSimpleStmt : Expr ';'\r\nSimpleStmt : Expr ERROR\r\nSimpleStmt : T_KW_RETURN ';'\r\nSimpleStmt : T_KW_RETURN Expr ';'\r\nSimpleStmt : T_KW_RETURN ERROR ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' Expr ')' ';'\r\nSimpleStmt : T_KW_DO Stmt T_KW_WHILE '(' ERROR ')' ';'\r\nSimpleStmt : StmtBlock\r\nSimpleStmt : T_KW_DISCARD ';'\r\nSimpleStmt : TypeDecl\r\nSimpleStmt : VariableDecl --add\r\nSimpleStmt : VarStructDecl\r\nSimpleStmt : T_KW_BREAK ';'\r\nSimpleStmt : T_KW_BREAK ERROR\r\nSimpleStmt : T_KW_CONTINUE ';'\r\nSimpleStmt : T_KW_CONTINUE ERROR\r\n\r\n#if FX_PART\r\nSimpleStmt : T_KW_SPAWN '(' Uint ')' NonTypeId '(' ArgumentsOpt ')' ';'\r\n#endif\r\n\r\n\r\nNonIfStmt : SimpleStmt --add\r\nNonIfStmt : WhileStmt NonIfStmt\r\nNonIfStmt : ForStmt NonIfStmt\r\n\r\nStmt : SimpleStmt --add\r\nStmt : UseDecl\r\nStmt : WhileStmt Stmt\r\nStmt : ForStmt Stmt\r\nStmt : IfStmt Stmt\r\nStmt : IfStmt NonIfStmt T_KW_ELSE Stmt\r\nStmt : ERROR\r\nStmt : ';'\r\n\r\nIfStmt : AttributesOpt T_KW_IF '(' Expr ')' --expose\r\nIfStmt : AttributesOpt T_KW_IF '(' ERROR ')' --expose\r\n\r\nWhileStmt : T_KW_WHILE '(' Expr ')' --expose\r\nWhileStmt : T_KW_WHILE '(' ERROR ')' --expose\r\n\r\nForStmt : For '(' ForInit ForCond ForStep ')' --expose\r\nForStmt : For ERROR --expose\r\n\r\nFor : T_KW_FOR\r\n\r\nForInit : ';' --add\r\nForInit : Expr ';'\r\nForInit : VariableDecl\r\nForInit : ERROR ';'\r\n\r\nForCond : ';' --add\r\nForCond : Expr ';'\r\nForCond : ERROR ';'\r\n\r\nForStep : --add\r\nForStep : Expr\r\nForStep : ERROR\r\n\r\nDwordExpr : Dword\r\nDwordExpr : Dword '|' DwordExpr\r\n\r\nDwordExprSeq : DwordExpr --expose\r\nDwordExprSeq : DwordExpr ',' DwordExprSeq\r\n\r\nPassStateExpr : DwordExpr --add\r\nPassStateExpr : ComplexExpr\r\nPassStateExpr : '{' DwordExprSeq '}'\r\n\r\nStateExpr : DwordExpr --add\r\nStateExpr : ComplexExpr\r\nStateExpr : '{' InitExprs '}'\r\nStateExpr : '{' InitExprs ',' '}'\r\nStateExpr : '<' RelationalExpr '>'\r\n\r\nSimpleExpr : T_KW_TRUE\r\nSimpleExpr : T_KW_FALSE\r\nSimpleExpr : Uint\r\nSimpleExpr : Float\r\nSimpleExpr : String\r\nSimpleExpr : NonTypeId\r\n\r\nComplexExpr : '(' Expr ')'\r\nComplexExpr : TypeId '(' ArgumentsOpt ')'\r\nComplexExpr : BaseType '(' ArgumentsOpt ')'\r\nComplexExpr : NonTypeId '(' ArgumentsOpt ')'\r\nComplexExpr : PostfixPointExpr '(' ArgumentsOpt ')'\r\nComplexExpr : ObjectExpr\r\n\r\nObjectExpr : T_KW_COMPILE NonTypeId '(' ArgumentsOpt ')'\r\nObjectExpr : T_KW_SAMPLER_STATE StateBlock\r\nObjectExpr : T_KW_COMPILE_FRAGMENT Target NonTypeId '(' ArgumentsOpt ')'\r\nObjectExpr : T_KW_STATEBLOCK_STATE StateBlock\r\n\r\nPrimaryExpr : ComplexExpr\r\nPrimaryExpr : SimpleExpr\r\nPostfixExpr : PrimaryExpr\r\nPostfixExpr : PostfixExpr '[' Expr ']'\r\nPostfixExpr : PostfixExpr '[' ERROR ']'\r\nPostfixExpr : PostfixExpr '.' Id\r\nPostfixExpr : PostfixExpr T_OP_INC\r\nPostfixExpr : PostfixExpr T_OP_DEC\r\n\r\nPostfixPointExpr : PostfixExpr '.' Id\r\n\r\nUnaryExpr : PostfixExpr\r\nUnaryExpr : T_OP_INC UnaryExpr\r\nUnaryExpr : T_OP_DEC UnaryExpr\r\n# UnaryExpr : T_OP_INC ERROR\r\n# UnaryExpr : T_OP_DEC ERROR\r\nUnaryExpr : '!' CastExpr\r\n# UnaryExpr : '!' ERROR\r\nUnaryExpr : '-' CastExpr\r\nUnaryExpr : '+' CastExpr\r\n\r\nCastExpr : UnaryExpr\r\nCastExpr : '(' ConstTypeDim ')' CastExpr\r\nCastExpr : '(' ERROR ')' CastExpr\r\n\r\nMulExpr : CastExpr\r\nMulExpr : MulExpr '*' CastExpr\r\nMulExpr : MulExpr '/' CastExpr\r\nMulExpr : MulExpr '%' CastExpr\r\n\r\nMulExpr : ERROR '*' CastExpr\r\nMulExpr : ERROR '/' CastExpr\r\nMulExpr : ERROR '%' CastExpr\r\nMulExpr : MulExpr '*' ERROR\r\nMulExpr : MulExpr '/' ERROR\r\nMulExpr : MulExpr '%' ERROR\r\n# MulExpr : ERROR '*' ERROR\r\n# MulExpr : ERROR '/' ERROR\r\n# MulExpr : ERROR '%' ERROR\r\n\r\nAddExpr : MulExpr\r\nAddExpr : AddExpr '+' MulExpr\r\nAddExpr : AddExpr '-' MulExpr\r\n\r\nAddExpr : AddExpr '+' ERROR\r\nAddExpr : AddExpr '-' ERROR\r\n\r\nRelationalExpr : AddExpr\r\nRelationalExpr : RelationalExpr '<' AddExpr\r\nRelationalExpr : RelationalExpr '>' AddExpr\r\nRelationalExpr : RelationalExpr T_OP_LE AddExpr\r\nRelationalExpr : RelationalExpr T_OP_GE AddExpr\r\n\r\nRelationalExpr : ERROR '<' AddExpr\r\nRelationalExpr : RelationalExpr '<' ERROR\r\nRelationalExpr : ERROR '<' ERROR\r\n\r\nRelationalExpr : RelationalExpr '>' ERROR\r\nRelationalExpr : ERROR '>' AddExpr\r\nRelationalExpr : ERROR '>' ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_LE ERROR\r\nRelationalExpr : ERROR T_OP_LE AddExpr\r\nRelationalExpr : ERROR T_OP_LE ERROR\r\n\r\nRelationalExpr : RelationalExpr T_OP_GE ERROR\r\nRelationalExpr : ERROR T_OP_GE AddExpr\r\nRelationalExpr : ERROR T_OP_GE ERROR\r\n\r\nEqualityExpr : RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE RelationalExpr\r\nEqualityExpr : ERROR T_OP_EQ RelationalExpr\r\nEqualityExpr : EqualityExpr T_OP_NE ERROR\r\nEqualityExpr : ERROR T_OP_NE ERROR\r\n\r\nAndExpr : EqualityExpr\r\nAndExpr : AndExpr T_OP_AND EqualityExpr\r\nAndExpr : ERROR T_OP_AND EqualityExpr\r\nAndExpr : AndExpr T_OP_AND ERROR\r\n\r\nOrExpr : AndExpr\r\nOrExpr : OrExpr T_OP_OR AndExpr\r\nOrExpr : OrExpr T_OP_OR ERROR\r\nOrExpr : ERROR T_OP_OR AndExpr\r\n\r\nConditionalExpr : OrExpr\r\nConditionalExpr : OrExpr '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : ERROR '?' AssignmentExpr ':' ConditionalExpr\r\nConditionalExpr : OrExpr '?' ERROR ':' ConditionalExpr\r\nConditionalExpr : OrExpr '?' AssignmentExpr ':' ERROR\r\nConditionalExpr : OrExpr '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ERROR\r\nConditionalExpr : ERROR '?' ERROR ':' ConditionalExpr\r\n\r\nAssignmentExpr : ConditionalExpr\r\nAssignmentExpr : CastExpr '=' AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_ME AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_DE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_RE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_AE AssignmentExpr\r\nAssignmentExpr : CastExpr T_OP_SE AssignmentExpr\r\n\r\nArguments : AssignmentExpr --expose\r\nArguments : Arguments ',' AssignmentExpr\r\nArguments : Arguments ERROR AssignmentExpr\r\nArguments : Arguments ',' ERROR\r\nArgumentsOpt : --expose\r\nArgumentsOpt : Arguments\r\n\r\nInitExpr : AssignmentExpr --add\r\nInitExpr : '{' InitExprs '}'\r\nInitExpr : '{' InitExprs ',' '}'\r\nInitExprs : InitExpr --expose\r\nInitExprs : InitExprs ',' InitExpr\r\n\r\nConstantExpr : AssignmentExpr\r\nExpr : AssignmentExpr\r\nExpr : Expr ',' AssignmentExpr\r\nExpr : Expr ',' ERROR\r\nExpr : ERROR ',' ERROR\r\nExpr : ERROR ',' AssignmentExpr\r\n\r\nDword : Uint\r\nDword : '-' Uint\r\nDword : Float\r\nDword : '-' Float\r\nDword : DwordId\r\nDword : Uint DwordId\r\nDwordId : Id\r\nDwordId : T_KW_TRUE\r\nDwordId : T_KW_FALSE\r\nDwordId : T_KW_TEXTURE\r\n\r\nId : TypeId\r\nId : NonTypeId\r\nIdOpt :\r\nIdOpt : Id\r\n\r\nTarget : NonTypeId\r\n\r\nUint : T_UINT\r\nFloat : T_FLOAT\r\n\r\nStrings : String\r\nStrings : Strings String\r\nString : T_STRING\r\n\r\nTypeId : T_TYPE_ID\r\nNonTypeId : T_NON_TYPE_ID\r\nLineTerminator : T_LINE_TERMINATOR\r\n\r\nAsmDecl : T_KW_DECL '{'\r\nAsm : T_KW_ASM '{'\r\nAsmFragment : T_KW_ASM_FRAGMENT '{'\r\n\r\n--LEXER--\r\n\r\nT_KW_STATIC : \"static\"\r\nT_KW_UNIFORM : \"uniform\"\r\nT_KW_EXTERN : \"extern\"\r\nT_KW_VOLATILE : \"volatile\"\r\nT_KW_INLINE : \"inline\"\r\nT_KW_CONST : \"const\"\r\nT_KW_ROW_MAJOR : \"row_major\"\r\nT_KW_COLUMN_MAJOR : \"column_major\"\r\nT_KW_TYPEDEF : \"typedef\"\r\nT_KW_STRUCT : \"struct\"\r\nT_KW_VOID : \"void\"\r\nT_KW_BOOL : \"bool\"\r\nT_KW_INT : \"int\"\r\nT_KW_UINT : \"uint\"\r\nT_KW_HALF : \"half\"\r\nT_KW_FLOAT : \"float\"\r\nT_KW_DOUBLE : \"double\"\r\nT_KW_VECTOR : \"vector\"\r\nT_KW_MATRIX : \"matrix\"\r\nT_KW_STRING : \"string\"\r\nT_KW_TEXTURE : \"texture\"\r\nT_KW_TEXTURE1D : \"texture1D\"\r\nT_KW_TEXTURE2D : \"texture2D\"\r\nT_KW_TEXTURE3D : \"texture3D\"\r\nT_KW_TEXTURECUBE : \"texturecube\"\r\nT_KW_SAMPLER : \"sampler\"\r\nT_KW_SAMPLER1D : \"sampler1D\"\r\nT_KW_SAMPLER2D : \"sampler2D\"\r\nT_KW_SAMPLER3D : \"sampler3D\"\r\nT_KW_SAMPLERCUBE : \"samplerCUBE\"\r\nT_KW_RWBUFFER : \"RWBuffer\"\r\nT_KW_RWSTRUCTUREDBUFFER : \"RWStructuredBuffer\"\r\nT_KW_APPENDSTRUCTUREDBUFFER : \"AppendStructuredBuffer\"\r\nT_KW_PIXELSHADER : \"pixelshader\"\r\nT_KW_VERTEXSHADER : \"vertexshader\"\r\nT_KW_PIXELFRAGMENT : \"pixelfragment\"\r\nT_KW_VERTEXFRAGMENT : \"vertexfragment\"\r\nT_KW_STATEBLOCK : \"stateblock\"\r\nT_KW_REGISTER : \"register\"\r\nT_KW_IN : \"in\"\r\nT_KW_OUT : \"out\"\r\nT_KW_INOUT : \"inout\"\r\nT_KW_TECHNIQUE : \"technique\"\r\n#if FX_PART\r\n    T_KW_FXPART : \"partFx\"\r\n#endif\r\nT_KW_PASS : \"pass\"\r\nT_KW_RETURN : \"return\"\r\nT_KW_DO : \"do\"\r\nT_KW_DISCARD : \"discard\"\r\nT_KW_WHILE : \"while\"\r\nT_KW_IF : \"if\"\r\nT_KW_ELSE : \"else\"\r\nT_KW_FOR : \"for\"\r\nT_KW_TRUE : \"true\"\r\nT_KW_FALSE : \"false\"\r\nT_KW_COMPILE : \"compile\"\r\nT_KW_SAMPLER_STATE : \"sampler_state\"\r\nT_KW_COMPILE_FRAGMENT : \"compile_fragment\"\r\nT_KW_STATEBLOCK_STATE : \"stateblock_state\"\r\nT_KW_DECL : \"decl\"\r\nT_KW_ASM : \"asm\"\r\nT_KW_ASM_FRAGMENT : \"asm_fragment\"\r\nT_KW_USE : \"use\"\r\nT_KW_STRICT : \"strict\"\r\nT_KW_IMPORT : \"import\"\r\nT_KW_PROVIDE : \"provide\"\r\nT_KW_SWITCH : \"switch\"\r\nT_KW_CASE : \"case\"\r\nT_KW_DEFAULT : \"default\"\r\nT_KW_BREAK : \"break\"\r\n#if FX_PART\r\nT_KW_SPAWN : \"spawn\"\r\n#endif\r\nT_KW_CONTINUE : \"continue\"\r\nT_KW_AS : \"as\"\r\nT_KW_INCLUDE : \"include\"\r\nT_OP_INC : \"++\"\r\nT_OP_DEC : \"--\"\r\nT_OP_LE : \">=\"\r\nT_OP_GE : \"<=\"\r\nT_OP_EQ : \"==\"\r\nT_OP_NE : \"!=\"\r\nT_OP_AND : \"&&\"\r\nT_OP_OR : \"||\"\r\nT_OP_ME : \"*=\"\r\nT_OP_DE : \"/=\"\r\nT_OP_RE : \"%=\"\r\nT_OP_AE : \"+=\"\r\nT_OP_SE : \"-=\"";class ue extends oe{init({grammar:e=le,type:t=s.k_LALR,flags:r=l.k_Default}){super.init({grammar:e,type:t,flags:r})}}let ce=null,pe=null;function de(e={grammar:le}){Object(p.b)(ce,e)||(ce=e,pe=new ue(e))}var he,fe=r("zX2+"),me=r("zioJ"),Ee=r("a1Km");!function(e){e[e.k_Billboard=0]="k_Billboard",e[e.k_Cylinder=1]="k_Cylinder",e[e.k_Box=2]="k_Box",e[e.k_Sphere=3]="k_Sphere",e[e.k_Line=4]="k_Line"}(he||(he={}));var _e=r("NzFo"),ye=r("C2sc"),Te=r("FrU9"),ge=r("+Z36");class xe extends ge.a{constructor({spawnRoutine:e,initRoutine:t,updateRoutine:r,particle:n,capacity:a=-1,...i}){super({instrType:Te.b.k_PartFxDecl,techniqueType:Te.d.k_PartFx,...i}),this._spawnRoutine=e,this._initRoutine=t,this._updateRoutine=r,this._particle=n,this._capacity=a}get spawnRoutine(){return this._spawnRoutine}get initRoutine(){return this._initRoutine}get updateRoutine(){return this._updateRoutine}get particle(){return this._particle}get capacity(){return this._capacity}isValid(){const e=!!this.spawnRoutine&&!!this.initRoutine&&!!this.updateRoutine,t=!!this.particle,r=this.passList&&this.passList.filter(e=>e.isValid()).length>0;return e&&t&&r}}var be=r("jfm7");class Se extends be.a{constructor({sorting:e=!1,instanceCount:t=1,prerenderRoutine:r,geometry:n,...a}){super({instrType:Te.b.k_PartFxPass,...a}),this.sorting=e,this.prerenderRoutine=r,this.geometry=n,this.instanceCount=t}get particleInstance(){return Object(p.f)(this.prerenderRoutine)?null:this.prerenderRoutine.function.def.params[1].type.subType}isValid(){return!!this.particleInstance&&!!this.prerenderRoutine}}var Re=r("Wl5j");class ke extends _e.b{beginPartFxPass(){this.beginPass(),this.particleInstance=null}endPartFxPass(){this.particleInstance=null,this.endPass()}beginPartFx(){this.particleCore=null}endPartFx(){this.particleCore=null}}class Ne extends _e.a{analyzePartFXProperty(e,t,r){r.children;console.log(r)}analyzePartFXPassDecl(e,t,r){e.beginPartFxPass();const n=r.children,a=t.currentScope,i=this.analyzePassStateBlockForShaders(e,t,n[0]),s=this.analyzePassStateBlock(e,t,n[0]);e.renderStates=s;const o=this.analyzePartFxStateBlock(e,t,n[0]),l=!Object(p.c)(o.sorting)||o.sorting,u=o.prerenderRoutine||null,c=o.geometry||he.k_Billboard,d=o.instanceCount||1;let h=i.pixel,f=i.vertex;if(f){const t=["POSITION","POSITION0"];let n=!1,a=!1;for(const r of f.def.params)n=n||r.type.subType===e.particleInstance,a=a||!!t.find(e=>r.type.hasFieldWithSematics(e));n||(e.error(r,me.a.PartFx_VertexShaderParametersMismatch,{tooltip:"vertex shader must have a valid material param which is compatible with prerender routine."}),f=h=null)}let m=null;for(let e=0;e<n.length;++e)if("T_NON_TYPE_ID"===n[e].name){let t=n[e].value;m=new ye.a({sourceNode:n[e],scope:a,name:t})}const E=new Se({scope:a,sourceNode:r,id:m,sorting:l,geometry:c,instanceCount:d,prerenderRoutine:u,renderStates:s,pixelShader:h,vertexShader:f});return e.endPartFxPass(),E}analyzePartFxStateBlock(e,t,r){const n=r.children;let a={};for(let r=n.length-2;r>=1;r--)a={...a,...this.analyzePartFXPassProperies(e,t,n[r])};return a}analyzePartFXPassProperies(e,t,r){const n=r.children,a=n[n.length-1].value.toUpperCase(),i=n[n.length-3],s=i.children[i.children.length-1];let o={};if(Object(p.f)(s.value)||Object(p.f)(a))return console.warn("Pass state is incorrect."),o;if("{"===s.value&&i.children.length>3){const e=new Array(Math.ceil((i.children.length-2)/2));for(let t=i.children.length-2,r=0;t>=1;t-=2,r++)e[r]=i.children[t].value.toUpperCase();return console.warn("Pass fx state is incorrect."),o}{let r=null;switch(r="{"===s.value?i.children[1].value.toUpperCase():s.value.toUpperCase(),a){case"InstanceCount".toUpperCase():o.instanceCount=Number(r)||1;break;case"Geometry".toUpperCase():const n=["Billboard","Cylinder","Box","Sphere","Line"].map(e=>e.toUpperCase());o.geometry=Math.max(0,n.indexOf(r));break;case"Sorting".toUpperCase():Object(p.a)("TRUE"==r||"FALSE"==r),o.sorting="TRUE"===r;break;case"PrerenderRoutine".toUpperCase():{let r=[{ret:Re.i,args:[e.particleCore,null]},{ret:Re.i,args:[e.particleCore,null,Re.e]}],n=this.analyzeCompileExpr(e,t,s,r);if(!n)break;let a=n.function,i=a.def.params.map(e=>e.type);i.length<2&&(e.error(s,me.a.InvalidCompileFunctionNotValid,{funcName:a.name,tooltip:"'PrerenderRoutine' arguments' count mismatch."}),n=null),i[0].readable&&i[0].subType===e.particleCore&&!i[0].isNotBaseArray()&&i[1].hasUsage("out")&&i[1].writable&&!i[1].isNotBaseArray()||(e.error(s,me.a.InvalidCompileFunctionNotValid,{funcName:a.name,tooltip:"'PrerenderRoutine' arguments' type mismatch."}),n=null),e.particleInstance=i[1].subType,o.prerenderRoutine=n}}}return o}analyzePartFXBody(e,t,r){let n=[],a=null,i=null,s=null,o=null,l=null;const u=r.children;for(let r=u.length-2;r>0;r--)switch(u[r].name){case"PassState":{let n=u[r];switch(n.children[3].value.toUpperCase()){case"Capacity".toUpperCase():{const e=n.children[1].children[0].value;Object(p.a)(Object(p.g)(Number(e))),l=Number(e)||-1;break}case"SpawnRoutine".toUpperCase():{let r={ret:Re.e,args:[]},i=n.children[1].children[0];a=this.analyzeCompileExpr(e,t,i,[r])}break;case"InitRoutine".toUpperCase():{let r=[{ret:Re.i,args:[null,Re.e]},{ret:Re.i,args:[null,Re.h]},{ret:Re.i,args:[null]}],a=n.children[1].children[0];if(!(i=this.analyzeCompileExpr(e,t,a,r)))break;let l=i.function,u=l.def.params[0].type;(!u.hasUsage("out")&&!u.hasUsage("inout")||u.isNotBaseArray())&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),i=null),o&&u.subType!==o&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:l.name,tooltip:"'InitRoutine' arguments' type mismatch."}),s=null),o=u.subType}break;case"UpdateRoutine".toUpperCase():{let r=[{ret:Re.b,args:[null,Re.e]},{ret:Re.b,args:[null]}],a=n.children[1].children[0];if(!(s=this.analyzeCompileExpr(e,t,a,r)))break;const i=s.function,l=i.def,u=l.params;(u.length<1||u.length>2)&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null);let c=u[0].type;if((!c.hasUsage("out")&&!c.hasUsage("inout")||c.isNotBaseArray())&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null),o&&c.subType!==o&&(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' arguments' type mismatch."}),s=null),l.returnType.isEqual(Re.b)||(e.error(a,me.a.InvalidCompileFunctionNotValid,{funcName:i.name,tooltip:"'UpdateRoutine' return type mismatch. 'boolean' is expected."}),s=null),!s)break;o=c.subType}}}}e.particleCore=o;for(let r=u.length-2;r>0;r--)switch(u[r].name){case"PassDecl":{let a=this.analyzePartFXPassDecl(e,t,u[r]);a.isValid()||e.warn(a.id&&a.id.sourceNode||u[r],Ee.a.IncompletePass,{techniqueName:a.name,tooltip:"The pass is not completed. Not all required parameters are specified."}),Object(p.a)(!Object(p.f)(a)),n.push(a)}}return{passList:n,spawnRoutine:a,initRoutine:i,updateRoutine:s,particle:o,capacity:l}}analyzePartFXDecl(e,t,r){const n=r.children,a=this.analyzeComplexName(n[n.length-2]),i=(n[n.length-2].children.length,t.currentScope);let s=null,o=null,l=null;e.beginPartFx();for(let r=n.length-3;r>=0;r--)switch(n[r].name){case"Annotation":s=this.analyzeAnnotation(n[r]);break;case"Semantic":o=this.analyzeSemantic(n[r]);break;case"PartFxBody":l=this.analyzePartFXBody(e,t,n[r])}e.endPartFx();const u=new xe({sourceNode:r,name:a,semantic:o,annotation:s,scope:i,...l});return u.isValid()||e.warn(n[n.length-2],Ee.a.IncompleteTechnique,{techniqueName:u.name,tooltip:"The technique is not completed. Not all required parameters are specified."}),Ne.addTechnique(e,t,u),u}analyzeUnknDecl(e,t,r){switch(r.name){case"PartFxDecl":return[this.analyzePartFXDecl(e,t,r)];default:return super.analyzeUnknDecl(e,t,r)}}createContext(e){return new ke(e)}}function Ae(e,t){return Object(p.a)(String(e.file)===String(t.file)),{offset:Math.min(e.offset,t.offset),line:Math.min(e.line,t.line),column:Math.min(e.column,t.column),file:e.file}}function Ce(e,t){return Object(p.a)(String(e.file)===String(t.file)),{offset:Math.max(e.offset,t.offset),line:Math.max(e.line,t.line),column:Math.max(e.column,t.column),file:e.file}}function Oe(e,t){return t.start.file!==e.start.file?e:(t.start.line<e.start.line?e.start={...t.start}:t.start.line===e.start.line&&(e.start=Ae(t.start,e.start)),t.end.line>e.end.line?e.end={...t.end}:t.end.line===e.end.line&&(e.end=Ce(t.end,e.end)),e)}const Ie=(e,t)=>e.start.offset<=t&&e.end.offset>t;class ve{constructor(e,t=null){this.root=t,this.nodes=[],this.optimized=e,this.nodesCountStack=[]}get lastNode(){return this.nodes[this.nodes.length-1]}finishTree(){this.root=this.nodes.pop()}addToken({name:e,value:t,loc:r}){this.addNode({name:e,value:t,loc:r,children:null,parent:null})}reduceByRule(e,t=a.k_Default){let r=0,n=this.nodesCountStack,i=e.right.length,s=this.nodes,o=this.optimized?1:0;for(;i;)r+=n.pop(),i--;if(t===a.k_Skip&&r>o)s.length-=r,n.push(0);else if(t===a.k_Default&&r>o||t===a.k_Necessary){Object(p.a)(r>0);let t=s.pop();r--;const a={name:e.left,children:null,parent:null,value:"",loc:{...t.loc}};for(this.addLink(a,t);r;)Object(p.a)(s.length>0),this.addLink(a,s.pop()),r--;s.push(a),n.push(1)}else n.push(r)}addNode(e){this.nodes.push(e),this.nodesCountStack.push(1)}$pop(e=null){let t=this.nodesCountStack.pop();for(;t;){let r=this.nodes.pop();e&&Oe(e,r.loc),t--}}addLink(e,t){e.children=e.children||[],Oe(e.loc,t.loc),e.children.push(t),t.parent=e}clone(){return new ve(this.optimized,this.cloneNode(this.root))}cloneNode({name:e,value:t,children:r}){const n={name:e,value:t,children:null,parent:null};return r&&r.forEach(e=>this.addLink(n,this.cloneNode(e))),n}toString(){return this.root?this.toStringNode(this.root):""}toStringNode(e,t=""){let r=t+"{\n",n=t;if(t+="  ",e.value)r+=t+'name : "'+e.name+'",\n',r+=t+'value : "'+e.value+'"\n';else{r+=t+'name : "'+e.name+'"\n',r+=t+"children : [";let a=e.children;if(a){r+="\n",t+="  ";for(let e=a.length-1;e>=0;e--)r+=this.toStringNode(a[e],t),r+=",\n";r=r.slice(0,r.length-2),r+="\n",r+=n+"  ]\n"}else r+=" ]\n"}return r+=n+"}"}toHTMLString(e,t=""){let r=t+"{\n",n=t;if(t+="  ",(e=e||this.root).value)r+=t+'<b style="color: #458383;">name</b>: "'+e.name+'",\n',r+=t+'<b style="color: #458383;">value</b>: "'+e.value+'",\n',r+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',r+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n';else{let a;if(r+=t+'<i style="color: #8A2BE2;">name</i>: "'+e.name+'"\n',r+=t+'<b style="color: #458383;">line</b>: "'+e.loc.start.line+'" - "'+e.loc.end.line+'"\n',r+=t+'<b style="color: #458383;">column</b>: "'+e.loc.start.column+'" - "'+e.loc.end.column+'"\n',r+=t+'<i style="color: #8A2BE2;">children</i>: [',e.children){for(r+="\n",t+="  ",a=e.children.length-1;a>=0;a--)r+=this.toHTMLString(e.children[a],t),r+=",\n";r=r.slice(0,r.length-2),r+="\n",r+=n+"  ]\n"}else r+=" ]\n"}return r+=n+"}"}}var Pe;!function(e){e[e.SyntaxUnknownError=2051]="SyntaxUnknownError",e[e.SyntaxUnexpectedEOF=2052]="SyntaxUnexpectedEOF",e[e.SyntaxRecoverableStateNotFound=2053]="SyntaxRecoverableStateNotFound",e[e.GeneralCouldNotReadFile=2200]="GeneralCouldNotReadFile",e[e.GeneralParsingLimitIsReached=2201]="GeneralParsingLimitIsReached"}(Pe||(Pe={}));class De extends v.b{constructor(){super("Parsing diagnostics","P")}resolveFilename(e,t){return t.file}resolveRange(e,t){switch(e){case Pe.SyntaxUnknownError:case Pe.SyntaxUnexpectedEOF:return t.token.loc;case Pe.GeneralCouldNotReadFile:return t.loc}return null}resolvePosition(e,t){return console.assert(e!=Pe.SyntaxUnknownError),{line:t.line,column:0,file:null}}diagnosticMessages(){return{[Pe.SyntaxUnknownError]:"Syntax error during parsing. Token: '{token.value}'\nLine: {token.loc.start.line}. Column: {token.loc.start.column}.",[Pe.SyntaxUnexpectedEOF]:"Syntax error. Unexpected EOF.",[Pe.GeneralCouldNotReadFile]:"Could not read file '{target}'.",[Pe.GeneralParsingLimitIsReached]:"Parsing limit is reached.",[Pe.SyntaxRecoverableStateNotFound]:"Recoverable state not found."}}}function Fe(e){return{...e,loc:{start:{...e.loc.start},end:{...e.loc.end}}}}class Le{constructor(e){Object(p.a)(e.parser,"parser engine is not defined"),this.init(e)}init({parser:e,knownTypes:t=new Set,ruleFunctions:r=new Map}){const n=e.lexerEngine;this.parser=e,this.knownTypes=t,this.ruleFunctions=r,this.lexer=new ae({engine:n,knownTypes:t})}get uri(){return this.lexer.uri.toString()}get diagnosticReport(){let e=this.lexer.getDiagnosticReport(),t=this.diag.resolve();return v.b.mergeReports([e,t])}get root(){return this.tree.root}async parse(e,t=o.k_Optimize){const r=I.testAll(t,o.k_DeveloperMode),n=I.testAll(t,o.k_Optimize);return this.diag=new De,this.tree=new ve(n),this.stack=[0],this.lexer.setup(e),this.token=this.readToken(),this.token.value===B?i.k_Ok:(await this.run({developerMode:r,allowErrorRecoverty:!0}),this.diag.hasErrors()?(console.error("parsing was ended with errors."),i.k_Error):i.k_Ok)}readToken(){return this.lexer.getNextToken()}emitError(e,t){this.diag.error(e,{...this.lexer.getLocation(),token:t})}emitCritical(e,t=null){this.diag.critical(e,{...this.lexer.getLocation(),token:t})}restoreState(e,t,r,n,a){for(;;){let i=-1;for(let t=r.length-1;t>=0;--t){const a=e[r[t]][j];if(Object(p.d)(a)&&a.type===c.k_Shift&&e[a.stateIndex][n.name]){i=t;break}}if(-1!==i){const e=r[i];let n=r.length-1-i;for(;0!=n;)t.$pop(a.loc),r.pop(),n--;return e}if(Oe(a.loc,n.loc),n.value===B)break;const s=this.readToken();Object.keys(s).forEach(e=>n[e]=s[e])}return-1}async operationAdditionalAction(e,t){const r=this.parser.findFunctionByState(e,t);return Object(p.f)(r)?c.k_Ok:(Object(p.a)(!!this.ruleFunctions.has(r)),await this.ruleFunctions.get(r)())}async run({developerMode:e=!1,allowErrorRecoverty:t=!0}){const{syntaxTable:r}=this.parser,{stack:n,tree:a}=this,i={index:-1,name:null,value:null};let s=i;let o=0;try{e:for(;;){e&&(o>1e4&&this.emitCritical(Pe.GeneralParsingLimitIsReached),o++);let l=n[n.length-1],u=r[l][this.token.name];if(t){if(!u){if(s.index===this.token.index){this.token=this.readToken(),s=i;continue}this.token.value===B?this.emitError(Pe.SyntaxUnexpectedEOF,this.token):this.emitError(Pe.SyntaxUnknownError,this.token),s=Fe(this.token),this.token={...Fe(this.token),name:j}}u=r[l][this.token.name];const e=this.token.name===j;if(!u||e&&u.type===c.k_Shift){let e=Fe(s);for(;e.name===F;)e=this.readToken();-1===(l=this.restoreState(r,a,n,e,this.token))&&this.emitCritical(Pe.SyntaxRecoverableStateNotFound),u=r[l][this.token.name],n.push(u.stateIndex),a.addToken(this.token),this.token=e;continue}}if(Object(p.d)(u))switch(u.type){case c.k_Success:break e;case c.k_Shift:{const e=u.stateIndex;n.push(e),a.addToken(this.token);const t=await this.operationAdditionalAction(e,this.token.name);t===c.k_Error?this.emitCritical(Pe.SyntaxUnknownError,this.token):t===c.k_Ok&&(this.token=this.readToken())}break;case c.k_Reduce:{const e=u.rule.right.length;n.length-=e;const t=r[n[n.length-1]][u.rule.left].stateIndex;n.push(t),a.reduceByRule(u.rule,this.parser.getRuleCreationMode(u.rule.left)),await this.operationAdditionalAction(t,u.rule.left)===c.k_Error&&this.emitCritical(Pe.SyntaxUnknownError,this.token)}}else Object(p.a)(!t,"unexpected end, something went wrong :/"),this.emitCritical(Pe.SyntaxUnknownError,this.token)}a.finishTree()}catch(e){if(!(e instanceof v.a))throw e}}}class we{constructor(e){this._dirname=null,this._extension=null,this._filename=null,Object(p.d)(e)&&this.set(e)}get path(){return this.toString()}set path(e){this.set(e)}get dirname(){return this._dirname}set dirname(e){this._dirname=e}get filename(){return this._filename}set filename(e){this._filename=e}get ext(){return this._extension}set ext(e){this._extension=e}get basename(){return this._filename?this._filename+(this._extension?"."+this._extension:""):""}set basename(e){var t=e.lastIndexOf(".");t<0?(this._filename=e.substr(0),this._extension=null):(this._filename=e.substr(0,t),this._extension=e.substr(t+1))}set(e){if(Object(p.h)(e)){var t=e.replace("\\","/").split("/");this.basename=t.pop(),this._dirname=t.join("/")}else{if(!(e instanceof we)){if(Object(p.f)(e))return null;throw new Error(`Unexpected data type was used: ${e}`)}this._dirname=e.dirname,this._filename=e.filename,this._extension=e.ext}}isAbsolute(){return"/"===this._dirname[0]}toString(){return(this._dirname?this._dirname+"/":"")+this.basename}}function Ue(e){var t=je(e),r=t.isAbsolute(),n=t.dirname,a=/[\\\/]$/.test(n);return(n=function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];"."===a?e.splice(n,1):".."===a?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;)e.unshift("..");return e}(n.split(/[\\\/]+/).filter((function(e){return!!e})),!r).join("/"))&&a&&(n+="/"),t.dirname=(r?"/":"")+n,t.toString()}function je(e){return new we(e)}class Be{constructor(e){this._scheme=null,this._userinfo=null,this._host=null,this._port=0,this._path=null,this._query=null,this._fragment=null,e&&this.set(e)}get urn(){return(this._path?this._path:"")+(this._query?"?"+this._query:"")+(this._fragment?"#"+this._fragment:"")}get url(){return(this._scheme?this._scheme:"")+this.authority}get authority(){return this._host?"//"+(this._userinfo?this._userinfo+"@":"")+this._host+(this._port?":"+this._port:""):""}get scheme(){return this._scheme}get protocol(){return this._scheme?this._scheme.substr(0,this._scheme.lastIndexOf(":")):this._scheme}get userInfo(){return this._userinfo}get host(){return this._host}set host(e){this._host=e}get port(){return this._port}set port(e){this._port=e}get path(){return this._path}set path(e){this._path=e}get query(){return this._query}set query(e){this._query=e}get fragment(){return this._fragment}set(e){if(Object(p.h)(e)){var t=Be.uriExp.exec(e);return console.assert(null!==t,"Invalid URI format used.\nused uri: "+e),t?(this._scheme=t[1]||null,this._userinfo=t[2]||null,this._host=t[3]||null,this._port=parseInt(t[4])||null,this._path=t[5]||t[6]||null,this._query=t[7]||null,this._fragment=t[8]||null,this):null}return e instanceof Be?this.set(e.toString()):(console.error("Unexpected data type was used."),null)}toString(){return this.url+this.urn}}function We(e){if(!Object(p.f)(e.path))if("filesystem:"===e.scheme){var t=ze(e.path);t.path=Ue(t.path),e.path=t.toString()}else e.path=Ue(e.path);return e}function ze(e){return new Be(e)}Be.uriExp=new RegExp("^([a-z0-9+.-]+:)?(?:\\/\\/(?:((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*)@)?((?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*)(?::(\\d*))?(\\/(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?|(\\/?(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*(?:[a-z0-9-._~!$&'()*+,;=:@/]|%[0-9A-F]{2})*)?)(?:\\?((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-z0-9-._~!$&'()*+,;=:/?@]|%[0-9A-F]{2})*))?$","i");const Me=["float2","float3","float4","float2x2","float3x3","float4x4","int2","int3","int4","uint2","uint3","uint4","bool2","bool3","bool4","auto"];class Ve extends Le{constructor({parser:e=(pe||de(),pe)}={}){super({parser:e,knownTypes:new Set(Me)})}get includes(){return this.includeList}async parse(e,t){return this.includeList.set(e.uri,null),await super.parse(e,t)}init(e){super.init(e),this.includeList=new Map,this.lexers=[],this.tokens=[],this.ruleFunctions.set("addType",this._addType.bind(this)),this.ruleFunctions.set("includeCode",this._includeCode.bind(this))}_addType(){const e=this.tree.lastNode,t=e.children[e.children.length-2].value;return this.knownTypes.add(t),c.k_Ok}emitFileNotFound(e,t){this.diag.error(Pe.GeneralCouldNotReadFile,{...this.lexer.getLocation(),loc:t,target:e})}readToken(){const e=super.readToken();return e.value===B&&this.lexers.length>0?(this.lexer=this.lexers.pop(),this.tokens.pop()):e}async _includeCode(){let e=this.tree.lastNode,t=e.value;const r=function(e,t=document.location.href){var r,n=ze(t),a=ze(e);return We(a),We(n),Object(p.f)(a.scheme)&&Object(p.f)(a.host)&&!je(a.path).isAbsolute()?(r=je(n.path).dirname,n.path=r?r+"/"+e:e,We(n).toString()):e}(t.substr(1,t.length-2),`${this.uri}`);if(this.includeList.has(r))return console.warn(`'${r}' file has already been included previously.`),c.k_Ok;this.includeList.set(r,e.loc);try{const t=await fetch(r);if(!t.ok)return this.emitFileNotFound(r,e.loc),c.k_Error;const n=await t.text();return this.lexers.push(this.lexer),this.tokens.push(this.token),this.lexer=new ae({engine:this.parser.lexerEngine,knownTypes:this.knownTypes}),this.lexer.setup({source:n,uri:r}),this.token=this.readToken(),c.k_Ok}catch(r){console.error(r),this.emitFileNotFound(t,e.loc)}return c.k_Error}}async function qe(e,t,r){let n,a,i;if(Object(p.h)(arguments[0].source)){const e=Object(p.g)(arguments[1])?arguments[1]:void 0;n=arguments[0],a=await async function(e,t){const r=new Ve;return await r.parse(e,t),r}(n,e),i=arguments[2]}else a=arguments[0],i=arguments[1];const s=new Ne;return await s.parse(a,i)}var Ke,Ge,$e,He,Xe,Ze,Qe,Ye,Je,et,tt,rt,nt,at,it,st,ot,lt,ut;!function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return Ut.objectLiteral(t)&&Ut.number(t.line)&&Ut.number(t.character)}}(Ke||(Ke={})),function(e){e.create=function(e,t,r,n){if(Ut.number(e)&&Ut.number(t)&&Ut.number(r)&&Ut.number(n))return{start:Ke.create(e,t),end:Ke.create(r,n)};if(Ke.is(e)&&Ke.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+r+", "+n+"]")},e.is=function(e){var t=e;return Ut.objectLiteral(t)&&Ke.is(t.start)&&Ke.is(t.end)}}(Ge||(Ge={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Ut.defined(t)&&Ge.is(t.range)&&(Ut.string(t.uri)||Ut.undefined(t.uri))}}($e||($e={})),function(e){e.create=function(e,t,r,n){return{targetUri:e,targetRange:t,targetSelectionRange:r,originSelectionRange:n}},e.is=function(e){var t=e;return Ut.defined(t)&&Ge.is(t.targetRange)&&Ut.string(t.targetUri)&&(Ge.is(t.targetSelectionRange)||Ut.undefined(t.targetSelectionRange))&&(Ge.is(t.originSelectionRange)||Ut.undefined(t.originSelectionRange))}}(He||(He={})),function(e){e.create=function(e,t,r,n){return{red:e,green:t,blue:r,alpha:n}},e.is=function(e){var t=e;return Ut.number(t.red)&&Ut.number(t.green)&&Ut.number(t.blue)&&Ut.number(t.alpha)}}(Xe||(Xe={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return Ge.is(t.range)&&Xe.is(t.color)}}(Ze||(Ze={})),function(e){e.create=function(e,t,r){return{label:e,textEdit:t,additionalTextEdits:r}},e.is=function(e){var t=e;return Ut.string(t.label)&&(Ut.undefined(t.textEdit)||at.is(t))&&(Ut.undefined(t.additionalTextEdits)||Ut.typedArray(t.additionalTextEdits,at.is))}}(Qe||(Qe={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(Ye||(Ye={})),function(e){e.create=function(e,t,r,n,a){var i={startLine:e,endLine:t};return Ut.defined(r)&&(i.startCharacter=r),Ut.defined(n)&&(i.endCharacter=n),Ut.defined(a)&&(i.kind=a),i},e.is=function(e){var t=e;return Ut.number(t.startLine)&&Ut.number(t.startLine)&&(Ut.undefined(t.startCharacter)||Ut.number(t.startCharacter))&&(Ut.undefined(t.endCharacter)||Ut.number(t.endCharacter))&&(Ut.undefined(t.kind)||Ut.string(t.kind))}}(Je||(Je={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Ut.defined(t)&&$e.is(t.location)&&Ut.string(t.message)}}(et||(et={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(tt||(tt={})),function(e){e.create=function(e,t,r,n,a,i){var s={range:e,message:t};return Ut.defined(r)&&(s.severity=r),Ut.defined(n)&&(s.code=n),Ut.defined(a)&&(s.source=a),Ut.defined(i)&&(s.relatedInformation=i),s},e.is=function(e){var t=e;return Ut.defined(t)&&Ge.is(t.range)&&Ut.string(t.message)&&(Ut.number(t.severity)||Ut.undefined(t.severity))&&(Ut.number(t.code)||Ut.string(t.code)||Ut.undefined(t.code))&&(Ut.string(t.source)||Ut.undefined(t.source))&&(Ut.undefined(t.relatedInformation)||Ut.typedArray(t.relatedInformation,et.is))}}(rt||(rt={})),function(e){e.create=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a={title:e,command:t};return Ut.defined(r)&&r.length>0&&(a.arguments=r),a},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.string(t.title)&&Ut.string(t.command)}}(nt||(nt={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Ut.objectLiteral(t)&&Ut.string(t.newText)&&Ge.is(t.range)}}(at||(at={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Ut.defined(t)&&pt.is(t.textDocument)&&Array.isArray(t.edits)}}(it||(it={})),function(e){e.create=function(e,t){var r={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(r.options=t),r},e.is=function(e){var t=e;return t&&"create"===t.kind&&Ut.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Ut.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ut.boolean(t.options.ignoreIfExists)))}}(st||(st={})),function(e){e.create=function(e,t,r){var n={kind:"rename",oldUri:e,newUri:t};return void 0===r||void 0===r.overwrite&&void 0===r.ignoreIfExists||(n.options=r),n},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Ut.string(t.oldUri)&&Ut.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Ut.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ut.boolean(t.options.ignoreIfExists)))}}(ot||(ot={})),function(e){e.create=function(e,t){var r={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(r.options=t),r},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Ut.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Ut.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Ut.boolean(t.options.ignoreIfNotExists)))}}(lt||(lt={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Ut.string(e.kind)?st.is(e)||ot.is(e)||lt.is(e):it.is(e)})))}}(ut||(ut={}));var ct,pt,dt,ht,ft,mt,Et,_t,yt,Tt,gt,xt,bt,St,Rt,kt,Nt,At=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(at.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(at.replace(e,t))},e.prototype.delete=function(e){this.edits.push(at.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}();!function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(it.is(e)){var r=new At(e.edits);t._textEditChanges[e.textDocument.uri]=r}})):e.changes&&Object.keys(e.changes).forEach((function(r){var n=new At(e.changes[r]);t._textEditChanges[r]=n})))}Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(pt.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(n=this._textEditChanges[t.uri])){var r={textDocument:t,edits:a=[]};this._workspaceEdit.documentChanges.push(r),n=new At(a),this._textEditChanges[t.uri]=n}return n}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var n;if(!(n=this._textEditChanges[e])){var a=[];this._workspaceEdit.changes[e]=a,n=new At(a),this._textEditChanges[e]=n}return n},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(st.create(e,t))},e.prototype.renameFile=function(e,t,r){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(ot.create(e,t,r))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(lt.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")}}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.string(t.uri)}}(ct||(ct={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.string(t.uri)&&(null===t.version||Ut.number(t.version))}}(pt||(pt={})),function(e){e.create=function(e,t,r,n){return{uri:e,languageId:t,version:r,text:n}},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.string(t.uri)&&Ut.string(t.languageId)&&Ut.number(t.version)&&Ut.string(t.text)}}(dt||(dt={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(ht||(ht={})),function(e){e.is=function(t){var r=t;return r===e.PlainText||r===e.Markdown}}(ht||(ht={})),function(e){e.is=function(e){var t=e;return Ut.objectLiteral(e)&&ht.is(t.kind)&&Ut.string(t.value)}}(ft||(ft={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(mt||(mt={})),function(e){e.PlainText=1,e.Snippet=2}(Et||(Et={})),function(e){e.create=function(e){return{label:e}}}(_t||(_t={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(yt||(yt={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Ut.string(t)||Ut.objectLiteral(t)&&Ut.string(t.language)&&Ut.string(t.value)}}(Tt||(Tt={})),function(e){e.is=function(e){var t=e;return!!t&&Ut.objectLiteral(t)&&(ft.is(t.contents)||Tt.is(t.contents)||Ut.typedArray(t.contents,Tt.is))&&(void 0===e.range||Ge.is(e.range))}}(gt||(gt={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(xt||(xt={})),function(e){e.create=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a={label:e};return Ut.defined(t)&&(a.documentation=t),Ut.defined(r)?a.parameters=r:a.parameters=[],a}}(bt||(bt={})),function(e){e.Text=1,e.Read=2,e.Write=3}(St||(St={})),function(e){e.create=function(e,t){var r={range:e};return Ut.number(t)&&(r.kind=t),r}}(Rt||(Rt={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(kt||(kt={})),function(e){e.create=function(e,t,r,n,a){var i={name:e,kind:t,location:{uri:n,range:r}};return a&&(i.containerName=a),i}}(Nt||(Nt={}));var Ct,Ot,It,vt,Pt,Dt=function(){};!function(e){e.create=function(e,t,r,n,a,i){var s={name:e,detail:t,kind:r,range:n,selectionRange:a};return void 0!==i&&(s.children=i),s},e.is=function(e){var t=e;return t&&Ut.string(t.name)&&Ut.number(t.kind)&&Ge.is(t.range)&&Ge.is(t.selectionRange)&&(void 0===t.detail||Ut.string(t.detail))&&(void 0===t.deprecated||Ut.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(Dt||(Dt={})),function(e){e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports"}(Ct||(Ct={})),function(e){e.create=function(e,t){var r={diagnostics:e};return null!=t&&(r.only=t),r},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.typedArray(t.diagnostics,rt.is)&&(void 0===t.only||Ut.typedArray(t.only,Ut.string))}}(Ot||(Ot={})),function(e){e.create=function(e,t,r){var n={title:e};return nt.is(t)?n.command=t:n.edit=t,void 0!==r&&(n.kind=r),n},e.is=function(e){var t=e;return t&&Ut.string(t.title)&&(void 0===t.diagnostics||Ut.typedArray(t.diagnostics,rt.is))&&(void 0===t.kind||Ut.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||nt.is(t.command))&&(void 0===t.edit||ut.is(t.edit))}}(It||(It={})),function(e){e.create=function(e,t){var r={range:e};return Ut.defined(t)&&(r.data=t),r},e.is=function(e){var t=e;return Ut.defined(t)&&Ge.is(t.range)&&(Ut.undefined(t.command)||nt.is(t.command))}}(vt||(vt={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Ut.defined(t)&&Ut.number(t.tabSize)&&Ut.boolean(t.insertSpaces)}}(Pt||(Pt={}));var Ft=function(){};!function(e){e.create=function(e,t,r){return{range:e,target:t,data:r}},e.is=function(e){var t=e;return Ut.defined(t)&&Ge.is(t.range)&&(Ut.undefined(t.target)||Ut.string(t.target))}}(Ft||(Ft={}));var Lt,wt;!function(e){e.create=function(e,t,r,n){return new jt(e,t,r,n)},e.is=function(e){var t=e;return!!(Ut.defined(t)&&Ut.string(t.uri)&&(Ut.undefined(t.languageId)||Ut.string(t.languageId))&&Ut.number(t.lineCount)&&Ut.func(t.getText)&&Ut.func(t.positionAt)&&Ut.func(t.offsetAt))},e.applyEdits=function(e,t){for(var r=e.getText(),n=function e(t,r){if(t.length<=1)return t;var n=t.length/2|0,a=t.slice(0,n),i=t.slice(n);e(a,r),e(i,r);var s=0,o=0,l=0;for(;s<a.length&&o<i.length;){var u=r(a[s],i[o]);t[l++]=u<=0?a[s++]:i[o++]}for(;s<a.length;)t[l++]=a[s++];for(;o<i.length;)t[l++]=i[o++];return t}(t,(function(e,t){var r=e.range.start.line-t.range.start.line;return 0===r?e.range.start.character-t.range.start.character:r})),a=r.length,i=n.length-1;i>=0;i--){var s=n[i],o=e.offsetAt(s.range.start),l=e.offsetAt(s.range.end);if(!(l<=a))throw new Error("Overlapping edit");r=r.substring(0,o)+s.newText+r.substring(l,r.length),a=o}return r}}(Lt||(Lt={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(wt||(wt={}));var Ut,jt=function(){function e(e,t,r,n){this._uri=e,this._languageId=t,this._version=r,this._content=n,this._lineOffsets=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(t,r)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=null},e.prototype.getLineOffsets=function(){if(null===this._lineOffsets){for(var e=[],t=this._content,r=!0,n=0;n<t.length;n++){r&&(e.push(n),r=!1);var a=t.charAt(n);r="\r"===a||"\n"===a,"\r"===a&&n+1<t.length&&"\n"===t.charAt(n+1)&&n++}r&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),r=0,n=t.length;if(0===n)return Ke.create(0,e);for(;r<n;){var a=Math.floor((r+n)/2);t[a]>e?n=a:r=a+1}var i=r-1;return Ke.create(i,e-t[i])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var r=t[e.line],n=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,n),r)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Ut||(Ut={}));class Bt{doProvide(e,t){if(!t)return[];const r=[],n=t.root.scope,a=(e,t)=>{const r=Ke.create(t.start.line,t.start.column),n=Ge.create(r,r),a=vt.create(n);return a.command=nt.create(e,null),a};if(!Object(p.f)(n))for(const e in n.techniques){const t=n.techniques[e];if(t.type===Te.d.k_PartFx){const e=t;if(e.spawnRoutine){const t=e.spawnRoutine.function.def.sourceNode;r.push(a("[spawn routine]",t.loc))}if(e.initRoutine){const t=e.initRoutine.function.def.sourceNode;r.push(a("[init routine]",t.loc))}if(e.updateRoutine){const t=e.updateRoutine.function.def.sourceNode;r.push(a("[update routine]",t.loc))}if(e.particle&&e.particle.instructionType!==Te.b.k_SystemType){const t=e.particle.sourceNode;r.push(a("[particle]",t.loc))}for(const t of e.passList)if(t.prerenderRoutine){{const e=t.prerenderRoutine.function.def.sourceNode;r.push(a("[prerender routine]",e.loc))}{const e=t.particleInstance.sourceNode;r.push(a("[material]",e.loc))}}}}return r}}var Wt=r("DTTp");const zt=e=>e.sourceNode.loc;class Mt{doSignatureHelp(e,t,r){if(!r)return null;const n=e.offsetAt(t),a=r.root.instructions.find(e=>Ie(zt(e),n));if(a&&a.instructionType===Te.b.k_FunctionDecl){let e=null;if(Wt.a.each(a,t=>{t.instructionType===Te.b.k_FunctionCallExpr&&Ie(zt(t),n)&&(e=t)}),!e)return null;const t=e.decl,r=t.scope.functions[t.name],i=r.map(e=>bt.create(e.def.toCode(),null,...e.def.params.map(e=>xt.create(e.name))));let s=r.indexOf(t),o=0;return-1!==s?o=e.args.findIndex(e=>Ie(zt(e),n)):(s=0,console.error(`could not find active signature for: '${t.def.toCode()}'`)),{signatures:i,activeParameter:o,activeSignature:s}}return null}}const Vt=Symbol("Comlink.proxy"),qt=Symbol("Comlink.endpoint"),Kt=Symbol("Comlink.releaseProxy"),Gt=new WeakSet,$t=new Map([["proxy",{canHandle:e=>e&&e[Vt],serialize(e){const{port1:t,port2:r}=new MessageChannel;return Ht(e,t),[r,[r]]},deserialize:e=>(e.start(),function(e){return function e(t,r=[]){let n=!1;const a=new Proxy((function(){}),{get(i,s){if(Zt(n),s===Kt)return()=>tr(t,{type:5,path:r.map(e=>e.toString())}).then(()=>{Xt(t),n=!0});if("then"===s){if(0===r.length)return{then:()=>a};const e=tr(t,{type:0,path:r.map(e=>e.toString())}).then(er);return e.then.bind(e)}return e(t,[...r,s])},set(e,a,i){Zt(n);const[s,o]=Jt(i);return tr(t,{type:1,path:[...r,a].map(e=>e.toString()),value:s},o).then(er)},apply(a,i,s){Zt(n);const o=r[r.length-1];if(o===qt)return tr(t,{type:4}).then(er);if("bind"===o)return e(t,r.slice(0,-1));const[l,u]=Qt(s);return tr(t,{type:2,path:r.map(e=>e.toString()),argumentList:l},u).then(er)},construct(e,a){Zt(n);const[i,s]=Qt(a);return tr(t,{type:3,path:r.map(e=>e.toString()),argumentList:i},s).then(er)}});return a}(e)}(e))}],["throw",{canHandle:e=>Gt.has(e),serialize(e){const t=e instanceof Error;let r=e;return t&&(r={isError:t,message:e.message,stack:e.stack}),[r,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error,e);throw e}}]]);function Ht(e,t=self){t.addEventListener("message",(function r(n){if(!n||!n.data)return;const{id:a,type:i,path:s}=Object.assign({path:[]},n.data),o=(n.data.argumentList||[]).map(er);let l;try{const t=s.slice(0,-1).reduce((e,t)=>e[t],e),r=s.reduce((e,t)=>e[t],e);switch(i){case 0:l=r;break;case 1:t[s.slice(-1)[0]]=er(n.data.value),l=!0;break;case 2:l=r.apply(t,o);break;case 3:l=function(e){return Object.assign(e,{[Vt]:!0})}(new r(...o));break;case 4:{const{port1:t,port2:r}=new MessageChannel;Ht(e,r),l=function(e,t){return Yt.set(e,t),e}(t,[t])}break;case 5:l=void 0}}catch(e){l=e,Gt.add(e)}Promise.resolve(l).catch(e=>(Gt.add(e),e)).then(e=>{const[n,s]=Jt(e);t.postMessage(Object.assign(Object.assign({},n),{id:a}),s),5===i&&(t.removeEventListener("message",r),Xt(t))})})),t.start&&t.start()}function Xt(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function Zt(e){if(e)throw new Error("Proxy has been released and is not useable")}function Qt(e){const t=e.map(Jt);return[t.map(e=>e[0]),(r=t.map(e=>e[1]),Array.prototype.concat.apply([],r))];var r}const Yt=new WeakMap;function Jt(e){for(const[t,r]of $t)if(r.canHandle(e)){const[n,a]=r.serialize(e);return[{type:3,name:t,value:n},a]}return[{type:0,value:e},Yt.get(e)||[]]}function er(e){switch(e.type){case 3:return $t.get(e.name).deserialize(e.value);case 0:return e.value}}function tr(e,t,r){return new Promise(n=>{const a=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===a&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),r)})}function rr(e){const{code:t,content:r,start:n,end:a,category:i}=e,s={[fe.a.k_Error]:tt.Error,[fe.a.k_Warning]:tt.Warning};return{range:Ge.create(n.line,n.column,(a||n).line,(a||n).column),severity:s[i],code:t,message:r}}Ht(new class{constructor(){this.documents=new Map}init(e,t){console.log("%c Creating parser for language service provider...","background: #222; color: #bada55");try{de(e),console.log("%c [ DONE ]","background: #222; color: #bada55")}catch(e){return console.error("could not initialize parser."),null}this.service=function(e){const t=new Mt,r=new Bt;return{async parseDocument(t){const r=t.uri,n=t.getText();return await qe({uri:r,source:n},e)},doResolve:e=>null,doComplete:(e,t,r)=>null,findDocumentSymbols:(e,t)=>[],findDocumentColors:(e,t)=>null,getColorPresentations:(e,t,r,n)=>[],doHover:(e,t,r)=>null,format:(e,t,r)=>[],getFoldingRanges:e=>[],getSelectionRanges:(e,t,r)=>[],doSignatureHelp:t.doSignatureHelp.bind(t),doFxCodeLenses:r.doProvide.bind(r)}}(t)}async validate(e){const t=function({_content:e,_languageId:t,_lineOffsets:r,_uri:n,_version:a}){return Lt.create(n,t,a,e)}(e),r=await this.service.parseDocument(t);return this.documents.set(t.uri,{textDocument:t,slDocument:r}),r.diagnosticReport.messages.map(rr)}async provideFxCodeLenses(e){if(!this.service)return[];const{textDocument:t,slDocument:r}=await this.getDocument(e);return this.service.doFxCodeLenses(t,r)}async provideSignatureHelp(e,t){if(!this.service)return null;const{textDocument:r,slDocument:n}=await this.getDocument(e);return this.service.doSignatureHelp(r,t,n)}getDocument(e){return this.documents.has(e.uri)?this.documents.get(e.uri):(console.warn("could not find document",e.uri),{textDocument:null,slDocument:null})}})},Wl5j:function(e,t,r){"use strict";var n=r("fb8x"),a=r("u2cq"),i=r("hsO8"),s=r("C2sc"),o=r("FrU9"),l=r("BKBR");class u extends l.a{constructor({vertex:e=!0,pixel:t=!0,implementation:r=null,...a}){super({instrType:o.b.k_SystemFunctionDecl,implementation:null,...a}),Object(n.a)(Object(n.f)(r)),this._bForVertex=e,this._bForPixel=t}checkVertexUsage(){return this._bForVertex}checkPixelUsage(){return this._bForPixel}$makeVertexCompatible(e){console.warn("@deprecated"),this._bForVertex=e}$makePixelCompatible(e){console.warn("@deprecated"),this._bForPixel=e}}var c=r("2b0+");class p extends c.a{constructor({name:e,size:t=0,elementType:r=null,length:n=1,fields:a=[],methods:i=[],writable:s=!0,readable:l=!0,complex:u=!1,sampler:p=!1,texture:d=!1,uav:h=!1,...f}){super({instrType:o.b.k_SystemType,...f}),this._name=e,this._size=t,this._elementType=c.a.$withNoParent(r),this._length=n,this._fields=[],this._methods=[],this._bIsWritable=s,this._bIsReadable=l,this._bIsComplex=u,this._bIsSampler=p,this._bIsTexture=d,this._bIsUAV=h,a.forEach(e=>this.addField(e)),i.forEach(e=>this.addMethod(e))}get writable(){return this._bIsWritable}get readable(){return this._bIsReadable}set name(e){this._name=e}get name(){return this._name}get hash(){return this._name}get strongHash(){return this._name}get size(){return this.isArray()?this.length===a.c.UNDEFINE_LENGTH?a.c.UNDEFINE_LENGTH:this.arrayElementType.size*this.length:this._size}get baseType(){return this}get arrayElementType(){return this._elementType}get typeDecl(){return this.parent}get length(){return this._length}get fields(){return this._fields}get methods(){return this._methods}get fieldNames(){return this._fields.map(e=>e.name)}isSampler(){return this._bIsSampler}isTexture(){return this._bIsTexture}isUAV(){return this._bIsUAV}isEqual(e){return a.d.equals(this,e)}toDeclString(){return console.warn("@pure_virtual"),""}isBase(){return!0}isArray(){return!Object(n.f)(this.arrayElementType)}isNotBaseArray(){return!1}isComplex(){return this._bIsComplex}isConst(){return!1}isContainArray(){return!1}isContainSampler(){return!1}isContainPointer(){return!1}isContainComplexType(){return!1}toString(){return this.name||a.d.hash(this)}toCode(){return this._name}hasField(e){return!!this.getField(e)}hasFieldWithSematics(e){return!1}hasAllUniqueSemantics(){return!1}hasFieldWithoutSemantics(){return!1}getField(e){return this._fields.find(t=>t.name===e)||null}getMethod(e,t){const r=this._methods.filter(t=>t.name===e);return a.b.matchList(r,t)}getFieldBySemantics(e){return console.error("@undefined_behavior"),null}addField(e){console.assert(null===this.getField(e.name)),this._fields.push(c.a.$withParent(e,this))}addMethod(e){console.assert(Object(n.f)(this.getMethod(e.name,e.def.params.map(e=>e.type)))),this._methods.push(c.a.$withParent(e,this))}}var d,h=r("MJEd"),f=r("hljw"),m=r("IHXS"),E=r("zioJ");r.d(t,"a",(function(){return P})),r.d(t,"i",(function(){return D})),r.d(t,"g",(function(){return F})),r.d(t,"c",(function(){return L})),r.d(t,"d",(function(){return j})),r.d(t,"b",(function(){return M})),r.d(t,"e",(function(){return X})),r.d(t,"h",(function(){return J})),r.d(t,"f",(function(){return se})),r.d(t,"j",(function(){return oe})),r.d(t,"l",(function(){return le})),r.d(t,"p",(function(){return ue})),r.d(t,"s",(function(){return ce})),r.d(t,"r",(function(){return pe})),r.d(t,"n",(function(){return de})),r.d(t,"o",(function(){return he})),r.d(t,"m",(function(){return fe})),r.d(t,"q",(function(){return me})),r.d(t,"k",(function(){return Ee})),function(e){e[e.k_Sampler=0]="k_Sampler",e[e.k_Sampler2D=1]="k_Sampler2D",e[e.k_Sampler3D=2]="k_Sampler3D",e[e.k_SamplerCube=3]="k_SamplerCube",e[e.k_RWBuffer=4]="k_RWBuffer",e[e.k_RWStructuredBuffer=5]="k_RWStructuredBuffer",e[e.k_AppendStructuredBuffer=6]="k_AppendStructuredBuffer"}(d||(d={}));const _=new m.b({type:o.c.k_System}),y={},T="template";function g(e){throw new Error(e)}function x(e,t={}){g(E.a[e])}function b(...e){let t,r,n,a,i,s;if([t,r,n,a,i,s]=e,v(t))return console.error(`type already exists: ${t}`),null;const o=new p({scope:_,name:t,elementType:n,length:a,fields:i,size:r,methods:s});return _.addType(o),o}class S{constructor(e,t){this.name=e,this.scope=t}produceType(e,t){return null}typeName(e){return e?`${this.name}<${e.map(e=>e.name).join(", ")}>`:this.name}}class R extends S{constructor(){super("RWBuffer",_)}produceType(e,t){if(1!==t.length)return null;if(!t[0].isBase())return null;const r=this.typeName(t),n=t[0],i=a.c.UNDEFINE_LENGTH;return new p({scope:e,name:r,elementType:n,length:i,fields:[],size:-1,methods:[],uav:!0})}}class k extends S{constructor(){super("RWStructuredBuffer",_)}produceType(e,t){if(1!==t.length)return null;const r=this.typeName(t),n=t[0],o=a.c.UNDEFINE_LENGTH,l=[];{let t=new f.a({type:e.findType("uint"),scope:e}),r=new s.a({scope:e,name:"IncrementCounter"}),n=new i.a({scope:e,returnType:t,id:r}),a=new u({scope:e,definition:n,pixel:!1,vertex:!1});l.push(a)}{let t=new f.a({type:e.findType("uint"),scope:e}),r=new s.a({scope:e,name:"DecrementCounter"}),n=new i.a({scope:e,returnType:t,id:r}),a=new u({scope:e,definition:n,pixel:!1,vertex:!1});l.push(a)}return new p({scope:e,name:r,elementType:n,length:o,fields:[],size:-1,methods:l,uav:!0})}}class N extends S{constructor(){super("AppendStructuredBuffer",_)}produceType(e,t){if(1!==t.length)return null;const r=this.typeName(t),n=t[0],o=a.c.UNDEFINE_LENGTH,l=[];{const r=[];{const n=new f.a({type:t[0],scope:e}),a=new s.a({scope:e,name:"Append"}),i=h.a.k_Argument|h.a.k_Local,o=new h.b({scope:e,type:n,id:a,usageFlags:i});r.push(o)}const n=new f.a({type:e.findType("void"),scope:e}),a=new s.a({scope:e,name:"Append"}),o=new i.a({scope:e,returnType:n,id:a,paramList:r}),c=new u({scope:e,definition:o,pixel:!1,vertex:!1});l.push(c)}return new p({scope:e,name:r,elementType:n,length:o,fields:[],size:-1,methods:l,uav:!0})}}function A(e,t,r){for(let a in t){const i=v(r+(a.length>1?a.length.toString():""));Object(n.a)(i);const o=new s.a({scope:_,name:a}),l=new f.a({scope:_,type:i,writable:t[a]});e.push(new h.b({scope:_,id:o,type:l}))}}function C(e,t,r=0){if(r>=e.length)return;if(0===r){for(let r=0;r<e.length;r++)t[e[r]]=!0;r=1}const n=Object.keys(t);for(let r=0;r<e.length;r++)for(let a=0;a<n.length;a++)-1!==n[a].indexOf(e[r])?t[n[a]+e[r]]=!1:t[n[a]+e[r]]=!1!==t[n[a]];C(e,t,++r)}function O(e,t,r,n,a){let o=r.map((e,t)=>new h.b({type:new f.a({type:e,scope:_}),id:new s.a({name:`p${t}`,scope:_}),scope:_})),l=new f.a({type:e,scope:_}),c=new s.a({scope:_,name:t}),p=new i.a({scope:_,returnType:l,id:c,paramList:o}),d=new u({scope:_,definition:p,pixel:a,vertex:n});_.addFunction(d)}function I(e,t,r,a,i=!0,s=!0){if(Object(n.f)(a)){t===T&&g("Bad return type(TEMPLATE_TYPE) for system function '"+e+"'.");let n=e+"(",a=v(t),o=[];for(let t=0;t<r.length;t++)r[t]===T?g("Bad argument type(TEMPLATE_TYPE) for system function '"+e+"'."):(o.push(v(r[t])),n+=r[t]+",");y[n+=")"]&&x(E.a.SystemFunctionRedefinition,{funcName:n}),O(a,e,o,i,s),y[n]=!0}else for(let n=0;n<a.length;n++){let o=e+"(",l=v(t===T?a[n]:t),u=[];for(let e=0;e<r.length;e++)r[e]===T?(u.push(v(a[n])),o+=a[n]+","):(u.push(v(r[e])),o+=r[e]+",");y[o+=")"]&&x(E.a.SystemFunctionRedefinition,{funcName:o}),O(l,e,u,i,s),y[o]=!0}}function v(e){let t=_.findType(e);return Object(n.a)(!t||t.instructionType===o.b.k_SystemType),t}b("void",0),b("int",4),b("uint",4),b("bool",4),b("float",4),b("string"),b("texture"),b("sampler"),b("sampler2D"),b("samplerCUBE"),function(){let e={},t={},r={},n={},a={},i={},s={},o={},l={};C(["x","y"],e),C(["x","y","z"],t),C(["x","y","z","w"],r),C(["r","g"],n),C(["r","g","b"],a),C(["r","g","b","a"],i),C(["s","t"],s),C(["s","t","p"],o),C(["s","t","p","q"],l);let u=v("float"),c=v("int"),p=v("uint"),d=v("bool"),h=b("float2",-1,u,2),f=b("float3",-1,u,3),m=b("float4",-1,u,4),E=b("int2",-1,c,2),_=b("int3",-1,c,3),y=b("int4",-1,c,4),T=b("uint2",-1,p,2),g=b("uint3",-1,p,3),x=b("uint4",-1,p,4),S=b("bool2",-1,d,2),R=b("bool3",-1,d,3),k=b("bool4",-1,d,4);{let t=[];A(t,e,"float"),A(t,n,"float"),A(t,s,"float"),t.forEach(e=>h.addField(e))}{let e=[];A(e,t,"float"),A(e,a,"float"),A(e,o,"float"),e.forEach(e=>f.addField(e))}{let e=[];A(e,r,"float"),A(e,i,"float"),A(e,l,"float"),e.forEach(e=>m.addField(e))}{let t=[];A(t,e,"int"),A(t,n,"int"),A(t,s,"int"),t.forEach(e=>E.addField(e))}{let e=[];A(e,t,"int"),A(e,a,"int"),A(e,o,"int"),e.forEach(e=>_.addField(e))}{let e=[];A(e,r,"int"),A(e,i,"int"),A(e,l,"int"),e.forEach(e=>y.addField(e))}{let t=[];A(t,e,"uint"),A(t,n,"uint"),A(t,s,"uint"),t.forEach(e=>T.addField(e))}{let e=[];A(e,t,"uint"),A(e,a,"uint"),A(e,o,"uint"),e.forEach(e=>g.addField(e))}{let e=[];A(e,r,"uint"),A(e,i,"uint"),A(e,l,"uint"),e.forEach(e=>x.addField(e))}{let t=[];A(t,e,"bool"),A(t,n,"bool"),A(t,s,"bool"),t.forEach(e=>S.addField(e))}{let e=[];A(e,t,"bool"),A(e,a,"bool"),A(e,o,"bool"),e.forEach(e=>R.addField(e))}{let e=[];A(e,r,"bool"),A(e,i,"bool"),A(e,l,"bool"),e.forEach(e=>k.addField(e))}}(),function(){let e=v("float2"),t=v("float3"),r=v("float4"),n=v("int2"),a=v("int3"),i=v("int4"),s=(v("uint2"),v("uint3"),v("uint4"),v("bool2")),o=v("bool3"),l=v("bool4");b("float2x2",-1,e,2),b("float2x3",-1,e,3),b("float2x4",-1,e,4),b("float3x2",-1,t,2),b("float3x3",-1,t,3),b("float3x4",-1,t,4),b("float4x2",-1,r,2),b("float4x3",-1,r,3),b("float4x4",-1,r,4),b("int2x2",-1,n,2),b("int2x3",-1,n,3),b("int2x4",-1,n,4),b("int3x2",-1,a,2),b("int3x3",-1,a,3),b("int3x4",-1,a,4),b("int4x2",-1,i,2),b("int4x3",-1,i,3),b("int4x4",-1,i,4),b("bool2x2",-1,s,2),b("bool2x3",-1,s,3),b("bool2x4",-1,s,4),b("bool3x2",-1,o,2),b("bool3x3",-1,o,3),b("bool3x4",-1,o,4),b("bool4x2",-1,l,2),b("bool4x3",-1,l,3),b("bool4x4",-1,l,4)}(),_.addTypeTemplate(new R),_.addTypeTemplate(new k),_.addTypeTemplate(new N),I("dot","float",[T,T],["float","float2","float3","float4"]),I("mul",T,[T,T],["float","int"]),I("mul",T,[T,"float"],["float2","float3","float4","float2x2","float3x3","float4x4"]),I("mul",T,["float",T],["float2","float3","float4","float2x2","float3x3","float4x4"]),I("mul","float4",["float4",T],["float4x4","float4x3","float4x2"]),I("mul","float3",["float3",T],["float3x4","float3x3","float3x2"]),I("mul","float2",["float2",T],["float2x4","float2x3","float2x2"]),I("mul","float4",[T,"float4"],["float4x4","float3x4","float2x4"]),I("mul","float3",[T,"float3"],["float4x3","float3x3","float2x3"]),I("mul","float2",[T,"float2"],["float4x2","float3x2","float2x2"]),I("mod","float",["float","float"],null),I("floor",T,[T],["float","float2","float3","float4"]),I("ceil",T,[T],["float","float2","float3","float4"]),I("abs",T,[T],["float","float2","float3","float4"]),I("sign",T,[T],["float","float2","float3","float4"]),I("normalize",T,[T],["float","float2","float3","float4"]),I("length","float",[T],["float","float2","float3","float4"]),I("cross","float3",["float3","float3"],null),I("reflect",T,[T,T],["float","float2","float3","float4"]),I("max",T,[T,T],["float","float2","float3","float4"]),I("max",T,[T,"float"],["float2","float3","float4"]),I("min",T,[T,T],["float","float2","float3","float4"]),I("min",T,[T,"float"],["float2","float3","float4"]),I("clamp",T,[T,T,T],["float","float2","float3","float4"]),I("clamp",T,[T,"float","float"],["float2","float3","float4"]),I("pow",T,[T,T],["float","float2","float3","float4"]),I("mod",T,[T,T],["float2","float3","float4"]),I("mod",T,[T,"float"],["float2","float3","float4"]),I("exp",T,[T],["float","float2","float3","float4"]),I("exp2",T,[T],["float","float2","float3","float4"]),I("log",T,[T],["float","float2","float3","float4"]),I("log2",T,[T],["float","float2","float3","float4"]),I("inversesqrt",T,[T],["float","float2","float3","float4"]),I("sqrt",T,[T],["float","float2","float3","float4"]),I("all","bool",[T],["bool2","bool3","bool4"]),I("any","bool",[T],["bool2","bool3","bool4"]),I("not",T,[T],["bool2","bool3","bool4"]),I("distance","float",[T,T],["float","float2","float3","float4"]),I("lessThan","bool2",[T,T],["float2","int2","uint2"]),I("lessThan","bool3",[T,T],["float3","int3","uint3"]),I("lessThan","bool4",[T,T],["float4","int4","uint4"]),I("lessThanEqual","bool2",[T,T],["float2","int2","uint2"]),I("lessThanEqual","bool3",[T,T],["float3","int3","uint3"]),I("lessThanEqual","bool4",[T,T],["float4","int4","uint4"]),I("equal","bool2",[T,T],["float2","int2","uint2"]),I("equal","bool3",[T,T],["float3","int3","uint3"]),I("equal","bool4",[T,T],["float4","int4","uint4"]),I("equal",T,[T,T],["bool2","bool3","bool4"]),I("notEqual","bool2",[T,T],["float2","int2","uint2"]),I("notEqual","bool3",[T,T],["float3","int3","uint3"]),I("notEqual","bool4",[T,T],["float4","int4","uint4"]),I("notEqual",T,[T,T],["bool2","bool3","bool4"]),I("greaterThan","bool2",[T,T],["float2","int2","uint2"]),I("greaterThan","bool3",[T,T],["float3","int3","uint3"]),I("greaterThan","bool4",[T,T],["float4","int4","uint4"]),I("greaterThanEqual","bool2",[T,T],["float2","int2","uint2"]),I("greaterThanEqual","bool3",[T,T],["float3","int3","uint3"]),I("greaterThanEqual","bool4",[T,T],["float4","int4","uint4"]),I("radians",T,[T],["float","float2","float3","float4"]),I("degrees",T,[T],["float","float2","float3","float4"]),I("sin",T,[T],["float","float2","float3","float4"]),I("cos",T,[T],["float","float2","float3","float4"]),I("tan",T,[T],["float","float2","float3","float4"]),I("asin",T,[T],["float","float2","float3","float4"]),I("acos",T,[T],["float","float2","float3","float4"]),I("atan",T,[T],["float","float2","float3","float4"]),I("atan",T,[T,T],["float","float2","float3","float4"]),I("tex2D","float4",["sampler","float2"],null),I("tex2D","float4",["sampler2D","float2"],null),I("tex2DProj","float4",["sampler","float3"],null),I("tex2DProj","float4",["sampler2D","float3"],null),I("tex2DProj","float4",["sampler","float4"],null),I("tex2DProj","float4",["sampler2D","float4"],null),I("texCUBE","float4",["sampler","float3"],null),I("texCUBE","float4",["samplerCUBE","float3"],null),I("tex2D","float4",["sampler","float2","float"],null,!1,!0),I("tex2D","float4",["sampler2D","float2","float"],null,!1,!0),I("tex2DProj","float4",["sampler","float3","float"],null,!1,!0),I("tex2DProj","float4",["sampler2D","float3","float"],null,!1,!0),I("tex2DProj","float4",["sampler","float4","float"],null,!1,!0),I("tex2DProj","float4",["sampler2D","float4","float"],null,!1,!0),I("texCUBE","float4",["sampler","float3","float"],null,!1,!0),I("texCUBE","float4",["samplerCUBE","float3","float"],null,!1,!0),I("tex2DLod","float4",["sampler","float2","float"],null,!0,!1),I("tex2DLod","float4",["sampler2D","float2","float"],null,!0,!1),I("tex2DProjLod","float4",["sampler","float3","float"],null,!0,!1),I("tex2DProjLod","float4",["sampler2D","float3","float"],null,!0,!1),I("tex2DProjLod","float4",["sampler","float4","float"],null,!0,!1),I("tex2DProjLod","float4",["sampler2D","float4","float"],null,!0,!1),I("texCUBELod","float4",["sampler","float3","float"],null,!0,!1),I("texCUBELod","float4",["samplerCUBE","float3","float"],null,!0,!1),I("dFdx",T,[T],["float","float2","float3","float4"]),I("dFdy",T,[T],["float","float2","float3","float4"]),I("width",T,[T],["float","float2","float3","float4"]),I("fwidth",T,[T],["float","float2","float3","float4"]),I("smoothstep",T,[T,T,T],["float","float2","float3","float4"]),I("smoothstep",T,["float","float",T],["float2","float3","float4"]),I("frac",T,[T],["float","float2","float3","float4"]),I("lerp",T,[T,T,T],["float","float2","float3","float4"]),I("lerp",T,[T,T,"float"],["float2","float3","float4"]),I("saturate",T,[T],["float","float2","float3","float4"]);const P=_,D=_.findType("void"),F=_.findType("string"),L=_.findType("float"),w=_.findType("float2"),U=_.findType("float3"),j=_.findType("float4"),B=_.findType("float2x2"),W=_.findType("float3x3"),z=_.findType("float4x4"),M=_.findType("bool"),V=_.findType("bool2"),q=_.findType("bool3"),K=_.findType("bool4"),G=_.findType("bool2x2"),$=_.findType("bool3x3"),H=_.findType("bool4x4"),X=_.findType("int"),Z=_.findType("int2"),Q=_.findType("int3"),Y=_.findType("int4"),J=_.findType("uint"),ee=_.findType("uint2"),te=_.findType("uint3"),re=_.findType("uint4"),ne=_.findType("int2x2"),ae=_.findType("int3x3"),ie=_.findType("int4x4"),se=_.findType("sampler"),oe=(_.findType("sampler2D"),_.findType("samplerCUBE"),e=>_.findType(e)),le=e=>!Object(n.f)(_.findVariable(e));function ue(e){return e.isEqual(v("float2x2"))||e.isEqual(v("float3x3"))||e.isEqual(v("float4x4"))||e.isEqual(v("int2x2"))||e.isEqual(v("int3x3"))||e.isEqual(v("int4x4"))||e.isEqual(v("bool2x2"))||e.isEqual(v("bool3x3"))||e.isEqual(v("bool4x4"))}function ce(e){return e.isEqual(v("float2"))||e.isEqual(v("float3"))||e.isEqual(v("float4"))||e.isEqual(v("bool2"))||e.isEqual(v("bool3"))||e.isEqual(v("bool4"))||e.isEqual(v("int2"))||e.isEqual(v("int3"))||e.isEqual(v("int4"))||e.isEqual(v("uint2"))||e.isEqual(v("uint3"))||e.isEqual(v("uint4"))}function pe(e){return e.isEqual(M)||e.isEqual(X)||e.isEqual(J)||e.isEqual(L)}function de(e){return e.isEqual(L)||e.isEqual(w)||e.isEqual(U)||e.isEqual(j)||e.isEqual(B)||e.isEqual(W)||e.isEqual(z)}function he(e){return e.isEqual(X)||e.isEqual(Z)||e.isEqual(Q)||e.isEqual(Y)||e.isEqual(ne)||e.isEqual(ae)||e.isEqual(ie)}function fe(e){return e.isEqual(M)||e.isEqual(V)||e.isEqual(q)||e.isEqual(K)||e.isEqual(G)||e.isEqual($)||e.isEqual(H)}function me(e){return e.isEqual(se)||e.isEqual(v("sampler2D"))||e.isEqual(v("samplerCUBE"))}function Ee(e){return e.isEqual(X)||e.isEqual(J)||e.isEqual(L)?Number:e.isEqual(M)?"Boolean":e.isEqual(w)||e.isEqual(V)||e.isEqual(Z)||e.isEqual(ee)?"Vec2":e.isEqual(U)||e.isEqual(q)||e.isEqual(Q)||e.isEqual(te)?"Vec3":e.isEqual(j)||e.isEqual(K)||e.isEqual(Y)||e.isEqual(re)?"Vec4":e.isEqual(B)||e.isEqual(G)||e.isEqual(ne)?"Vec2":e.isEqual(W)||e.isEqual($)||e.isEqual(ae)?"Mat3":e.isEqual(z)||e.isEqual(H)||e.isEqual(ie)?"Mat4":null}},"Wv+o":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("fb8x"),a=r("zioJ"),i=r("FrU9"),s=r("2b0+"),o=r("oseZ");class l extends o.a{constructor({init:e=null,cond:t=null,step:r=null,body:n=null,...a}){super({instrType:i.b.k_ForStmt,...a}),this._init=s.a.$withParent(e,this),this._cond=s.a.$withParent(t,this),this._step=s.a.$withParent(r,this),this._body=s.a.$withParent(n,this)}get init(){return this._init}get cond(){return this._cond}get step(){return this._step}get body(){return this._body}toCode(){var e="for(";return e+=this._init.toCode()+";",e+=this._cond.toCode()+";",e+=this._step.toCode()+")",e+=this._body.toCode()}check(e,t=null){return Object(n.f)(this._step)?(this._setError(a.a.InvalidForStepEmpty),!1):Object(n.f)(this._init)?(this._setError(a.a.InvalidForInitEmptyIterator),!1):this._init.instructionType!==i.b.k_VariableDecl?(this._setError(a.a.InvalidForInitExpr),!1):Object(n.f)(this._cond)?(this._setError(a.a.InvalidForConditionEmpty),!1):this._cond.instructionType!==i.b.k_RelationalExpr?(this._setError(a.a.InvalidForConditionRelation),!1):this._step.instructionType===i.b.k_UnaryExpr||this._step.instructionType===i.b.k_AssignmentExpr||this._step.instructionType===i.b.k_PostfixArithmeticExpr||(this._setError(a.a.InvalidForStepExpr),!1)}}},XQla:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({left:e,right:t,operator:r,...a}){super({instrType:n.b.k_AssignmentExpr,type:e.type,...a}),this._leftValue=i.a.$withParent(e,this),this._rightValue=i.a.$withParent(t,this),this._operator=r}get left(){return this._leftValue}get right(){return this._rightValue}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}}},Zd6l:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("2b0+"),i=r("oseZ");class s extends i.a{constructor({declList:e=null,...t}){super({instrType:n.b.k_DeclStmt,...t}),this._declList=(e||[]).map(e=>a.a.$withParent(e,this))}get declList(){return this._declList}toCode(){for(var e="",t=this.declList,r=0;r<this.declList.length;r++)e+=t[r].toCode()+";\n";return e}}},a1Km:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.UnsupportedRenderStateTypeUsed=3e3]="UnsupportedRenderStateTypeUsed",e[e.IncompleteTechnique=3001]="IncompleteTechnique",e[e.IncompletePass=3002]="IncompletePass",e[e.UselessPassState=3003]="UselessPassState"}(n||(n={}))},bxdW:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("FrU9"),a=r("u2cq"),i=r("4AA8"),s=r("2b0+");class o extends i.a{constructor({cond:e,left:t,right:r,...i}){super({instrType:n.b.k_ConditionalExpr,type:t.type,...i}),console.assert(a.d.equals(t.type,r.type,!0)),this._cond=s.a.$withParent(e,this),this._leftValue=s.a.$withParent(t,this),this._rightValue=s.a.$withParent(r,this)}get condition(){return this._cond}get left(){return this._leftValue}get right(){return this._rightValue}toCode(){var e="(";return e+=this.condition.toCode(),e+="?",e+=this.left.toCode(),e+=":",e+=this.right.toCode(),e+=")"}isConst(){return this.condition.isConst()&&this.left.isConst()}}},fb8x:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"h",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return c})),r.d(t,"i",(function(){return p}));let n=e=>void 0!==e,a=e=>null!=e,i=e=>null===e,s=e=>"boolean"==typeof e,o=e=>"string"==typeof e,l=e=>"number"==typeof e,u=(e,t)=>JSON.stringify(e)===JSON.stringify(t);const c=console.assert.bind(console);console.log.bind(console);function p(e,t){let r=0;for(const n in e)if(!1===t(e[n],n,r++))break}},fjuh:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({operand:e,args:t=null,...r}){super({instrType:n.b.k_CompileExpr,...r}),this._operand=i.a.$withParent(e,this),this._args=(t||[]).map(e=>i.a.$withParent(e,this))}get function(){return this._operand}get args(){return this._args}}},fuca:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({element:e,index:t,...r}){super({instrType:n.b.k_PostfixIndexExpr,type:e.type.arrayElementType,...r}),this.element=i.a.$withParent(e,this),this.index=i.a.$withParent(t,this)}toCode(){return`${this.element.toCode()}[${this.index.toCode()}]`}isConst(){return this.element.isConst()&&this.index.isConst()}}},gf1s:function(e,t,r){"use strict";var n,a,i,s,o,l,u;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),function(e){e[e.UNDEF=0]="UNDEF",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(n||(n={})),function(e){e[e.UNDEF=0]="UNDEF",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(a||(a={})),function(e){e[e.MAG_FILTER=10240]="MAG_FILTER",e[e.MIN_FILTER=10241]="MIN_FILTER",e[e.WRAP_S=10242]="WRAP_S",e[e.WRAP_T=10243]="WRAP_T"}(i||(i={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP"}(s||(s={})),function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.NEGATIVE_X=1]="NEGATIVE_X",e[e.POSITIVE_Y=2]="POSITIVE_Y",e[e.NEGATIVE_Y=3]="NEGATIVE_Y",e[e.POSITIVE_Z=4]="POSITIVE_Z",e[e.NEGATIVE_Z=5]="NEGATIVE_Z"}(o||(o={})),function(e){e[e.POSITIVE_X=1]="POSITIVE_X",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.POSITIVE_Y=4]="POSITIVE_Y",e[e.NEGATIVE_Y=8]="NEGATIVE_Y",e[e.POSITIVE_Z=12]="POSITIVE_Z",e[e.NEGATIVE_Z=16]="NEGATIVE_Z"}(l||(l={})),function(e){e[e.TEXTURE0=33984]="TEXTURE0"}(u||(u={}))},ggRF:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("fb8x"),a=r("u2cq"),i=r("Wl5j"),s=r("FrU9"),o=r("4AA8"),l=r("2b0+");class u extends o.a{constructor({type:e,args:t=[],...r}){super({instrType:s.b.k_InitExpr,type:e,...r}),this._isArray=!1,this._args=t.map(e=>l.a.$withParent(e,this))}get args(){return this._args}isArray(){return this._isArray}toCode(){let e="";Object(n.f)(this.type)||(e+=this.type.toCode()),e+="(";for(let t=0;t<this.args.length;t++)e+=this.args[t].toCode(),t!==this.args.length-1&&(e+=",");return e+=")"}isConst(){let e=this.args;for(let t=0;t<e.length;t++)if(!e[t].isConst())return!1;return!0}optimizeForVariableType(e){if(e.isNotBaseArray()&&e.scope.type<=s.c.k_Global||e.isArray()&&this.args.length>1){if(e.length===a.c.UNDEFINE_LENGTH||e.isNotBaseArray()&&this.args.length!==e.length||!e.isNotBaseArray()&&this.args.length!==e.baseType.length)return!1;e.isNotBaseArray()&&(this._isArray=!0);let t=e.arrayElementType,r=!1,n=null;for(let e=0;e<this.args.length;e++)if((n=this.args[e]).instructionType===s.b.k_InitExpr){if(!(r=n.optimizeForVariableType(t)))return!1}else if(i.q(t)){if(n.instructionType!==s.b.k_SamplerStateBlockExpr)return!1}else if(!(r=n.type.isEqual(t)))return!1;return this._type=e.baseType,!0}{let t=this.args[0];if(1===this.args.length&&t.instructionType!==s.b.k_InitExpr)return i.q(e)?t.instructionType===s.b.k_SamplerStateBlockExpr:!!t.type.isEqual(e);if(1===this.args.length)return!1;let r=this.args,n=e.fieldNames;for(let t=0;t<r.length;t++){let a=e.getField(n[t]).type;if(!r[t].optimizeForVariableType(a))return!1}return this._type=e.baseType,!0}}evaluate(){if(!this.isConst())return this._evalResult=null,!1;let e=null;if(this._isArray){e=new Array(this.args.length);for(let t=0;t<this.args.length;t++){let r=this.args[t];r.evaluate()&&(e[t]=r.getEvalValue())}}else if(1===this.args.length){let t=this.args[0];t.evaluate(),e=t.getEvalValue()}else{let t=i.k(this.type),r=new Array(this.args.length);if(Object(n.f)(t))return!1;try{if(i.r(this.type)){let r=this.args[1];if(this.args.length>2||!r.evaluate())return!1;e=t(r.getEvalValue())}else{for(let e=0;e<this.args.length;e++){let t=this.args[e];if(!t.evaluate())return!1;r[e]=t.getEvalValue()}(e=new t).set.apply(e,r)}}catch(e){return!1}}return this._evalResult=e,!0}}},hljw:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("u2cq"),i=r("FrU9"),s=r("2b0+");class o extends s.a{constructor({type:e,usages:t=[],arrayIndex:r=null,writable:l=!0,readable:u=!0,padding:c=a.c.UNDEFINE_PADDING,...p}){super({instrType:i.b.k_VariableType,...p}),e=e.$withNoParent(),this._usageList=[];let d=e.instructionType;if(d===i.b.k_ProxyType||d===i.b.k_SystemType||d===i.b.k_ComplexType)this._subType=e;else{let t=e;t.isNotBaseArray()?this._subType=e:(this._subType=t.subType,t.usages.forEach(e=>this.addUsage(e)))}Object(n.a)(Object(n.e)(this._subType)),Object(n.a)(Object(n.e)(this._usageList)),this._isWritable=l,this._isReadable=u,this._arrayIndexExpr=null,this._arrayElementType=null,this._padding=c,r&&(this._arrayElementType=s.a.$withParent(new o({scope:this.scope,type:this.subType,usages:this._usageList}),this),this._arrayIndexExpr=s.a.$withParent(r,this)),t.forEach(e=>this.addUsage(e))}get name(){return this.baseType.name}get writable(){return!!this._isWritable&&(!(this.isArray()&&!this.isBase()||this.isUniform())&&(!this.isConst()&&this.subType.writable))}get readable(){return!!this._isReadable&&(!this.hasUsage("out")&&this.subType.readable)}get methods(){return this.subType.methods}get size(){if(!Object(n.f)(this._arrayElementType)){const e=this._arrayElementType.size,t=this.length;return t===a.c.UNDEFINE_LENGTH||e===a.c.UNDEFINE_SIZE?a.c.UNDEFINE_SIZE:e*t}return this.subType.size}get baseType(){return this.subType.baseType}get length(){if(!this.isNotBaseArray())return this.subType.length;if(this.isNotBaseArray()&&Object(n.f)(this._arrayElementType))return this.subType.length;if(this._arrayIndexExpr.evaluate()){let e=this._arrayIndexExpr.getEvalValue();if(Object(n.g)(e))return e}return a.c.UNDEFINE_LENGTH}get padding(){return this._padding}get arrayElementType(){return this.isArray()?this._arrayElementType||this.subType.arrayElementType:null}get fieldNames(){return this.subType.fieldNames}get usages(){return this._usageList}get subType(){return this._subType}get fields(){return this.subType.fields}toString(){return this.name||this.subType.toString()||a.d.hash(this)}toCode(){let e="";if(!Object(n.f)(this._usageList))for(let t=0;t<this._usageList.length;t++)e+=this._usageList[t]+" ";return e+=this.subType.toCode()}isEqual(e){return a.d.equals(this,e)}toDeclString(){return this.subType.toDeclString()}isBase(){return this.subType.isBase()&&Object(n.f)(this._arrayElementType)}isArray(){return!Object(n.f)(this._arrayElementType)||this.subType.isArray()}isNotBaseArray(){return!Object(n.f)(this._arrayElementType)||this.subType.isNotBaseArray()}isComplex(){return this.subType.isComplex()}isContainArray(){return this.subType.isContainArray()}isContainSampler(){return this.subType.isContainSampler()}isContainComplexType(){return this.subType.isContainComplexType()}isUniform(){return this.hasUsage("uniform")}isConst(){return this.hasUsage("const")}isSampler(){return!this.isNotBaseArray()&&this.subType.isSampler()}isTexture(){return!this.isNotBaseArray()&&this.subType.isTexture()}isUAV(){return!this.isNotBaseArray()&&this.subType.isUAV()}$overwritePadding(e){this._padding=e}addUsage(e){this.hasUsage(e)||this._usageList.push(e)}hasField(e){return this.subType.hasField(e)}hasFieldWithSematics(e){return this.subType.hasFieldWithSematics(e)}hasAllUniqueSemantics(){return this.subType.hasAllUniqueSemantics()}hasFieldWithoutSemantics(){return this.subType.hasFieldWithoutSemantics()}getField(e){return this.subType.getField(e)}getMethod(e,t){return this.subType.getMethod(e,t)}getFieldBySemantics(e){return this.subType.getFieldBySemantics(e)}hasUsage(e){return!!this._usageList.find(t=>t===e)||!Object(n.f)(this.subType)&&this.subType.instructionType===i.b.k_VariableType&&this.subType.hasUsage(e)}static wrap(e,t){return new o({type:e,scope:t})}static wrapAsConst(e,t){return new o({type:e,scope:t,writable:!1,usages:["const"]})}}},hsO8:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("mXWi"),a=r("2b0+"),i=r("FrU9"),s=r("u2cq");class o extends n.a{constructor({returnType:e,id:t,paramList:r=[],...n}){super({instrType:i.b.k_FunctionDef,...n}),this.params=r.map(e=>a.a.$withParent(e,this)),this.returnType=a.a.$withParent(e,this),this._id=a.a.$withParent(t,this)}get id(){return this._id}get name(){return this._id.name}toString(){let e=s.d.signature(this.returnType)+" "+this.name+"(";for(let t=0;t<this.params.length;t++)e+=s.d.signature(this.params[t].type)+",";return e+=")"}toCode(){const{_id:e,returnType:t,params:r}=this;return`${t.toCode()} ${e.toCode()}(${r.map(e=>e.toCode()).join(", ")})`}}},huhI:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("2b0+"),a=r("oseZ"),i=r("FrU9");class s extends a.a{constructor({expr:e,...t}){super({instrType:i.b.k_ExprStmt,...t}),this._expr=n.a.$withParent(e,this)}get expr(){return this._expr}toCode(){return this._expr.toCode()+";"}}},i81d:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("fb8x"),a=r("Wl5j"),i=r("zioJ"),s=r("FrU9"),o=r("u2cq"),l=r("2b0+");class u extends l.a{constructor({name:e=null,fields:t,...r}){super({instrType:s.b.k_ComplexType,...r}),this._name=e,this._fields={},this._isContainArray=!1,this._isContainSampler=!1,this._isContainComplexType=!1,this.addFields(t.filter(e=>!Object(n.f)(e)).map(e=>l.a.$withParent(e,this)))}get writable(){return!0}get readable(){return!0}get name(){return this._name}get size(){return this.calcSize()}get baseType(){return this}get arrayElementType(){return null}get typeDecl(){return this.parent}get length(){return 0}get fieldNames(){return Object.keys(this._fields)}get fields(){return this.fieldNames.map(e=>this._fields[e])}get methods(){return[]}isSampler(){return!1}isTexture(){return!1}isUAV(){return!1}toString(){return this.name||o.d.hash(this)}toDeclString(){for(var e="struct "+this._name+"{",t=0;t<this.fields.length;t++)e+="\t"+this.fields[t].toCode()+";\n";return e+="}"}isEqual(e){return o.d.equals(this,e)}toCode(){return this._name}isBase(){return!1}isArray(){return!1}isNotBaseArray(){return!1}isComplex(){return!0}isConst(){return!1}isContainArray(){return this._isContainArray}isContainSampler(){return this._isContainSampler}isContainComplexType(){return this._isContainComplexType}addField(e){var t=e.name;this._fields[t]=e;var r=e.type;(r.isNotBaseArray()||r.isContainArray())&&(this._isContainArray=!0),(a.q(r)||r.isContainSampler())&&(this._isContainSampler=!0),r.isComplex()&&(this._isContainComplexType=!0)}addFields(e){for(var t=0;t<e.length;t++)this.addField(e[t]);this.calculatePaddings()}hasField(e){return Object(n.d)(this._fields[e])}hasFieldWithSematics(e){return!!this.getFieldBySemantics(e)}getField(e){return this._fields[e]||null}getMethod(e,t){return null}getFieldBySemantics(e){for(let t in this._fields){let r=this._fields[t];if(e==r.semantic)return r}return null}calcSize(){let e=0;for(let t=0;t<this.fields.length;t++){let r=this.fields[t].type.size;if(r===o.c.UNDEFINE_SIZE){e=o.c.UNDEFINE_SIZE;break}e+=r}return e}hasFieldWithoutSemantics(){for(let e in this._fields){let t=this._fields[e],r=t.semantic;if(null==r||""==r)return!0;if(t.type.hasFieldWithoutSemantics())return!0}return!1}hasAllUniqueSemantics(){let e={};for(let t in this._fields){let r=this._fields[t],a=r.semantic;if(Object(n.e)(e[a]))return!1;if(e[a]=r,r.type.isComplex()&&!r.type.hasAllUniqueSemantics())return!1}return!0}calculatePaddings(){let e=0;for(let t=0;t<this.fields.length;t++){let r=this.fields[t].type,n=r.size;if(n===o.c.UNDEFINE_SIZE)return void this._setError(i.a.CannotCalcPadding,{typeName:this.name});r.$overwritePadding(e),e+=n}}}},iYqf:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({instructions:e=[],...t}){super({instrType:n.b.k_Collector,...t}),this._instructions=e}get instructions(){return this._instructions}push(e){this._instructions.push(e)}toCode(){let e="";for(const t of this.instructions)switch(t.instructionType){case n.b.k_VariableDecl:e+=t.toCode()+";\n";break;default:e+=t.toCode()+"\n"}return e}}},"ip/g":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("oseZ");class i extends a.a{constructor({...e}){super({instrType:n.b.k_SemicolonStmt,...e})}toCode(){return";"}}},jfm7:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("fb8x"),a=r("6dfp"),i=r("2blz"),s=r("FrU9"),o=r("gf1s"),l=r("mXWi"),u=r("2b0+");class c extends l.a{constructor({id:e=null,vertexShader:t=null,pixelShader:r=null,renderStates:n={},...a}){super({instrType:s.b.k_PassDecl,...a}),this._passStateMap={},c.clearRenderStateMap(this._passStateMap),c.copyRenderStateMap(n,this._passStateMap),this._vertexShader=u.a.$withNoParent(t),this._pixelShader=u.a.$withNoParent(r),this._id=e}get id(){return this._id}get name(){return Object(n.f)(this._id)?null:this._id.name}get vertexShader(){return this._vertexShader}get pixelShader(){return this._pixelShader}getState(e){return this._passStateMap[e]}get renderStates(){return this._passStateMap}static createRenderStateMap(){let e={};return c.clearRenderStateMap(e),e}static copyRenderStateMap(e,t){Object(n.f)(e)||Object.keys(a.a).filter(e=>Object(n.g)(a.a[e])).map(e=>a.a[e]).forEach(r=>{t[r]=e[r]||t[r]})}static clearRenderStateMap(e){Object.keys(a.a).filter(e=>Object(n.g)(a.a[e])).map(e=>a.a[e]).forEach(t=>{e[t]=i.a.UNDEF})}static createSamplerState(){return{textureName:"",texture:null,wrap_s:o.b.UNDEF,wrap_t:o.b.UNDEF,mag_filter:o.a.UNDEF,min_filter:o.a.UNDEF}}}},"kGK+":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("2b0+"),i=r("oseZ");class s extends i.a{constructor({stmtList:e,...t}){super({instrType:n.b.k_StmtBlock,...t}),this._stmtList=e.map(e=>a.a.$withParent(e,this))}get stmtList(){return this._stmtList}toCode(){for(var e="{\n",t=0;t<this.stmtList.length;t++)e+="\t"+this.stmtList[t].toCode()+"\n";return e+="}"}}},"l4+G":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("4AA8"),s=r("2b0+");class o extends i.a{constructor({left:e,right:t,operator:r,...n}){super({instrType:a.b.k_ArithmeticExpr,...n}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=r}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}evaluate(){var e=this._leftOperand.evaluate()?this._leftOperand.getEvalValue():null,t=this._rightOperand.evaluate()?this._rightOperand.getEvalValue():null;if(Object(n.f)(e)||Object(n.f)(t))return!1;try{switch(this.operator){case"+":this._evalResult=e+t;break;case"-":this._evalResult=e-t;break;case"*":this._evalResult=e*t;break;case"/":this._evalResult=e/t;break;case"%":this._evalResult=e%t}return!0}catch(e){return!1}}toCode(){var e="";return e+=this._leftOperand.toCode(),e+=this.operator,e+=this._rightOperand.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},mXWi:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({semantic:e=null,annotation:t=null,...r}){super({instrType:n.b.k_Decl,...r}),this._semantic=e,this._annotation=a.a.$withParent(t,this)}get semantic(){return this._semantic}get annotation(){return this._annotation}get name(){return null}get id(){return null}}},onqc:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fb8x"),a=r("FrU9"),i=r("mXWi"),s=r("2b0+");class o extends i.a{constructor({type:e,...t}){super({instrType:a.b.k_TypeDecl,...t}),this.type=s.a.$withParent(e,this),Object(n.a)(Object(n.d)(this.type))}get name(){return this.type.name}toCode(){return this.type.toDeclString()+";"}}},oseZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({...e}){super({instrType:n.b.k_Stmt,...e})}}},pq1u:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("FrU9"),a=r("2b0+");class i extends a.a{constructor({name:e,args:t,...r}){super({instrType:n.b.k_Attribute,...r}),this.name=e,this.args=t}toCode(){return`[${this.name}${this.args.length>0?`(${this.args.map(e=>e.toCode()).join(", ")})`:""}]`}}},sQ1Q:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("FrU9"),a=r("4AA8"),i=r("2b0+");class s extends a.a{constructor({element:e,postfix:t,...r}){super({instrType:n.b.k_PostfixPointExpr,type:t.type,...r}),this.element=i.a.$withParent(e,this),this.postfix=i.a.$withParent(t,this)}toCode(){return`${this.element.toCode()}.${this.postfix.toCode()}`}isConst(){return this.element.isConst()}}},u2cq:function(e,t,r){"use strict";var n,a,i,s,o,l,u=r("fb8x"),c=r("FrU9");(n||(n={})).unwind=function e(t){if(Object(u.f)(t))return null;switch(t.instructionType){case c.b.k_PostfixPointExpr:case c.b.k_PostfixIndexExpr:return e(t.element);case c.b.k_IdExpr:return t.decl;case c.b.k_ArithmeticExpr:return null;case c.b.k_InitExpr:return Object(u.a)(!1,"init expression doesn't support unwind operation"),null;case c.b.k_AssignmentExpr:return e(t.left);case c.b.k_CastExpr:case c.b.k_UnaryExpr:case c.b.k_RelationalExpr:case c.b.k_ConstructorCallExpr:return null;case c.b.k_ComplexExpr:return e(t.expr);case c.b.k_IntExpr:case c.b.k_FloatExpr:case c.b.k_StringExpr:case c.b.k_BoolExpr:case c.b.k_FunctionCallExpr:return null;default:return Object(u.a)(!1,"unsupported expr found"),null}},function(e){function t(e,t){return`${l.signature(e.type,t)}${e.initExpr?"?":""}`}function r(e){return e.params.filter(e=>!e||!e.initExpr).length}e.signature=function(e,r=!1){const{name:n,params:a}=e;return`${n}(${a.map(e=>t(e,r)).join(", ")})`},e.signatureEx=function(e,r=!1){const{name:n,returnType:a,params:i}=e;return`${l.signature(a,r)} ${n}(${i.map(e=>t(e,r)).join(", ")})`},e.numArgsRequired=r,e.match=function(e,t,n=!1){return!(n||!Object(u.f)(t))||!(t.length>e.params.length||r(e)>t.length)&&t.every((t,r)=>!n&&Object(u.f)(t)||!n&&Object(u.f)(e.params[r].type)||l.equals(t,e.params[r].type,n))},e.matchList=function(t,r,n=!1){if(!t)return null;const a=t.filter(t=>e.match(t.def,r,n));return a.length>1?void 0:1===a.length?a[0]:null}}(a||(a={})),(s=i||(i={})).UNDEFINE_LENGTH=16777215,s.UNDEFINE_SIZE=16777215,s.UNDEFINE_PADDING=16777215,s.UNDEFINE_NAME="undef",s.isExpression=function(e){switch(e.instructionType){case c.b.k_ConditionalExpr:case c.b.k_ConstructorCallExpr:case c.b.k_AssignmentExpr:case c.b.k_ArithmeticExpr:case c.b.k_InitExpr:case c.b.k_IdExpr:case c.b.k_FunctionCallExpr:case c.b.k_FloatExpr:case c.b.k_IntExpr:case c.b.k_BoolExpr:case c.b.k_PostfixArithmeticExpr:case c.b.k_PostfixIndexExpr:case c.b.k_PostfixPointExpr:case c.b.k_ComplexExpr:case c.b.k_CastExpr:case c.b.k_UnaryExpr:return!0}return!1},s.isStatement=function(e){switch(e.instructionType){case c.b.k_Stmt:case c.b.k_DeclStmt:case c.b.k_ReturnStmt:case c.b.k_IfStmt:case c.b.k_StmtBlock:case c.b.k_ExprStmt:case c.b.k_WhileStmt:case c.b.k_ForStmt:case c.b.k_BreakStmt:case c.b.k_SemicolonStmt:return!0}return!1},s.isLiteral=function(e){switch(e.instructionType){case c.b.k_IntExpr:case c.b.k_FloatExpr:case c.b.k_BoolExpr:case c.b.k_StringExpr:return!0}return!1},function(e){function t(e){return e.isParameter()?(Object(u.a)(e.parent.instructionType===c.b.k_FunctionDef),e.parent.params.indexOf(e)):(console.error("invalid call."),-1)}e.parameterIndex=t,e.parameterOffset=function(e){if(!e.isParameter())return console.error("invalid call."),0;let r=t(e),n=0;for(let t=0;t<r;++t)n+=e.parent.params[t].type.size;return n},e.fullName=function(e){if(e.isField()&&l.findParentVariableDecl(e.parent)){let t="";return e.parent.instructionType===c.b.k_VariableType&&(t=l.resolveVariableDeclFullName(e.parent)),t+="."+e.name}return e.name},e.resolveRegister=function(e){let t=null,r=-1;const n=e.semantic;if(n){const e=n.match(/^register\(([utbs]{1})([\d]+)\)$/);e&&(t=e[1],r=Number(e[2]))}return e.type.isUAV()&&(Object(u.a)(null===t||"u"===t),t="u"),e.type.isTexture()&&(Object(u.a)(null===t||"t"===t),t="t"),e.type.isSampler()&&(Object(u.a)(null===t||"s"===t),t="s"),{type:t,index:r}}}(o||(o={})),function(e){function t(e){if(Object(u.f)(e.parent))return!1;const r=e.parent.instructionType;return r===c.b.k_VariableDecl||r===c.b.k_VariableType&&t(e.parent)}function r(e){if(Object(u.f)(e.parent))return!1;if(e.parent.instructionType===c.b.k_VariableDecl){return e.parent.isField()}return!1}function n(e){if(!t(e))return null;return e.parent.instructionType===c.b.k_VariableDecl?e.parent:n(e.parent)}function a(e){if(!t(e))return null;return e.parent.instructionType===c.b.k_TypeDecl?e.parent:a(e.parent)}function s(e,t=!1){if(Object(u.f)(e))return Object(u.a)(!t),"*";switch(e.instructionType){case c.b.k_VariableType:return function(e,t){let r="";t&&e.usages.length>0&&(r=`${e.usages.join("_")}_`);let n="";return e.isNotBaseArray()&&(n="[]",e.length!==i.UNDEFINE_LENGTH&&(n=`[${e.length}]`)),`${r}${s(e.subType)}${n}`}(e,t);case c.b.k_ComplexType:return`${e.name}${e.instructionID}`;case c.b.k_ProxyType:return e.baseType?s(e.baseType):e.name;case c.b.k_SystemType:return e.name;default:return Object(u.a)(!1,"unsupported type"),null}}function l(e,t=!1){switch(e.instructionType){case c.b.k_VariableType:return function(e,t){let r="";return(t?e.isArray():e.isNotBaseArray())&&(r="[]",e.length!==i.UNDEFINE_LENGTH&&(r=`[${e.length}]`)),`${l(e.subType)}${r}`}(e,t);case c.b.k_ComplexType:return function(e,t){return`{${e.fields.map(e=>l(e.type,t)).join(";")}}`}(e,t);case c.b.k_ProxyType:return e.baseType?l(e.baseType):e.name;case c.b.k_SystemType:return e.name;default:return Object(u.a)(!1,"unsupported type"),null}}function p(e,t,r=!1){if(Object(u.f)(e)||Object(u.f)(t))return!1;if(e instanceof RegExp&&t instanceof RegExp)return Object(u.a)(!1),!1;if(e instanceof RegExp){let n=e;return!!s(t,r).match(n)}if(t instanceof RegExp){let n=t;return!!s(e,r).match(n)}let n=e,a=t;return(!n.isArray()||!a.isArray()||n.length!==i.UNDEFINE_LENGTH&&a.length!==i.UNDEFINE_LENGTH)&&s(n,r)===s(a,r)}e.isInheritedFromVariableDecl=t,e.isTypeOfField=r,e.findParentContainer=function(e){if(!t(e)||!r(e))return null;let a=n(e).parent;return t(a)?n(a):null},e.findParentVariableDecl=n,e.findParentVariableDeclName=function(e){let t=n(e);return Object(u.f)(t)?null:t.name},e.finParentTypeDecl=a,e.finParentTypeDeclName=function(e){let t=a(e);return Object(u.f)(t)?null:t.name},e.resolveVariableDeclFullName=function(e){return t(e)?o.fullName(n(e)):(console.error("Not from variable decl"),null)},e.findMainVariable=function e(a){return t(a)?r(a)?e(a.parent.parent):n(a):null},e.signature=s,e.hash=l,e.compareRelaxed=function(e,t,r=!1){return l(e,r)===l(t,r)},e.compare=p,e.equals=function(e,t,r=!1){return p(e,t,r)}}(l||(l={})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return l}))},wEKK:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("Wl5j"),a=r("FrU9"),i=r("4AA8"),s=r("2b0+");class o extends i.a{constructor({left:e,right:t,operator:r,...i}){super({instrType:a.b.k_LogicalExpr,type:n.b,...i}),this._leftOperand=s.a.$withParent(e,this),this._rightOperand=s.a.$withParent(t,this),this._operator=r}get operator(){return this._operator}get left(){return this._leftOperand}get right(){return this._rightOperand}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},wsMd:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("4AA8"),a=r("Wl5j"),i=r("FrU9");class s extends n.a{constructor({left:e,right:t,operator:r,...n}){super({instrType:i.b.k_RelationalExpr,type:a.b,...n}),this._leftOperand=e,this._rightOperand=t,this._operator=r}get left(){return this._leftOperand}get right(){return this._rightOperand}get operator(){return this._operator}toCode(){var e="";return e+=this.left.toCode(),e+=this.operator,e+=this.right.toCode()}isConst(){return this.left.isConst()&&this.right.isConst()}}},"zX2+":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.k_Warning=0]="k_Warning",e[e.k_Error=1]="k_Error"}(n||(n={}))},zioJ:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.SystemTypeRedefinition=2202]="SystemTypeRedefinition",e[e.TypeRedefinition=2203]="TypeRedefinition",e[e.VariableRedefinition=2204]="VariableRedefinition",e[e.SystemVariableRedefinition=2205]="SystemVariableRedefinition",e[e.FunctionRedifinition=2206]="FunctionRedifinition",e[e.SystemFunctionRedefinition=2207]="SystemFunctionRedefinition",e[e.UnsupportedTypeDecl=2208]="UnsupportedTypeDecl",e[e.UnsupportedExpr=2209]="UnsupportedExpr",e[e.UnknownVarName=2210]="UnknownVarName",e[e.InvalidArithmeticOperation=2211]="InvalidArithmeticOperation",e[e.InvalidArithmeticAssigmentOperation=2212]="InvalidArithmeticAssigmentOperation",e[e.InvalidAssigmentOperation=2213]="InvalidAssigmentOperation",e[e.InvalidLeftHandSideInAssignment=2214]="InvalidLeftHandSideInAssignment",e[e.InvalidRelationalOperation=2215]="InvalidRelationalOperation",e[e.InvalidLogicOperation=2216]="InvalidLogicOperation",e[e.InvalidConditionType=2217]="InvalidConditionType",e[e.InvalidConditonValueTypes=2218]="InvalidConditonValueTypes",e[e.InvalidCastTypeUsage=2219]="InvalidCastTypeUsage",e[e.InvalidCastTypeNotBase=2220]="InvalidCastTypeNotBase",e[e.InvalidCastUnknownType=2221]="InvalidCastUnknownType",e[e.InvalidUnaryOperation=2222]="InvalidUnaryOperation",e[e.InvalidPostfixNotArray=2223]="InvalidPostfixNotArray",e[e.InvalidPostfixNotIntIndex=2224]="InvalidPostfixNotIntIndex",e[e.InvalidPostfixNotField=2225]="InvalidPostfixNotField",e[e.InvalidPostfixArithmetic=2226]="InvalidPostfixArithmetic",e[e.InvalidComplexNotFunction=2227]="InvalidComplexNotFunction",e[e.InvalidComplexNotType=2228]="InvalidComplexNotType",e[e.InvalidComplexNotConstructor=2229]="InvalidComplexNotConstructor",e[e.InvalidCompileNotFunction=2230]="InvalidCompileNotFunction",e[e.InvalidCompileFunctionNotValid=2231]="InvalidCompileFunctionNotValid",e[e.FunctionRedefinition=2232]="FunctionRedefinition",e[e.InvalidWhileCondition=2233]="InvalidWhileCondition",e[e.InvalidDoWhileCondition=2234]="InvalidDoWhileCondition",e[e.InvalidIfCondition=2235]="InvalidIfCondition",e[e.InvalidForInitExpr=2236]="InvalidForInitExpr",e[e.InvalidForInitEmptyIterator=2237]="InvalidForInitEmptyIterator",e[e.InvalidForConditionEmpty=2238]="InvalidForConditionEmpty",e[e.InvalidForConditionRelation=2239]="InvalidForConditionRelation",e[e.InvalidForStepEmpty=2240]="InvalidForStepEmpty",e[e.InvalidForStepOperator=2241]="InvalidForStepOperator",e[e.InvalidForStepExpr=2242]="InvalidForStepExpr",e[e.InvalidNewFieldForStructName=2243]="InvalidNewFieldForStructName",e[e.InvalidNewFieldForStructSematic=2244]="InvalidNewFieldForStructSematic",e[e.InvalidNewAnnotationVar=2245]="InvalidNewAnnotationVar",e[e.InvalidFunctionParameterDefenitionDefaultNeeded=2246]="InvalidFunctionParameterDefenitionDefaultNeeded",e[e.CannotChooseFunction=2247]="CannotChooseFunction",e[e.InvalidFuncDefenitionReturnType=2248]="InvalidFuncDefenitionReturnType",e[e.InvalidSystemFunctionReturnType=2249]="InvalidSystemFunctionReturnType",e[e.InvalidTypeNameNotType=2250]="InvalidTypeNameNotType",e[e.InvalidTypeNameTemplateNotFound=2251]="InvalidTypeNameTemplateNotFound",e[e.InvalidTypeScope=2252]="InvalidTypeScope",e[e.CannotProduceType=2253]="CannotProduceType",e[e.InvalidTypeVectorMatrix=2254]="InvalidTypeVectorMatrix",e[e.TechniqueNameRedefinition=2255]="TechniqueNameRedefinition",e[e.InvalidFunctionRecursionNotAllowed=2256]="InvalidFunctionRecursionNotAllowed",e[e.InvalidFunctionImplementationNotFound=2257]="InvalidFunctionImplementationNotFound",e[e.FunctionIsNotCompatibleWithVertexShader=2258]="FunctionIsNotCompatibleWithVertexShader",e[e.FunctionIsNotCompatibleWithPixelShader=2259]="FunctionIsNotCompatibleWithPixelShader",e[e.InvalidReturnStmtVoid=2260]="InvalidReturnStmtVoid",e[e.InvalidReturnStmtEmpty=2261]="InvalidReturnStmtEmpty",e[e.InvalidReturnStmtTypesNotEqual=2262]="InvalidReturnStmtTypesNotEqual",e[e.InvalidFunctionReturnType=2263]="InvalidFunctionReturnType",e[e.InvalidFunctionParameterUsage=2264]="InvalidFunctionParameterUsage",e[e.InvalidTypeForWriting=2265]="InvalidTypeForWriting",e[e.InvalidTypeForReading=2266]="InvalidTypeForReading",e[e.InvalidExprIsNotLValue=2267]="InvalidExprIsNotLValue",e[e.InvalidVariableInitializing=2268]="InvalidVariableInitializing",e[e.UnsupportedStateIndex=2269]="UnsupportedStateIndex",e[e.InvalidSamplerTexture=2270]="InvalidSamplerTexture",e[e.CannotCalcPadding=2271]="CannotCalcPadding",e[e.ImportedComponentNotExists=2272]="ImportedComponentNotExists",e[e.InvalidFunctionReturnStmtNotFound=2273]="InvalidFunctionReturnStmtNotFound",e[e.UnsupportedProvideAs=2274]="UnsupportedProvideAs",e[e.UnreachableCode=2275]="UnreachableCode",e[e.PartFx_VertexShaderParametersMismatch=2276]="PartFx_VertexShaderParametersMismatch"}(n||(n={}))}});